/*
 * jQuery Templates Plugin 1.0.0pre
 * http://github.com/jquery/jquery-tmpl
 * Requires jQuery 1.4.2
 *
 * Copyright 2011, Software Freedom Conservancy, Inc.
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */
(function(jQuery,undefined){var oldManip=jQuery.fn.domManip,tmplItmAtt="_tmplitem",htmlExpr=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,newTmplItems={},wrappedItems={},appendToTmplItems,topTmplItem={key:0,data:{}},itemKey=0,cloneIndex=0,stack=[];function newTmplItem(options,parentItem,fn,data){var newItem={data:data||(data===0||data===false)?data:(parentItem?parentItem.data:{}),_wrap:parentItem?parentItem._wrap:null,tmpl:null,parent:parentItem||null,nodes:[],calls:tiCalls,nest:tiNest,wrap:tiWrap,html:tiHtml,update:tiUpdate};if(options){jQuery.extend(newItem,options,{nodes:[],parent:parentItem})}if(fn){newItem.tmpl=fn;newItem._ctnt=newItem._ctnt||newItem.tmpl(jQuery,newItem);newItem.key=++itemKey;(stack.length?wrappedItems:newTmplItems)[itemKey]=newItem}return newItem}jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var ret=[],insert=jQuery(selector),elems,i,l,tmplItems,parent=this.length===1&&this[0].parentNode;appendToTmplItems=newTmplItems||{};if(parent&&parent.nodeType===11&&parent.childNodes.length===1&&insert.length===1){insert[original](this[0]);ret=this}else{for(i=0,l=insert.length;i<l;i++){cloneIndex=i;elems=(i>0?this.clone(true):this).get();jQuery(insert[i])[original](elems);ret=ret.concat(elems)}cloneIndex=0;ret=this.pushStack(ret,name,insert.selector)}tmplItems=appendToTmplItems;appendToTmplItems=null;jQuery.tmpl.complete(tmplItems);return ret}});jQuery.fn.extend({tmpl:function(data,options,parentItem){return jQuery.tmpl(this[0],data,options,parentItem)},tmplItem:function(){return jQuery.tmplItem(this[0])},template:function(name){return jQuery.template(name,this[0])},domManip:function(args,table,callback,options){if(args[0]&&jQuery.isArray(args[0])){var dmArgs=jQuery.makeArray(arguments),elems=args[0],elemsLength=elems.length,i=0,tmplItem;while(i<elemsLength&&!(tmplItem=jQuery.data(elems[i++],"tmplItem"))){}if(tmplItem&&cloneIndex){dmArgs[2]=function(fragClone){jQuery.tmpl.afterManip(this,fragClone,callback)}}oldManip.apply(this,dmArgs)}else{oldManip.apply(this,arguments)}cloneIndex=0;if(!appendToTmplItems){jQuery.tmpl.complete(newTmplItems)}return this}});jQuery.extend({tmpl:function(tmpl,data,options,parentItem){var ret,topLevel=!parentItem;if(topLevel){parentItem=topTmplItem;tmpl=jQuery.template[tmpl]||jQuery.template(null,tmpl);wrappedItems={}}else{if(!tmpl){tmpl=parentItem.tmpl;newTmplItems[parentItem.key]=parentItem;parentItem.nodes=[];if(parentItem.wrapped){updateWrapped(parentItem,parentItem.wrapped)}return jQuery(build(parentItem,null,parentItem.tmpl(jQuery,parentItem)))}}if(!tmpl){return[]}if(typeof data==="function"){data=data.call(parentItem||{})}if(options&&options.wrapped){updateWrapped(options,options.wrapped)}ret=jQuery.isArray(data)?jQuery.map(data,function(dataItem){return dataItem?newTmplItem(options,parentItem,tmpl,dataItem):null}):[newTmplItem(options,parentItem,tmpl,data)];return topLevel?jQuery(build(parentItem,null,ret)):ret},tmplItem:function(elem){var tmplItem;if(elem instanceof jQuery){elem=elem[0]}while(elem&&elem.nodeType===1&&!(tmplItem=jQuery.data(elem,"tmplItem"))&&(elem=elem.parentNode)){}return tmplItem||topTmplItem},template:function(name,tmpl){if(tmpl){if(typeof tmpl==="string"){tmpl=buildTmplFn(tmpl)}else{if(tmpl instanceof jQuery){tmpl=tmpl[0]||{}}}if(tmpl.nodeType){tmpl=jQuery.data(tmpl,"tmpl")||jQuery.data(tmpl,"tmpl",buildTmplFn(tmpl.innerHTML))}return typeof name==="string"?(jQuery.template[name]=tmpl):tmpl}return name?(typeof name!=="string"?jQuery.template(null,name):(jQuery.template[name]||jQuery.template(null,htmlExpr.test(name)?name:jQuery(name)))):null},encode:function(text){return(""+text).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});jQuery.extend(jQuery.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(items){newTmplItems={}},afterManip:function afterManip(elem,fragClone,callback){var content=fragClone.nodeType===11?jQuery.makeArray(fragClone.childNodes):fragClone.nodeType===1?[fragClone]:[];callback.call(elem,fragClone);storeTmplItems(content);cloneIndex++}});function build(tmplItem,nested,content){var frag,ret=content?jQuery.map(content,function(item){return(typeof item==="string")?(tmplItem.key?item.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+tmplItmAtt+'="'+tmplItem.key+'" $2'):item):build(item,tmplItem,item._ctnt)}):tmplItem;if(nested){return ret}ret=ret.join("");ret.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(all,before,middle,after){frag=jQuery(middle).get();storeTmplItems(frag);if(before){frag=unencode(before).concat(frag)}if(after){frag=frag.concat(unencode(after))}});return frag?frag:unencode(ret)}function unencode(text){var el=document.createElement("div");el.innerHTML=text;return jQuery.makeArray(el.childNodes)}function buildTmplFn(markup){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+jQuery.trim(markup).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(all,slash,type,fnargs,target,parens,args){var tag=jQuery.tmpl.tag[type],def,expr,exprAutoFnDetect;if(!tag){throw"Unknown template tag: "+type}def=tag._default||[];if(parens&&!/\w$/.test(target)){target+=parens;parens=""}if(target){target=unescape(target);args=args?(","+unescape(args)+")"):(parens?")":"");expr=parens?(target.indexOf(".")>-1?target+unescape(parens):("("+target+").call($item"+args)):target;exprAutoFnDetect=parens?expr:"(typeof("+target+")==='function'?("+target+").call($item):("+target+"))"}else{exprAutoFnDetect=expr=def.$1||"null"}fnargs=unescape(fnargs);return"');"+tag[slash?"close":"open"].split("$notnull_1").join(target?"typeof("+target+")!=='undefined' && ("+target+")!=null":"true").split("$1a").join(exprAutoFnDetect).split("$1").join(expr).split("$2").join(fnargs||def.$2||"")+"__.push('"})+"');}return __;")}function updateWrapped(options,wrapped){options._wrap=build(options,true,jQuery.isArray(wrapped)?wrapped:[htmlExpr.test(wrapped)?wrapped:jQuery(wrapped).html()]).join("")}function unescape(args){return args?args.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function outerHtml(elem){var div=document.createElement("div");div.appendChild(elem.cloneNode(true));return div.innerHTML}function storeTmplItems(content){var keySuffix="_"+cloneIndex,elem,elems,newClonedItems={},i,l,m;for(i=0,l=content.length;i<l;i++){if((elem=content[i]).nodeType!==1){continue}elems=elem.getElementsByTagName("*");for(m=elems.length-1;m>=0;m--){processItemKey(elems[m])}processItemKey(elem)}function processItemKey(el){var pntKey,pntNode=el,pntItem,tmplItem,key;if((key=el.getAttribute(tmplItmAtt))){while(pntNode.parentNode&&(pntNode=pntNode.parentNode).nodeType===1&&!(pntKey=pntNode.getAttribute(tmplItmAtt))){}if(pntKey!==key){pntNode=pntNode.parentNode?(pntNode.nodeType===11?0:(pntNode.getAttribute(tmplItmAtt)||0)):0;if(!(tmplItem=newTmplItems[key])){tmplItem=wrappedItems[key];tmplItem=newTmplItem(tmplItem,newTmplItems[pntNode]||wrappedItems[pntNode]);tmplItem.key=++itemKey;newTmplItems[itemKey]=tmplItem}if(cloneIndex){cloneTmplItem(key)}}el.removeAttribute(tmplItmAtt)}else{if(cloneIndex&&(tmplItem=jQuery.data(el,"tmplItem"))){cloneTmplItem(tmplItem.key);newTmplItems[tmplItem.key]=tmplItem;pntNode=jQuery.data(el.parentNode,"tmplItem");pntNode=pntNode?pntNode.key:0}}if(tmplItem){pntItem=tmplItem;while(pntItem&&pntItem.key!=pntNode){pntItem.nodes.push(el);pntItem=pntItem.parent}delete tmplItem._ctnt;delete tmplItem._wrap;jQuery.data(el,"tmplItem",tmplItem)}function cloneTmplItem(key){key=key+keySuffix;tmplItem=newClonedItems[key]=(newClonedItems[key]||newTmplItem(tmplItem,newTmplItems[tmplItem.parent.key+keySuffix]||tmplItem.parent))}}}function tiCalls(content,tmpl,data,options){if(!content){return stack.pop()}stack.push({_:content,tmpl:tmpl,item:this,data:data,options:options})}function tiNest(tmpl,data,options){return jQuery.tmpl(jQuery.template(tmpl),data,options,this)}function tiWrap(call,wrapped){var options=call.options||{};options.wrapped=wrapped;return jQuery.tmpl(jQuery.template(call.tmpl),call.data,options,call.item)}function tiHtml(filter,textOnly){var wrapped=this._wrap;return jQuery.map(jQuery(jQuery.isArray(wrapped)?wrapped.join(""):wrapped).filter(filter||"*"),function(e){return textOnly?e.innerText||e.textContent:e.outerHTML||outerHtml(e)})}function tiUpdate(){var coll=this.nodes;jQuery.tmpl(null,null,null,this).insertBefore(coll[0]);jQuery(coll).remove()}})(jQuery);;
/*! jQuery Validation Plugin - v1.17.0 - 7/29/2017
 * https://jqueryvalidation.org/
 * Copyright (c) 2017 JÃ¶rn Zaefferer; Licensed MIT */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&module.exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){a.extend(a.fn,{validate:function(b){if(!this.length)return void(b&&b.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing."));var c=a.data(this[0],"validator");return c?c:(this.attr("novalidate","novalidate"),c=new a.validator(b,this[0]),a.data(this[0],"validator",c),c.settings.onsubmit&&(this.on("click.validate",":submit",function(b){c.submitButton=b.currentTarget,a(this).hasClass("cancel")&&(c.cancelSubmit=!0),void 0!==a(this).attr("formnovalidate")&&(c.cancelSubmit=!0)}),this.on("submit.validate",function(b){function d(){var d,e;return c.submitButton&&(c.settings.submitHandler||c.formSubmitted)&&(d=a("<input type='hidden'/>").attr("name",c.submitButton.name).val(a(c.submitButton).val()).appendTo(c.currentForm)),!c.settings.submitHandler||(e=c.settings.submitHandler.call(c,c.currentForm,b),d&&d.remove(),void 0!==e&&e)}return c.settings.debug&&b.preventDefault(),c.cancelSubmit?(c.cancelSubmit=!1,d()):c.form()?c.pendingRequest?(c.formSubmitted=!0,!1):d():(c.focusInvalid(),!1)})),c)},valid:function(){var b,c,d;return a(this[0]).is("form")?b=this.validate().form():(d=[],b=!0,c=a(this[0].form).validate(),this.each(function(){b=c.element(this)&&b,b||(d=d.concat(c.errorList))}),c.errorList=d),b},rules:function(b,c){var d,e,f,g,h,i,j=this[0];if(null!=j&&(!j.form&&j.hasAttribute("contenteditable")&&(j.form=this.closest("form")[0],j.name=this.attr("name")),null!=j.form)){if(b)switch(d=a.data(j.form,"validator").settings,e=d.rules,f=a.validator.staticRules(j),b){case"add":a.extend(f,a.validator.normalizeRule(c)),delete f.messages,e[j.name]=f,c.messages&&(d.messages[j.name]=a.extend(d.messages[j.name],c.messages));break;case"remove":return c?(i={},a.each(c.split(/\s/),function(a,b){i[b]=f[b],delete f[b]}),i):(delete e[j.name],f)}return g=a.validator.normalizeRules(a.extend({},a.validator.classRules(j),a.validator.attributeRules(j),a.validator.dataRules(j),a.validator.staticRules(j)),j),g.required&&(h=g.required,delete g.required,g=a.extend({required:h},g)),g.remote&&(h=g.remote,delete g.remote,g=a.extend(g,{remote:h})),g}}}),a.extend(a.expr.pseudos||a.expr[":"],{blank:function(b){return!a.trim(""+a(b).val())},filled:function(b){var c=a(b).val();return null!==c&&!!a.trim(""+c)},unchecked:function(b){return!a(b).prop("checked")}}),a.validator=function(b,c){this.settings=a.extend(!0,{},a.validator.defaults,b),this.currentForm=c,this.init()},a.validator.format=function(b,c){return 1===arguments.length?function(){var c=a.makeArray(arguments);return c.unshift(b),a.validator.format.apply(this,c)}:void 0===c?b:(arguments.length>2&&c.constructor!==Array&&(c=a.makeArray(arguments).slice(1)),c.constructor!==Array&&(c=[c]),a.each(c,function(a,c){b=b.replace(new RegExp("\\{"+a+"\\}","g"),function(){return c})}),b)},a.extend(a.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",pendingClass:"pending",validClass:"valid",errorElement:"label",focusCleanup:!1,focusInvalid:!0,errorContainer:a([]),errorLabelContainer:a([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(a){this.lastActive=a,this.settings.focusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,a,this.settings.errorClass,this.settings.validClass),this.hideThese(this.errorsFor(a)))},onfocusout:function(a){this.checkable(a)||!(a.name in this.submitted)&&this.optional(a)||this.element(a)},onkeyup:function(b,c){var d=[16,17,18,20,35,36,37,38,39,40,45,144,225];9===c.which&&""===this.elementValue(b)||a.inArray(c.keyCode,d)!==-1||(b.name in this.submitted||b.name in this.invalid)&&this.element(b)},onclick:function(a){a.name in this.submitted?this.element(a):a.parentNode.name in this.submitted&&this.element(a.parentNode)},highlight:function(b,c,d){"radio"===b.type?this.findByName(b.name).addClass(c).removeClass(d):a(b).addClass(c).removeClass(d)},unhighlight:function(b,c,d){"radio"===b.type?this.findByName(b.name).removeClass(c).addClass(d):a(b).removeClass(c).addClass(d)}},setDefaults:function(b){a.extend(a.validator.defaults,b)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",equalTo:"Please enter the same value again.",maxlength:a.validator.format("Please enter no more than {0} characters."),minlength:a.validator.format("Please enter at least {0} characters."),rangelength:a.validator.format("Please enter a value between {0} and {1} characters long."),range:a.validator.format("Please enter a value between {0} and {1}."),max:a.validator.format("Please enter a value less than or equal to {0}."),min:a.validator.format("Please enter a value greater than or equal to {0}."),step:a.validator.format("Please enter a multiple of {0}.")},autoCreateRanges:!1,prototype:{init:function(){function b(b){!this.form&&this.hasAttribute("contenteditable")&&(this.form=a(this).closest("form")[0],this.name=a(this).attr("name"));var c=a.data(this.form,"validator"),d="on"+b.type.replace(/^validate/,""),e=c.settings;e[d]&&!a(this).is(e.ignore)&&e[d].call(c,this,b)}this.labelContainer=a(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||a(this.currentForm),this.containers=a(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var c,d=this.groups={};a.each(this.settings.groups,function(b,c){"string"==typeof c&&(c=c.split(/\s/)),a.each(c,function(a,c){d[c]=b})}),c=this.settings.rules,a.each(c,function(b,d){c[b]=a.validator.normalizeRule(d)}),a(this.currentForm).on("focusin.validate focusout.validate keyup.validate",":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'], [type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox'], [contenteditable], [type='button']",b).on("click.validate","select, option, [type='radio'], [type='checkbox']",b),this.settings.invalidHandler&&a(this.currentForm).on("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),a.extend(this.submitted,this.errorMap),this.invalid=a.extend({},this.errorMap),this.valid()||a(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var a=0,b=this.currentElements=this.elements();b[a];a++)this.check(b[a]);return this.valid()},element:function(b){var c,d,e=this.clean(b),f=this.validationTargetFor(e),g=this,h=!0;return void 0===f?delete this.invalid[e.name]:(this.prepareElement(f),this.currentElements=a(f),d=this.groups[f.name],d&&a.each(this.groups,function(a,b){b===d&&a!==f.name&&(e=g.validationTargetFor(g.clean(g.findByName(a))),e&&e.name in g.invalid&&(g.currentElements.push(e),h=g.check(e)&&h))}),c=this.check(f)!==!1,h=h&&c,c?this.invalid[f.name]=!1:this.invalid[f.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),a(b).attr("aria-invalid",!c)),h},showErrors:function(b){if(b){var c=this;a.extend(this.errorMap,b),this.errorList=a.map(this.errorMap,function(a,b){return{message:a,element:c.findByName(b)[0]}}),this.successList=a.grep(this.successList,function(a){return!(a.name in b)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){a.fn.resetForm&&a(this.currentForm).resetForm(),this.invalid={},this.submitted={},this.prepareForm(),this.hideErrors();var b=this.elements().removeData("previousValue").removeAttr("aria-invalid");this.resetElements(b)},resetElements:function(a){var b;if(this.settings.unhighlight)for(b=0;a[b];b++)this.settings.unhighlight.call(this,a[b],this.settings.errorClass,""),this.findByName(a[b].name).removeClass(this.settings.validClass);else a.removeClass(this.settings.errorClass).removeClass(this.settings.validClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(a){var b,c=0;for(b in a)void 0!==a[b]&&null!==a[b]&&a[b]!==!1&&c++;return c},hideErrors:function(){this.hideThese(this.toHide)},hideThese:function(a){a.not(this.containers).text(""),this.addWrapper(a).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{a(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(b){}},findLastActive:function(){var b=this.lastActive;return b&&1===a.grep(this.errorList,function(a){return a.element.name===b.name}).length&&b},elements:function(){var b=this,c={};return a(this.currentForm).find("input, select, textarea, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter(function(){var d=this.name||a(this).attr("name");return!d&&b.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.hasAttribute("contenteditable")&&(this.form=a(this).closest("form")[0],this.name=d),!(d in c||!b.objectLength(a(this).rules()))&&(c[d]=!0,!0)})},clean:function(b){return a(b)[0]},errors:function(){var b=this.settings.errorClass.split(" ").join(".");return a(this.settings.errorElement+"."+b,this.errorContext)},resetInternals:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=a([]),this.toHide=a([])},reset:function(){this.resetInternals(),this.currentElements=a([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(a){this.reset(),this.toHide=this.errorsFor(a)},elementValue:function(b){var c,d,e=a(b),f=b.type;return"radio"===f||"checkbox"===f?this.findByName(b.name).filter(":checked").val():"number"===f&&"undefined"!=typeof b.validity?b.validity.badInput?"NaN":e.val():(c=b.hasAttribute("contenteditable")?e.text():e.val(),"file"===f?"C:\\fakepath\\"===c.substr(0,12)?c.substr(12):(d=c.lastIndexOf("/"),d>=0?c.substr(d+1):(d=c.lastIndexOf("\\"),d>=0?c.substr(d+1):c)):"string"==typeof c?c.replace(/\r/g,""):c)},check:function(b){b=this.validationTargetFor(this.clean(b));var c,d,e,f,g=a(b).rules(),h=a.map(g,function(a,b){return b}).length,i=!1,j=this.elementValue(b);if("function"==typeof g.normalizer?f=g.normalizer:"function"==typeof this.settings.normalizer&&(f=this.settings.normalizer),f){if(j=f.call(b,j),"string"!=typeof j)throw new TypeError("The normalizer should return a string value.");delete g.normalizer}for(d in g){e={method:d,parameters:g[d]};try{if(c=a.validator.methods[d].call(this,j,b,e.parameters),"dependency-mismatch"===c&&1===h){i=!0;continue}if(i=!1,"pending"===c)return void(this.toHide=this.toHide.not(this.errorsFor(b)));if(!c)return this.formatAndAdd(b,e),!1}catch(k){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+b.id+", check the '"+e.method+"' method.",k),k instanceof TypeError&&(k.message+=".  Exception occurred when checking element "+b.id+", check the '"+e.method+"' method."),k}}if(!i)return this.objectLength(g)&&this.successList.push(b),!0},customDataMessage:function(b,c){return a(b).data("msg"+c.charAt(0).toUpperCase()+c.substring(1).toLowerCase())||a(b).data("msg")},customMessage:function(a,b){var c=this.settings.messages[a];return c&&(c.constructor===String?c:c[b])},findDefined:function(){for(var a=0;a<arguments.length;a++)if(void 0!==arguments[a])return arguments[a]},defaultMessage:function(b,c){"string"==typeof c&&(c={method:c});var d=this.findDefined(this.customMessage(b.name,c.method),this.customDataMessage(b,c.method),!this.settings.ignoreTitle&&b.title||void 0,a.validator.messages[c.method],"<strong>Warning: No message defined for "+b.name+"</strong>"),e=/\$?\{(\d+)\}/g;return"function"==typeof d?d=d.call(this,c.parameters,b):e.test(d)&&(d=a.validator.format(d.replace(e,"{$1}"),c.parameters)),d},formatAndAdd:function(a,b){var c=this.defaultMessage(a,b);this.errorList.push({message:c,element:a,method:b.method}),this.errorMap[a.name]=c,this.submitted[a.name]=c},addWrapper:function(a){return this.settings.wrapper&&(a=a.add(a.parent(this.settings.wrapper))),a},defaultShowErrors:function(){var a,b,c;for(a=0;this.errorList[a];a++)c=this.errorList[a],this.settings.highlight&&this.settings.highlight.call(this,c.element,this.settings.errorClass,this.settings.validClass),this.showLabel(c.element,c.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(a=0;this.successList[a];a++)this.showLabel(this.successList[a]);if(this.settings.unhighlight)for(a=0,b=this.validElements();b[a];a++)this.settings.unhighlight.call(this,b[a],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return a(this.errorList).map(function(){return this.element})},showLabel:function(b,c){var d,e,f,g,h=this.errorsFor(b),i=this.idOrName(b),j=a(b).attr("aria-describedby");h.length?(h.removeClass(this.settings.validClass).addClass(this.settings.errorClass),h.html(c)):(h=a("<"+this.settings.errorElement+">").attr("id",i+"-error").addClass(this.settings.errorClass).html(c||""),d=h,this.settings.wrapper&&(d=h.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.length?this.labelContainer.append(d):this.settings.errorPlacement?this.settings.errorPlacement.call(this,d,a(b)):d.insertAfter(b),h.is("label")?h.attr("for",i):0===h.parents("label[for='"+this.escapeCssMeta(i)+"']").length&&(f=h.attr("id"),j?j.match(new RegExp("\\b"+this.escapeCssMeta(f)+"\\b"))||(j+=" "+f):j=f,a(b).attr("aria-describedby",j),e=this.groups[b.name],e&&(g=this,a.each(g.groups,function(b,c){c===e&&a("[name='"+g.escapeCssMeta(b)+"']",g.currentForm).attr("aria-describedby",h.attr("id"))})))),!c&&this.settings.success&&(h.text(""),"string"==typeof this.settings.success?h.addClass(this.settings.success):this.settings.success(h,b)),this.toShow=this.toShow.add(h)},errorsFor:function(b){var c=this.escapeCssMeta(this.idOrName(b)),d=a(b).attr("aria-describedby"),e="label[for='"+c+"'], label[for='"+c+"'] *";return d&&(e=e+", #"+this.escapeCssMeta(d).replace(/\s+/g,", #")),this.errors().filter(e)},escapeCssMeta:function(a){return a.replace(/([\\!"#$%&'()*+,.\/:;<=>?@\[\]^`{|}~])/g,"\\$1")},idOrName:function(a){return this.groups[a.name]||(this.checkable(a)?a.name:a.id||a.name)},validationTargetFor:function(b){return this.checkable(b)&&(b=this.findByName(b.name)),a(b).not(this.settings.ignore)[0]},checkable:function(a){return/radio|checkbox/i.test(a.type)},findByName:function(b){return a(this.currentForm).find("[name='"+this.escapeCssMeta(b)+"']")},getLength:function(b,c){switch(c.nodeName.toLowerCase()){case"select":return a("option:selected",c).length;case"input":if(this.checkable(c))return this.findByName(c.name).filter(":checked").length}return b.length},depend:function(a,b){return!this.dependTypes[typeof a]||this.dependTypes[typeof a](a,b)},dependTypes:{"boolean":function(a){return a},string:function(b,c){return!!a(b,c.form).length},"function":function(a,b){return a(b)}},optional:function(b){var c=this.elementValue(b);return!a.validator.methods.required.call(this,c,b)&&"dependency-mismatch"},startRequest:function(b){this.pending[b.name]||(this.pendingRequest++,a(b).addClass(this.settings.pendingClass),this.pending[b.name]=!0)},stopRequest:function(b,c){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[b.name],a(b).removeClass(this.settings.pendingClass),c&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(a(this.currentForm).submit(),this.submitButton&&a("input:hidden[name='"+this.submitButton.name+"']",this.currentForm).remove(),this.formSubmitted=!1):!c&&0===this.pendingRequest&&this.formSubmitted&&(a(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(b,c){return c="string"==typeof c&&c||"remote",a.data(b,"previousValue")||a.data(b,"previousValue",{old:null,valid:!0,message:this.defaultMessage(b,{method:c})})},destroy:function(){this.resetForm(),a(this.currentForm).off(".validate").removeData("validator").find(".validate-equalTo-blur").off(".validate-equalTo").removeClass("validate-equalTo-blur")}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(b,c){b.constructor===String?this.classRuleSettings[b]=c:a.extend(this.classRuleSettings,b)},classRules:function(b){var c={},d=a(b).attr("class");return d&&a.each(d.split(" "),function(){this in a.validator.classRuleSettings&&a.extend(c,a.validator.classRuleSettings[this])}),c},normalizeAttributeRule:function(a,b,c,d){/min|max|step/.test(c)&&(null===b||/number|range|text/.test(b))&&(d=Number(d),isNaN(d)&&(d=void 0)),d||0===d?a[c]=d:b===c&&"range"!==b&&(a[c]=!0)},attributeRules:function(b){var c,d,e={},f=a(b),g=b.getAttribute("type");for(c in a.validator.methods)"required"===c?(d=b.getAttribute(c),""===d&&(d=!0),d=!!d):d=f.attr(c),this.normalizeAttributeRule(e,g,c,d);return e.maxlength&&/-1|2147483647|524288/.test(e.maxlength)&&delete e.maxlength,e},dataRules:function(b){var c,d,e={},f=a(b),g=b.getAttribute("type");for(c in a.validator.methods)d=f.data("rule"+c.charAt(0).toUpperCase()+c.substring(1).toLowerCase()),this.normalizeAttributeRule(e,g,c,d);return e},staticRules:function(b){var c={},d=a.data(b.form,"validator");return d.settings.rules&&(c=a.validator.normalizeRule(d.settings.rules[b.name])||{}),c},normalizeRules:function(b,c){return a.each(b,function(d,e){if(e===!1)return void delete b[d];if(e.param||e.depends){var f=!0;switch(typeof e.depends){case"string":f=!!a(e.depends,c.form).length;break;case"function":f=e.depends.call(c,c)}f?b[d]=void 0===e.param||e.param:(a.data(c.form,"validator").resetElements(a(c)),delete b[d])}}),a.each(b,function(d,e){b[d]=a.isFunction(e)&&"normalizer"!==d?e(c):e}),a.each(["minlength","maxlength"],function(){b[this]&&(b[this]=Number(b[this]))}),a.each(["rangelength","range"],function(){var c;b[this]&&(a.isArray(b[this])?b[this]=[Number(b[this][0]),Number(b[this][1])]:"string"==typeof b[this]&&(c=b[this].replace(/[\[\]]/g,"").split(/[\s,]+/),b[this]=[Number(c[0]),Number(c[1])]))}),a.validator.autoCreateRanges&&(null!=b.min&&null!=b.max&&(b.range=[b.min,b.max],delete b.min,delete b.max),null!=b.minlength&&null!=b.maxlength&&(b.rangelength=[b.minlength,b.maxlength],delete b.minlength,delete b.maxlength)),b},normalizeRule:function(b){if("string"==typeof b){var c={};a.each(b.split(/\s/),function(){c[this]=!0}),b=c}return b},addMethod:function(b,c,d){a.validator.methods[b]=c,a.validator.messages[b]=void 0!==d?d:a.validator.messages[b],c.length<3&&a.validator.addClassRules(b,a.validator.normalizeRule(b))},methods:{required:function(b,c,d){if(!this.depend(d,c))return"dependency-mismatch";if("select"===c.nodeName.toLowerCase()){var e=a(c).val();return e&&e.length>0}return this.checkable(c)?this.getLength(b,c)>0:b.length>0},email:function(a,b){return this.optional(b)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(a)},url:function(a,b){return this.optional(b)||/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[\/?#]\S*)?$/i.test(a)},date:function(a,b){return this.optional(b)||!/Invalid|NaN/.test(new Date(a).toString())},dateISO:function(a,b){return this.optional(b)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(a)},number:function(a,b){return this.optional(b)||/^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a)},digits:function(a,b){return this.optional(b)||/^\d+$/.test(a)},minlength:function(b,c,d){var e=a.isArray(b)?b.length:this.getLength(b,c);return this.optional(c)||e>=d},maxlength:function(b,c,d){var e=a.isArray(b)?b.length:this.getLength(b,c);return this.optional(c)||e<=d},rangelength:function(b,c,d){var e=a.isArray(b)?b.length:this.getLength(b,c);return this.optional(c)||e>=d[0]&&e<=d[1]},min:function(a,b,c){return this.optional(b)||a>=c},max:function(a,b,c){return this.optional(b)||a<=c},range:function(a,b,c){return this.optional(b)||a>=c[0]&&a<=c[1]},step:function(b,c,d){var e,f=a(c).attr("type"),g="Step attribute on input type "+f+" is not supported.",h=["text","number","range"],i=new RegExp("\\b"+f+"\\b"),j=f&&!i.test(h.join()),k=function(a){var b=(""+a).match(/(?:\.(\d+))?$/);return b&&b[1]?b[1].length:0},l=function(a){return Math.round(a*Math.pow(10,e))},m=!0;if(j)throw new Error(g);return e=k(d),(k(b)>e||l(b)%l(d)!==0)&&(m=!1),this.optional(c)||m},equalTo:function(b,c,d){var e=a(d);return this.settings.onfocusout&&e.not(".validate-equalTo-blur").length&&e.addClass("validate-equalTo-blur").on("blur.validate-equalTo",function(){a(c).valid()}),b===e.val()},remote:function(b,c,d,e){if(this.optional(c))return"dependency-mismatch";e="string"==typeof e&&e||"remote";var f,g,h,i=this.previousValue(c,e);return this.settings.messages[c.name]||(this.settings.messages[c.name]={}),i.originalMessage=i.originalMessage||this.settings.messages[c.name][e],this.settings.messages[c.name][e]=i.message,d="string"==typeof d&&{url:d}||d,h=a.param(a.extend({data:b},d.data)),i.old===h?i.valid:(i.old=h,f=this,this.startRequest(c),g={},g[c.name]=b,a.ajax(a.extend(!0,{mode:"abort",port:"validate"+c.name,dataType:"json",data:g,context:f.currentForm,success:function(a){var d,g,h,j=a===!0||"true"===a;f.settings.messages[c.name][e]=i.originalMessage,j?(h=f.formSubmitted,f.resetInternals(),f.toHide=f.errorsFor(c),f.formSubmitted=h,f.successList.push(c),f.invalid[c.name]=!1,f.showErrors()):(d={},g=a||f.defaultMessage(c,{method:e,parameters:b}),d[c.name]=i.message=g,f.invalid[c.name]=!0,f.showErrors(d)),i.valid=j,f.stopRequest(c,j)}},d)),"pending")}}});var b,c={};return a.ajaxPrefilter?a.ajaxPrefilter(function(a,b,d){var e=a.port;"abort"===a.mode&&(c[e]&&c[e].abort(),c[e]=d)}):(b=a.ajax,a.ajax=function(d){var e=("mode"in d?d:a.ajaxSettings).mode,f=("port"in d?d:a.ajaxSettings).port;return"abort"===e?(c[f]&&c[f].abort(),c[f]=b.apply(this,arguments),c[f]):b.apply(this,arguments)}),a});;
/*
** Unobtrusive validation support library for jQuery and jQuery Validate
** Copyright (C) Microsoft Corporation. All rights reserved.
*/
(function($){var $jQval=$.validator,adapters,data_validation="unobtrusiveValidation";function setValidationValues(options,ruleName,value){options.rules[ruleName]=value;if(options.message){options.messages[ruleName]=options.message}}function splitAndTrim(value){return value.replace(/^\s+|\s+$/g,"").split(/\s*,\s*/g)}function escapeAttributeValue(value){return value.replace(/([!"#$%&'()*+,./:;<=>?@\[\\\]^`{|}~])/g,"\\$1")}function getModelPrefix(fieldName){return fieldName.substr(0,fieldName.lastIndexOf(".")+1)}function appendModelPrefix(value,prefix){if(value.indexOf("*.")===0){value=value.replace("*.",prefix)}return value}function onError(error,inputElement){var container=$(this).find("[data-valmsg-for='"+escapeAttributeValue(inputElement[0].name)+"']"),replaceAttrValue=container.attr("data-valmsg-replace"),replace=replaceAttrValue?$.parseJSON(replaceAttrValue)!==false:null;container.removeClass("field-validation-valid").addClass("field-validation-error");error.data("unobtrusiveContainer",container);if(replace){container.empty();error.removeClass("input-validation-error").appendTo(container)}else{error.hide()}}function onErrors(event,validator){var container=$(this).find("[data-valmsg-summary=true]"),list=container.find("ul");if(list&&list.length&&validator.errorList.length){list.empty();container.addClass("validation-summary-errors").removeClass("validation-summary-valid");$.each(validator.errorList,function(){$("<li />").html(this.message).appendTo(list)})}}function onSuccess(error){var container=error.data("unobtrusiveContainer"),replaceAttrValue=container.attr("data-valmsg-replace"),replace=replaceAttrValue?$.parseJSON(replaceAttrValue):null;if(container){container.addClass("field-validation-valid").removeClass("field-validation-error");error.removeData("unobtrusiveContainer");if(replace){container.empty()}}}function onReset(event){var $form=$(this);$form.data("validator").resetForm();$form.find(".validation-summary-errors").addClass("validation-summary-valid").removeClass("validation-summary-errors");$form.find(".field-validation-error").addClass("field-validation-valid").removeClass("field-validation-error").removeData("unobtrusiveContainer").find(">*").removeData("unobtrusiveContainer")}function validationInfo(form){var $form=$(form),result=$form.data(data_validation),onResetProxy=$.proxy(onReset,form);if(!result){result={options:{errorClass:"input-validation-error",errorElement:"span",errorPlacement:$.proxy(onError,form),invalidHandler:$.proxy(onErrors,form),messages:{},rules:{},success:$.proxy(onSuccess,form)},attachValidation:function(){$form.unbind("reset."+data_validation,onResetProxy).bind("reset."+data_validation,onResetProxy).validate(this.options)},validate:function(){$form.validate();return $form.valid()}};$form.data(data_validation,result)}return result}$jQval.unobtrusive={adapters:[],parseElement:function(element,skipAttach){var $element=$(element),form=$element.parents("form")[0],valInfo,rules,messages;if(!form){return}valInfo=validationInfo(form);valInfo.options.rules[element.name]=rules={};valInfo.options.messages[element.name]=messages={};$.each(this.adapters,function(){var prefix="data-val-"+this.name,message=$element.attr(prefix),paramValues={};if(message!==undefined){prefix+="-";$.each(this.params,function(){paramValues[this]=$element.attr(prefix+this)});this.adapt({element:element,form:form,message:message,params:paramValues,rules:rules,messages:messages})}});$.extend(rules,{__dummy__:true});if(!skipAttach){valInfo.attachValidation()}},parse:function(selector){var $forms=$(selector).parents("form").andSelf().add($(selector).find("form")).filter("form");$(selector).find(":input[data-val=true]").each(function(){$jQval.unobtrusive.parseElement(this,true)});$forms.each(function(){var info=validationInfo(this);if(info){info.attachValidation()}})}};adapters=$jQval.unobtrusive.adapters;adapters.add=function(adapterName,params,fn){if(!fn){fn=params;params=[]}this.push({name:adapterName,params:params,adapt:fn});return this};adapters.addBool=function(adapterName,ruleName){return this.add(adapterName,function(options){setValidationValues(options,ruleName||adapterName,true)})};adapters.addMinMax=function(adapterName,minRuleName,maxRuleName,minMaxRuleName,minAttribute,maxAttribute){return this.add(adapterName,[minAttribute||"min",maxAttribute||"max"],function(options){var min=options.params.min,max=options.params.max;if(min&&max){setValidationValues(options,minMaxRuleName,[min,max])}else{if(min){setValidationValues(options,minRuleName,min)}else{if(max){setValidationValues(options,maxRuleName,max)}}}})};adapters.addSingleVal=function(adapterName,attribute,ruleName){return this.add(adapterName,[attribute||"val"],function(options){setValidationValues(options,ruleName||adapterName,options.params[attribute])})};$jQval.addMethod("__dummy__",function(value,element,params){return true});$jQval.addMethod("regex",function(value,element,params){var match;if(this.optional(element)){return true}match=new RegExp(params).exec(value);return(match&&(match.index===0)&&(match[0].length===value.length))});$jQval.addMethod("nonalphamin",function(value,element,nonalphamin){var match;if(nonalphamin){match=value.match(/\W/g);match=match&&match.length>=nonalphamin}return match});adapters.addSingleVal("accept","exts").addSingleVal("regex","pattern");adapters.addBool("creditcard").addBool("date").addBool("digits").addBool("email").addBool("number").addBool("url");adapters.addMinMax("length","minlength","maxlength","rangelength").addMinMax("range","min","max","range");adapters.add("equalto",["other"],function(options){var prefix=getModelPrefix(options.element.name),other=options.params.other,fullOtherName=appendModelPrefix(other,prefix),element=$(options.form).find(":input[name='"+escapeAttributeValue(fullOtherName)+"']")[0];setValidationValues(options,"equalTo",element)});adapters.add("required",function(options){if(options.element.tagName.toUpperCase()!=="INPUT"||options.element.type.toUpperCase()!=="CHECKBOX"){setValidationValues(options,"required",true)}});adapters.add("remote",["url","type","additionalfields"],function(options){var value={url:options.params.url,type:options.params.type||"GET",data:{}},prefix=getModelPrefix(options.element.name);$.each(splitAndTrim(options.params.additionalfields||options.element.name),function(i,fieldName){var paramName=appendModelPrefix(fieldName,prefix);value.data[paramName]=function(){return $(options.form).find(":input[name='"+escapeAttributeValue(paramName)+"']").val()}});setValidationValues(options,"remote",value)});adapters.add("password",["min","nonalphamin","regex"],function(options){if(options.params.min){setValidationValues(options,"minlength",options.params.min)}if(options.params.nonalphamin){setValidationValues(options,"nonalphamin",options.params.nonalphamin)}if(options.params.regex){setValidationValues(options,"regex",options.params.regex)}});$(function(){$jQval.unobtrusive.parse(document)})}(jQuery));!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Styles=e():t.Styles=e()}("undefined"!=typeof self?self:this,function(){return webpackJsonp_name_([3],{223:function(t,e,i){i(35),t.exports=i(425)},425:function(t,e,i){i(426),i(427),i(428),i(429),i(430),i(431),i(432),i(433),i(434),i(435),i(436)},426:function(t,e){+function(t){function e(e){return this.each(function(){var i=t(this),n=i.data("bs.alert");n||i.data("bs.alert",n=new o(this)),"string"==typeof e&&n[e].call(i)})}var i='[data-dismiss="alert"]',o=function(e){t(e).on("click",i,this.close)};o.VERSION="3.4.1",o.TRANSITION_DURATION=150,o.prototype.close=function(e){function i(){a.detach().trigger("closed.bs.alert").remove()}var n=t(this),s=n.attr("data-target");s||(s=n.attr("href"),s=s&&s.replace(/.*(?=#[^\s]*$)/,"")),s="#"===s?[]:s;var a=t(document).find(s);e&&e.preventDefault(),a.length||(a=n.closest(".alert")),a.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(a.removeClass("in"),t.support.transition&&a.hasClass("fade")?a.one("bsTransitionEnd",i).emulateTransitionEnd(o.TRANSITION_DURATION):i())};var n=t.fn.alert;t.fn.alert=e,t.fn.alert.Constructor=o,t.fn.alert.noConflict=function(){return t.fn.alert=n,this},t(document).on("click.bs.alert.data-api",i,o.prototype.close)}(jQuery)},427:function(t,e){+function(t){function e(e){return this.each(function(){var o=t(this),n=o.data("bs.button"),s="object"==typeof e&&e;n||o.data("bs.button",n=new i(this,s)),"toggle"==e?n.toggle():e&&n.setState(e)})}var i=function(e,o){this.$element=t(e),this.options=t.extend({},i.DEFAULTS,o),this.isLoading=!1};i.VERSION="3.4.1",i.DEFAULTS={loadingText:"loading..."},i.prototype.setState=function(e){var i="disabled",o=this.$element,n=o.is("input")?"val":"html",s=o.data();e+="Text",null==s.resetText&&o.data("resetText",o[n]()),setTimeout(t.proxy(function(){o[n](null==s[e]?this.options[e]:s[e]),"loadingText"==e?(this.isLoading=!0,o.addClass(i).attr(i,i).prop(i,!0)):this.isLoading&&(this.isLoading=!1,o.removeClass(i).removeAttr(i).prop(i,!1))},this),0)},i.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var i=this.$element.find("input");"radio"==i.prop("type")?(i.prop("checked")&&(t=!1),e.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==i.prop("type")&&(i.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),i.prop("checked",this.$element.hasClass("active")),t&&i.trigger("change")}else{this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")}};var o=t.fn.button;t.fn.button=e,t.fn.button.Constructor=i,t.fn.button.noConflict=function(){return t.fn.button=o,this},t(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(i){var o=t(i.target).closest(".btn");e.call(o,"toggle"),t(i.target).is('input[type="radio"], input[type="checkbox"]')||(i.preventDefault(),o.is("input,button")?o.trigger("focus"):o.find("input:visible,button:visible").first().trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){t(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery)},428:function(t,e){+function(t){function e(e){var i,o=e.attr("data-target")||(i=e.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"");return t(document).find(o)}function i(e){return this.each(function(){var i=t(this),n=i.data("bs.collapse"),s=t.extend({},o.DEFAULTS,i.data(),"object"==typeof e&&e);!n&&s.toggle&&/show|hide/.test(e)&&(s.toggle=!1),n||i.data("bs.collapse",n=new o(this,s)),"string"==typeof e&&n[e]()})}var o=function(e,i){this.$element=t(e),this.options=t.extend({},o.DEFAULTS,i),this.$trigger=t('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};o.VERSION="3.4.1",o.TRANSITION_DURATION=350,o.DEFAULTS={toggle:!0},o.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},o.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,n=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(n&&n.length&&(e=n.data("bs.collapse"))&&e.transitioning)){var s=t.Event("show.bs.collapse");if(this.$element.trigger(s),!s.isDefaultPrevented()){n&&n.length&&(i.call(n,"hide"),e||n.data("bs.collapse",null));var a=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[a](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var r=function(){this.$element.removeClass("collapsing").addClass("collapse in")[a](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition){return r.call(this)}var l=t.camelCase(["scroll",a].join("-"));this.$element.one("bsTransitionEnd",t.proxy(r,this)).emulateTransitionEnd(o.TRANSITION_DURATION)[a](this.$element[0][l])}}}},o.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var n=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!t.support.transition){return n.call(this)}this.$element[i](0).one("bsTransitionEnd",t.proxy(n,this)).emulateTransitionEnd(o.TRANSITION_DURATION)}}},o.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},o.prototype.getParent=function(){return t(document).find(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy(function(i,o){var n=t(o);this.addAriaAndCollapsedClass(e(n),n)},this)).end()},o.prototype.addAriaAndCollapsedClass=function(t,e){var i=t.hasClass("in");t.attr("aria-expanded",i),e.toggleClass("collapsed",!i).attr("aria-expanded",i)};var n=t.fn.collapse;t.fn.collapse=i,t.fn.collapse.Constructor=o,t.fn.collapse.noConflict=function(){return t.fn.collapse=n,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(o){var n=t(this);n.attr("data-target")||o.preventDefault();var s=e(n),a=s.data("bs.collapse"),r=a?"toggle":n.data();i.call(s,r)})}(jQuery)},429:function(t,e){+function(t){function e(e){var i=e.attr("data-target");i||(i=e.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var o="#"!==i?t(document).find(i):null;return o&&o.length?o:e.parent()}function i(i){i&&3===i.which||(t(n).remove(),t(s).each(function(){var o=t(this),n=e(o),s={relatedTarget:this};n.hasClass("open")&&(i&&"click"==i.type&&/input|textarea/i.test(i.target.tagName)&&t.contains(n[0],i.target)||(n.trigger(i=t.Event("hide.bs.dropdown",s)),i.isDefaultPrevented()||(o.attr("aria-expanded","false"),n.removeClass("open").trigger(t.Event("hidden.bs.dropdown",s)))))}))}function o(e){return this.each(function(){var i=t(this),o=i.data("bs.dropdown");o||i.data("bs.dropdown",o=new a(this)),"string"==typeof e&&o[e].call(i)})}var n=".dropdown-backdrop",s='[data-toggle="dropdown"]',a=function(e){t(e).on("click.bs.dropdown",this.toggle)};a.VERSION="3.4.1",a.prototype.toggle=function(o){var n=t(this);if(!n.is(".disabled, :disabled")){var s=e(n),a=s.hasClass("open");if(i(),!a){"ontouchstart" in document.documentElement&&!s.closest(".navbar-nav").length&&t(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(t(this)).on("click",i);var r={relatedTarget:this};if(s.trigger(o=t.Event("show.bs.dropdown",r)),o.isDefaultPrevented()){return}n.trigger("focus").attr("aria-expanded","true"),s.toggleClass("open").trigger(t.Event("shown.bs.dropdown",r))}return !1}},a.prototype.keydown=function(i){if(/(38|40|27|32)/.test(i.which)&&!/input|textarea/i.test(i.target.tagName)){var o=t(this);if(i.preventDefault(),i.stopPropagation(),!o.is(".disabled, :disabled")){var n=e(o),a=n.hasClass("open");if(!a&&27!=i.which||a&&27==i.which){return 27==i.which&&n.find(s).trigger("focus"),o.trigger("click")}var r=n.find(".dropdown-menu li:not(.disabled):visible a");if(r.length){var l=r.index(i.target);38==i.which&&l>0&&l--,40==i.which&&l<r.length-1&&l++,~l||(l=0),r.eq(l).trigger("focus")}}}};var r=t.fn.dropdown;t.fn.dropdown=o,t.fn.dropdown.Constructor=a,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=r,this},t(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",s,a.prototype.toggle).on("keydown.bs.dropdown.data-api",s,a.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",a.prototype.keydown)}(jQuery)},430:function(t,e){+function(t){function e(e,o){return this.each(function(){var n=t(this),s=n.data("bs.modal"),a=t.extend({},i.DEFAULTS,n.data(),"object"==typeof e&&e);s||n.data("bs.modal",s=new i(this,a)),"string"==typeof e?s[e](o):a.show&&s.show(o)})}var i=function(e,i){this.options=i,this.$body=t(document.body),this.$element=t(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.fixedContent=".navbar-fixed-top, .navbar-fixed-bottom",this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};i.VERSION="3.4.1",i.TRANSITION_DURATION=300,i.BACKDROP_TRANSITION_DURATION=150,i.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},i.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},i.prototype.show=function(e){var o=this,n=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(n),this.isShown||n.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){o.$element.one("mouseup.dismiss.bs.modal",function(e){t(e.target).is(o.$element)&&(o.ignoreBackdropClick=!0)})}),this.backdrop(function(){var n=t.support.transition&&o.$element.hasClass("fade");o.$element.parent().length||o.$element.appendTo(o.$body),o.$element.show().scrollTop(0),o.adjustDialog(),n&&o.$element[0].offsetWidth,o.$element.addClass("in"),o.enforceFocus();var s=t.Event("shown.bs.modal",{relatedTarget:e});n?o.$dialog.one("bsTransitionEnd",function(){o.$element.trigger("focus").trigger(s)}).emulateTransitionEnd(i.TRANSITION_DURATION):o.$element.trigger("focus").trigger(s)}))},i.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(i.TRANSITION_DURATION):this.hideModal())},i.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){document===t.target||this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},i.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},i.prototype.resize=function(){this.isShown?t(window).on("resize.bs.modal",t.proxy(this.handleUpdate,this)):t(window).off("resize.bs.modal")},i.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},i.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},i.prototype.backdrop=function(e){var o=this,n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=t.support.transition&&n;if(this.$backdrop=t(document.createElement("div")).addClass("modal-backdrop "+n).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",t.proxy(function(t){if(this.ignoreBackdropClick){return void (this.ignoreBackdropClick=!1)}t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e){return}s?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(i.BACKDROP_TRANSITION_DURATION):e()}else{if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var a=function(){o.removeBackdrop(),e&&e()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",a).emulateTransitionEnd(i.BACKDROP_TRANSITION_DURATION):a()}else{e&&e()}}},i.prototype.handleUpdate=function(){this.adjustDialog()},i.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},i.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},i.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},i.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"";var i=this.scrollbarWidth;this.bodyIsOverflowing&&(this.$body.css("padding-right",e+i),t(this.fixedContent).each(function(e,o){var n=o.style.paddingRight,s=t(o).css("padding-right");t(o).data("padding-right",n).css("padding-right",parseFloat(s)+i+"px")}))},i.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad),t(this.fixedContent).each(function(e,i){var o=t(i).data("padding-right");t(i).removeData("padding-right"),i.style.paddingRight=o||""})},i.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var o=t.fn.modal;t.fn.modal=e,t.fn.modal.Constructor=i,t.fn.modal.noConflict=function(){return t.fn.modal=o,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(i){var o=t(this),n=o.attr("href"),s=o.attr("data-target")||n&&n.replace(/.*(?=#[^\s]+$)/,""),a=t(document).find(s),r=a.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(n)&&n},a.data(),o.data());o.is("a")&&i.preventDefault(),a.one("show.bs.modal",function(t){t.isDefaultPrevented()||a.one("hidden.bs.modal",function(){o.is(":visible")&&o.trigger("focus")})}),e.call(a,r,this)})}(jQuery)},431:function(t,e){+function(t){function e(e,i){var o=e.nodeName.toLowerCase();if(-1!==t.inArray(o,i)){return -1===t.inArray(o,s)||Boolean(e.nodeValue.match(l)||e.nodeValue.match(h))}for(var n=t(i).filter(function(t,e){return e instanceof RegExp}),a=0,r=n.length;a<r;a++){if(o.match(n[a])){return !0}}return !1}function i(i,o,n){if(0===i.length){return i}if(n&&"function"==typeof n){return n(i)}if(!document.implementation||!document.implementation.createHTMLDocument){return i}var s=document.implementation.createHTMLDocument("sanitization");s.body.innerHTML=i;for(var a=t.map(o,function(t,e){return e}),r=t(s.body).find("*"),l=0,h=r.length;l<h;l++){var d=r[l],p=d.nodeName.toLowerCase();if(-1!==t.inArray(p,a)){for(var c=t.map(d.attributes,function(t){return t}),f=[].concat(o["*"]||[],o[p]||[]),u=0,g=c.length;u<g;u++){e(c[u],f)||d.removeAttribute(c[u].nodeName)}}else{d.parentNode.removeChild(d)}}return s.body.innerHTML}function o(e){return this.each(function(){var i=t(this),o=i.data("bs.tooltip"),n="object"==typeof e&&e;!o&&/destroy|hide/.test(e)||(o||i.data("bs.tooltip",o=new d(this,n)),"string"==typeof e&&o[e]())})}var n=["sanitize","whiteList","sanitizeFn"],s=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],a=/^aria-[\w-]*$/i,r={"*":["class","dir","id","lang","role",a],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},l=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,h=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+/]+=*$/i,d=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};d.VERSION="3.4.1",d.TRANSITION_DURATION=150,d.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0},sanitize:!0,sanitizeFn:null,whiteList:r},d.prototype.init=function(e,i,o){if(this.enabled=!0,this.type=e,this.$element=t(i),this.options=this.getOptions(o),this.$viewport=this.options.viewport&&t(document).find(t.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0] instanceof document.constructor&&!this.options.selector){throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!")}for(var n=this.options.trigger.split(" "),s=n.length;s--;){var a=n[s];if("click"==a){this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this))}else{if("manual"!=a){var r="hover"==a?"mouseenter":"focusin",l="hover"==a?"mouseleave":"focusout";this.$element.on(r+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},d.prototype.getDefaults=function(){return d.DEFAULTS},d.prototype.getOptions=function(e){var o=this.$element.data();for(var s in o){o.hasOwnProperty(s)&&-1!==t.inArray(s,n)&&delete o[s]}return e=t.extend({},this.getDefaults(),o,e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e.sanitize&&(e.template=i(e.template,e.whiteList,e.sanitizeFn)),e},d.prototype.getDelegateOptions=function(){var e={},i=this.getDefaults();return this._options&&t.each(this._options,function(t,o){i[t]!=o&&(e[t]=o)}),e},d.prototype.enter=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),e instanceof t.Event&&(i.inState["focusin"==e.type?"focus":"hover"]=!0),i.tip().hasClass("in")||"in"==i.hoverState?void (i.hoverState="in"):(clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?void (i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)):i.show())},d.prototype.isInStateTrue=function(){for(var t in this.inState){if(this.inState[t]){return !0}}return !1},d.prototype.leave=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),e instanceof t.Event&&(i.inState["focusout"==e.type?"focus":"hover"]=!1),!i.isInStateTrue()){if(clearTimeout(i.timeout),i.hoverState="out",!i.options.delay||!i.options.delay.hide){return i.hide()}i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)}},d.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var i=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!i){return}var o=this,n=this.tip(),s=this.getUID(this.type);this.setContent(),n.attr("id",s),this.$element.attr("aria-describedby",s),this.options.animation&&n.addClass("fade");var a="function"==typeof this.options.placement?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,r=/\s?auto?\s?/i,l=r.test(a);l&&(a=a.replace(r,"")||"top"),n.detach().css({top:0,left:0,display:"block"}).addClass(a).data("bs."+this.type,this),this.options.container?n.appendTo(t(document).find(this.options.container)):n.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var h=this.getPosition(),p=n[0].offsetWidth,c=n[0].offsetHeight;if(l){var f=a,u=this.getPosition(this.$viewport);a="bottom"==a&&h.bottom+c>u.bottom?"top":"top"==a&&h.top-c<u.top?"bottom":"right"==a&&h.right+p>u.width?"left":"left"==a&&h.left-p<u.left?"right":a,n.removeClass(f).addClass(a)}var g=this.getCalculatedOffset(a,h,p,c);this.applyPlacement(g,a);var m=function(){var t=o.hoverState;o.$element.trigger("shown.bs."+o.type),o.hoverState=null,"out"==t&&o.leave(o)};t.support.transition&&this.$tip.hasClass("fade")?n.one("bsTransitionEnd",m).emulateTransitionEnd(d.TRANSITION_DURATION):m()}},d.prototype.applyPlacement=function(e,i){var o=this.tip(),n=o[0].offsetWidth,s=o[0].offsetHeight,a=parseInt(o.css("margin-top"),10),r=parseInt(o.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(r)&&(r=0),e.top+=a,e.left+=r,t.offset.setOffset(o[0],t.extend({using:function(t){o.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),o.addClass("in");var l=o[0].offsetWidth,h=o[0].offsetHeight;"top"==i&&h!=s&&(e.top=e.top+s-h);var d=this.getViewportAdjustedDelta(i,e,l,h);d.left?e.left+=d.left:e.top+=d.top;var p=/top|bottom/.test(i),c=p?2*d.left-n+l:2*d.top-s+h,f=p?"offsetWidth":"offsetHeight";o.offset(e),this.replaceArrow(c,o[0][f],p)},d.prototype.replaceArrow=function(t,e,i){this.arrow().css(i?"left":"top",50*(1-t/e)+"%").css(i?"top":"left","")},d.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();this.options.html?(this.options.sanitize&&(e=i(e,this.options.whiteList,this.options.sanitizeFn)),t.find(".tooltip-inner").html(e)):t.find(".tooltip-inner").text(e),t.removeClass("fade in top bottom left right")},d.prototype.hide=function(e){function i(){"in"!=o.hoverState&&n.detach(),o.$element&&o.$element.removeAttr("aria-describedby").trigger("hidden.bs."+o.type),e&&e()}var o=this,n=t(this.$tip),s=t.Event("hide.bs."+this.type);if(this.$element.trigger(s),!s.isDefaultPrevented()){return n.removeClass("in"),t.support.transition&&n.hasClass("fade")?n.one("bsTransitionEnd",i).emulateTransitionEnd(d.TRANSITION_DURATION):i(),this.hoverState=null,this}},d.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},d.prototype.hasContent=function(){return this.getTitle()},d.prototype.getPosition=function(e){e=e||this.$element;var i=e[0],o="BODY"==i.tagName,n=i.getBoundingClientRect();null==n.width&&(n=t.extend({},n,{width:n.right-n.left,height:n.bottom-n.top}));var s=window.SVGElement&&i instanceof window.SVGElement,a=o?{top:0,left:0}:s?null:e.offset(),r={scroll:o?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},l=o?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},n,r,l,a)},d.prototype.getCalculatedOffset=function(t,e,i,o){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-o,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-o/2,left:e.left-i}:{top:e.top+e.height/2-o/2,left:e.left+e.width}},d.prototype.getViewportAdjustedDelta=function(t,e,i,o){var n={top:0,left:0};if(!this.$viewport){return n}var s=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(t)){var r=e.top-s-a.scroll,l=e.top+s-a.scroll+o;r<a.top?n.top=a.top-r:l>a.top+a.height&&(n.top=a.top+a.height-l)}else{var h=e.left-s,d=e.left+s+i;h<a.left?n.left=a.left-h:d>a.right&&(n.left=a.left+a.width-d)}return n},d.prototype.getTitle=function(){var t=this.$element,e=this.options;return t.attr("data-original-title")||("function"==typeof e.title?e.title.call(t[0]):e.title)},d.prototype.getUID=function(t){do{t+=~~(1000000*Math.random())}while(document.getElementById(t));return t},d.prototype.tip=function(){if(!this.$tip&&(this.$tip=t(this.options.template),1!=this.$tip.length)){throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!")}return this.$tip},d.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},d.prototype.enable=function(){this.enabled=!0},d.prototype.disable=function(){this.enabled=!1},d.prototype.toggleEnabled=function(){this.enabled=!this.enabled},d.prototype.toggle=function(e){var i=this;e&&((i=t(e.currentTarget).data("bs."+this.type))||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i))),e?(i.inState.click=!i.inState.click,i.isInStateTrue()?i.enter(i):i.leave(i)):i.tip().hasClass("in")?i.leave(i):i.enter(i)},d.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null,t.$element=null})},d.prototype.sanitizeHtml=function(t){return i(t,this.options.whiteList,this.options.sanitizeFn)};var p=t.fn.tooltip;t.fn.tooltip=o,t.fn.tooltip.Constructor=d,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=p,this}}(jQuery)},432:function(t,e){+function(t){function e(e){return this.each(function(){var o=t(this),n=o.data("bs.popover"),s="object"==typeof e&&e;!n&&/destroy|hide/.test(e)||(n||o.data("bs.popover",n=new i(this,s)),"string"==typeof e&&n[e]())})}var i=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip){throw new Error("Popover requires tooltip.js")}i.VERSION="3.4.1",i.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),i.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),i.prototype.constructor=i,i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();if(this.options.html){var o=typeof i;this.options.sanitize&&(e=this.sanitizeHtml(e),"string"===o&&(i=this.sanitizeHtml(i))),t.find(".popover-title").html(e),t.find(".popover-content").children().detach().end()["string"===o?"html":"append"](i)}else{t.find(".popover-title").text(e),t.find(".popover-content").children().detach().end().text(i)}t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},i.prototype.hasContent=function(){return this.getTitle()||this.getContent()},i.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var o=t.fn.popover;t.fn.popover=e,t.fn.popover.Constructor=i,t.fn.popover.noConflict=function(){return t.fn.popover=o,this}}(jQuery)},433:function(t,e){+function(t){function e(i,o){this.$body=t(document.body),this.$scrollElement=t(t(i).is(document.body)?window:i),this.options=t.extend({},e.DEFAULTS,o),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",t.proxy(this.process,this)),this.refresh(),this.process()}function i(i){return this.each(function(){var o=t(this),n=o.data("bs.scrollspy"),s="object"==typeof i&&i;n||o.data("bs.scrollspy",n=new e(this,s)),"string"==typeof i&&n[i]()})}e.VERSION="3.4.1",e.DEFAULTS={offset:10},e.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},e.prototype.refresh=function(){var e=this,i="offset",o=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),t.isWindow(this.$scrollElement[0])||(i="position",o=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var e=t(this),n=e.data("target")||e.attr("href"),s=/^#./.test(n)&&t(n);return s&&s.length&&s.is(":visible")&&[[s[i]().top+o,n]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){e.offsets.push(this[0]),e.targets.push(this[1])})},e.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,i=this.getScrollHeight(),o=this.options.offset+i-this.$scrollElement.height(),n=this.offsets,s=this.targets,a=this.activeTarget;if(this.scrollHeight!=i&&this.refresh(),e>=o){return a!=(t=s[s.length-1])&&this.activate(t)}if(a&&e<n[0]){return this.activeTarget=null,this.clear()}for(t=n.length;t--;){a!=s[t]&&e>=n[t]&&(void 0===n[t+1]||e<n[t+1])&&this.activate(s[t])}},e.prototype.activate=function(e){this.activeTarget=e,this.clear();var i=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',o=t(i).parents("li").addClass("active");o.parent(".dropdown-menu").length&&(o=o.closest("li.dropdown").addClass("active")),o.trigger("activate.bs.scrollspy")},e.prototype.clear=function(){t(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var o=t.fn.scrollspy;t.fn.scrollspy=i,t.fn.scrollspy.Constructor=e,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=o,this},t(window).on("load.bs.scrollspy.data-api",function(){t('[data-spy="scroll"]').each(function(){var e=t(this);i.call(e,e.data())})})}(jQuery)},434:function(t,e){+function(t){function e(e){return this.each(function(){var o=t(this),n=o.data("bs.tab");n||o.data("bs.tab",n=new i(this)),"string"==typeof e&&n[e]()})}var i=function(e){this.element=t(e)};i.VERSION="3.4.1",i.TRANSITION_DURATION=150,i.prototype.show=function(){var e=this.element,i=e.closest("ul:not(.dropdown-menu)"),o=e.data("target");if(o||(o=e.attr("href"),o=o&&o.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var n=i.find(".active:last a"),s=t.Event("hide.bs.tab",{relatedTarget:e[0]}),a=t.Event("show.bs.tab",{relatedTarget:n[0]});if(n.trigger(s),e.trigger(a),!a.isDefaultPrevented()&&!s.isDefaultPrevented()){var r=t(document).find(o);this.activate(e.closest("li"),i),this.activate(r,r.parent(),function(){n.trigger({type:"hidden.bs.tab",relatedTarget:e[0]}),e.trigger({type:"shown.bs.tab",relatedTarget:n[0]})})}}},i.prototype.activate=function(e,o,n){function s(){a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),e.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),r?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu").length&&e.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),n&&n()}var a=o.find("> .active"),r=n&&t.support.transition&&(a.length&&a.hasClass("fade")||!!o.find("> .fade").length);a.length&&r?a.one("bsTransitionEnd",s).emulateTransitionEnd(i.TRANSITION_DURATION):s(),a.removeClass("in")};var o=t.fn.tab;t.fn.tab=e,t.fn.tab.Constructor=i,t.fn.tab.noConflict=function(){return t.fn.tab=o,this};var n=function(i){i.preventDefault(),e.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',n).on("click.bs.tab.data-api",'[data-toggle="pill"]',n)}(jQuery)},435:function(t,e){+function(t){function e(e){return this.each(function(){var o=t(this),n=o.data("bs.affix"),s="object"==typeof e&&e;n||o.data("bs.affix",n=new i(this,s)),"string"==typeof e&&n[e]()})}var i=function(e,o){this.options=t.extend({},i.DEFAULTS,o);var n=this.options.target===i.DEFAULTS.target?t(this.options.target):t(document).find(this.options.target);this.$target=n.on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(e),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};i.VERSION="3.4.1",i.RESET="affix affix-top affix-bottom",i.DEFAULTS={offset:0,target:window},i.prototype.getState=function(t,e,i,o){var n=this.$target.scrollTop(),s=this.$element.offset(),a=this.$target.height();if(null!=i&&"top"==this.affixed){return n<i&&"top"}if("bottom"==this.affixed){return null!=i?!(n+this.unpin<=s.top)&&"bottom":!(n+a<=t-o)&&"bottom"}var r=null==this.affixed,l=r?n:s.top,h=r?a:e;return null!=i&&n<=i?"top":null!=o&&l+h>=t-o&&"bottom"},i.prototype.getPinnedOffset=function(){if(this.pinnedOffset){return this.pinnedOffset}this.$element.removeClass(i.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},i.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},i.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e=this.$element.height(),o=this.options.offset,n=o.top,s=o.bottom,a=Math.max(t(document).height(),t(document.body).height());"object"!=typeof o&&(s=n=o),"function"==typeof n&&(n=o.top(this.$element)),"function"==typeof s&&(s=o.bottom(this.$element));var r=this.getState(a,e,n,s);if(this.affixed!=r){null!=this.unpin&&this.$element.css("top","");var l="affix"+(r?"-"+r:""),h=t.Event(l+".bs.affix");if(this.$element.trigger(h),h.isDefaultPrevented()){return}this.affixed=r,this.unpin="bottom"==r?this.getPinnedOffset():null,this.$element.removeClass(i.RESET).addClass(l).trigger(l.replace("affix","affixed")+".bs.affix")}"bottom"==r&&this.$element.offset({top:a-e-s})}};var o=t.fn.affix;t.fn.affix=e,t.fn.affix.Constructor=i,t.fn.affix.noConflict=function(){return t.fn.affix=o,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var i=t(this),o=i.data();o.offset=o.offset||{},null!=o.offsetBottom&&(o.offset.bottom=o.offsetBottom),null!=o.offsetTop&&(o.offset.top=o.offsetTop),e.call(i,o)})})}(jQuery)},436:function(t,e){}},[223])});
/* modernizr 3.3.1 (Custom Build) | MIT *
 * https://modernizr.com/download/?-filereader-setclasses-shiv !*/
!function(e,t,n){function a(e,t){return typeof e===t}function o(){var e,t,n,o,r,c,l;for(var f in s){if(s.hasOwnProperty(f)){if(e=[],t=s[f],t.name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length)){for(n=0;n<t.options.aliases.length;n++){e.push(t.options.aliases[n].toLowerCase())}}for(o=a(t.fn,"function")?t.fn():t.fn,r=0;r<e.length;r++){c=e[r],l=c.split("."),1===l.length?Modernizr[l[0]]=o:(!Modernizr[l[0]]||Modernizr[l[0]] instanceof Boolean||(Modernizr[l[0]]=new Boolean(Modernizr[l[0]])),Modernizr[l[0]][l[1]]=o),i.push((o?"":"no-")+l.join("-"))}}}}function r(e){var t=l.className,n=Modernizr._config.classPrefix||"";if(f&&(t=t.baseVal),Modernizr._config.enableJSClass){var a=new RegExp("(^|\\s)"+n+"no-js(\\s|$)");t=t.replace(a,"$1"+n+"js$2")}Modernizr._config.enableClasses&&(t+=" "+n+e.join(" "+n),f?l.className.baseVal=t:l.className=t)}var i=[],s=[],c={_version:"3.3.1",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout(function(){t(n[e])},0)},addTest:function(e,t,n){s.push({name:e,fn:t,options:n})},addAsyncTest:function(e){s.push({name:null,fn:e})}},Modernizr=function(){};Modernizr.prototype=c,Modernizr=new Modernizr;var l=t.documentElement,f="svg"===l.nodeName.toLowerCase();f||!function(e,t){function n(e,t){var n=e.createElement("p"),a=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",a.insertBefore(n.lastChild,a.firstChild)}function a(){var e=E.elements;return"string"==typeof e?e.split(" "):e}function o(e,t){var n=E.elements;"string"!=typeof n&&(n=n.join(" ")),"string"!=typeof e&&(e=e.join(" ")),E.elements=n+" "+e,l(t)}function r(e){var t=y[e[g]];return t||(t={},v++,e[g]=v,y[v]=t),t}function i(e,n,a){if(n||(n=t),u){return n.createElement(e)}a||(a=r(n));var o;return o=a.cache[e]?a.cache[e].cloneNode():p.test(e)?(a.cache[e]=a.createElem(e)).cloneNode():a.createElem(e),!o.canHaveChildren||h.test(e)||o.tagUrn?o:a.frag.appendChild(o)}function s(e,n){if(e||(e=t),u){return e.createDocumentFragment()}n=n||r(e);for(var o=n.frag.cloneNode(),i=0,s=a(),c=s.length;c>i;i++){o.createElement(s[i])}return o}function c(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return E.shivMethods?i(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+a().join().replace(/[\w\-:]+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(E,t.frag)}function l(e){e||(e=t);var a=r(e);return !E.shivCSS||f||a.hasCSS||(a.hasCSS=!!n(e,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),u||c(e,a),e}var f,u,d="3.7.3",m=e.html5||{},h=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,p=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,g="_html5shiv",v=0,y={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",f="hidden" in e,u=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(n){f=!0,u=!0}}();var E={elements:m.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output picture progress section summary template time video",version:d,shivCSS:m.shivCSS!==!1,supportsUnknownElements:u,shivMethods:m.shivMethods!==!1,type:"default",shivDocument:l,createElement:i,createDocumentFragment:s,addElements:o};e.html5=E,l(t),"object"==typeof module&&module.exports&&(module.exports=E)}("undefined"!=typeof e?e:this,t),Modernizr.addTest("filereader",!!(e.File&&e.FileList&&e.FileReader)),o(),r(i),delete c.addTest,delete c.addAsyncTest;for(var u=0;u<Modernizr._q.length;u++){Modernizr._q[u]()}e.Modernizr=Modernizr}(window,document);(function(){var root=this;var previousUnderscore=root._;var breaker={};var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var _=function(obj){if(obj instanceof _){return obj}if(!(this instanceof _)){return new _(obj)}this._wrapped=obj};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=_}exports._=_}else{root._=_}_.VERSION="1.5.2";var each=_.each=_.forEach=function(obj,iterator,context){if(obj==null){return}if(nativeForEach&&obj.forEach===nativeForEach){obj.forEach(iterator,context)}else{if(obj.length===+obj.length){for(var i=0,length=obj.length;i<length;i++){if(iterator.call(context,obj[i],i,obj)===breaker){return}}}else{var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){if(iterator.call(context,obj[keys[i]],keys[i],obj)===breaker){return}}}}};_.map=_.collect=function(obj,iterator,context){var results=[];if(obj==null){return results}if(nativeMap&&obj.map===nativeMap){return obj.map(iterator,context)}each(obj,function(value,index,list){results.push(iterator.call(context,value,index,list))});return results};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null){obj=[]}if(nativeReduce&&obj.reduce===nativeReduce){if(context){iterator=_.bind(iterator,context)}return initial?obj.reduce(iterator,memo):obj.reduce(iterator)}each(obj,function(value,index,list){if(!initial){memo=value;initial=true}else{memo=iterator.call(context,memo,value,index,list)}});if(!initial){throw new TypeError(reduceError)}return memo};_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null){obj=[]}if(nativeReduceRight&&obj.reduceRight===nativeReduceRight){if(context){iterator=_.bind(iterator,context)}return initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator)}var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length}each(obj,function(value,index,list){index=keys?keys[--length]:--length;if(!initial){memo=obj[index];initial=true}else{memo=iterator.call(context,memo,obj[index],index,list)}});if(!initial){throw new TypeError(reduceError)}return memo};_.find=_.detect=function(obj,iterator,context){var result;any(obj,function(value,index,list){if(iterator.call(context,value,index,list)){result=value;return true}});return result};_.filter=_.select=function(obj,iterator,context){var results=[];if(obj==null){return results}if(nativeFilter&&obj.filter===nativeFilter){return obj.filter(iterator,context)}each(obj,function(value,index,list){if(iterator.call(context,value,index,list)){results.push(value)}});return results};_.reject=function(obj,iterator,context){return _.filter(obj,function(value,index,list){return !iterator.call(context,value,index,list)},context)};_.every=_.all=function(obj,iterator,context){iterator||(iterator=_.identity);var result=true;if(obj==null){return result}if(nativeEvery&&obj.every===nativeEvery){return obj.every(iterator,context)}each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list))){return breaker}});return !!result};var any=_.some=_.any=function(obj,iterator,context){iterator||(iterator=_.identity);var result=false;if(obj==null){return result}if(nativeSome&&obj.some===nativeSome){return obj.some(iterator,context)}each(obj,function(value,index,list){if(result||(result=iterator.call(context,value,index,list))){return breaker}});return !!result};_.contains=_.include=function(obj,target){if(obj==null){return false}if(nativeIndexOf&&obj.indexOf===nativeIndexOf){return obj.indexOf(target)!=-1}return any(obj,function(value){return value===target})};_.invoke=function(obj,method){var args=slice.call(arguments,2);var isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})};_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})};_.where=function(obj,attrs,first){if(_.isEmpty(attrs)){return first?void 0:[]}return _[first?"find":"filter"](obj,function(value){for(var key in attrs){if(attrs[key]!==value[key]){return false}}return true})};_.findWhere=function(obj,attrs){return _.where(obj,attrs,true)};_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.max.apply(Math,obj)}if(!iterator&&_.isEmpty(obj)){return -Infinity}var result={computed:-Infinity,value:-Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>result.computed&&(result={value:value,computed:computed})});return result.value};_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.min.apply(Math,obj)}if(!iterator&&_.isEmpty(obj)){return Infinity}var result={computed:Infinity,value:Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})});return result.value};_.shuffle=function(obj){var rand;var index=0;var shuffled=[];each(obj,function(value){rand=_.random(index++);shuffled[index-1]=shuffled[rand];shuffled[rand]=value});return shuffled};_.sample=function(obj,n,guard){if(arguments.length<2||guard){return obj[_.random(obj.length-1)]}return _.shuffle(obj).slice(0,Math.max(0,n))};var lookupIterator=function(value){return _.isFunction(value)?value:function(obj){return obj[value]}};_.sortBy=function(obj,value,context){var iterator=lookupIterator(value);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0){return 1}if(a<b||b===void 0){return -1}}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,value,context){var result={};var iterator=value==null?_.identity:lookupIterator(value);each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value)});return result}};_.groupBy=group(function(result,key,value){(_.has(result,key)?result[key]:(result[key]=[])).push(value)});_.indexBy=group(function(result,key,value){result[key]=value});_.countBy=group(function(result,key){_.has(result,key)?result[key]++:result[key]=1});_.sortedIndex=function(array,obj,iterator,context){iterator=iterator==null?_.identity:lookupIterator(iterator);var value=iterator.call(context,obj);var low=0,high=array.length;while(low<high){var mid=(low+high)>>>1;iterator.call(context,array[mid])<value?low=mid+1:high=mid}return low};_.toArray=function(obj){if(!obj){return[]}if(_.isArray(obj)){return slice.call(obj)}if(obj.length===+obj.length){return _.map(obj,_.identity)}return _.values(obj)};_.size=function(obj){if(obj==null){return 0}return(obj.length===+obj.length)?obj.length:_.keys(obj).length};_.first=_.head=_.take=function(array,n,guard){if(array==null){return void 0}return(n==null)||guard?array[0]:slice.call(array,0,n)};_.initial=function(array,n,guard){return slice.call(array,0,array.length-((n==null)||guard?1:n))};_.last=function(array,n,guard){if(array==null){return void 0}if((n==null)||guard){return array[array.length-1]}else{return slice.call(array,Math.max(array.length-n,0))}};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,(n==null)||guard?1:n)};_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,output){if(shallow&&_.every(input,_.isArray)){return concat.apply(output,input)}each(input,function(value){if(_.isArray(value)||_.isArguments(value)){shallow?push.apply(output,value):flatten(value,shallow,output)}else{output.push(value)}});return output};_.flatten=function(array,shallow){return flatten(array,shallow,[])};_.without=function(array){return _.difference(array,slice.call(arguments,1))};_.uniq=_.unique=function(array,isSorted,iterator,context){if(_.isFunction(isSorted)){context=iterator;iterator=isSorted;isSorted=false}var initial=iterator?_.map(array,iterator,context):array;var results=[];var seen=[];each(initial,function(value,index){if(isSorted?(!index||seen[seen.length-1]!==value):!_.contains(seen,value)){seen.push(value);results.push(array[index])}});return results};_.union=function(){return _.uniq(_.flatten(arguments,true))};_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})};_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return !_.contains(rest,value)})};_.zip=function(){var length=_.max(_.pluck(arguments,"length").concat(0));var results=new Array(length);for(var i=0;i<length;i++){results[i]=_.pluck(arguments,""+i)}return results};_.object=function(list,values){if(list==null){return{}}var result={};for(var i=0,length=list.length;i<length;i++){if(values){result[list[i]]=values[i]}else{result[list[i][0]]=list[i][1]}}return result};_.indexOf=function(array,item,isSorted){if(array==null){return -1}var i=0,length=array.length;if(isSorted){if(typeof isSorted=="number"){i=(isSorted<0?Math.max(0,length+isSorted):isSorted)}else{i=_.sortedIndex(array,item);return array[i]===item?i:-1}}if(nativeIndexOf&&array.indexOf===nativeIndexOf){return array.indexOf(item,isSorted)}for(;i<length;i++){if(array[i]===item){return i}}return -1};_.lastIndexOf=function(array,item,from){if(array==null){return -1}var hasIndex=from!=null;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf){return hasIndex?array.lastIndexOf(item,from):array.lastIndexOf(item)}var i=(hasIndex?from:array.length);while(i--){if(array[i]===item){return i}}return -1};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0}step=arguments[2]||1;var length=Math.max(Math.ceil((stop-start)/step),0);var idx=0;var range=new Array(length);while(idx<length){range[idx++]=start;start+=step}return range};var ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind){return nativeBind.apply(func,slice.call(arguments,1))}if(!_.isFunction(func)){throw new TypeError}args=slice.call(arguments,2);return bound=function(){if(!(this instanceof bound)){return func.apply(context,args.concat(slice.call(arguments)))}ctor.prototype=func.prototype;var self=new ctor;ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));if(Object(result)===result){return result}return self}};_.partial=function(func){var args=slice.call(arguments,1);return function(){return func.apply(this,args.concat(slice.call(arguments)))}};_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(funcs.length===0){throw new Error("bindAll must be passed function names")}each(funcs,function(f){obj[f]=_.bind(obj[f],obj)});return obj};_.memoize=function(func,hasher){var memo={};hasher||(hasher=_.identity);return function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:(memo[key]=func.apply(this,arguments))}};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)};_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))};_.throttle=function(func,wait,options){var context,args,result;var timeout=null;var previous=0;options||(options={});var later=function(){previous=options.leading===false?0:new Date;timeout=null;result=func.apply(context,args)};return function(){var now=new Date;if(!previous&&options.leading===false){previous=now}var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0){clearTimeout(timeout);timeout=null;previous=now;result=func.apply(context,args)}else{if(!timeout&&options.trailing!==false){timeout=setTimeout(later,remaining)}}return result}};_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result;return function(){context=this;args=arguments;timestamp=new Date();var later=function(){var last=(new Date())-timestamp;if(last<wait){timeout=setTimeout(later,wait-last)}else{timeout=null;if(!immediate){result=func.apply(context,args)}}};var callNow=immediate&&!timeout;if(!timeout){timeout=setTimeout(later,wait)}if(callNow){result=func.apply(context,args)}return result}};_.once=function(func){var ran=false,memo;return function(){if(ran){return memo}ran=true;memo=func.apply(this,arguments);func=null;return memo}};_.wrap=function(func,wrapper){return function(){var args=[func];push.apply(args,arguments);return wrapper.apply(this,args)}};_.compose=function(){var funcs=arguments;return function(){var args=arguments;for(var i=funcs.length-1;i>=0;i--){args=[funcs[i].apply(this,args)]}return args[0]}};_.after=function(times,func){return function(){if(--times<1){return func.apply(this,arguments)}}};_.keys=nativeKeys||function(obj){if(obj!==Object(obj)){throw new TypeError("Invalid object")}var keys=[];for(var key in obj){if(_.has(obj,key)){keys.push(key)}}return keys};_.values=function(obj){var keys=_.keys(obj);var length=keys.length;var values=new Array(length);for(var i=0;i<length;i++){values[i]=obj[keys[i]]}return values};_.pairs=function(obj){var keys=_.keys(obj);var length=keys.length;var pairs=new Array(length);for(var i=0;i<length;i++){pairs[i]=[keys[i],obj[keys[i]]]}return pairs};_.invert=function(obj){var result={};var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){result[obj[keys[i]]]=keys[i]}return result};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key])){names.push(key)}}return names.sort()};_.extend=function(obj){each(slice.call(arguments,1),function(source){if(source){for(var prop in source){obj[prop]=source[prop]}}});return obj};_.pick=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));each(keys,function(key){if(key in obj){copy[key]=obj[key]}});return copy};_.omit=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));for(var key in obj){if(!_.contains(keys,key)){copy[key]=obj[key]}}return copy};_.defaults=function(obj){each(slice.call(arguments,1),function(source){if(source){for(var prop in source){if(obj[prop]===void 0){obj[prop]=source[prop]}}}});return obj};_.clone=function(obj){if(!_.isObject(obj)){return obj}return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};var eq=function(a,b,aStack,bStack){if(a===b){return a!==0||1/a==1/b}if(a==null||b==null){return a===b}if(a instanceof _){a=a._wrapped}if(b instanceof _){b=b._wrapped}var className=toString.call(a);if(className!=toString.call(b)){return false}switch(className){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:(a==0?1/a==1/b:a==+b);case"[object Date]":case"[object Boolean]":return +a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object"){return false}var length=aStack.length;while(length--){if(aStack[length]==a){return bStack[length]==b}}var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&(aCtor instanceof aCtor)&&_.isFunction(bCtor)&&(bCtor instanceof bCtor))){return false}aStack.push(a);bStack.push(b);var size=0,result=true;if(className=="[object Array]"){size=a.length;result=size==b.length;if(result){while(size--){if(!(result=eq(a[size],b[size],aStack,bStack))){break}}}}else{for(var key in a){if(_.has(a,key)){size++;if(!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack))){break}}}if(result){for(key in b){if(_.has(b,key)&&!(size--)){break}}result=!size}}aStack.pop();bStack.pop();return result};_.isEqual=function(a,b){return eq(a,b,[],[])};_.isEmpty=function(obj){if(obj==null){return true}if(_.isArray(obj)||_.isString(obj)){return obj.length===0}for(var key in obj){if(_.has(obj,key)){return false}}return true};_.isElement=function(obj){return !!(obj&&obj.nodeType===1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)=="[object Array]"};_.isObject=function(obj){return obj===Object(obj)};each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)=="[object "+name+"]"}});if(!_.isArguments(arguments)){_.isArguments=function(obj){return !!(obj&&_.has(obj,"callee"))}}if(typeof(/./)!=="function"){_.isFunction=function(obj){return typeof obj==="function"}}_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))};_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)=="[object Boolean]"};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.has=function(obj,key){return hasOwnProperty.call(obj,key)};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.times=function(n,iterator,context){var accum=Array(Math.max(0,n));for(var i=0;i<n;i++){accum[i]=iterator.call(context,i)}return accum};_.random=function(min,max){if(max==null){max=min;min=0}return min+Math.floor(Math.random()*(max-min+1))};var entityMap={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:new RegExp("["+_.keys(entityMap.escape).join("")+"]","g"),unescape:new RegExp("("+_.keys(entityMap.unescape).join("|")+")","g")};_.each(["escape","unescape"],function(method){_[method]=function(string){if(string==null){return""}return(""+string).replace(entityRegexes[method],function(match){return entityMap[method][match]})}});_.result=function(object,property){if(object==null){return void 0}var value=object[property];return _.isFunction(value)?value.call(object):value};_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result.call(this,func.apply(_,args))}})};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};var escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g;_.template=function(text,data,settings){var render;settings=_.defaults({},settings,_.templateSettings);var matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g");var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,function(match){return"\\"+escapes[match]});if(escape){source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'"}if(interpolate){source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'"}if(evaluate){source+="';\n"+evaluate+"\n__p+='"}index=offset+match.length;return match});source+="';\n";if(!settings.variable){source="with(obj||{}){\n"+source+"}\n"}source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{render=new Function(settings.variable||"obj","_",source)}catch(e){e.source=source;throw e}if(data){return render(data,_)}var template=function(data){return render.call(this,data,_)};template.source="function("+(settings.variable||"obj")+"){\n"+source+"}";return template};_.chain=function(obj){return _(obj).chain()};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin(_);each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name=="shift"||name=="splice")&&obj.length===0){delete obj[0]}return result.call(this,obj)}});each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}});_.extend(_.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this);
/*
 * jQuery Form Plugin
 * version: 2.83 (11-JUL-2011)
 * @requires jQuery v1.3.2 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
(function($){$.fn.ajaxSubmit=function(options){if(!this.length){log("ajaxSubmit: skipping submit process - no element selected");return this}var method,action,url,$form=this;if(typeof options=="function"){options={success:options}}method=this.attr("method");action=this.attr("action");url=(typeof action==="string")?$.trim(action):"";url=url||window.location.href||"";if(url){url=(url.match(/^([^#]+)/)||[])[1]}options=$.extend(true,{url:url,success:$.ajaxSettings.success,type:method||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},options);var veto={};this.trigger("form-pre-serialize",[this,options,veto]);if(veto.veto){log("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(options.beforeSerialize&&options.beforeSerialize(this,options)===false){log("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var n,v,a=this.formToArray(options.semantic);if(options.data){options.extraData=options.data;for(n in options.data){if(options.data[n] instanceof Array){for(var k in options.data[n]){a.push({name:n,value:options.data[n][k]})}}else{v=options.data[n];v=$.isFunction(v)?v():v;a.push({name:n,value:v})}}}if(options.beforeSubmit&&options.beforeSubmit(a,this,options)===false){log("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[a,this,options,veto]);if(veto.veto){log("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var q=$.param(a);if(options.type.toUpperCase()=="GET"){options.url+=(options.url.indexOf("?")>=0?"&":"?")+q;options.data=null}else{options.data=q}var callbacks=[];if(options.resetForm){callbacks.push(function(){$form.resetForm()})}if(options.clearForm){callbacks.push(function(){$form.clearForm()})}if(!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push(function(data){var fn=options.replaceTarget?"replaceWith":"html";$(options.target)[fn](data).each(oldSuccess,arguments)})}else{if(options.success){callbacks.push(options.success)}}options.success=function(data,status,xhr){var context=options.context||options;for(var i=0,max=callbacks.length;i<max;i++){callbacks[i].apply(context,[data,status,xhr||$form,$form])}};var fileInputs=$("input:file",this).length>0;var mp="multipart/form-data";var multipart=($form.attr("enctype")==mp||$form.attr("encoding")==mp);if(options.iframe!==false&&(fileInputs||options.iframe||multipart)){if(options.closeKeepAlive){$.get(options.closeKeepAlive,function(){fileUpload(a)})}else{fileUpload(a)}}else{if($.browser.msie&&method=="get"){var ieMeth=$form[0].getAttribute("method");if(typeof ieMeth==="string"){options.type=ieMeth}}$.ajax(options)}this.trigger("form-submit-notify",[this,options]);return this;function fileUpload(a){var form=$form[0],el,i,s,g,id,$io,io,xhr,sub,n,timedOut,timeoutHandle;var useProp=!!$.fn.prop;if(a){for(i=0;i<a.length;i++){el=$(form[a[i].name]);el[useProp?"prop":"attr"]("disabled",false)}}if($(":input[name=submit],:input[id=submit]",form).length){alert('Error: Form elements must not have name or id of "submit".');return}s=$.extend(true,{},$.ajaxSettings,options);s.context=s.context||s;id="jqFormIO"+(new Date().getTime());if(s.iframeTarget){$io=$(s.iframeTarget);n=$io.attr("name");if(n==null){$io.attr("name",id)}else{id=n}}else{$io=$('<iframe name="'+id+'" src="'+s.iframeSrc+'" />');$io.css({position:"absolute",top:"-1000px",left:"-1000px"})}io=$io[0];xhr={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(status){var e=(status==="timeout"?"timeout":"aborted");log("aborting upload... "+e);this.aborted=1;$io.attr("src",s.iframeSrc);xhr.error=e;s.error&&s.error.call(s.context,xhr,e,status);g&&$.event.trigger("ajaxError",[xhr,s,e]);s.complete&&s.complete.call(s.context,xhr,e)}};g=s.global;if(g&&!$.active++){$.event.trigger("ajaxStart")}if(g){$.event.trigger("ajaxSend",[xhr,s])}if(s.beforeSend&&s.beforeSend.call(s.context,xhr,s)===false){if(s.global){$.active--}return}if(xhr.aborted){return}sub=form.clk;if(sub){n=sub.name;if(n&&!sub.disabled){s.extraData=s.extraData||{};s.extraData[n]=sub.value;if(sub.type=="image"){s.extraData[n+".x"]=form.clk_x;s.extraData[n+".y"]=form.clk_y}}}var CLIENT_TIMEOUT_ABORT=1;var SERVER_ABORT=2;function getDoc(frame){var doc=frame.contentWindow?frame.contentWindow.document:frame.contentDocument?frame.contentDocument:frame.document;return doc}function doSubmit(){var t=$form.attr("target"),a=$form.attr("action");form.setAttribute("target",id);if(!method){form.setAttribute("method","POST")}if(a!=s.url){form.setAttribute("action",s.url)}if(!s.skipEncodingOverride&&(!method||/post/i.test(method))){$form.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"})}if(s.timeout){timeoutHandle=setTimeout(function(){timedOut=true;cb(CLIENT_TIMEOUT_ABORT)},s.timeout)}function checkState(){try{var state=getDoc(io).readyState;log("state = "+state);if(state.toLowerCase()=="uninitialized"){setTimeout(checkState,50)}}catch(e){log("Server abort: ",e," (",e.name,")");cb(SERVER_ABORT);timeoutHandle&&clearTimeout(timeoutHandle);timeoutHandle=undefined}}var extraInputs=[];try{if(s.extraData){for(var n in s.extraData){extraInputs.push($('<input type="hidden" name="'+n+'" />').attr("value",s.extraData[n]).appendTo(form)[0])}}if(!s.iframeTarget){$io.appendTo("body");io.attachEvent?io.attachEvent("onload",cb):io.addEventListener("load",cb,false)}setTimeout(checkState,15);form.submit()}finally{form.setAttribute("action",a);if(t){form.setAttribute("target",t)}else{$form.removeAttr("target")}$(extraInputs).remove()}}if(s.forceSync){doSubmit()}else{setTimeout(doSubmit,10)}var data,doc,domCheckCount=50,callbackProcessed;function cb(e){if(xhr.aborted||callbackProcessed){return}try{doc=getDoc(io)}catch(ex){log("cannot access response document: ",ex);e=SERVER_ABORT}if(e===CLIENT_TIMEOUT_ABORT&&xhr){xhr.abort("timeout");return}else{if(e==SERVER_ABORT&&xhr){xhr.abort("server abort");return}}if(!doc||doc.location.href==s.iframeSrc){if(!timedOut){return}}io.detachEvent?io.detachEvent("onload",cb):io.removeEventListener("load",cb,false);var status="success",errMsg;try{if(timedOut){throw"timeout"}var isXml=s.dataType=="xml"||doc.XMLDocument||$.isXMLDoc(doc);log("isXml="+isXml);if(!isXml&&window.opera&&(doc.body==null||doc.body.innerHTML=="")){if(--domCheckCount){log("requeing onLoad callback, DOM not available");setTimeout(cb,250);return}}var docRoot=doc.body?doc.body:doc.documentElement;xhr.responseText=docRoot?docRoot.innerHTML:null;xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc;if(isXml){s.dataType="xml"}xhr.getResponseHeader=function(header){var headers={"content-type":s.dataType};return headers[header]};if(docRoot){xhr.status=Number(docRoot.getAttribute("status"))||xhr.status;xhr.statusText=docRoot.getAttribute("statusText")||xhr.statusText}var dt=s.dataType||"";var scr=/(json|script|text)/.test(dt.toLowerCase());if(scr||s.textarea){var ta=doc.getElementsByTagName("textarea")[0];if(ta){xhr.responseText=ta.value;xhr.status=Number(ta.getAttribute("status"))||xhr.status;xhr.statusText=ta.getAttribute("statusText")||xhr.statusText}else{if(scr){var pre=doc.getElementsByTagName("pre")[0];var b=doc.getElementsByTagName("body")[0];if(pre){xhr.responseText=pre.textContent?pre.textContent:pre.innerHTML}else{if(b){xhr.responseText=b.innerHTML}}}}}else{if(s.dataType=="xml"&&!xhr.responseXML&&xhr.responseText!=null){xhr.responseXML=toXml(xhr.responseText)}}try{data=httpData(xhr,s.dataType,s)}catch(e){status="parsererror";xhr.error=errMsg=(e||status)}}catch(e){log("error caught: ",e);status="error";xhr.error=errMsg=(e||status)}if(xhr.aborted){log("upload aborted");status=null}if(xhr.status){status=(xhr.status>=200&&xhr.status<300||xhr.status===304)?"success":"error"}if(status==="success"){s.success&&s.success.call(s.context,data,"success",xhr);g&&$.event.trigger("ajaxSuccess",[xhr,s])}else{if(status){if(errMsg==undefined){errMsg=xhr.statusText}s.error&&s.error.call(s.context,xhr,status,errMsg);g&&$.event.trigger("ajaxError",[xhr,s,errMsg])}}g&&$.event.trigger("ajaxComplete",[xhr,s]);if(g&&!--$.active){$.event.trigger("ajaxStop")}s.complete&&s.complete.call(s.context,xhr,status);callbackProcessed=true;if(s.timeout){clearTimeout(timeoutHandle)}setTimeout(function(){if(!s.iframeTarget){$io.remove()}xhr.responseXML=null},100)}var toXml=$.parseXML||function(s,doc){if(window.ActiveXObject){doc=new ActiveXObject("Microsoft.XMLDOM");doc.async="false";doc.loadXML(s)}else{doc=(new DOMParser()).parseFromString(s,"text/xml")}return(doc&&doc.documentElement&&doc.documentElement.nodeName!="parsererror")?doc:null};var parseJSON=$.parseJSON||function(s){return window["eval"]("("+s+")")};var httpData=function(xhr,type,s){var ct=xhr.getResponseHeader("content-type")||"",xml=type==="xml"||!type&&ct.indexOf("xml")>=0,data=xml?xhr.responseXML:xhr.responseText;if(xml&&data.documentElement.nodeName==="parsererror"){$.error&&$.error("parsererror")}if(s&&s.dataFilter){data=s.dataFilter(data,type)}if(typeof data==="string"){if(type==="json"||!type&&ct.indexOf("json")>=0){data=parseJSON(data)}else{if(type==="script"||!type&&ct.indexOf("javascript")>=0){$.globalEval(data)}}}return data}}};$.fn.ajaxForm=function(options){if(this.length===0){var o={s:this.selector,c:this.context};if(!$.isReady&&o.s){log("DOM not ready, queuing ajaxForm");$(function(){$(o.s,o.c).ajaxForm(options)});return this}log("terminating; zero elements found by selector"+($.isReady?"":" (DOM not ready)"));return this}return this.ajaxFormUnbind().bind("submit.form-plugin",function(e){if(!e.isDefaultPrevented()){e.preventDefault();$(this).ajaxSubmit(options)}}).bind("click.form-plugin",function(e){var target=e.target;var $el=$(target);if(!($el.is(":submit,input:image"))){var t=$el.closest(":submit");if(t.length==0){return}target=t[0]}var form=this;form.clk=target;if(target.type=="image"){if(e.offsetX!=undefined){form.clk_x=e.offsetX;form.clk_y=e.offsetY}else{if(typeof $.fn.offset=="function"){var offset=$el.offset();form.clk_x=e.pageX-offset.left;form.clk_y=e.pageY-offset.top}else{form.clk_x=e.pageX-target.offsetLeft;form.clk_y=e.pageY-target.offsetTop}}}setTimeout(function(){form.clk=form.clk_x=form.clk_y=null},100)})};$.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};$.fn.formToArray=function(semantic){var a=[];if(this.length===0){return a}var form=this[0];var els=semantic?form.getElementsByTagName("*"):form.elements;if(!els){return a}var i,j,n,v,el,max,jmax;for(i=0,max=els.length;i<max;i++){el=els[i];n=el.name;if(!n){continue}if(semantic&&form.clk&&el.type=="image"){if(!el.disabled&&form.clk==el){a.push({name:n,value:$(el).val()});a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y})}continue}v=$.fieldValue(el,true);if(v&&v.constructor==Array){for(j=0,jmax=v.length;j<jmax;j++){a.push({name:n,value:v[j]})}}else{if(v!==null&&typeof v!="undefined"){a.push({name:n,value:v})}}}if(!semantic&&form.clk){var $input=$(form.clk),input=$input[0];n=input.name;if(n&&!input.disabled&&input.type=="image"){a.push({name:n,value:$input.val()});a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y})}}return a};$.fn.formSerialize=function(semantic){return $.param(this.formToArray(semantic))};$.fn.fieldSerialize=function(successful){var a=[];this.each(function(){var n=this.name;if(!n){return}var v=$.fieldValue(this,successful);if(v&&v.constructor==Array){for(var i=0,max=v.length;i<max;i++){a.push({name:n,value:v[i]})}}else{if(v!==null&&typeof v!="undefined"){a.push({name:this.name,value:v})}}});return $.param(a)};$.fn.fieldValue=function(successful){for(var val=[],i=0,max=this.length;i<max;i++){var el=this[i];var v=$.fieldValue(el,successful);if(v===null||typeof v=="undefined"||(v.constructor==Array&&!v.length)){continue}v.constructor==Array?$.merge(val,v):val.push(v)}return val};$.fieldValue=function(el,successful){var n=el.name,t=el.type,tag=el.tagName.toLowerCase();if(successful===undefined){successful=true}if(successful&&(!n||el.disabled||t=="reset"||t=="button"||(t=="checkbox"||t=="radio")&&!el.checked||(t=="submit"||t=="image")&&el.form&&el.form.clk!=el||tag=="select"&&el.selectedIndex==-1)){return null}if(tag=="select"){var index=el.selectedIndex;if(index<0){return null}var a=[],ops=el.options;var one=(t=="select-one");var max=(one?index+1:ops.length);for(var i=(one?index:0);i<max;i++){var op=ops[i];if(op.selected){var v=op.value;if(!v){v=(op.attributes&&op.attributes.value&&!(op.attributes.value.specified))?op.text:op.value}if(one){return v}a.push(v)}}return a}return $(el).val()};$.fn.clearForm=function(){return this.each(function(){$("input,select,textarea",this).clearFields()})};$.fn.clearFields=$.fn.clearInputs=function(){var re=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var t=this.type,tag=this.tagName.toLowerCase();if(re.test(t)||tag=="textarea"){this.value=""}else{if(t=="checkbox"||t=="radio"){this.checked=false}else{if(tag=="select"){this.selectedIndex=-1}}}})};$.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||(typeof this.reset=="object"&&!this.reset.nodeType)){this.reset()}})};$.fn.enable=function(b){if(b===undefined){b=true}return this.each(function(){this.disabled=!b})};$.fn.selected=function(select){if(select===undefined){select=true}return this.each(function(){var t=this.type;if(t=="checkbox"||t=="radio"){this.checked=select}else{if(this.tagName.toLowerCase()=="option"){var $sel=$(this).parent("select");if(select&&$sel[0]&&$sel[0].type=="select-one"){$sel.find("option").selected(false)}this.selected=select}}})};function log(){var msg="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log){window.console.log(msg)}else{if(window.opera&&window.opera.postError){window.opera.postError(msg)}}}})(jQuery);var Hashtable=(function(){var p="function";var n=(typeof Array.prototype.splice==p)?function(s,r){s.splice(r,1)}:function(u,t){var s,v,r;if(t===u.length-1){u.length=t}else{s=u.slice(t+1);u.length=t;for(v=0,r=s.length;v<r;++v){u[t+v]=s[v]}}};function a(t){var r;if(typeof t=="string"){return t}else{if(typeof t.hashCode==p){r=t.hashCode();return(typeof r=="string")?r:a(r)}else{if(typeof t.toString==p){return t.toString()}else{try{return String(t)}catch(s){return Object.prototype.toString.call(t)}}}}}function g(r,s){return r.equals(s)}function e(r,s){return(typeof s.equals==p)?s.equals(r):(r===s)}function c(r){return function(s){if(s===null){throw new Error("null is not a valid "+r)}else{if(typeof s=="undefined"){throw new Error(r+" must not be undefined")}}}}var q=c("key"),l=c("value");function d(u,s,t,r){this[0]=u;this.entries=[];this.addEntry(s,t);if(r!==null){this.getEqualityFunction=function(){return r}}}var h=0,j=1,f=2;function o(r){return function(t){var s=this.entries.length,v,u=this.getEqualityFunction(t);while(s--){v=this.entries[s];if(u(t,v[0])){switch(r){case h:return true;case j:return v;case f:return[s,v[1]]}}}return false}}function k(r){return function(u){var v=u.length;for(var t=0,s=this.entries.length;t<s;++t){u[v+t]=this.entries[t][r]}}}d.prototype={getEqualityFunction:function(r){return(typeof r.equals==p)?g:e},getEntryForKey:o(j),getEntryAndIndexForKey:o(f),removeEntryForKey:function(s){var r=this.getEntryAndIndexForKey(s);if(r){n(this.entries,r[0]);return r[1]}return null},addEntry:function(r,s){this.entries[this.entries.length]=[r,s]},keys:k(0),values:k(1),getEntries:function(s){var u=s.length;for(var t=0,r=this.entries.length;t<r;++t){s[u+t]=this.entries[t].slice(0)}},containsKey:o(h),containsValue:function(s){var r=this.entries.length;while(r--){if(s===this.entries[r][1]){return true}}return false}};function m(s,t){var r=s.length,u;while(r--){u=s[r];if(t===u[0]){return r}}return null}function i(r,s){var t=r[s];return(t&&(t instanceof d))?t:null}function b(t,r){var w=this;var v=[];var u={};var x=(typeof t==p)?t:a;var s=(typeof r==p)?r:null;this.put=function(B,C){q(B);l(C);var D=x(B),E,A,z=null;E=i(u,D);if(E){A=E.getEntryForKey(B);if(A){z=A[1];A[1]=C}else{E.addEntry(B,C)}}else{E=new d(D,B,C,s);v[v.length]=E;u[D]=E}return z};this.get=function(A){q(A);var B=x(A);var C=i(u,B);if(C){var z=C.getEntryForKey(A);if(z){return z[1]}}return null};this.containsKey=function(A){q(A);var z=x(A);var B=i(u,z);return B?B.containsKey(A):false};this.containsValue=function(A){l(A);var z=v.length;while(z--){if(v[z].containsValue(A)){return true}}return false};this.clear=function(){v.length=0;u={}};this.isEmpty=function(){return !v.length};var y=function(z){return function(){var A=[],B=v.length;while(B--){v[B][z](A)}return A}};this.keys=y("keys");this.values=y("values");this.entries=y("getEntries");this.remove=function(B){q(B);var C=x(B),z,A=null;var D=i(u,C);if(D){A=D.removeEntryForKey(B);if(A!==null){if(!D.entries.length){z=m(v,C);n(v,z);delete u[C]}}}return A};this.size=function(){var A=0,z=v.length;while(z--){A+=v[z].entries.length}return A};this.each=function(C){var z=w.entries(),A=z.length,B;while(A--){B=z[A];C(B[0],B[1])}};this.putAll=function(H,C){var B=H.entries();var E,F,D,z,A=B.length;var G=(typeof C==p);while(A--){E=B[A];F=E[0];D=E[1];if(G&&(z=w.get(F))){D=C(F,z,D)}w.put(F,D)}};this.clone=function(){var z=new b(t,r);z.putAll(w);return z}}return b})();(function(jQuery){var nfLocales=new Hashtable();var nfLocalesLikeUS=["ae","au","ca","cn","eg","gb","hk","il","in","jp","sk","th","tw","us"];var nfLocalesLikeDE=["at","br","de","dk","es","gr","it","nl","pt","tr","vn"];var nfLocalesLikeFR=["cz","fi","fr","ru","se","pl"];var nfLocalesLikeCH=["ch"];var nfLocaleFormatting=[[".",","],[",","."],[","," "],[".","'"]];var nfAllLocales=[nfLocalesLikeUS,nfLocalesLikeDE,nfLocalesLikeFR,nfLocalesLikeCH];function FormatData(dec,group,neg){this.dec=dec;this.group=group;this.neg=neg}function init(){for(var localeGroupIdx=0;localeGroupIdx<nfAllLocales.length;localeGroupIdx++){localeGroup=nfAllLocales[localeGroupIdx];for(var i=0;i<localeGroup.length;i++){nfLocales.put(localeGroup[i],localeGroupIdx)}}}function formatCodes(locale){if(nfLocales.size()==0){init()}var dec=".";var group=",";var neg="-";var codesIndex=nfLocales.get(locale);if(codesIndex){var codes=nfLocaleFormatting[codesIndex];if(codes){dec=codes[0];group=codes[1]}}return new FormatData(dec,group,neg)}jQuery.fn.formatNumber=function(options,writeBack,giveReturnValue){return this.each(function(){if(writeBack==null){writeBack=true}if(giveReturnValue==null){giveReturnValue=true}var text;if(jQuery(this).is(":input")){text=new String(jQuery(this).val())}else{text=new String(jQuery(this).text())}var returnString=jQuery.formatNumber(text,options);if(writeBack){if(jQuery(this).is(":input")){jQuery(this).val(returnString)}else{jQuery(this).text(returnString)}}if(giveReturnValue){return returnString}})};jQuery.formatNumber=function(numberString,options){var options=jQuery.extend({},jQuery.fn.formatNumber.defaults,options);var formatData=formatCodes(options.locale.toLowerCase());var dec=formatData.dec;var group=formatData.group;var neg=formatData.neg;var validFormat="0#-,.";var prefix="";var negativeInFront=false;for(var i=0;i<options.format.length;i++){if(validFormat.indexOf(options.format.charAt(i))==-1){prefix=prefix+options.format.charAt(i)}else{if(i==0&&options.format.charAt(i)=="-"){negativeInFront=true;continue}else{break}}}var suffix="";for(var i=options.format.length-1;i>=0;i--){if(validFormat.indexOf(options.format.charAt(i))==-1){suffix=options.format.charAt(i)+suffix}else{break}}options.format=options.format.substring(prefix.length);options.format=options.format.substring(0,options.format.length-suffix.length);var number=new Number(numberString);return jQuery._formatNumber(number,options,suffix,prefix,negativeInFront)};jQuery._formatNumber=function(number,options,suffix,prefix,negativeInFront){var options=jQuery.extend({},jQuery.fn.formatNumber.defaults,options);var formatData=formatCodes(options.locale.toLowerCase());var dec=formatData.dec;var group=formatData.group;var neg=formatData.neg;var forcedToZero=false;if(isNaN(number)){if(options.nanForceZero==true){number=0;forcedToZero=true}else{return null}}if(suffix=="%"){number=number*100}var returnString="";if(options.format.indexOf(".")>-1){var decimalPortion=dec;var decimalFormat=options.format.substring(options.format.lastIndexOf(".")+1);if(options.round==true){number=new Number(number.toFixed(decimalFormat.length))}else{var numStr=number.toString();numStr=numStr.substring(0,numStr.lastIndexOf(".")+decimalFormat.length+1);number=new Number(numStr)}var decimalValue=number%1;var decimalString=new String(decimalValue.toFixed(decimalFormat.length));decimalString=decimalString.substring(decimalString.lastIndexOf(".")+1);for(var i=0;i<decimalFormat.length;i++){if(decimalFormat.charAt(i)=="#"&&decimalString.charAt(i)!="0"){decimalPortion+=decimalString.charAt(i);continue}else{if(decimalFormat.charAt(i)=="#"&&decimalString.charAt(i)=="0"){var notParsed=decimalString.substring(i);if(notParsed.match("[1-9]")){decimalPortion+=decimalString.charAt(i);continue}else{break}}else{if(decimalFormat.charAt(i)=="0"){decimalPortion+=decimalString.charAt(i)}}}}returnString+=decimalPortion}else{number=Math.round(number)}var ones=Math.floor(number);if(number<0){ones=Math.ceil(number)}var onesFormat="";if(options.format.indexOf(".")==-1){onesFormat=options.format}else{onesFormat=options.format.substring(0,options.format.indexOf("."))}var onePortion="";if(!(ones==0&&onesFormat.substr(onesFormat.length-1)=="#")||forcedToZero){var oneText=new String(Math.abs(ones));var groupLength=9999;if(onesFormat.lastIndexOf(",")!=-1){groupLength=onesFormat.length-onesFormat.lastIndexOf(",")-1}var groupCount=0;for(var i=oneText.length-1;i>-1;i--){onePortion=oneText.charAt(i)+onePortion;groupCount++;if(groupCount==groupLength&&i!=0){onePortion=group+onePortion;groupCount=0}}if(onesFormat.length>onePortion.length){var padStart=onesFormat.indexOf("0");if(padStart!=-1){var padLen=onesFormat.length-padStart;while(onePortion.length<padLen){onePortion="0"+onePortion}}}}if(!onePortion&&onesFormat.indexOf("0",onesFormat.length-1)!==-1){onePortion="0"}returnString=onePortion+returnString;if(number<0&&negativeInFront&&prefix.length>0){prefix=neg+prefix}else{if(number<0){returnString=neg+returnString}}if(!options.decimalSeparatorAlwaysShown){if(returnString.lastIndexOf(dec)==returnString.length-1){returnString=returnString.substring(0,returnString.length-1)}}returnString=prefix+returnString+suffix;return returnString};jQuery.fn.parseNumber=function(options,writeBack,giveReturnValue){if(writeBack==null){writeBack=true}if(giveReturnValue==null){giveReturnValue=true}var text;if(jQuery(this).is(":input")){text=new String(jQuery(this).val())}else{text=new String(jQuery(this).text())}var number=jQuery.parseNumber(text,options);if(number){if(writeBack){if(jQuery(this).is(":input")){jQuery(this).val(number.toString())}else{jQuery(this).text(number.toString())}}if(giveReturnValue){return number}}};jQuery.parseNumber=function(numberString,options){var options=jQuery.extend({},jQuery.fn.parseNumber.defaults,options);var formatData=formatCodes(options.locale.toLowerCase());var dec=formatData.dec;var group=formatData.group;var neg=formatData.neg;var valid="1234567890.-";while(numberString.indexOf(group)>-1){numberString=numberString.replace(group,"")}numberString=numberString.replace(dec,".").replace(neg,"-");var validText="";var hasPercent=false;if(numberString.charAt(numberString.length-1)=="%"){hasPercent=true}for(var i=0;i<numberString.length;i++){if(valid.indexOf(numberString.charAt(i))>-1){validText=validText+numberString.charAt(i)}}var number=new Number(validText);if(hasPercent){number=number/100;number=number.toFixed(validText.length-1)}return number};jQuery.fn.parseNumber.defaults={locale:"us",decimalSeparatorAlwaysShown:false};jQuery.fn.formatNumber.defaults={format:"#,###.00",locale:"us",decimalSeparatorAlwaysShown:false,nanForceZero:true,round:true};Number.prototype.toFixed=function(precision){return $._roundNumber(this,precision)};jQuery._roundNumber=function(number,decimalPlaces){var power=Math.pow(10,decimalPlaces||0);var value=String(Math.round(number*power)/power);if(decimalPlaces>0){var dp=value.indexOf(".");if(dp==-1){value+=".";dp=0}else{dp=value.length-(dp+1)}while(dp<decimalPlaces){value+="0";dp++}}return value}})(jQuery);(function($){$.format=(function(){function strDay(value){switch(parseInt(value)){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday";default:return value}}function strMonth(value){switch(parseInt(value)){case 1:return"Jan";case 2:return"Feb";case 3:return"Mar";case 4:return"Apr";case 5:return"May";case 6:return"Jun";case 7:return"Jul";case 8:return"Aug";case 9:return"Sep";case 10:return"Oct";case 11:return"Nov";case 12:return"Dec";default:return value}}var parseMonth=function(value){switch(value){case"Jan":return"01";case"Feb":return"02";case"Mar":return"03";case"Apr":return"04";case"May":return"05";case"Jun":return"06";case"Jul":return"07";case"Aug":return"08";case"Sep":return"09";case"Oct":return"10";case"Nov":return"11";case"Dec":return"12";default:return value}};var parseTime=function(value){var retValue=value;var millis="";if(retValue.indexOf(".")!==-1){var delimited=retValue.split(".");retValue=delimited[0];millis=delimited[1]}var values3=retValue.split(":");if(values3.length===3){hour=values3[0];minute=values3[1];second=values3[2];return{time:retValue,hour:hour,minute:minute,second:second,millis:millis}}else{return{time:"",hour:"",minute:"",second:"",millis:""}}};return{date:function(value,format){try{var date=null;var year=null;var month=null;var dayOfMonth=null;var dayOfWeek=null;var time=null;if(typeof value.getFullYear==="function"){year=value.getFullYear();month=value.getMonth()+1;dayOfMonth=value.getDate();dayOfWeek=value.getDay();time=parseTime(value.toTimeString())}else{if(value.search(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.?\d{0,3}\+\d{2}:\d{2}/)!=-1){var values=value.split(/[T\+-]/);year=values[0];month=values[1];dayOfMonth=values[2];time=parseTime(values[3].split(".")[0]);date=new Date(year,month-1,dayOfMonth);dayOfWeek=date.getDay()}else{var values=value.split(" ");switch(values.length){case 6:year=values[5];month=parseMonth(values[1]);dayOfMonth=values[2];time=parseTime(values[3]);date=new Date(year,month-1,dayOfMonth);dayOfWeek=date.getDay();break;case 2:var values2=values[0].split("-");year=values2[0];month=values2[1];dayOfMonth=values2[2];time=parseTime(values[1]);date=new Date(year,month-1,dayOfMonth);dayOfWeek=date.getDay();break;case 7:case 9:case 10:year=values[3];month=parseMonth(values[1]);dayOfMonth=values[2];time=parseTime(values[4]);date=new Date(year,month-1,dayOfMonth);dayOfWeek=date.getDay();break;default:return value}}}var pattern="";var retValue="";for(var i=0;i<format.length;i++){var currentPattern=format.charAt(i);pattern+=currentPattern;switch(pattern){case"ddd":retValue+=strDay(dayOfWeek);pattern="";break;case"dd":if(format.charAt(i+1)=="d"){break}if(String(dayOfMonth).length===1){dayOfMonth="0"+dayOfMonth}retValue+=dayOfMonth;pattern="";break;case"MMM":retValue+=strMonth(month);pattern="";break;case"MM":if(format.charAt(i+1)=="M"){break}if(String(month).length===1){month="0"+month}retValue+=month;pattern="";break;case"yyyy":retValue+=year;pattern="";break;case"HH":retValue+=time.hour;pattern="";break;case"hh":retValue+=(time.hour==0?12:time.hour<13?time.hour:time.hour-12);pattern="";break;case"mm":retValue+=time.minute;pattern="";break;case"ss":retValue+=time.second.substring(0,2);pattern="";break;case"SSS":retValue+=time.millis.substring(0,3);pattern="";break;case"a":retValue+=time.hour>=12?"PM":"AM";pattern="";break;case" ":retValue+=currentPattern;pattern="";break;case"/":retValue+=currentPattern;pattern="";break;case":":retValue+=currentPattern;pattern="";break;default:if(pattern.length===2&&pattern.indexOf("y")!==0&&pattern!="SS"){retValue+=pattern.substring(0,1);pattern=pattern.substring(1,2)}else{if((pattern.length===3&&pattern.indexOf("yyy")===-1)){pattern=""}}}}return retValue}catch(e){console.log(e);return value}}}}())}(jQuery));$(document).ready(function(){$(".shortDateFormat").each(function(idx,elem){if($(elem).is(":input")){$(elem).val($.format.date($(elem).val(),"dd/MM/yyyy"))}else{$(elem).text($.format.date($(elem).text(),"dd/MM/yyyy"))}});$(".longDateFormat").each(function(idx,elem){if($(elem).is(":input")){$(elem).val($.format.date($(elem).val(),"dd/MM/yyyy hh:mm:ss"))}else{$(elem).text($.format.date($(elem).text(),"dd/MM/yyyy hh:mm:ss"))}})});!function($){function UTCDate(){return new Date(Date.UTC.apply(Date,arguments))}function UTCToday(){var today=new Date();return UTCDate(today.getUTCFullYear(),today.getUTCMonth(),today.getUTCDate())}var Datepicker=function(element,options){var that=this;this.element=$(element);this.language=options.language||this.element.data("date-language")||"en";this.language=this.language in dates?this.language:"en";this.format=DPGlobal.parseFormat(options.format||this.element.data("date-format")||"mm/dd/yyyy");this.isInline=false;this.isInput=this.element.is("input");this.component=this.element.is(".date")?this.element.find(".input-group-addon"):false;this.hasInput=this.component&&this.element.find("input").length;if(this.component&&this.component.length===0){this.component=false}this._attachEvents();this.forceParse=true;if("forceParse" in options){this.forceParse=options.forceParse}else{if("dateForceParse" in this.element.data()){this.forceParse=this.element.data("date-force-parse")}}this.picker=$(DPGlobal.template).appendTo(this.isInline?this.element:"body").on({click:$.proxy(this.click,this),mousedown:$.proxy(this.mousedown,this)});if(this.isInline){this.picker.addClass("datepicker-inline")}else{this.picker.addClass("datepicker-dropdown dropdown-menu")}this.autoclose=false;if("autoclose" in options){this.autoclose=options.autoclose}else{if("dateAutoclose" in this.element.data()){this.autoclose=this.element.data("date-autoclose")}}this.keyboardNavigation=true;if("keyboardNavigation" in options){this.keyboardNavigation=options.keyboardNavigation}else{if("dateKeyboardNavigation" in this.element.data()){this.keyboardNavigation=this.element.data("date-keyboard-navigation")}}this.viewMode=this.startViewMode=0;switch(options.startView||this.element.data("date-start-view")){case 2:case"decade":this.viewMode=this.startViewMode=2;break;case 1:case"year":this.viewMode=this.startViewMode=1;break}this.todayBtn=(options.todayBtn||this.element.data("date-today-btn")||false);this.todayHighlight=(options.todayHighlight||this.element.data("date-today-highlight")||false);this.weekStart=((options.weekStart||this.element.data("date-weekstart")||dates[this.language].weekStart||0)%7);this.weekEnd=((this.weekStart+6)%7);this.startDate=-Infinity;this.endDate=Infinity;this.daysOfWeekDisabled=[];this.setStartDate(options.startDate||this.element.data("date-startdate"));this.setEndDate(options.endDate||this.element.data("date-enddate"));this.setDaysOfWeekDisabled(options.daysOfWeekDisabled||this.element.data("date-days-of-week-disabled"));this.fillDow();this.fillMonths();this.update();this.showMode();if(this.isInline){this.show()}};Datepicker.prototype={constructor:Datepicker,_events:[],_attachEvents:function(){this._detachEvents();if(this.isInput){this._events=[[this.element,{focus:$.proxy(this.show,this),keyup:$.proxy(this.update,this),keydown:$.proxy(this.keydown,this)}]]}else{if(this.component&&this.hasInput){this._events=[[this.element.find("input"),{focus:$.proxy(this.show,this),keyup:$.proxy(this.update,this),keydown:$.proxy(this.keydown,this)}],[this.component,{click:$.proxy(this.show,this)}]]}else{if(this.element.is("div")){this.isInline=true}else{this._events=[[this.element,{click:$.proxy(this.show,this)}]]}}}for(var i=0,el,ev;i<this._events.length;i++){el=this._events[i][0];ev=this._events[i][1];el.on(ev)}},_detachEvents:function(){for(var i=0,el,ev;i<this._events.length;i++){el=this._events[i][0];ev=this._events[i][1];el.off(ev)}this._events=[]},show:function(e){var f=$.proxy(this.hide,this);$(document).on("mousedown.datepicker.data-api",function(e){if($(e.target).closest(".datepicker").length===0){f()}});$(window).on("resize.datepicker.data-api",$.proxy(this.place,this));$(this.element).closest(".modal-content").on("scroll.datepicker.data-api",$.proxy(this.place,this));this.viewMode=this.startViewMode;this.showMode();this.picker.show();this.isShown=true;this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.update();this.place();if(e&&e.type!="focus"){e.stopPropagation();e.preventDefault()}this.element.trigger({type:"show",date:this.date})},hide:function(e){if(this.isInline||!this.isShown){return}this.picker.hide();this.isShown=false;$(document).off("mousedown.datepicker.data-api");$(window).off("resize.datepicker.data-api");$(this.element).closest(".modal-content").off("scroll.datepicker.data-api");this.element.trigger({type:"hide",date:this.date})},remove:function(){this._detachEvents();this.picker.remove();delete this.element.data().datepicker},getDate:function(){var d=this.getUTCDate();return new Date(d.getTime()+(d.getTimezoneOffset()*60000))},getUTCDate:function(){return this.date},setDate:function(d){this.setUTCDate(new Date(d.getTime()-(d.getTimezoneOffset()*60000)))},setUTCDate:function(d){this.date=d;this.setValue()},setValue:function(){var formatted=this.dateString=this.getFormattedDate();if(!this.isInput){if(this.component){this.element.find("input").prop("value",formatted)}this.element.data("date",formatted)}else{this.element.prop("value",formatted)}},getFormattedDate:function(format){if(format==undefined){format=this.format}return DPGlobal.formatDate(this.date,format,this.language)},setStartDate:function(startDate){this.startDate=startDate||-Infinity;if(this.startDate!==-Infinity){this.startDate=DPGlobal.parseDate(this.startDate,this.format,this.language)}},setEndDate:function(endDate){this.endDate=endDate||Infinity;if(this.endDate!==Infinity){this.endDate=DPGlobal.parseDate(this.endDate,this.format,this.language)}},setDaysOfWeekDisabled:function(daysOfWeekDisabled){this.daysOfWeekDisabled=daysOfWeekDisabled||[];if(!$.isArray(this.daysOfWeekDisabled)){this.daysOfWeekDisabled=this.daysOfWeekDisabled.split(/,\s*/)}this.daysOfWeekDisabled=$.map(this.daysOfWeekDisabled,function(d){return parseInt(d,10)})},place:function(){if(this.isInline){return}var zIndex=Math.max.apply(Math,$(this.element.parents()).map(function(){return $(this).css("zIndex")}))+10;var offset=this.component?this.component.offset():this.element.offset();this.picker.css({top:offset.top+this.height,left:offset.left,zIndex:zIndex})},update:function(e){if(e&&e.keyCode==27&&this.isShown){this.hide();e.stopPropagation();return}var date,fromArgs=false,shouldParse=true,argType=$.type(e);if(argType=="string"||argType=="date"){date=e;fromArgs=true}else{date=this.isInput?this.element.prop("value"):this.element.data("date")||this.element.find("input").prop("value");shouldParse=this.dateString!==date}if(shouldParse||!this.date){this.date=DPGlobal.parseDate(date,this.format,this.language);this.dateString=this.getFormattedDate()}if(fromArgs){this.setValue()}if(this.date<this.startDate){this.viewDate=this.startDate}else{if(this.date>this.endDate){this.viewDate=this.endDate}else{this.viewDate=this.date}}this.fill()},fillDow:function(){var dowCnt=this.weekStart,html="<tr>";while(dowCnt<this.weekStart+7){html+='<th class="dow">'+dates[this.language].daysMin[(dowCnt++)%7]+"</th>"}html+="</tr>";this.picker.find(".datepicker-days thead").append(html)},fillMonths:function(){var html="",i=0;while(i<12){html+='<span class="month">'+dates[this.language].monthsShort[i++]+"</span>"}this.picker.find(".datepicker-months td").html(html)},fill:function(){var d=this.viewDate,year=d.getUTCFullYear(),month=d.getUTCMonth(),startYear=this.startDate!==-Infinity?this.startDate.getUTCFullYear():-Infinity,startMonth=this.startDate!==-Infinity?this.startDate.getUTCMonth():-Infinity,endYear=this.endDate!==Infinity?this.endDate.getUTCFullYear():Infinity,endMonth=this.endDate!==Infinity?this.endDate.getUTCMonth():Infinity,currentDate=this.date.valueOf(),today=new Date();this.picker.find(".datepicker-days thead th:eq(1)").text(dates[this.language].months[month]+" "+year);this.picker.find("tfoot th.today").text(dates[this.language].today).toggle(this.todayBtn!==false);this.updateNavArrows();this.fillMonths();var prevMonth=UTCDate(year,month-1,28,0,0,0,0),day=DPGlobal.getDaysInMonth(prevMonth.getUTCFullYear(),prevMonth.getUTCMonth());prevMonth.setUTCDate(day);prevMonth.setUTCDate(day-(prevMonth.getUTCDay()-this.weekStart+7)%7);var nextMonth=new Date(prevMonth);nextMonth.setUTCDate(nextMonth.getUTCDate()+42);nextMonth=nextMonth.valueOf();var html=[];var clsName;while(prevMonth.valueOf()<nextMonth){if(prevMonth.getUTCDay()==this.weekStart){html.push("<tr>")}clsName="";if(prevMonth.getUTCFullYear()<year||(prevMonth.getUTCFullYear()==year&&prevMonth.getUTCMonth()<month)){clsName+=" old"}else{if(prevMonth.getUTCFullYear()>year||(prevMonth.getUTCFullYear()==year&&prevMonth.getUTCMonth()>month)){clsName+=" new"}}if(this.todayHighlight&&prevMonth.getUTCFullYear()==today.getFullYear()&&prevMonth.getUTCMonth()==today.getMonth()&&prevMonth.getUTCDate()==today.getDate()){clsName+=" today"}if(prevMonth.valueOf()==currentDate){clsName+=" active"}if(prevMonth.valueOf()<this.startDate||prevMonth.valueOf()>this.endDate||$.inArray(prevMonth.getUTCDay(),this.daysOfWeekDisabled)!==-1){clsName+=" disabled"}html.push('<td class="day'+clsName+'">'+prevMonth.getUTCDate()+"</td>");if(prevMonth.getUTCDay()==this.weekEnd){html.push("</tr>")}prevMonth.setUTCDate(prevMonth.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(html.join(""));var currentYear=this.date.getUTCFullYear();var months=this.picker.find(".datepicker-months").find("th:eq(1)").text(year).end().find("span").removeClass("active");if(currentYear==year){months.eq(this.date.getUTCMonth()).addClass("active")}if(year<startYear||year>endYear){months.addClass("disabled")}if(year==startYear){months.slice(0,startMonth).addClass("disabled")}if(year==endYear){months.slice(endMonth+1).addClass("disabled")}html="";year=parseInt(year/10,10)*10;var yearCont=this.picker.find(".datepicker-years").find("th:eq(1)").text(year+"-"+(year+9)).end().find("td");year-=1;for(var i=-1;i<11;i++){html+='<span class="year'+(i==-1||i==10?" old":"")+(currentYear==year?" active":"")+(year<startYear||year>endYear?" disabled":"")+'">'+year+"</span>";year+=1}yearCont.html(html)},updateNavArrows:function(){var d=new Date(this.viewDate),year=d.getUTCFullYear(),month=d.getUTCMonth();switch(this.viewMode){case 0:if(this.startDate!==-Infinity&&year<=this.startDate.getUTCFullYear()&&month<=this.startDate.getUTCMonth()){this.picker.find(".prev").css({visibility:"hidden"})}else{this.picker.find(".prev").css({visibility:"visible"})}if(this.endDate!==Infinity&&year>=this.endDate.getUTCFullYear()&&month>=this.endDate.getUTCMonth()){this.picker.find(".next").css({visibility:"hidden"})}else{this.picker.find(".next").css({visibility:"visible"})}break;case 1:case 2:if(this.startDate!==-Infinity&&year<=this.startDate.getUTCFullYear()){this.picker.find(".prev").css({visibility:"hidden"})}else{this.picker.find(".prev").css({visibility:"visible"})}if(this.endDate!==Infinity&&year>=this.endDate.getUTCFullYear()){this.picker.find(".next").css({visibility:"hidden"})}else{this.picker.find(".next").css({visibility:"visible"})}break}},click:function(e){e.stopPropagation();e.preventDefault();var target=$(e.target).closest("span, td, th");if(target.length===1){switch(target[0].nodeName.toLowerCase()){case"th":switch(target[0].className){case"switch":this.showMode(1);break;case"prev":case"next":var dir=DPGlobal.modes[this.viewMode].navStep*(target[0].className=="prev"?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,dir);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,dir);break}this.fill();break;case"today":var date=new Date();date=UTCDate(date.getFullYear(),date.getMonth(),date.getDate(),0,0,0);this.showMode(-2);this._setDate(date);break}break;case"span":if(!target.is(".disabled")){if(target.is(".month")){var month=target.parent().find("span").index(target);this.viewDate.setUTCDate(1);this.viewDate.setUTCMonth(month);this.element.trigger({type:"changeMonth",date:this.viewDate})}if(target.is(".year")){var year=parseInt(target.text(),10)||0;this.viewDate.setUTCDate(1);this.viewDate.setUTCFullYear(year);this.element.trigger({type:"changeYear",date:this.viewDate})}this.showMode(-1);this.fill()}break;case"td":if(target.is(".day")&&!target.is(".disabled")){var day=parseInt(target.text(),10)||1;var year=this.viewDate.getUTCFullYear(),month=this.viewDate.getUTCMonth();if(target.is(".old")){if(month===0){month=11;year-=1}else{month-=1}}else{if(target.is(".new")){if(month==11){month=0;year+=1}else{month+=1}}}this._setDate(UTCDate(year,month,day,0,0,0,0))}break}}},_setDate:function(date){this.date=date;this.fill();this.setValue();this.element.trigger({type:"changeDate",date:this.date});var element;if(this.isInput){element=this.element}else{if(this.component){element=this.element.find("input")}}if(element){element.change();if(this.autoclose){this.hide()}}},moveMonth:function(date,dir){if(!dir){return date}var new_date=new Date(date.valueOf()),day=new_date.getUTCDate(),month=new_date.getUTCMonth(),mag=Math.abs(dir),new_month,test;dir=dir>0?1:-1;if(mag==1){test=dir==-1?function(){return new_date.getUTCMonth()==month}:function(){return new_date.getUTCMonth()!=new_month};new_month=month+dir;new_date.setUTCMonth(new_month);if(new_month<0||new_month>11){new_month=(new_month+12)%12}}else{for(var i=0;i<mag;i++){new_date=this.moveMonth(new_date,dir)}new_month=new_date.getUTCMonth();new_date.setUTCDate(day);test=function(){return new_month!=new_date.getUTCMonth()}}while(test()){new_date.setUTCDate(--day);new_date.setUTCMonth(new_month)}return new_date},moveYear:function(date,dir){return this.moveMonth(date,dir*12)},dateWithinRange:function(date){return date>=this.startDate&&date<=this.endDate},keydown:function(e){var dateChanged=false,dir,day,month,newDate,newViewDate;switch(e.keyCode){case 27:e.preventDefault();break;case 37:case 39:if(!this.keyboardNavigation){break}dir=e.keyCode==37?-1:1;if(e.ctrlKey){newDate=this.moveYear(this.date,dir);newViewDate=this.moveYear(this.viewDate,dir)}else{if(e.shiftKey){newDate=this.moveMonth(this.date,dir);newViewDate=this.moveMonth(this.viewDate,dir)}else{newDate=new Date(this.date);newDate.setUTCDate(this.date.getUTCDate()+dir);newViewDate=new Date(this.viewDate);newViewDate.setUTCDate(this.viewDate.getUTCDate()+dir)}}if(this.dateWithinRange(newDate)){e.preventDefault();dateChanged=true}break;case 38:case 40:if(!this.keyboardNavigation){break}dir=e.keyCode==38?-1:1;if(e.ctrlKey){newDate=this.moveYear(this.date,dir);newViewDate=this.moveYear(this.viewDate,dir)}else{if(e.shiftKey){newDate=this.moveMonth(this.date,dir);newViewDate=this.moveMonth(this.viewDate,dir)}else{newDate=new Date(this.date);newDate.setUTCDate(this.date.getUTCDate()+dir*7);newViewDate=new Date(this.viewDate);newViewDate.setUTCDate(this.viewDate.getUTCDate()+dir*7)}}if(this.dateWithinRange(newDate)){e.preventDefault();dateChanged=true}break;case 13:this.hide();e.preventDefault();break;case 9:this.hide();break}if(dateChanged){this.date=newDate;this.viewDate=newViewDate;this.setValue();this.update();this.element.trigger({type:"changeDate",date:this.date});var element;if(this.isInput){element=this.element}else{if(this.component){element=this.element.find("input")}}if(element){element.change()}}},showMode:function(dir){if(dir){this.viewMode=Math.max(0,Math.min(2,this.viewMode+dir))}this.picker.find(">div").hide().filter(".datepicker-"+DPGlobal.modes[this.viewMode].clsName).css("display","block");this.updateNavArrows()},destroy:function(){$(document).off("mousedown.datepicker.data-api");$(window).off("resize.datepicker.data-api");this.picker&&this.picker.remove()}};$.fn.datepicker=function(option){var args=Array.apply(null,arguments),retValue,hasMethodReturned=false,options=typeof option=="object"&&option;args.shift();this.each(function(){var $this=$(this),data=$this.data("datepicker");if(!data){$this.data("datepicker",(data=new Datepicker(this,$.extend({},$.fn.datepicker.defaults,options))))}if(typeof option=="string"&&typeof data[option]=="function"){retValue=data[option].apply(data,args);if(retValue!==undefined){hasMethodReturned=true;return false}}});return hasMethodReturned?retValue:this};$.fn.datepicker.defaults={};$.fn.datepicker.Constructor=Datepicker;var dates=$.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today"}};var DPGlobal=(function(){var dateOffsetRe=/^[-+]\d+[dmwy]([\s,]+[-+]\d+[dmwy])*$/,offsetPartSplitterRe=/([-+]\d+)([dmwy])/g,offsetPartRe=/([-+]\d+)([dmwy])/,setters_order=["yyyy","yy","M","MM","m","mm","d","dd"],setters_map={yyyy:function(d,v){return d.setUTCFullYear(Math.max(1,Math.min(9999,v)))},yy:function(d,v){return d.setUTCFullYear(2000+Math.max(0,v))},m:function(d,v){v-=1;while(v<0){v+=12}v%=12;d.setUTCMonth(v);while(d.getUTCMonth()!=v){d.setUTCDate(d.getUTCDate()-1)}return d},d:function(d,v){return d.setUTCDate(v)}};setters_map.M=setters_map.MM=setters_map.mm=setters_map.m;setters_map.dd=setters_map.d;return{modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(year){return(((year%4===0)&&(year%100!==0))||(year%400===0))},getDaysInMonth:function(year,month){return[31,(DPGlobal.isLeapYear(year)?29:28),31,30,31,30,31,31,30,31,30,31][month]},validParts:/dd?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[-`{-~\t\n\r]+/g,parseFormat:function(format){var separators=format.replace(this.validParts,"\0").split("\0"),parts=format.match(this.validParts);if(!separators||!separators.length||!parts||parts.length==0){throw new Error("Invalid date format.")}return{separators:separators,parts:parts}},parseDate:function(_date,format,language){if(_date instanceof Date){return _date}var date=new Date();if(!_date||typeof(_date)!="string"){return date}if(dateOffsetRe.test(_date)){var parts=_date.match(offsetPartSplitterRe),part,dir;for(var i=0;i<parts.length;i++){part=offsetPartRe.exec(parts[i]);dir=parseInt(part[1]);switch(part[2]){case"d":date.setUTCDate(date.getUTCDate()+dir);break;case"m":date=Datepicker.prototype.moveMonth.call(Datepicker.prototype,date,dir);break;case"w":date.setUTCDate(date.getUTCDate()+dir*7);break;case"y":date=Datepicker.prototype.moveYear.call(Datepicker.prototype,date,dir);break}}return UTCDate(date.getUTCFullYear(),date.getUTCMonth(),date.getUTCDate(),0,0,0)}var parts=_date.match(this.nonpunctuation)||[],parsed={},val,filtered,part;date=UTCDate(date.getFullYear(),date.getMonth(),date.getDate(),0,0,0);if(parts.length==format.parts.length){for(var i=0,cnt=format.parts.length;i<cnt;i++){val=parseInt(parts[i],10);part=format.parts[i];if(isNaN(val)){switch(part){case"MM":filtered=$(dates[language].months).filter(function(){var m=this.slice(0,parts[i].length),p=parts[i].slice(0,m.length);return m==p});val=$.inArray(filtered[0],dates[language].months)+1;break;case"M":filtered=$(dates[language].monthsShort).filter(function(){var m=this.slice(0,parts[i].length),p=parts[i].slice(0,m.length);return m==p});val=$.inArray(filtered[0],dates[language].monthsShort)+1;break}}parsed[part]=val}for(var i=0,s;i<setters_order.length;i++){s=setters_order[i];if(s in parsed&&!isNaN(parsed[s])){setters_map[s](date,parsed[s])}}}return date},formatDate:function(date,format,language){var val={d:date.getUTCDate(),m:date.getUTCMonth()+1,M:dates[language].monthsShort[date.getUTCMonth()],MM:dates[language].months[date.getUTCMonth()],yy:date.getUTCFullYear().toString().substring(2),yyyy:date.getUTCFullYear()};val.dd=(val.d<10?"0":"")+val.d;val.mm=(val.m<10?"0":"")+val.m;var date=[],seps=$.extend([],format.separators);for(var i=0,cnt=format.parts.length;i<cnt;i++){if(seps.length){date.push(seps.shift())}date.push(val[format.parts[i]])}return date.join("")},headTemplate:'<thead><tr><th class="prev"><i class="icon-arrow-left"/></th><th colspan="5" class="switch"></th><th class="next"><i class="icon-arrow-right"/></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr></tfoot>'}})();DPGlobal.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+DPGlobal.headTemplate+"<tbody></tbody>"+DPGlobal.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+DPGlobal.headTemplate+DPGlobal.contTemplate+DPGlobal.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+DPGlobal.headTemplate+DPGlobal.contTemplate+DPGlobal.footTemplate+"</table></div></div>";$.fn.datepicker.DPGlobal=DPGlobal}(window.jQuery);!function($){var Timepicker=function(element,options){this.$element=$(element);this.options=$.extend({},$.fn.timepicker.defaults,options,this.$element.data());this.minuteStep=this.options.minuteStep||this.minuteStep;this.secondStep=this.options.secondStep||this.secondStep;this.showMeridian=this.options.showMeridian||this.showMeridian;this.showSeconds=this.options.showSeconds||this.showSeconds;this.showInputs=this.options.showInputs||this.showInputs;this.disableFocus=this.options.disableFocus||this.disableFocus;this.template=this.options.template||this.template;this.modalBackdrop=this.options.modalBackdrop||this.modalBackdrop;this.defaultTime=this.options.defaultTime||this.defaultTime;this.isInline=this.options.isInline||this.isInline;this.open=false;this.init()};Timepicker.prototype={constructor:Timepicker,init:function(){var $cmpnt=this.$element.closest(".input-group");if($cmpnt.length>0){$cmpnt.find(".input-group-addon").on("click",$.proxy(this.showWidget,this));this.$element.on({focus:$.proxy(this.highlightUnit,this),click:$.proxy(this.highlightUnit,this),keydown:$.proxy(this.elementKeypress,this),keyup:$.proxy(this.elementKeypress,this),blur:$.proxy(this.blurElement,this)})}else{if(this.template){this.$element.on({focus:$.proxy(this.showWidget,this),click:$.proxy(this.showWidget,this),blur:$.proxy(this.blurElement,this)})}else{this.$element.on({focus:$.proxy(this.highlightUnit,this),click:$.proxy(this.highlightUnit,this),keydown:$.proxy(this.elementKeypress,this),keyup:$.proxy(this.elementKeypress,this),blur:$.proxy(this.blurElement,this)})}}if(this.isInline){this.$widget=$(this.getTemplate()).insertAfter(this.$element)}else{this.$widget=$(this.getTemplate()).appendTo($(document.body))}this.$widget.on("click",$.proxy(this.widgetClick,this));if(this.showInputs){this.$widget.find("input").on({click:function(){this.select()},keydown:$.proxy(this.widgetKeypress,this),keyup:$.proxy(this.widgetKeypress,this),change:$.proxy(this.updateFromWidgetInputs,this)})}this.setDefaultTime(this.defaultTime)},showWidget:function(e){e.stopPropagation();e.preventDefault();if(this.open){return}this.$element.trigger("show");if(this.disableFocus){this.$element.blur()}else{if(e.type=="click"&&e.target!=this.$element.get(0)){this.$element.get(0).focus()}}var offsetParent=this.$element.offsetParent();var pos=$.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});var zIndex=parseInt(this.$element.parents().filter(function(){return $(this).css("z-index")!="auto"}).first().css("z-index"))+10;this.updateFromElementVal();$(document.body).trigger("click.timepicker.data-api").one("click.timepicker.data-api",$.proxy(this.hideWidget,this));if(this.template==="modal"){this.$widget.modal("show").on("hidden",$.proxy(this.hideWidget,this))}else{var offset=this.component?this.component.offset():this.$element.offset();this.$widget.css({top:pos.height+offset.top,left:offset.left,zIndex:zIndex});if(!this.open){this.$widget.addClass("open")}}this.open=true;this.$element.trigger("shown")},hideWidget:function(){if(!this.open){return}this.$element.trigger("hide");if(this.template==="modal"){this.$widget.modal("hide")}else{this.$widget.removeClass("open")}this.open=false;this.$element.trigger("hidden")},widgetClick:function(e){e.stopPropagation();e.preventDefault();var action=$(e.target).closest("a").data("action");if(action){this[action]();this.update()}},widgetKeypress:function(e){if(e.type=="keyup"){e.keyCode==27&&e.stopPropagation();return}var input=$(e.target).closest("input").attr("name");switch(e.keyCode){case 9:if(this.showMeridian){if(input=="meridian"){this.hideWidget()}}else{if(this.showSeconds){if(input=="second"){this.hideWidget()}}else{if(input=="minute"){this.hideWidget()}}}break;case 27:this.hideWidget();break;case 38:switch(input){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian();break}this.update();break;case 40:switch(input){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian();break}this.update();break}},elementKeypress:function(e){if(e.type=="keyup"){if(e.keyCode==27&&this.open){this.hideWidget();e.stopPropagation()}return}var input=this.$element.get(0),keyCode=e.keyCode;switch(keyCode){case 0:break;case 9:var v=this.$element.val();this.updateFromElementVal();if(v&&((this.showMeridian&&this.highlightedUnit!="meridian")||(this.showSeconds&&this.highlightedUnit!="second")||this.highlightedUnit!="minute")){e.preventDefault();this.highlightNextUnit()}if(!e.isDefaultPrevented()){this.hideWidget()}break;case 27:this.updateFromElementVal();break;case 37:this.updateFromElementVal();this.highlightPrevUnit();break;case 38:switch(this.highlightedUnit){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian();break}this.updateElement();break;case 39:this.updateFromElementVal();this.highlightNextUnit();break;case 40:switch(this.highlightedUnit){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian();break}this.updateElement();break}if(keyCode!==0&&keyCode!==8&&keyCode!==9&&keyCode!==46&&!(keyCode>=48&&keyCode<=57)&&!((keyCode==59||keyCode==186)&&e.shiftKey)&&!(e.keyCode>=96&&e.keyCode<=105)){e.preventDefault()}},setValues:function(time,setIfEmpty){if(this.showMeridian){var arr=time.split(" ");var timeArray=arr[0].split(":");this.meridian=arr[1]}else{var timeArray=time.split(":")}this.hour=parseInt(timeArray[0],10);this.minute=parseInt(timeArray[1],10);this.second=parseInt(timeArray[2],10);if(isNaN(this.hour)){this.hour=0}if(isNaN(this.minute)){this.minute=0}if(this.showMeridian){if(this.hour>12){this.hour=12}else{if(this.hour<1){this.hour=1}}if(this.meridian=="am"||this.meridian=="a"){this.meridian="AM"}else{if(this.meridian=="pm"||this.meridian=="p"){this.meridian="PM"}}if(this.meridian!="AM"&&this.meridian!="PM"){this.meridian="AM"}}else{if(this.hour>=24){this.hour=23}else{if(this.hour<0){this.hour=0}}}if(this.minute<0){this.minute=0}else{if(this.minute>=60){this.minute=59}}if(this.showSeconds){if(isNaN(this.second)){this.second=0}else{if(this.second<0){this.second=0}else{if(this.second>=60){this.second=59}}}}if(setIfEmpty||this.$element.val()!=""){this.updateElement()}this.updateWidget()},setMeridian:function(meridian){if(meridian=="a"||meridian=="am"||meridian=="AM"){this.meridian="AM"}else{if(meridian=="p"||meridian=="pm"||meridian=="PM"){this.meridian="PM"}else{this.updateWidget()}}this.updateElement()},setDefaultTime:function(defaultTime){if(defaultTime){if(defaultTime==="current"){var dTime=new Date();var hours=dTime.getHours();var minutes=Math.floor(dTime.getMinutes()/this.minuteStep)*this.minuteStep;var seconds=Math.floor(dTime.getSeconds()/this.secondStep)*this.secondStep;var meridian="AM";if(this.showMeridian){if(hours===0){hours=12}else{if(hours>=12){if(hours>12){hours=hours-12}meridian="PM"}else{meridian="AM"}}}this.hour=hours;this.minute=minutes;this.second=seconds;this.meridian=meridian}else{if(defaultTime==="value"){this.setValues(this.$element.val())}else{this.setValues(defaultTime)}}if(this.$element.val()!=""){this.updateElement()}this.updateWidget()}else{this.hour=0;this.minute=0;this.second=0}},formatTime:function(hour,minute,second,meridian){hour=hour<10?"0"+hour:hour;minute=minute<10?"0"+minute:minute;second=second<10?"0"+second:second;return hour+":"+minute+(this.showSeconds?":"+second:"")+(this.showMeridian?" "+meridian:"")},getTime:function(){return this.formatTime(this.hour,this.minute,this.second,this.meridian)},setTime:function(time){this.setValues(time);this.update()},update:function(){this.updateElement();this.updateWidget()},blurElement:function(){this.highlightedUnit=undefined;this.updateFromElementVal()},updateElement:function(){var time=this.getTime();this.$element.val(time).change();switch(this.highlightedUnit){case"hour":this.highlightHour();break;case"minute":this.highlightMinute();break;case"second":this.highlightSecond();break;case"meridian":this.highlightMeridian();break}},updateWidget:function(){if(this.showInputs){this.$widget.find("input.bootstrap-timepicker-hour").val(this.hour<10?"0"+this.hour:this.hour);this.$widget.find("input.bootstrap-timepicker-minute").val(this.minute<10?"0"+this.minute:this.minute);if(this.showSeconds){this.$widget.find("input.bootstrap-timepicker-second").val(this.second<10?"0"+this.second:this.second)}if(this.showMeridian){this.$widget.find("input.bootstrap-timepicker-meridian").val(this.meridian)}}else{this.$widget.find("span.bootstrap-timepicker-hour").text(this.hour);this.$widget.find("span.bootstrap-timepicker-minute").text(this.minute<10?"0"+this.minute:this.minute);if(this.showSeconds){this.$widget.find("span.bootstrap-timepicker-second").text(this.second<10?"0"+this.second:this.second)}if(this.showMeridian){this.$widget.find("span.bootstrap-timepicker-meridian").text(this.meridian)}}},updateFromElementVal:function(e){var time=this.$element.val();if(time){this.setValues(time);this.updateWidget()}},updateFromWidgetInputs:function(){var time=$("input.bootstrap-timepicker-hour",this.$widget).val()+":"+$("input.bootstrap-timepicker-minute",this.$widget).val()+(this.showSeconds?":"+$("input.bootstrap-timepicker-second",this.$widget).val():"")+(this.showMeridian?" "+$("input.bootstrap-timepicker-meridian",this.$widget).val():"");this.setValues(time,true)},getCursorPosition:function(){var input=this.$element.get(0);if("selectionStart" in input){return input.selectionStart}else{if(document.selection){input.focus();var sel=document.selection.createRange();var selLen=document.selection.createRange().text.length;sel.moveStart("character",-input.value.length);return sel.text.length-selLen}}},highlightUnit:function(e){var input=this.$element.get(0);if(e.type=="focus"){e.preventDefault();this.position=0}else{this.position=this.getCursorPosition()}if(this.position>=0&&this.position<=2){this.highlightHour()}else{if(this.position>=3&&this.position<=5){this.highlightMinute()}else{if(this.position>=6&&this.position<=8){if(this.showSeconds){this.highlightSecond()}else{this.highlightMeridian()}}else{if(this.position>=9&&this.position<=11){this.highlightMeridian()}}}}},highlightNextUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMinute();break;case"minute":if(this.showSeconds){this.highlightSecond()}else{this.highlightMeridian()}break;case"second":this.highlightMeridian();break;case"meridian":this.highlightHour();break}},highlightPrevUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMeridian();break;case"minute":this.highlightHour();break;case"second":this.highlightMinute();break;case"meridian":if(this.showSeconds){this.highlightSecond()}else{this.highlightMinute()}break}},highlightHour:function(){this.highlightedUnit="hour";this.setSelectionRange(0,2)},highlightMinute:function(){this.highlightedUnit="minute";this.setSelectionRange(3,5)},highlightSecond:function(){this.highlightedUnit="second";this.setSelectionRange(6,8)},highlightMeridian:function(){this.highlightedUnit="meridian";if(this.showSeconds){this.setSelectionRange(9,11)}else{this.setSelectionRange(6,8)}},setSelectionRange:function(start,end){var input=this.$element.get(0);if(input.setSelectionRange){input.setSelectionRange(start,end)}else{if(input.createTextRange){var range=input.createTextRange();range.move("character",-input.value.length);range.moveEnd("character",end);range.moveStart("character",start);range.select()}}},incrementHour:function(){if(this.showMeridian){if(this.hour===11){this.toggleMeridian()}else{if(this.hour===12){return this.hour=1}}}if(this.hour===23){return this.hour=0}this.hour=this.hour+1},decrementHour:function(){if(this.showMeridian){if(this.hour===1){return this.hour=12}else{if(this.hour===12){this.toggleMeridian()}}}if(this.hour===0){return this.hour=23}this.hour=this.hour-1},incrementMinute:function(){var newVal=this.minute+this.minuteStep-(this.minute%this.minuteStep);if(newVal>59){this.incrementHour();this.minute=newVal-60}else{this.minute=newVal}},decrementMinute:function(){var newVal=this.minute-this.minuteStep;if(newVal<0){this.decrementHour();this.minute=newVal+60}else{this.minute=newVal}},incrementSecond:function(){var newVal=this.second+this.secondStep-(this.second%this.secondStep);if(newVal>59){this.incrementMinute();this.second=newVal-60}else{this.second=newVal}},decrementSecond:function(){var newVal=this.second-this.secondStep;if(newVal<0){this.decrementMinute();this.second=newVal+60}else{this.second=newVal}},toggleMeridian:function(){this.meridian=this.meridian==="AM"?"PM":"AM";this.update()},getTemplate:function(){if(this.options.templates[this.options.template]){return this.options.templates[this.options.template]}if(this.showInputs){var hourTemplate='<input type="text" name="hour" class="bootstrap-timepicker-hour" maxlength="2"/>';var minuteTemplate='<input type="text" name="minute" class="bootstrap-timepicker-minute" maxlength="2"/>';var secondTemplate='<input type="text" name="second" class="bootstrap-timepicker-second" maxlength="2"/>';var meridianTemplate='<input type="text" name="meridian" class="bootstrap-timepicker-meridian" maxlength="2"/>'}else{var hourTemplate='<span class="bootstrap-timepicker-hour"></span>';var minuteTemplate='<span class="bootstrap-timepicker-minute"></span>';var secondTemplate='<span class="bootstrap-timepicker-second"></span>';var meridianTemplate='<span class="bootstrap-timepicker-meridian"></span>'}var templateContent='<table class="'+(this.showSeconds?"show-seconds":"")+" "+(this.showMeridian?"show-meridian":"")+'"><tr><td><a href="#" data-action="incrementHour"><i class="icon-triangle-up"></i></a></td><td class="separator">&nbsp;</td><td><a href="#" data-action="incrementMinute"><i class="icon-triangle-up"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="incrementSecond"><i class="icon-triangle-up"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td class="meridian-column"><a href="#" data-action="toggleMeridian"><i class="icon-triangle-up"></i></a></td>':"")+"</tr><tr><td>"+hourTemplate+'</td> <td class="separator">:</td><td>'+minuteTemplate+"</td> "+(this.showSeconds?'<td class="separator">:</td><td>'+secondTemplate+"</td>":"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td>'+meridianTemplate+"</td>":"")+'</tr><tr><td><a href="#" data-action="decrementHour"><i class="icon-triangle-down"></i></a></td><td class="separator"></td><td><a href="#" data-action="decrementMinute"><i class="icon-triangle-down"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="decrementSecond"><i class="icon-triangle-down"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td><a href="#" data-action="toggleMeridian"><i class="icon-triangle-down"></i></a></td>':"")+"</tr></table>";var template;switch(this.options.template){case"modal":template='<div class="bootstrap-timepicker modal hide fade in" style="top: 30%; margin-top: 0; width: 200px; margin-left: -100px;" data-backdrop="'+(this.modalBackdrop?"true":"false")+'"><div class="modal-header"><a href="#" class="close" data-dismiss="modal">Ã</a><h3>Pick a Time</h3></div><div class="modal-content">'+templateContent+'</div><div class="modal-footer"><a href="#" class="btn btn-primary" data-dismiss="modal">Ok</a></div></div>';break;case"dropdown":template='<div class="bootstrap-timepicker dropdown-menu">'+templateContent+"</div>";break}return template},destroy:function(){$(document.body).off("click.timepicker.data-api");this.$widget&&this.$widget.remove()}};$.fn.timepicker=function(option){return this.each(function(){var $this=$(this),data=$this.data("timepicker"),options=typeof option=="object"&&option;if(!data){$this.data("timepicker",(data=new Timepicker(this,options)))}if(typeof option=="string"){data[option]()}})};$.fn.timepicker.defaults={minuteStep:15,secondStep:15,disableFocus:false,defaultTime:"current",showSeconds:false,showInputs:true,showMeridian:true,template:"dropdown",modalBackdrop:false,isInline:false,templates:{}};$.fn.timepicker.Constructor=Timepicker}(window.jQuery);
/*
 * jQuery BBQ: Back Button & Query Library - v1.2.1 - 2/17/2010
 * http://benalman.com/projects/jquery-bbq-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($,window){var undefined,aps=Array.prototype.slice,decode=decodeURIComponent,jq_param=$.param,jq_param_fragment,jq_deparam,jq_deparam_fragment,jq_bbq=$.bbq=$.bbq||{},jq_bbq_pushState,jq_bbq_getState,jq_elemUrlAttr,jq_event_special=$.event.special,str_hashchange="hashchange",str_querystring="querystring",str_fragment="fragment",str_elemUrlAttr="elemUrlAttr",str_location="location",str_href="href",str_src="src",re_trim_querystring=/^.*\?|#.*$/g,re_trim_fragment=/^.*\#/,re_no_escape,elemUrlAttr_cache={};function is_string(arg){return typeof arg==="string"}function curry(func){var args=aps.call(arguments,1);return function(){return func.apply(this,args.concat(aps.call(arguments)))}}function get_fragment(url){return url.replace(/^[^#]*#?(.*)$/,"$1")}function get_querystring(url){return url.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function jq_param_sub(is_fragment,get_func,url,params,merge_mode){var result,qs,matches,url_params,hash;if(params!==undefined){matches=url.match(is_fragment?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/);hash=matches[3]||"";if(merge_mode===2&&is_string(params)){qs=params.replace(is_fragment?re_trim_fragment:re_trim_querystring,"")}else{url_params=jq_deparam(matches[2]);params=is_string(params)?jq_deparam[is_fragment?str_fragment:str_querystring](params):params;qs=merge_mode===2?params:merge_mode===1?$.extend({},params,url_params):$.extend({},url_params,params);qs=jq_param(qs);if(is_fragment){qs=qs.replace(re_no_escape,decode)}}result=matches[1]+(is_fragment?"#":qs||!matches[1]?"?":"")+qs+hash}else{result=get_func(url!==undefined?url:window[str_location][str_href])}return result}jq_param[str_querystring]=curry(jq_param_sub,0,get_querystring);jq_param[str_fragment]=jq_param_fragment=curry(jq_param_sub,1,get_fragment);jq_param_fragment.noEscape=function(chars){chars=chars||"";var arr=$.map(chars.split(""),encodeURIComponent);re_no_escape=new RegExp(arr.join("|"),"g")};jq_param_fragment.noEscape(",/");$.deparam=jq_deparam=function(params,coerce){var obj={},coerce_types={"true":!0,"false":!1,"null":null};$.each(params.replace(/\+/g," ").split("&"),function(j,v){var param=v.split("="),key=decode(param[0]),val,cur=obj,i=0,keys=key.split("]["),keys_last=keys.length-1;if(/\[/.test(keys[0])&&/\]$/.test(keys[keys_last])){keys[keys_last]=keys[keys_last].replace(/\]$/,"");keys=keys.shift().split("[").concat(keys);keys_last=keys.length-1}else{keys_last=0}if(param.length===2){val=decode(param[1]);if(coerce){val=val&&!isNaN(val)?+val:val==="undefined"?undefined:coerce_types[val]!==undefined?coerce_types[val]:val}if(keys_last){for(;i<=keys_last;i++){key=keys[i]===""?cur.length:keys[i];cur=cur[key]=i<keys_last?cur[key]||(keys[i+1]&&isNaN(keys[i+1])?{}:[]):val}}else{if($.isArray(obj[key])){obj[key].push(val)}else{if(obj[key]!==undefined){obj[key]=[obj[key],val]}else{obj[key]=val}}}}else{if(key){obj[key]=coerce?undefined:""}}});return obj};function jq_deparam_sub(is_fragment,url_or_params,coerce){if(url_or_params===undefined||typeof url_or_params==="boolean"){coerce=url_or_params;url_or_params=jq_param[is_fragment?str_fragment:str_querystring]()}else{url_or_params=is_string(url_or_params)?url_or_params.replace(is_fragment?re_trim_fragment:re_trim_querystring,""):url_or_params}return jq_deparam(url_or_params,coerce)}jq_deparam[str_querystring]=curry(jq_deparam_sub,0);jq_deparam[str_fragment]=jq_deparam_fragment=curry(jq_deparam_sub,1);$[str_elemUrlAttr]||($[str_elemUrlAttr]=function(obj){return $.extend(elemUrlAttr_cache,obj)})({a:str_href,base:str_href,iframe:str_src,img:str_src,input:str_src,form:"action",link:str_href,script:str_src});jq_elemUrlAttr=$[str_elemUrlAttr];function jq_fn_sub(mode,force_attr,params,merge_mode){if(!is_string(params)&&typeof params!=="object"){merge_mode=params;params=force_attr;force_attr=undefined}return this.each(function(){var that=$(this),attr=force_attr||jq_elemUrlAttr()[(this.nodeName||"").toLowerCase()]||"",url=attr&&that.attr(attr)||"";that.attr(attr,jq_param[mode](url,params,merge_mode))})}$.fn[str_querystring]=curry(jq_fn_sub,str_querystring);$.fn[str_fragment]=curry(jq_fn_sub,str_fragment);jq_bbq.pushState=jq_bbq_pushState=function(params,merge_mode){if(is_string(params)&&/^#/.test(params)&&merge_mode===undefined){merge_mode=2}var has_args=params!==undefined,url=jq_param_fragment(window[str_location][str_href],has_args?params:{},has_args?merge_mode:2);window[str_location][str_href]=url+(/#/.test(url)?"":"#")};jq_bbq.getState=jq_bbq_getState=function(key,coerce){return key===undefined||typeof key==="boolean"?jq_deparam_fragment(key):jq_deparam_fragment(coerce)[key]};jq_bbq.removeState=function(arr){var state={};if(arr!==undefined){state=jq_bbq_getState();$.each($.isArray(arr)?arr:arguments,function(i,v){delete state[v]})}jq_bbq_pushState(state,2)};jq_event_special[str_hashchange]=$.extend(jq_event_special[str_hashchange],{add:function(handleObj){var old_handler;function new_handler(e){var hash=e[str_fragment]=jq_param_fragment();e.getState=function(key,coerce){return key===undefined||typeof key==="boolean"?jq_deparam(hash,key):jq_deparam(hash,coerce)[key]};old_handler.apply(this,arguments)}if($.isFunction(handleObj)){old_handler=handleObj;return new_handler}else{old_handler=handleObj.handler;handleObj.handler=new_handler}}})})(jQuery,this);
/*
 * jQuery hashchange event - v1.2 - 2/11/2010
 * http://benalman.com/projects/jquery-hashchange-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($,window,undefined){var fake_onhashchange,jq_event_special=$.event.special,str_location="location",str_hashchange="hashchange",str_href="href",browser=$.browser,mode=document.documentMode,is_old_ie=browser.msie&&(mode===undefined||mode<8),supports_onhashchange="on"+str_hashchange in window&&!is_old_ie;function get_fragment(url){url=url||window[str_location][str_href];return url.replace(/^[^#]*#?(.*)$/,"$1")}$[str_hashchange+"Delay"]=100;jq_event_special[str_hashchange]=$.extend(jq_event_special[str_hashchange],{setup:function(){if(supports_onhashchange){return false}$(fake_onhashchange.start)},teardown:function(){if(supports_onhashchange){return false}$(fake_onhashchange.stop)}});fake_onhashchange=(function(){var self={},timeout_id,iframe,set_history,get_history;function init(){set_history=get_history=function(val){return val};if(is_old_ie){iframe=$('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow;get_history=function(){return get_fragment(iframe.document[str_location][str_href])};set_history=function(hash,history_hash){if(hash!==history_hash){var doc=iframe.document;doc.open().close();doc[str_location].hash="#"+hash}};set_history(get_fragment())}}self.start=function(){if(timeout_id){return}var last_hash=get_fragment();set_history||init();(function loopy(){var hash=get_fragment(),history_hash=get_history(last_hash);if(hash!==last_hash){set_history(last_hash=hash,history_hash);$(window).trigger(str_hashchange)}else{if(history_hash!==last_hash){window[str_location][str_href]=window[str_location][str_href].replace(/#.*/,"")+"#"+history_hash}}timeout_id=setTimeout(loopy,$[str_hashchange+"Delay"])})()};self.stop=function(){if(!iframe){timeout_id&&clearTimeout(timeout_id);timeout_id=0}};return self})()})(jQuery,this);(function($){$.fn.numeric=function(config,callback){if(typeof config==="boolean"){config={decimal:config}}config=config||{};if(typeof config.negative=="undefined"){config.negative=true}var decimal=(config.decimal===false)?"":config.decimal||".";var negative=(config.negative===true)?true:false;var callback=typeof callback=="function"?callback:function(){};return this.data("numeric.decimal",decimal).data("numeric.negative",negative).data("numeric.callback",callback).keypress($.fn.numeric.keypress).keyup($.fn.numeric.keyup).blur($.fn.numeric.blur)};$.fn.numeric.keypress=function(e){var decimal=$.data(this,"numeric.decimal");var negative=$.data(this,"numeric.negative");var key=e.charCode?e.charCode:e.keyCode?e.keyCode:0;if(key==13&&this.nodeName.toLowerCase()=="input"){return true}else{if(key==13){return false}}var allow=false;if((e.ctrlKey&&key==97)||(e.ctrlKey&&key==65)){return true}if((e.ctrlKey&&key==120)||(e.ctrlKey&&key==88)){return true}if((e.ctrlKey&&key==99)||(e.ctrlKey&&key==67)){return true}if((e.ctrlKey&&key==122)||(e.ctrlKey&&key==90)){return true}if((e.ctrlKey&&key==118)||(e.ctrlKey&&key==86)||(e.shiftKey&&key==45)){return true}if(key<48||key>57){if(this.value.indexOf("-")!=0&&negative&&key==45&&(this.value.length==0)){return true}if(decimal&&key==decimal.charCodeAt(0)&&this.value.indexOf(decimal)!=-1){allow=false}if(key!=8&&key!=9&&key!=13&&key!=35&&key!=36&&key!=37&&key!=39&&key!=46){allow=false}else{if(typeof e.charCode!="undefined"){if(e.keyCode==e.which&&e.which!=0){allow=true;if(e.which==46){allow=false}}else{if(e.keyCode!=0&&e.charCode==0&&e.which==0){allow=true}}}}if(decimal&&key==decimal.charCodeAt(0)){if(this.value.indexOf(decimal)==-1){allow=true}else{allow=false}}}else{allow=true}return allow};$.fn.numeric.keyup=function(e){var val=this.value;if(val.length>0){var decimal=$.data(this,"numeric.decimal");var negative=$.data(this,"numeric.negative");if(decimal!=""){var dot=val.indexOf(decimal);if(dot==0){this.value="0"+val}if(dot==1&&val.charAt(0)=="-"){this.value="-0"+val.substring(1)}val=this.value}var validChars=[0,1,2,3,4,5,6,7,8,9,"-",decimal];var length=val.length;for(var i=length-1;i>=0;i--){var ch=val.charAt(i);if(i!=0&&ch=="-"){val=val.substring(0,i)+val.substring(i+1)}else{if(i==0&&!negative&&ch=="-"){val=val.substring(1)}}var validChar=false;for(var j=0;j<validChars.length;j++){if(ch==validChars[j]){validChar=true;break}}if(!validChar||ch==" "){val=val.substring(0,i)+val.substring(i+1)}}var firstDecimal=val.indexOf(decimal);if(firstDecimal>0){for(var i=length-1;i>firstDecimal;i--){var ch=val.charAt(i);if(ch==decimal){val=val.substring(0,i)+val.substring(i+1)}}}if(this.value!=val){this.value=val}}};$.fn.numeric.blur=function(){var decimal=$.data(this,"numeric.decimal");var decimalPoints=$.data(this,"numeric.decimalpoints");var callback=$.data(this,"numeric.callback");var val=this.value;if(val!=""){var re=new RegExp("^\\d+$|\\d*"+decimal+"\\d+");if(!re.exec(val)){callback.apply(this)}}};$.fn.removeNumeric=function(){return this.data("numeric.decimal",null).data("numeric.negative",null).data("numeric.callback",null).unbind("keypress",$.fn.numeric.keypress).unbind("blur",$.fn.numeric.blur)}})(jQuery);(function($){$.extend({fileDownload:function(fileUrl,options){var defaultFailCallback=function(responseHtml,url){alert("A file download error has occurred, please try again.")};var settings=$.extend({preparingMessageHtml:null,failMessageHtml:null,androidPostUnsupportedMessageHtml:"Unfortunately your Android browser doesn't support this type of file download. Please try again with a different browser.",dialogOptions:{modal:true},successCallback:function(url){},failCallback:defaultFailCallback,httpMethod:"GET",data:null,checkInterval:100,cookieName:"fileDownload",cookieValue:"true",cookiePath:"/",popupWindowTitle:"Initiating file download...",encodeHTMLEntities:true},options);var userAgent=(navigator.userAgent||navigator.vendor||window.opera).toLowerCase();var isIos=false;var isAndroid=false;var isOtherMobileBrowser=false;if(/ip(ad|hone|od)/.test(userAgent)){isIos=true}else{if(userAgent.indexOf("android")!=-1){isAndroid=true}else{isOtherMobileBrowser=/avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|playbook|silk|iemobile|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(userAgent.substr(0,4))}}var httpMethodUpper=settings.httpMethod.toUpperCase();if(isAndroid&&httpMethodUpper!="GET"){if($().dialog){$("<div>").html(settings.androidPostUnsupportedMessageHtml).dialog(settings.dialogOptions)}else{alert(settings.androidPostUnsupportedMessageHtml)}return}var $preparingDialog=null;if(settings.preparingMessageHtml){$preparingDialog=$("<div>").html(settings.preparingMessageHtml).dialog(settings.dialogOptions)}var internalCallbacks={onSuccess:function(url){if($preparingDialog){$preparingDialog.dialog("close")}settings.successCallback(url)},onFail:function(responseHtml,url){if($preparingDialog){$preparingDialog.dialog("close")}if(settings.failMessageHtml){$("<div>").html(settings.failMessageHtml).dialog(settings.dialogOptions);if(settings.failCallback!=defaultFailCallback){settings.failCallback(responseHtml,url)}}else{settings.failCallback(responseHtml,url)}}};if(settings.data!==null&&typeof settings.data!=="string"){settings.data=$.param(settings.data)}settings.clearCookieBeforeDownload&&clearCookie();var $iframe,downloadWindow,formDoc,$form;if(httpMethodUpper==="GET"){if(settings.data!==null){var qsStart=fileUrl.indexOf("?");if(qsStart!=-1){if(fileUrl.substring(fileUrl.length-1)!=="&"){fileUrl=fileUrl+"&"}}else{fileUrl=fileUrl+"?"}fileUrl=fileUrl+settings.data}if(isIos||isAndroid){downloadWindow=window.open(fileUrl);downloadWindow.document.title=settings.popupWindowTitle;window.focus()}else{if(isOtherMobileBrowser){window.location(fileUrl)}else{$iframe=$("<iframe>").hide().attr("src",fileUrl).appendTo("body")}}}else{var formInnerHtml="";if(settings.data!==null){$.each(settings.data.replace(/\+/g," ").split("&"),function(){var kvp=this.split("=");var key=settings.encodeHTMLEntities?htmlSpecialCharsEntityEncode(decodeURIComponent(kvp[0])):decodeURIComponent(kvp[0]);if(!key){return}var value=kvp[1]||"";value=settings.encodeHTMLEntities?htmlSpecialCharsEntityEncode(decodeURIComponent(kvp[1])):decodeURIComponent(kvp[1]);formInnerHtml+='<input type="hidden" name="'+key+'" value="'+value+'" />'})}if(isOtherMobileBrowser){$form=$("<form>").appendTo("body");$form.hide().attr("method",settings.httpMethod).attr("action",fileUrl).html(formInnerHtml)}else{if(isIos){downloadWindow=window.open("about:blank");downloadWindow.document.title=settings.popupWindowTitle;formDoc=downloadWindow.document;window.focus()}else{$iframe=$("<iframe style='display: none' src='about:blank'></iframe>").appendTo("body");formDoc=getiframeDocument($iframe)}formDoc.write("<html><head></head><body><form method='"+settings.httpMethod+"' action='"+fileUrl+"'>"+formInnerHtml+"</form>"+settings.popupWindowTitle+"</body></html>");$form=$(formDoc).find("form")}$form.submit()}setTimeout(checkFileDownloadComplete,settings.checkInterval);function clearCookie(){if(document.cookie.indexOf(settings.cookieName+"="+settings.cookieValue)!=-1){var date=new Date(1000);document.cookie=settings.cookieName+"=; expires="+date.toUTCString()+"; path="+settings.cookiePath}}function checkFileDownloadComplete(){if(document.cookie.indexOf(settings.cookieName+"="+settings.cookieValue)!=-1){internalCallbacks.onSuccess(fileUrl);clearCookie();cleanUp(false);return}if(downloadWindow||$iframe){try{var formDoc;if(downloadWindow){formDoc=downloadWindow.document}else{formDoc=getiframeDocument($iframe)}if(formDoc&&formDoc.body!=null&&formDoc.body.innerHTML.length>0){var isFailure=true;if($form&&$form.length>0){var $contents=$(formDoc.body).contents().first();if($contents.length>0&&$contents[0]===$form[0]){isFailure=false}}if(isFailure){internalCallbacks.onFail(formDoc.body.innerHTML,fileUrl);cleanUp(true);return}}}catch(err){internalCallbacks.onFail("",fileUrl);cleanUp(true);return}}setTimeout(checkFileDownloadComplete,settings.checkInterval)}function getiframeDocument($iframe){var iframeDoc=$iframe[0].contentWindow||$iframe[0].contentDocument;if(iframeDoc.document){iframeDoc=iframeDoc.document}return iframeDoc}function cleanUp(isFailure){setTimeout(function(){if(downloadWindow){if(isAndroid){downloadWindow.close()}if(isIos){if(isFailure){downloadWindow.focus();downloadWindow.close()}else{downloadWindow.focus()}}}$iframe&&$iframe.remove()},0)}function htmlSpecialCharsEntityEncode(str){return str.replace(/&/gm,"&amp;").replace(/\n/gm,"&#10;").replace(/\r/gm,"&#13;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;").replace(/'/gm,"&apos;")}}})})(jQuery);
/*
 * Select2 4.0.0
 * https://select2.github.io
 *
 * Released under the MIT license
 * https://github.com/select2/select2/blob/master/LICENSE.md
 */
(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{if(typeof exports==="object"){factory(require("jquery"))}else{factory(jQuery)}}}(function(jQuery){var S2=(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd){var S2=jQuery.fn.select2.amd}var S2;(function(){if(!S2||!S2.requirejs){if(!S2){S2={}}else{require=S2}var requirejs,require,define;(function(undef){var main,req,makeMap,handlers,defined={},waiting={},config={},defining={},hasOwn=Object.prototype.hasOwnProperty,aps=[].slice,jsSuffixRegExp=/\.js$/;function hasProp(obj,prop){return hasOwn.call(obj,prop)}function normalize(name,baseName){var nameParts,nameSegment,mapValue,foundMap,lastIndex,foundI,foundStarMap,starI,i,j,part,baseParts=baseName&&baseName.split("/"),map=config.map,starMap=(map&&map["*"])||{};if(name&&name.charAt(0)==="."){if(baseName){baseParts=baseParts.slice(0,baseParts.length-1);name=name.split("/");lastIndex=name.length-1;if(config.nodeIdCompat&&jsSuffixRegExp.test(name[lastIndex])){name[lastIndex]=name[lastIndex].replace(jsSuffixRegExp,"")}name=baseParts.concat(name);for(i=0;i<name.length;i+=1){part=name[i];if(part==="."){name.splice(i,1);i-=1}else{if(part===".."){if(i===1&&(name[2]===".."||name[0]==="..")){break}else{if(i>0){name.splice(i-1,2);i-=2}}}}}name=name.join("/")}else{if(name.indexOf("./")===0){name=name.substring(2)}}}if((baseParts||starMap)&&map){nameParts=name.split("/");for(i=nameParts.length;i>0;i-=1){nameSegment=nameParts.slice(0,i).join("/");if(baseParts){for(j=baseParts.length;j>0;j-=1){mapValue=map[baseParts.slice(0,j).join("/")];if(mapValue){mapValue=mapValue[nameSegment];if(mapValue){foundMap=mapValue;foundI=i;break}}}}if(foundMap){break}if(!foundStarMap&&starMap&&starMap[nameSegment]){foundStarMap=starMap[nameSegment];starI=i}}if(!foundMap&&foundStarMap){foundMap=foundStarMap;foundI=starI}if(foundMap){nameParts.splice(0,foundI,foundMap);name=nameParts.join("/")}}return name}function makeRequire(relName,forceSync){return function(){return req.apply(undef,aps.call(arguments,0).concat([relName,forceSync]))}}function makeNormalize(relName){return function(name){return normalize(name,relName)}}function makeLoad(depName){return function(value){defined[depName]=value}}function callDep(name){if(hasProp(waiting,name)){var args=waiting[name];delete waiting[name];defining[name]=true;main.apply(undef,args)}if(!hasProp(defined,name)&&!hasProp(defining,name)){throw new Error("No "+name)}return defined[name]}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;if(index>-1){prefix=name.substring(0,index);name=name.substring(index+1,name.length)}return[prefix,name]}makeMap=function(name,relName){var plugin,parts=splitPrefix(name),prefix=parts[0];name=parts[1];if(prefix){prefix=normalize(prefix,relName);plugin=callDep(prefix)}if(prefix){if(plugin&&plugin.normalize){name=plugin.normalize(name,makeNormalize(relName))}else{name=normalize(name,relName)}}else{name=normalize(name,relName);parts=splitPrefix(name);prefix=parts[0];name=parts[1];if(prefix){plugin=callDep(prefix)}}return{f:prefix?prefix+"!"+name:name,n:name,pr:prefix,p:plugin}};function makeConfig(name){return function(){return(config&&config.config&&config.config[name])||{}}}handlers={require:function(name){return makeRequire(name)},exports:function(name){var e=defined[name];if(typeof e!=="undefined"){return e}else{return(defined[name]={})}},module:function(name){return{id:name,uri:"",exports:defined[name],config:makeConfig(name)}}};main=function(name,deps,callback,relName){var cjsModule,depName,ret,map,i,args=[],callbackType=typeof callback,usingExports;relName=relName||name;if(callbackType==="undefined"||callbackType==="function"){deps=!deps.length&&callback.length?["require","exports","module"]:deps;for(i=0;i<deps.length;i+=1){map=makeMap(deps[i],relName);depName=map.f;if(depName==="require"){args[i]=handlers.require(name)}else{if(depName==="exports"){args[i]=handlers.exports(name);usingExports=true}else{if(depName==="module"){cjsModule=args[i]=handlers.module(name)}else{if(hasProp(defined,depName)||hasProp(waiting,depName)||hasProp(defining,depName)){args[i]=callDep(depName)}else{if(map.p){map.p.load(map.n,makeRequire(relName,true),makeLoad(depName),{});args[i]=defined[depName]}else{throw new Error(name+" missing "+depName)}}}}}}ret=callback?callback.apply(defined[name],args):undefined;if(name){if(cjsModule&&cjsModule.exports!==undef&&cjsModule.exports!==defined[name]){defined[name]=cjsModule.exports}else{if(ret!==undef||!usingExports){defined[name]=ret}}}}else{if(name){defined[name]=callback}}};requirejs=require=req=function(deps,callback,relName,forceSync,alt){if(typeof deps==="string"){if(handlers[deps]){return handlers[deps](callback)}return callDep(makeMap(deps,callback).f)}else{if(!deps.splice){config=deps;if(config.deps){req(config.deps,config.callback)}if(!callback){return}if(callback.splice){deps=callback;callback=relName;relName=null}else{deps=undef}}}callback=callback||function(){};if(typeof relName==="function"){relName=forceSync;forceSync=alt}if(forceSync){main(undef,deps,callback,relName)}else{setTimeout(function(){main(undef,deps,callback,relName)},4)}return req};req.config=function(cfg){return req(cfg)};requirejs._defined=defined;define=function(name,deps,callback){if(!deps.splice){callback=deps;deps=[]}if(!hasProp(defined,name)&&!hasProp(waiting,name)){waiting[name]=[name,deps,callback]}};define.amd={jQuery:true}}());S2.requirejs=requirejs;S2.require=require;S2.define=define}}());S2.define("almond",function(){});S2.define("jquery",[],function(){var _$=jQuery||$;if(_$==null&&console&&console.error){console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page.")}return _$});S2.define("select2/utils",["jquery"],function($){var Utils={};Utils.Extend=function(ChildClass,SuperClass){var __hasProp={}.hasOwnProperty;function BaseConstructor(){this.constructor=ChildClass}for(var key in SuperClass){if(__hasProp.call(SuperClass,key)){ChildClass[key]=SuperClass[key]}}BaseConstructor.prototype=SuperClass.prototype;ChildClass.prototype=new BaseConstructor();ChildClass.__super__=SuperClass.prototype;return ChildClass};function getMethods(theClass){var proto=theClass.prototype;var methods=[];for(var methodName in proto){var m=proto[methodName];if(typeof m!=="function"){continue}if(methodName==="constructor"){continue}methods.push(methodName)}return methods}Utils.Decorate=function(SuperClass,DecoratorClass){var decoratedMethods=getMethods(DecoratorClass);var superMethods=getMethods(SuperClass);function DecoratedClass(){var unshift=Array.prototype.unshift;var argCount=DecoratorClass.prototype.constructor.length;var calledConstructor=SuperClass.prototype.constructor;if(argCount>0){unshift.call(arguments,SuperClass.prototype.constructor);calledConstructor=DecoratorClass.prototype.constructor}calledConstructor.apply(this,arguments)}DecoratorClass.displayName=SuperClass.displayName;function ctr(){this.constructor=DecoratedClass}DecoratedClass.prototype=new ctr();for(var m=0;m<superMethods.length;m++){var superMethod=superMethods[m];DecoratedClass.prototype[superMethod]=SuperClass.prototype[superMethod]}var calledMethod=function(methodName){var originalMethod=function(){};if(methodName in DecoratedClass.prototype){originalMethod=DecoratedClass.prototype[methodName]}var decoratedMethod=DecoratorClass.prototype[methodName];return function(){var unshift=Array.prototype.unshift;unshift.call(arguments,originalMethod);return decoratedMethod.apply(this,arguments)}};for(var d=0;d<decoratedMethods.length;d++){var decoratedMethod=decoratedMethods[d];DecoratedClass.prototype[decoratedMethod]=calledMethod(decoratedMethod)}return DecoratedClass};var Observable=function(){this.listeners={}};Observable.prototype.on=function(event,callback){this.listeners=this.listeners||{};if(event in this.listeners){this.listeners[event].push(callback)}else{this.listeners[event]=[callback]}};Observable.prototype.trigger=function(event){var slice=Array.prototype.slice;this.listeners=this.listeners||{};if(event in this.listeners){this.invoke(this.listeners[event],slice.call(arguments,1))}if("*" in this.listeners){this.invoke(this.listeners["*"],arguments)}};Observable.prototype.invoke=function(listeners,params){for(var i=0,len=listeners.length;i<len;i++){listeners[i].apply(this,params)}};Utils.Observable=Observable;Utils.generateChars=function(length){var chars="";for(var i=0;i<length;i++){var randomChar=Math.floor(Math.random()*36);chars+=randomChar.toString(36)}return chars};Utils.bind=function(func,context){return function(){func.apply(context,arguments)}};Utils._convertData=function(data){for(var originalKey in data){var keys=originalKey.split("-");var dataLevel=data;if(keys.length===1){continue}for(var k=0;k<keys.length;k++){var key=keys[k];key=key.substring(0,1).toLowerCase()+key.substring(1);if(!(key in dataLevel)){dataLevel[key]={}}if(k==keys.length-1){dataLevel[key]=data[originalKey]}dataLevel=dataLevel[key]}delete data[originalKey]}return data};Utils.hasScroll=function(index,el){var $el=$(el);var overflowX=el.style.overflowX;var overflowY=el.style.overflowY;if(overflowX===overflowY&&(overflowY==="hidden"||overflowY==="visible")){return false}if(overflowX==="scroll"||overflowY==="scroll"){return true}return($el.innerHeight()<el.scrollHeight||$el.innerWidth()<el.scrollWidth)};Utils.escapeMarkup=function(markup){var replaceMap={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};if(typeof markup!=="string"){return markup}return String(markup).replace(/[&<>"'\/\\]/g,function(match){return replaceMap[match]})};Utils.appendMany=function($element,$nodes){if($.fn.jquery.substr(0,3)==="1.7"){var $jqNodes=$();$.map($nodes,function(node){$jqNodes=$jqNodes.add(node)});$nodes=$jqNodes}$element.append($nodes)};return Utils});S2.define("select2/results",["jquery","./utils"],function($,Utils){function Results($element,options,dataAdapter){this.$element=$element;this.data=dataAdapter;this.options=options;Results.__super__.constructor.call(this)}Utils.Extend(Results,Utils.Observable);Results.prototype.render=function(){var $results=$('<ul class="select2-results__options" role="tree"></ul>');if(this.options.get("multiple")){$results.attr("aria-multiselectable","true")}this.$results=$results;return $results};Results.prototype.clear=function(){this.$results.empty()};Results.prototype.displayMessage=function(params){var escapeMarkup=this.options.get("escapeMarkup");this.clear();this.hideLoading();var $message=$('<li role="treeitem" class="select2-results__option"></li>');var message=this.options.get("translations").get(params.message);$message.append(escapeMarkup(message(params.args)));this.$results.append($message)};Results.prototype.append=function(data){this.hideLoading();var $options=[];if(data.results==null||data.results.length===0){if(this.$results.children().length===0){this.trigger("results:message",{message:"noResults"})}return}data.results=this.sort(data.results);for(var d=0;d<data.results.length;d++){var item=data.results[d];var $option=this.option(item);$options.push($option)}this.$results.append($options)};Results.prototype.position=function($results,$dropdown){var $resultsContainer=$dropdown.find(".select2-results");$resultsContainer.append($results)};Results.prototype.sort=function(data){var sorter=this.options.get("sorter");return sorter(data)};Results.prototype.setClasses=function(){var self=this;this.data.current(function(selected){var selectedIds=$.map(selected,function(s){return s.id.toString()});var $options=self.$results.find(".select2-results__option[aria-selected]");$options.each(function(){var $option=$(this);var item=$.data(this,"data");var id=""+item.id;if((item.element!=null&&item.element.selected)||(item.element==null&&$.inArray(id,selectedIds)>-1)){$option.attr("aria-selected","true")}else{$option.attr("aria-selected","false")}});var $selected=$options.filter("[aria-selected=true]");if($selected.length>0){$selected.first().trigger("mouseenter")}else{$options.first().trigger("mouseenter")}})};Results.prototype.showLoading=function(params){this.hideLoading();var loadingMore=this.options.get("translations").get("searching");var loading={disabled:true,loading:true,text:loadingMore(params)};var $loading=this.option(loading);$loading.className+=" loading-results";this.$results.prepend($loading)};Results.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()};Results.prototype.option=function(data){var option=document.createElement("li");option.className="select2-results__option";var attrs={role:"treeitem","aria-selected":"false"};if(data.disabled){delete attrs["aria-selected"];attrs["aria-disabled"]="true"}if(data.id==null){delete attrs["aria-selected"]}if(data._resultId!=null){option.id=data._resultId}if(data.title){option.title=data.title}if(data.children){attrs.role="group";attrs["aria-label"]=data.text;delete attrs["aria-selected"]}for(var attr in attrs){var val=attrs[attr];option.setAttribute(attr,val)}if(data.children){var $option=$(option);var label=document.createElement("strong");label.className="select2-results__group";var $label=$(label);this.template(data,label);var $children=[];for(var c=0;c<data.children.length;c++){var child=data.children[c];var $child=this.option(child);$children.push($child)}var $childrenContainer=$("<ul></ul>",{"class":"select2-results__options select2-results__options--nested"});$childrenContainer.append($children);$option.append(label);$option.append($childrenContainer)}else{this.template(data,option)}$.data(option,"data",data);return option};Results.prototype.bind=function(container,$container){var self=this;var id=container.id+"-results";this.$results.attr("id",id);container.on("results:all",function(params){self.clear();self.append(params.data);if(container.isOpen()){self.setClasses()}});container.on("results:append",function(params){self.append(params.data);if(container.isOpen()){self.setClasses()}});container.on("query",function(params){self.showLoading(params)});container.on("select",function(){if(!container.isOpen()){return}self.setClasses()});container.on("unselect",function(){if(!container.isOpen()){return}self.setClasses()});container.on("open",function(){self.$results.attr("aria-expanded","true");self.$results.attr("aria-hidden","false");self.setClasses();self.ensureHighlightVisible()});container.on("close",function(){self.$results.attr("aria-expanded","false");self.$results.attr("aria-hidden","true");self.$results.removeAttr("aria-activedescendant")});container.on("results:toggle",function(){var $highlighted=self.getHighlightedResults();if($highlighted.length===0){return}$highlighted.trigger("mouseup")});container.on("results:select",function(){var $highlighted=self.getHighlightedResults();if($highlighted.length===0){return}var data=$highlighted.data("data");if($highlighted.attr("aria-selected")=="true"){self.trigger("close")}else{self.trigger("select",{data:data})}});container.on("results:previous",function(){var $highlighted=self.getHighlightedResults();var $options=self.$results.find("[aria-selected]");var currentIndex=$options.index($highlighted);if(currentIndex===0){return}var nextIndex=currentIndex-1;if($highlighted.length===0){nextIndex=0}var $next=$options.eq(nextIndex);$next.trigger("mouseenter");var currentOffset=self.$results.offset().top;var nextTop=$next.offset().top;var nextOffset=self.$results.scrollTop()+(nextTop-currentOffset);if(nextIndex===0){self.$results.scrollTop(0)}else{if(nextTop-currentOffset<0){self.$results.scrollTop(nextOffset)}}});container.on("results:next",function(){var $highlighted=self.getHighlightedResults();var $options=self.$results.find("[aria-selected]");var currentIndex=$options.index($highlighted);var nextIndex=currentIndex+1;if(nextIndex>=$options.length){return}var $next=$options.eq(nextIndex);$next.trigger("mouseenter");var currentOffset=self.$results.offset().top+self.$results.outerHeight(false);var nextBottom=$next.offset().top+$next.outerHeight(false);var nextOffset=self.$results.scrollTop()+nextBottom-currentOffset;if(nextIndex===0){self.$results.scrollTop(0)}else{if(nextBottom>currentOffset){self.$results.scrollTop(nextOffset)}}});container.on("results:focus",function(params){params.element.addClass("select2-results__option--highlighted")});container.on("results:message",function(params){self.displayMessage(params)});if($.fn.mousewheel){this.$results.on("mousewheel",function(e){var top=self.$results.scrollTop();var bottom=(self.$results.get(0).scrollHeight-self.$results.scrollTop()+e.deltaY);var isAtTop=e.deltaY>0&&top-e.deltaY<=0;var isAtBottom=e.deltaY<0&&bottom<=self.$results.height();if(isAtTop){self.$results.scrollTop(0);e.preventDefault();e.stopPropagation()}else{if(isAtBottom){self.$results.scrollTop(self.$results.get(0).scrollHeight-self.$results.height());e.preventDefault();e.stopPropagation()}}})}this.$results.on("mouseup",".select2-results__option[aria-selected]",function(evt){var $this=$(this);var data=$this.data("data");if($this.attr("aria-selected")==="true"){if(self.options.get("multiple")){self.trigger("unselect",{originalEvent:evt,data:data})}else{self.trigger("close")}return}self.trigger("select",{originalEvent:evt,data:data})});this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(evt){var data=$(this).data("data");self.getHighlightedResults().removeClass("select2-results__option--highlighted");self.trigger("results:focus",{data:data,element:$(this)})})};Results.prototype.getHighlightedResults=function(){var $highlighted=this.$results.find(".select2-results__option--highlighted");return $highlighted};Results.prototype.destroy=function(){this.$results.remove()};Results.prototype.ensureHighlightVisible=function(){var $highlighted=this.getHighlightedResults();if($highlighted.length===0){return}var $options=this.$results.find("[aria-selected]");var currentIndex=$options.index($highlighted);var currentOffset=this.$results.offset().top;var nextTop=$highlighted.offset().top;var nextOffset=this.$results.scrollTop()+(nextTop-currentOffset);var offsetDelta=nextTop-currentOffset;nextOffset-=$highlighted.outerHeight(false)*2;if(currentIndex<=2){this.$results.scrollTop(0)}else{if(offsetDelta>this.$results.outerHeight()||offsetDelta<0){this.$results.scrollTop(nextOffset)}}};Results.prototype.template=function(result,container){var template=this.options.get("templateResult");var escapeMarkup=this.options.get("escapeMarkup");var content=template(result);if(content==null){container.style.display="none"}else{if(typeof content==="string"){container.innerHTML=escapeMarkup(content)}else{$(container).append(content)}}};return Results});S2.define("select2/keys",[],function(){var KEYS={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46};return KEYS});S2.define("select2/selection/base",["jquery","../utils","../keys"],function($,Utils,KEYS){function BaseSelection($element,options){this.$element=$element;this.options=options;BaseSelection.__super__.constructor.call(this)}Utils.Extend(BaseSelection,Utils.Observable);BaseSelection.prototype.render=function(){var $selection=$('<span class="select2-selection" role="combobox" aria-autocomplete="list" aria-haspopup="true" aria-expanded="false"></span>');this._tabindex=0;if(this.$element.data("old-tabindex")!=null){this._tabindex=this.$element.data("old-tabindex")}else{if(this.$element.attr("tabindex")!=null){this._tabindex=this.$element.attr("tabindex")}}$selection.attr("title",this.$element.attr("title"));$selection.attr("tabindex",this._tabindex);this.$selection=$selection;return $selection};BaseSelection.prototype.bind=function(container,$container){var self=this;var id=container.id+"-container";var resultsId=container.id+"-results";this.container=container;this.$selection.on("focus",function(evt){self.trigger("focus",evt)});this.$selection.on("blur",function(evt){self.trigger("blur",evt)});this.$selection.on("keydown",function(evt){self.trigger("keypress",evt);if(evt.which===KEYS.SPACE){evt.preventDefault()}});container.on("results:focus",function(params){self.$selection.attr("aria-activedescendant",params.data._resultId)});container.on("selection:update",function(params){self.update(params.data)});container.on("open",function(){self.$selection.attr("aria-expanded","true");self.$selection.attr("aria-owns",resultsId);self._attachCloseHandler(container)});container.on("close",function(){self.$selection.attr("aria-expanded","false");self.$selection.removeAttr("aria-activedescendant");self.$selection.removeAttr("aria-owns");self.$selection.focus();self._detachCloseHandler(container)});container.on("enable",function(){self.$selection.attr("tabindex",self._tabindex)});container.on("disable",function(){self.$selection.attr("tabindex","-1")})};BaseSelection.prototype._attachCloseHandler=function(container){var self=this;$(document.body).on("mousedown.select2."+container.id,function(e){var $target=$(e.target);var $select=$target.closest(".select2");var $all=$(".select2.select2-container--open");$all.each(function(){var $this=$(this);if(this==$select[0]){return}var $element=$this.data("element");$element.select2("close")})})};BaseSelection.prototype._detachCloseHandler=function(container){$(document.body).off("mousedown.select2."+container.id)};BaseSelection.prototype.position=function($selection,$container){var $selectionContainer=$container.find(".selection");$selectionContainer.append($selection)};BaseSelection.prototype.destroy=function(){this._detachCloseHandler(this.container)};BaseSelection.prototype.update=function(data){throw new Error("The `update` method must be defined in child classes.")};return BaseSelection});S2.define("select2/selection/single",["jquery","./base","../utils","../keys"],function($,BaseSelection,Utils,KEYS){function SingleSelection(){SingleSelection.__super__.constructor.apply(this,arguments)}Utils.Extend(SingleSelection,BaseSelection);SingleSelection.prototype.render=function(){var $selection=SingleSelection.__super__.render.call(this);$selection.addClass("select2-selection--single");$selection.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>');return $selection};SingleSelection.prototype.bind=function(container,$container){var self=this;SingleSelection.__super__.bind.apply(this,arguments);var id=container.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",id);this.$selection.attr("aria-labelledby",id);this.$selection.on("mousedown",function(evt){if(evt.which!==1){return}self.trigger("toggle",{originalEvent:evt})});this.$selection.on("focus",function(evt){});this.$selection.on("blur",function(evt){});container.on("selection:update",function(params){self.update(params.data)})};SingleSelection.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()};SingleSelection.prototype.display=function(data){var template=this.options.get("templateSelection");var escapeMarkup=this.options.get("escapeMarkup");return escapeMarkup(template(data))};SingleSelection.prototype.selectionContainer=function(){return $("<span></span>")};SingleSelection.prototype.update=function(data){if(data.length===0){this.clear();return}var selection=data[0];var formatted=this.display(selection);var $rendered=this.$selection.find(".select2-selection__rendered");$rendered.empty().append(formatted);$rendered.prop("title",selection.title||selection.text)};return SingleSelection});S2.define("select2/selection/multiple",["jquery","./base","../utils"],function($,BaseSelection,Utils){function MultipleSelection($element,options){MultipleSelection.__super__.constructor.apply(this,arguments)}Utils.Extend(MultipleSelection,BaseSelection);MultipleSelection.prototype.render=function(){var $selection=MultipleSelection.__super__.render.call(this);$selection.addClass("select2-selection--multiple");$selection.html('<ul class="select2-selection__rendered"></ul>');return $selection};MultipleSelection.prototype.bind=function(container,$container){var self=this;MultipleSelection.__super__.bind.apply(this,arguments);this.$selection.on("click",function(evt){self.trigger("toggle",{originalEvent:evt})});this.$selection.on("click",".select2-selection__choice__remove",function(evt){var $remove=$(this);var $selection=$remove.parent();var data=$selection.data("data");self.trigger("unselect",{originalEvent:evt,data:data})})};MultipleSelection.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()};MultipleSelection.prototype.display=function(data){var template=this.options.get("templateSelection");var escapeMarkup=this.options.get("escapeMarkup");return escapeMarkup(template(data))};MultipleSelection.prototype.selectionContainer=function(){var $container=$('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>');return $container};MultipleSelection.prototype.update=function(data){this.clear();if(data.length===0){return}var $selections=[];for(var d=0;d<data.length;d++){var selection=data[d];var formatted=this.display(selection);var $selection=this.selectionContainer();$selection.append(formatted);$selection.prop("title",selection.title||selection.text);$selection.data("data",selection);$selections.push($selection)}var $rendered=this.$selection.find(".select2-selection__rendered");Utils.appendMany($rendered,$selections)};return MultipleSelection});S2.define("select2/selection/placeholder",["../utils"],function(Utils){function Placeholder(decorated,$element,options){this.placeholder=this.normalizePlaceholder(options.get("placeholder"));decorated.call(this,$element,options)}Placeholder.prototype.normalizePlaceholder=function(_,placeholder){if(typeof placeholder==="string"){placeholder={id:"",text:placeholder}}return placeholder};Placeholder.prototype.createPlaceholder=function(decorated,placeholder){var $placeholder=this.selectionContainer();$placeholder.html(this.display(placeholder));$placeholder.addClass("select2-selection__placeholder").removeClass("select2-selection__choice");return $placeholder};Placeholder.prototype.update=function(decorated,data){var singlePlaceholder=(data.length==1&&data[0].id!=this.placeholder.id);var multipleSelections=data.length>1;if(multipleSelections||singlePlaceholder){return decorated.call(this,data)}this.clear();var $placeholder=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append($placeholder)};return Placeholder});S2.define("select2/selection/allowClear",["jquery","../keys"],function($,KEYS){function AllowClear(){}AllowClear.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container);if(this.placeholder==null){if(this.options.get("debug")&&window.console&&console.error){console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option.")}}this.$selection.on("mousedown",".select2-selection__clear",function(evt){self._handleClear(evt)});container.on("keypress",function(evt){self._handleKeyboardClear(evt,container)})};AllowClear.prototype._handleClear=function(_,evt){if(this.options.get("disabled")){return}var $clear=this.$selection.find(".select2-selection__clear");if($clear.length===0){return}evt.stopPropagation();var data=$clear.data("data");for(var d=0;d<data.length;d++){var unselectData={data:data[d]};this.trigger("unselect",unselectData);if(unselectData.prevented){return}}this.$element.val(this.placeholder.id).trigger("change");this.trigger("toggle")};AllowClear.prototype._handleKeyboardClear=function(_,evt,container){if(container.isOpen()){return}if(evt.which==KEYS.DELETE||evt.which==KEYS.BACKSPACE){this._handleClear(evt)}};AllowClear.prototype.update=function(decorated,data){decorated.call(this,data);if(this.$selection.find(".select2-selection__placeholder").length>0||data.length===0){return}var $remove=$('<span class="select2-selection__clear">&times;</span>');$remove.data("data",data);this.$selection.find(".select2-selection__rendered").prepend($remove)};return AllowClear});S2.define("select2/selection/search",["jquery","../utils","../keys"],function($,Utils,KEYS){function Search(decorated,$element,options){decorated.call(this,$element,options)}Search.prototype.render=function(decorated){var $search=$('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></li>');this.$searchContainer=$search;this.$search=$search.find("input");var $rendered=decorated.call(this);return $rendered};Search.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container);container.on("open",function(){self.$search.attr("tabindex",0);self.$search.focus()});container.on("close",function(){self.$search.attr("tabindex",-1);self.$search.val("");self.$search.focus()});container.on("enable",function(){self.$search.prop("disabled",false)});container.on("disable",function(){self.$search.prop("disabled",true)});this.$selection.on("focusin",".select2-search--inline",function(evt){self.trigger("focus",evt)});this.$selection.on("focusout",".select2-search--inline",function(evt){self.trigger("blur",evt)});this.$selection.on("keydown",".select2-search--inline",function(evt){evt.stopPropagation();self.trigger("keypress",evt);self._keyUpPrevented=evt.isDefaultPrevented();var key=evt.which;if(key===KEYS.BACKSPACE&&self.$search.val()===""){var $previousChoice=self.$searchContainer.prev(".select2-selection__choice");if($previousChoice.length>0){var item=$previousChoice.data("data");self.searchRemoveChoice(item);evt.preventDefault()}}});this.$selection.on("input",".select2-search--inline",function(evt){self.$selection.off("keyup.search")});this.$selection.on("keyup.search input",".select2-search--inline",function(evt){self.handleSearch(evt)})};Search.prototype.createPlaceholder=function(decorated,placeholder){this.$search.attr("placeholder",placeholder.text)};Search.prototype.update=function(decorated,data){this.$search.attr("placeholder","");decorated.call(this,data);this.$selection.find(".select2-selection__rendered").append(this.$searchContainer);this.resizeSearch()};Search.prototype.handleSearch=function(){this.resizeSearch();if(!this._keyUpPrevented){var input=this.$search.val();this.trigger("query",{term:input})}this._keyUpPrevented=false};Search.prototype.searchRemoveChoice=function(decorated,item){this.trigger("unselect",{data:item});this.trigger("open");this.$search.val(item.text+" ")};Search.prototype.resizeSearch=function(){this.$search.css("width","25px");var width="";if(this.$search.attr("placeholder")!==""){width=this.$selection.find(".select2-selection__rendered").innerWidth()}else{var minimumWidth=this.$search.val().length+1;width=(minimumWidth*0.75)+"em"}this.$search.css("width",width)};return Search});S2.define("select2/selection/eventRelay",["jquery"],function($){function EventRelay(){}EventRelay.prototype.bind=function(decorated,container,$container){var self=this;var relayEvents=["open","opening","close","closing","select","selecting","unselect","unselecting"];var preventableEvents=["opening","closing","selecting","unselecting"];decorated.call(this,container,$container);container.on("*",function(name,params){if($.inArray(name,relayEvents)===-1){return}params=params||{};var evt=$.Event("select2:"+name,{params:params});self.$element.trigger(evt);if($.inArray(name,preventableEvents)===-1){return}params.prevented=evt.isDefaultPrevented()})};return EventRelay});S2.define("select2/translation",["jquery","require"],function($,require){function Translation(dict){this.dict=dict||{}}Translation.prototype.all=function(){return this.dict};Translation.prototype.get=function(key){return this.dict[key]};Translation.prototype.extend=function(translation){this.dict=$.extend({},translation.all(),this.dict)};Translation._cache={};Translation.loadPath=function(path){if(!(path in Translation._cache)){var translations=require(path);Translation._cache[path]=translations}return new Translation(Translation._cache[path])};return Translation});S2.define("select2/diacritics",[],function(){var diacritics={"\u24B6":"A","\uFF21":"A","\u00C0":"A","\u00C1":"A","\u00C2":"A","\u1EA6":"A","\u1EA4":"A","\u1EAA":"A","\u1EA8":"A","\u00C3":"A","\u0100":"A","\u0102":"A","\u1EB0":"A","\u1EAE":"A","\u1EB4":"A","\u1EB2":"A","\u0226":"A","\u01E0":"A","\u00C4":"A","\u01DE":"A","\u1EA2":"A","\u00C5":"A","\u01FA":"A","\u01CD":"A","\u0200":"A","\u0202":"A","\u1EA0":"A","\u1EAC":"A","\u1EB6":"A","\u1E00":"A","\u0104":"A","\u023A":"A","\u2C6F":"A","\uA732":"AA","\u00C6":"AE","\u01FC":"AE","\u01E2":"AE","\uA734":"AO","\uA736":"AU","\uA738":"AV","\uA73A":"AV","\uA73C":"AY","\u24B7":"B","\uFF22":"B","\u1E02":"B","\u1E04":"B","\u1E06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24B8":"C","\uFF23":"C","\u0106":"C","\u0108":"C","\u010A":"C","\u010C":"C","\u00C7":"C","\u1E08":"C","\u0187":"C","\u023B":"C","\uA73E":"C","\u24B9":"D","\uFF24":"D","\u1E0A":"D","\u010E":"D","\u1E0C":"D","\u1E10":"D","\u1E12":"D","\u1E0E":"D","\u0110":"D","\u018B":"D","\u018A":"D","\u0189":"D","\uA779":"D","\u01F1":"DZ","\u01C4":"DZ","\u01F2":"Dz","\u01C5":"Dz","\u24BA":"E","\uFF25":"E","\u00C8":"E","\u00C9":"E","\u00CA":"E","\u1EC0":"E","\u1EBE":"E","\u1EC4":"E","\u1EC2":"E","\u1EBC":"E","\u0112":"E","\u1E14":"E","\u1E16":"E","\u0114":"E","\u0116":"E","\u00CB":"E","\u1EBA":"E","\u011A":"E","\u0204":"E","\u0206":"E","\u1EB8":"E","\u1EC6":"E","\u0228":"E","\u1E1C":"E","\u0118":"E","\u1E18":"E","\u1E1A":"E","\u0190":"E","\u018E":"E","\u24BB":"F","\uFF26":"F","\u1E1E":"F","\u0191":"F","\uA77B":"F","\u24BC":"G","\uFF27":"G","\u01F4":"G","\u011C":"G","\u1E20":"G","\u011E":"G","\u0120":"G","\u01E6":"G","\u0122":"G","\u01E4":"G","\u0193":"G","\uA7A0":"G","\uA77D":"G","\uA77E":"G","\u24BD":"H","\uFF28":"H","\u0124":"H","\u1E22":"H","\u1E26":"H","\u021E":"H","\u1E24":"H","\u1E28":"H","\u1E2A":"H","\u0126":"H","\u2C67":"H","\u2C75":"H","\uA78D":"H","\u24BE":"I","\uFF29":"I","\u00CC":"I","\u00CD":"I","\u00CE":"I","\u0128":"I","\u012A":"I","\u012C":"I","\u0130":"I","\u00CF":"I","\u1E2E":"I","\u1EC8":"I","\u01CF":"I","\u0208":"I","\u020A":"I","\u1ECA":"I","\u012E":"I","\u1E2C":"I","\u0197":"I","\u24BF":"J","\uFF2A":"J","\u0134":"J","\u0248":"J","\u24C0":"K","\uFF2B":"K","\u1E30":"K","\u01E8":"K","\u1E32":"K","\u0136":"K","\u1E34":"K","\u0198":"K","\u2C69":"K","\uA740":"K","\uA742":"K","\uA744":"K","\uA7A2":"K","\u24C1":"L","\uFF2C":"L","\u013F":"L","\u0139":"L","\u013D":"L","\u1E36":"L","\u1E38":"L","\u013B":"L","\u1E3C":"L","\u1E3A":"L","\u0141":"L","\u023D":"L","\u2C62":"L","\u2C60":"L","\uA748":"L","\uA746":"L","\uA780":"L","\u01C7":"LJ","\u01C8":"Lj","\u24C2":"M","\uFF2D":"M","\u1E3E":"M","\u1E40":"M","\u1E42":"M","\u2C6E":"M","\u019C":"M","\u24C3":"N","\uFF2E":"N","\u01F8":"N","\u0143":"N","\u00D1":"N","\u1E44":"N","\u0147":"N","\u1E46":"N","\u0145":"N","\u1E4A":"N","\u1E48":"N","\u0220":"N","\u019D":"N","\uA790":"N","\uA7A4":"N","\u01CA":"NJ","\u01CB":"Nj","\u24C4":"O","\uFF2F":"O","\u00D2":"O","\u00D3":"O","\u00D4":"O","\u1ED2":"O","\u1ED0":"O","\u1ED6":"O","\u1ED4":"O","\u00D5":"O","\u1E4C":"O","\u022C":"O","\u1E4E":"O","\u014C":"O","\u1E50":"O","\u1E52":"O","\u014E":"O","\u022E":"O","\u0230":"O","\u00D6":"O","\u022A":"O","\u1ECE":"O","\u0150":"O","\u01D1":"O","\u020C":"O","\u020E":"O","\u01A0":"O","\u1EDC":"O","\u1EDA":"O","\u1EE0":"O","\u1EDE":"O","\u1EE2":"O","\u1ECC":"O","\u1ED8":"O","\u01EA":"O","\u01EC":"O","\u00D8":"O","\u01FE":"O","\u0186":"O","\u019F":"O","\uA74A":"O","\uA74C":"O","\u01A2":"OI","\uA74E":"OO","\u0222":"OU","\u24C5":"P","\uFF30":"P","\u1E54":"P","\u1E56":"P","\u01A4":"P","\u2C63":"P","\uA750":"P","\uA752":"P","\uA754":"P","\u24C6":"Q","\uFF31":"Q","\uA756":"Q","\uA758":"Q","\u024A":"Q","\u24C7":"R","\uFF32":"R","\u0154":"R","\u1E58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1E5A":"R","\u1E5C":"R","\u0156":"R","\u1E5E":"R","\u024C":"R","\u2C64":"R","\uA75A":"R","\uA7A6":"R","\uA782":"R","\u24C8":"S","\uFF33":"S","\u1E9E":"S","\u015A":"S","\u1E64":"S","\u015C":"S","\u1E60":"S","\u0160":"S","\u1E66":"S","\u1E62":"S","\u1E68":"S","\u0218":"S","\u015E":"S","\u2C7E":"S","\uA7A8":"S","\uA784":"S","\u24C9":"T","\uFF34":"T","\u1E6A":"T","\u0164":"T","\u1E6C":"T","\u021A":"T","\u0162":"T","\u1E70":"T","\u1E6E":"T","\u0166":"T","\u01AC":"T","\u01AE":"T","\u023E":"T","\uA786":"T","\uA728":"TZ","\u24CA":"U","\uFF35":"U","\u00D9":"U","\u00DA":"U","\u00DB":"U","\u0168":"U","\u1E78":"U","\u016A":"U","\u1E7A":"U","\u016C":"U","\u00DC":"U","\u01DB":"U","\u01D7":"U","\u01D5":"U","\u01D9":"U","\u1EE6":"U","\u016E":"U","\u0170":"U","\u01D3":"U","\u0214":"U","\u0216":"U","\u01AF":"U","\u1EEA":"U","\u1EE8":"U","\u1EEE":"U","\u1EEC":"U","\u1EF0":"U","\u1EE4":"U","\u1E72":"U","\u0172":"U","\u1E76":"U","\u1E74":"U","\u0244":"U","\u24CB":"V","\uFF36":"V","\u1E7C":"V","\u1E7E":"V","\u01B2":"V","\uA75E":"V","\u0245":"V","\uA760":"VY","\u24CC":"W","\uFF37":"W","\u1E80":"W","\u1E82":"W","\u0174":"W","\u1E86":"W","\u1E84":"W","\u1E88":"W","\u2C72":"W","\u24CD":"X","\uFF38":"X","\u1E8A":"X","\u1E8C":"X","\u24CE":"Y","\uFF39":"Y","\u1EF2":"Y","\u00DD":"Y","\u0176":"Y","\u1EF8":"Y","\u0232":"Y","\u1E8E":"Y","\u0178":"Y","\u1EF6":"Y","\u1EF4":"Y","\u01B3":"Y","\u024E":"Y","\u1EFE":"Y","\u24CF":"Z","\uFF3A":"Z","\u0179":"Z","\u1E90":"Z","\u017B":"Z","\u017D":"Z","\u1E92":"Z","\u1E94":"Z","\u01B5":"Z","\u0224":"Z","\u2C7F":"Z","\u2C6B":"Z","\uA762":"Z","\u24D0":"a","\uFF41":"a","\u1E9A":"a","\u00E0":"a","\u00E1":"a","\u00E2":"a","\u1EA7":"a","\u1EA5":"a","\u1EAB":"a","\u1EA9":"a","\u00E3":"a","\u0101":"a","\u0103":"a","\u1EB1":"a","\u1EAF":"a","\u1EB5":"a","\u1EB3":"a","\u0227":"a","\u01E1":"a","\u00E4":"a","\u01DF":"a","\u1EA3":"a","\u00E5":"a","\u01FB":"a","\u01CE":"a","\u0201":"a","\u0203":"a","\u1EA1":"a","\u1EAD":"a","\u1EB7":"a","\u1E01":"a","\u0105":"a","\u2C65":"a","\u0250":"a","\uA733":"aa","\u00E6":"ae","\u01FD":"ae","\u01E3":"ae","\uA735":"ao","\uA737":"au","\uA739":"av","\uA73B":"av","\uA73D":"ay","\u24D1":"b","\uFF42":"b","\u1E03":"b","\u1E05":"b","\u1E07":"b","\u0180":"b","\u0183":"b","\u0253":"b","\u24D2":"c","\uFF43":"c","\u0107":"c","\u0109":"c","\u010B":"c","\u010D":"c","\u00E7":"c","\u1E09":"c","\u0188":"c","\u023C":"c","\uA73F":"c","\u2184":"c","\u24D3":"d","\uFF44":"d","\u1E0B":"d","\u010F":"d","\u1E0D":"d","\u1E11":"d","\u1E13":"d","\u1E0F":"d","\u0111":"d","\u018C":"d","\u0256":"d","\u0257":"d","\uA77A":"d","\u01F3":"dz","\u01C6":"dz","\u24D4":"e","\uFF45":"e","\u00E8":"e","\u00E9":"e","\u00EA":"e","\u1EC1":"e","\u1EBF":"e","\u1EC5":"e","\u1EC3":"e","\u1EBD":"e","\u0113":"e","\u1E15":"e","\u1E17":"e","\u0115":"e","\u0117":"e","\u00EB":"e","\u1EBB":"e","\u011B":"e","\u0205":"e","\u0207":"e","\u1EB9":"e","\u1EC7":"e","\u0229":"e","\u1E1D":"e","\u0119":"e","\u1E19":"e","\u1E1B":"e","\u0247":"e","\u025B":"e","\u01DD":"e","\u24D5":"f","\uFF46":"f","\u1E1F":"f","\u0192":"f","\uA77C":"f","\u24D6":"g","\uFF47":"g","\u01F5":"g","\u011D":"g","\u1E21":"g","\u011F":"g","\u0121":"g","\u01E7":"g","\u0123":"g","\u01E5":"g","\u0260":"g","\uA7A1":"g","\u1D79":"g","\uA77F":"g","\u24D7":"h","\uFF48":"h","\u0125":"h","\u1E23":"h","\u1E27":"h","\u021F":"h","\u1E25":"h","\u1E29":"h","\u1E2B":"h","\u1E96":"h","\u0127":"h","\u2C68":"h","\u2C76":"h","\u0265":"h","\u0195":"hv","\u24D8":"i","\uFF49":"i","\u00EC":"i","\u00ED":"i","\u00EE":"i","\u0129":"i","\u012B":"i","\u012D":"i","\u00EF":"i","\u1E2F":"i","\u1EC9":"i","\u01D0":"i","\u0209":"i","\u020B":"i","\u1ECB":"i","\u012F":"i","\u1E2D":"i","\u0268":"i","\u0131":"i","\u24D9":"j","\uFF4A":"j","\u0135":"j","\u01F0":"j","\u0249":"j","\u24DA":"k","\uFF4B":"k","\u1E31":"k","\u01E9":"k","\u1E33":"k","\u0137":"k","\u1E35":"k","\u0199":"k","\u2C6A":"k","\uA741":"k","\uA743":"k","\uA745":"k","\uA7A3":"k","\u24DB":"l","\uFF4C":"l","\u0140":"l","\u013A":"l","\u013E":"l","\u1E37":"l","\u1E39":"l","\u013C":"l","\u1E3D":"l","\u1E3B":"l","\u017F":"l","\u0142":"l","\u019A":"l","\u026B":"l","\u2C61":"l","\uA749":"l","\uA781":"l","\uA747":"l","\u01C9":"lj","\u24DC":"m","\uFF4D":"m","\u1E3F":"m","\u1E41":"m","\u1E43":"m","\u0271":"m","\u026F":"m","\u24DD":"n","\uFF4E":"n","\u01F9":"n","\u0144":"n","\u00F1":"n","\u1E45":"n","\u0148":"n","\u1E47":"n","\u0146":"n","\u1E4B":"n","\u1E49":"n","\u019E":"n","\u0272":"n","\u0149":"n","\uA791":"n","\uA7A5":"n","\u01CC":"nj","\u24DE":"o","\uFF4F":"o","\u00F2":"o","\u00F3":"o","\u00F4":"o","\u1ED3":"o","\u1ED1":"o","\u1ED7":"o","\u1ED5":"o","\u00F5":"o","\u1E4D":"o","\u022D":"o","\u1E4F":"o","\u014D":"o","\u1E51":"o","\u1E53":"o","\u014F":"o","\u022F":"o","\u0231":"o","\u00F6":"o","\u022B":"o","\u1ECF":"o","\u0151":"o","\u01D2":"o","\u020D":"o","\u020F":"o","\u01A1":"o","\u1EDD":"o","\u1EDB":"o","\u1EE1":"o","\u1EDF":"o","\u1EE3":"o","\u1ECD":"o","\u1ED9":"o","\u01EB":"o","\u01ED":"o","\u00F8":"o","\u01FF":"o","\u0254":"o","\uA74B":"o","\uA74D":"o","\u0275":"o","\u01A3":"oi","\u0223":"ou","\uA74F":"oo","\u24DF":"p","\uFF50":"p","\u1E55":"p","\u1E57":"p","\u01A5":"p","\u1D7D":"p","\uA751":"p","\uA753":"p","\uA755":"p","\u24E0":"q","\uFF51":"q","\u024B":"q","\uA757":"q","\uA759":"q","\u24E1":"r","\uFF52":"r","\u0155":"r","\u1E59":"r","\u0159":"r","\u0211":"r","\u0213":"r","\u1E5B":"r","\u1E5D":"r","\u0157":"r","\u1E5F":"r","\u024D":"r","\u027D":"r","\uA75B":"r","\uA7A7":"r","\uA783":"r","\u24E2":"s","\uFF53":"s","\u00DF":"s","\u015B":"s","\u1E65":"s","\u015D":"s","\u1E61":"s","\u0161":"s","\u1E67":"s","\u1E63":"s","\u1E69":"s","\u0219":"s","\u015F":"s","\u023F":"s","\uA7A9":"s","\uA785":"s","\u1E9B":"s","\u24E3":"t","\uFF54":"t","\u1E6B":"t","\u1E97":"t","\u0165":"t","\u1E6D":"t","\u021B":"t","\u0163":"t","\u1E71":"t","\u1E6F":"t","\u0167":"t","\u01AD":"t","\u0288":"t","\u2C66":"t","\uA787":"t","\uA729":"tz","\u24E4":"u","\uFF55":"u","\u00F9":"u","\u00FA":"u","\u00FB":"u","\u0169":"u","\u1E79":"u","\u016B":"u","\u1E7B":"u","\u016D":"u","\u00FC":"u","\u01DC":"u","\u01D8":"u","\u01D6":"u","\u01DA":"u","\u1EE7":"u","\u016F":"u","\u0171":"u","\u01D4":"u","\u0215":"u","\u0217":"u","\u01B0":"u","\u1EEB":"u","\u1EE9":"u","\u1EEF":"u","\u1EED":"u","\u1EF1":"u","\u1EE5":"u","\u1E73":"u","\u0173":"u","\u1E77":"u","\u1E75":"u","\u0289":"u","\u24E5":"v","\uFF56":"v","\u1E7D":"v","\u1E7F":"v","\u028B":"v","\uA75F":"v","\u028C":"v","\uA761":"vy","\u24E6":"w","\uFF57":"w","\u1E81":"w","\u1E83":"w","\u0175":"w","\u1E87":"w","\u1E85":"w","\u1E98":"w","\u1E89":"w","\u2C73":"w","\u24E7":"x","\uFF58":"x","\u1E8B":"x","\u1E8D":"x","\u24E8":"y","\uFF59":"y","\u1EF3":"y","\u00FD":"y","\u0177":"y","\u1EF9":"y","\u0233":"y","\u1E8F":"y","\u00FF":"y","\u1EF7":"y","\u1E99":"y","\u1EF5":"y","\u01B4":"y","\u024F":"y","\u1EFF":"y","\u24E9":"z","\uFF5A":"z","\u017A":"z","\u1E91":"z","\u017C":"z","\u017E":"z","\u1E93":"z","\u1E95":"z","\u01B6":"z","\u0225":"z","\u0240":"z","\u2C6C":"z","\uA763":"z","\u0386":"\u0391","\u0388":"\u0395","\u0389":"\u0397","\u038A":"\u0399","\u03AA":"\u0399","\u038C":"\u039F","\u038E":"\u03A5","\u03AB":"\u03A5","\u038F":"\u03A9","\u03AC":"\u03B1","\u03AD":"\u03B5","\u03AE":"\u03B7","\u03AF":"\u03B9","\u03CA":"\u03B9","\u0390":"\u03B9","\u03CC":"\u03BF","\u03CD":"\u03C5","\u03CB":"\u03C5","\u03B0":"\u03C5","\u03C9":"\u03C9","\u03C2":"\u03C3"};return diacritics});S2.define("select2/data/base",["../utils"],function(Utils){function BaseAdapter($element,options){BaseAdapter.__super__.constructor.call(this)}Utils.Extend(BaseAdapter,Utils.Observable);BaseAdapter.prototype.current=function(callback){throw new Error("The `current` method must be defined in child classes.")};BaseAdapter.prototype.query=function(params,callback){throw new Error("The `query` method must be defined in child classes.")};BaseAdapter.prototype.bind=function(container,$container){};BaseAdapter.prototype.destroy=function(){};BaseAdapter.prototype.generateResultId=function(container,data){var id=container.id+"-result-";id+=Utils.generateChars(4);if(data.id!=null){id+="-"+data.id.toString()}else{id+="-"+Utils.generateChars(4)}return id};return BaseAdapter});S2.define("select2/data/select",["./base","../utils","jquery"],function(BaseAdapter,Utils,$){function SelectAdapter($element,options){this.$element=$element;this.options=options;SelectAdapter.__super__.constructor.call(this)}Utils.Extend(SelectAdapter,BaseAdapter);SelectAdapter.prototype.current=function(callback){var data=[];var self=this;this.$element.find(":selected").each(function(){var $option=$(this);var option=self.item($option);data.push(option)});callback(data)};SelectAdapter.prototype.select=function(data){var self=this;data.selected=true;if($(data.element).is("option")){data.element.selected=true;this.$element.trigger("change");return}if(this.$element.prop("multiple")){this.current(function(currentData){var val=[];data=[data];data.push.apply(data,currentData);for(var d=0;d<data.length;d++){var id=data[d].id;if($.inArray(id,val)===-1){val.push(id)}}self.$element.val(val);self.$element.trigger("change")})}else{var val=data.id;this.$element.val(val);this.$element.trigger("change")}};SelectAdapter.prototype.unselect=function(data){var self=this;if(!this.$element.prop("multiple")){return}data.selected=false;if($(data.element).is("option")){data.element.selected=false;this.$element.trigger("change");return}this.current(function(currentData){var val=[];for(var d=0;d<currentData.length;d++){var id=currentData[d].id;if(id!==data.id&&$.inArray(id,val)===-1){val.push(id)}}self.$element.val(val);self.$element.trigger("change")})};SelectAdapter.prototype.bind=function(container,$container){var self=this;this.container=container;container.on("select",function(params){self.select(params.data)});container.on("unselect",function(params){self.unselect(params.data)})};SelectAdapter.prototype.destroy=function(){this.$element.find("*").each(function(){$.removeData(this,"data")})};SelectAdapter.prototype.query=function(params,callback){var data=[];var self=this;var $options=this.$element.children();$options.each(function(){var $option=$(this);if(!$option.is("option")&&!$option.is("optgroup")){return}var option=self.item($option);var matches=self.matches(params,option);if(matches!==null){data.push(matches)}});callback({results:data})};SelectAdapter.prototype.addOptions=function($options){Utils.appendMany(this.$element,$options)};SelectAdapter.prototype.option=function(data){var option;if(data.children){option=document.createElement("optgroup");option.label=data.text}else{option=document.createElement("option");if(option.textContent!==undefined){option.textContent=data.text}else{option.innerText=data.text}}if(data.id){option.value=data.id}if(data.disabled){option.disabled=true}if(data.selected){option.selected=true}if(data.title){option.title=data.title}var $option=$(option);var normalizedData=this._normalizeItem(data);normalizedData.element=option;$.data(option,"data",normalizedData);return $option};SelectAdapter.prototype.item=function($option){var data={};data=$.data($option[0],"data");if(data!=null){return data}if($option.is("option")){data={id:$option.val(),text:$option.text(),disabled:$option.prop("disabled"),selected:$option.prop("selected"),title:$option.prop("title")}}else{if($option.is("optgroup")){data={text:$option.prop("label"),children:[],title:$option.prop("title")};var $children=$option.children("option");var children=[];for(var c=0;c<$children.length;c++){var $child=$($children[c]);var child=this.item($child);children.push(child)}data.children=children}}data=this._normalizeItem(data);data.element=$option[0];$.data($option[0],"data",data);return data};SelectAdapter.prototype._normalizeItem=function(item){if(!$.isPlainObject(item)){item={id:item,text:item}}item=$.extend({},{text:""},item);var defaults={selected:false,disabled:false};if(item.id!=null){item.id=item.id.toString()}if(item.text!=null){item.text=item.text.toString()}if(item._resultId==null&&item.id&&this.container!=null){item._resultId=this.generateResultId(this.container,item)}return $.extend({},defaults,item)};SelectAdapter.prototype.matches=function(params,data){var matcher=this.options.get("matcher");return matcher(params,data)};return SelectAdapter});S2.define("select2/data/array",["./select","../utils","jquery"],function(SelectAdapter,Utils,$){function ArrayAdapter($element,options){var data=options.get("data")||[];ArrayAdapter.__super__.constructor.call(this,$element,options);this.addOptions(this.convertToOptions(data))}Utils.Extend(ArrayAdapter,SelectAdapter);ArrayAdapter.prototype.select=function(data){var $option=this.$element.find("option").filter(function(i,elm){return elm.value==data.id.toString()});if($option.length===0){$option=this.option(data);this.addOptions($option)}ArrayAdapter.__super__.select.call(this,data)};ArrayAdapter.prototype.convertToOptions=function(data){var self=this;var $existing=this.$element.find("option");var existingIds=$existing.map(function(){return self.item($(this)).id}).get();var $options=[];function onlyItem(item){return function(){return $(this).val()==item.id}}for(var d=0;d<data.length;d++){var item=this._normalizeItem(data[d]);if($.inArray(item.id,existingIds)>=0){var $existingOption=$existing.filter(onlyItem(item));var existingData=this.item($existingOption);var newData=$.extend(true,{},existingData,item);var $newOption=this.option(existingData);$existingOption.replaceWith($newOption);continue}var $option=this.option(item);if(item.children){var $children=this.convertToOptions(item.children);Utils.appendMany($option,$children)}$options.push($option)}return $options};return ArrayAdapter});S2.define("select2/data/ajax",["./array","../utils","jquery"],function(ArrayAdapter,Utils,$){function AjaxAdapter($element,options){this.ajaxOptions=this._applyDefaults(options.get("ajax"));if(this.ajaxOptions.processResults!=null){this.processResults=this.ajaxOptions.processResults}ArrayAdapter.__super__.constructor.call(this,$element,options)}Utils.Extend(AjaxAdapter,ArrayAdapter);AjaxAdapter.prototype._applyDefaults=function(options){var defaults={data:function(params){return{q:params.term}},transport:function(params,success,failure){var $request=$.ajax(params);$request.then(success);$request.fail(failure);return $request}};return $.extend({},defaults,options,true)};AjaxAdapter.prototype.processResults=function(results){return results};AjaxAdapter.prototype.query=function(params,callback){var matches=[];var self=this;if(this._request!=null){if($.isFunction(this._request.abort)){this._request.abort()}this._request=null}var options=$.extend({type:"GET"},this.ajaxOptions);if(typeof options.url==="function"){options.url=options.url(params)}if(typeof options.data==="function"){options.data=options.data(params)}function request(){var $request=options.transport(options,function(data){var results=self.processResults(data,params);if(self.options.get("debug")&&window.console&&console.error){if(!results||!results.results||!$.isArray(results.results)){console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")}}callback(results)},function(){});self._request=$request}if(this.ajaxOptions.delay&&params.term!==""){if(this._queryTimeout){window.clearTimeout(this._queryTimeout)}this._queryTimeout=window.setTimeout(request,this.ajaxOptions.delay)}else{request()}};return AjaxAdapter});S2.define("select2/data/tags",["jquery"],function($){function Tags(decorated,$element,options){var tags=options.get("tags");var createTag=options.get("createTag");if(createTag!==undefined){this.createTag=createTag}decorated.call(this,$element,options);if($.isArray(tags)){for(var t=0;t<tags.length;t++){var tag=tags[t];var item=this._normalizeItem(tag);var $option=this.option(item);this.$element.append($option)}}}Tags.prototype.query=function(decorated,params,callback){var self=this;this._removeOldTags();if(params.term==null||params.page!=null){decorated.call(this,params,callback);return}function wrapper(obj,child){var data=obj.results;for(var i=0;i<data.length;i++){var option=data[i];var checkChildren=(option.children!=null&&!wrapper({results:option.children},true));var checkText=option.text===params.term;if(checkText||checkChildren){if(child){return false}obj.data=data;callback(obj);return}}if(child){return true}var tag=self.createTag(params);if(tag!=null){var $option=self.option(tag);$option.attr("data-select2-tag",true);self.addOptions([$option]);self.insertTag(data,tag)}obj.results=data;callback(obj)}decorated.call(this,params,wrapper)};Tags.prototype.createTag=function(decorated,params){var term=$.trim(params.term);if(term===""){return null}return{id:term,text:term}};Tags.prototype.insertTag=function(_,data,tag){data.unshift(tag)};Tags.prototype._removeOldTags=function(_){var tag=this._lastTag;var $options=this.$element.find("option[data-select2-tag]");$options.each(function(){if(this.selected){return}$(this).remove()})};return Tags});S2.define("select2/data/tokenizer",["jquery"],function($){function Tokenizer(decorated,$element,options){var tokenizer=options.get("tokenizer");if(tokenizer!==undefined){this.tokenizer=tokenizer}decorated.call(this,$element,options)}Tokenizer.prototype.bind=function(decorated,container,$container){decorated.call(this,container,$container);this.$search=container.dropdown.$search||container.selection.$search||$container.find(".select2-search__field")};Tokenizer.prototype.query=function(decorated,params,callback){var self=this;function select(data){self.select(data)}params.term=params.term||"";var tokenData=this.tokenizer(params,this.options,select);if(tokenData.term!==params.term){if(this.$search.length){this.$search.val(tokenData.term);this.$search.focus()}params.term=tokenData.term}decorated.call(this,params,callback)};Tokenizer.prototype.tokenizer=function(_,params,options,callback){var separators=options.get("tokenSeparators")||[];var term=params.term;var i=0;var createTag=this.createTag||function(params){return{id:params.term,text:params.term}};while(i<term.length){var termChar=term[i];if($.inArray(termChar,separators)===-1){i++;continue}var part=term.substr(0,i);var partParams=$.extend({},params,{term:part});var data=createTag(partParams);callback(data);term=term.substr(i+1)||"";i=0}return{term:term}};return Tokenizer});S2.define("select2/data/minimumInputLength",[],function(){function MinimumInputLength(decorated,$e,options){this.minimumInputLength=options.get("minimumInputLength");decorated.call(this,$e,options)}MinimumInputLength.prototype.query=function(decorated,params,callback){params.term=params.term||"";if(params.term.length<this.minimumInputLength){this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:params.term,params:params}});return}decorated.call(this,params,callback)};return MinimumInputLength});S2.define("select2/data/maximumInputLength",[],function(){function MaximumInputLength(decorated,$e,options){this.maximumInputLength=options.get("maximumInputLength");decorated.call(this,$e,options)}MaximumInputLength.prototype.query=function(decorated,params,callback){params.term=params.term||"";if(this.maximumInputLength>0&&params.term.length>this.maximumInputLength){this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:params.term,params:params}});return}decorated.call(this,params,callback)};return MaximumInputLength});S2.define("select2/data/maximumSelectionLength",[],function(){function MaximumSelectionLength(decorated,$e,options){this.maximumSelectionLength=options.get("maximumSelectionLength");decorated.call(this,$e,options)}MaximumSelectionLength.prototype.query=function(decorated,params,callback){var self=this;this.current(function(currentData){var count=currentData!=null?currentData.length:0;if(self.maximumSelectionLength>0&&count>=self.maximumSelectionLength){self.trigger("results:message",{message:"maximumSelected",args:{maximum:self.maximumSelectionLength}});return}decorated.call(self,params,callback)})};return MaximumSelectionLength});S2.define("select2/dropdown",["jquery","./utils"],function($,Utils){function Dropdown($element,options){this.$element=$element;this.options=options;Dropdown.__super__.constructor.call(this)}Utils.Extend(Dropdown,Utils.Observable);Dropdown.prototype.render=function(){var $dropdown=$('<span class="select2-dropdown"><span class="select2-results"></span></span>');$dropdown.attr("dir",this.options.get("dir"));this.$dropdown=$dropdown;return $dropdown};Dropdown.prototype.position=function($dropdown,$container){};Dropdown.prototype.destroy=function(){this.$dropdown.remove()};return Dropdown});S2.define("select2/dropdown/search",["jquery","../utils"],function($,Utils){function Search(){}Search.prototype.render=function(decorated){var $rendered=decorated.call(this);var $search=$('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></span>');this.$searchContainer=$search;this.$search=$search.find("input");$rendered.prepend($search);return $rendered};Search.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container);this.$search.on("keydown",function(evt){self.trigger("keypress",evt);self._keyUpPrevented=evt.isDefaultPrevented()});this.$search.on("input",function(evt){$(this).off("keyup")});this.$search.on("keyup input",function(evt){self.handleSearch(evt)});container.on("open",function(){self.$search.attr("tabindex",0);self.$search.focus();window.setTimeout(function(){self.$search.focus()},0)});container.on("close",function(){self.$search.attr("tabindex",-1);self.$search.val("")});container.on("results:all",function(params){if(params.query.term==null||params.query.term===""){var showSearch=self.showSearch(params);if(showSearch){self.$searchContainer.removeClass("select2-search--hide")}else{self.$searchContainer.addClass("select2-search--hide")}}})};Search.prototype.handleSearch=function(evt){if(!this._keyUpPrevented){var input=this.$search.val();this.trigger("query",{term:input})}this._keyUpPrevented=false};Search.prototype.showSearch=function(_,params){return true};return Search});S2.define("select2/dropdown/hidePlaceholder",[],function(){function HidePlaceholder(decorated,$element,options,dataAdapter){this.placeholder=this.normalizePlaceholder(options.get("placeholder"));decorated.call(this,$element,options,dataAdapter)}HidePlaceholder.prototype.append=function(decorated,data){data.results=this.removePlaceholder(data.results);decorated.call(this,data)};HidePlaceholder.prototype.normalizePlaceholder=function(_,placeholder){if(typeof placeholder==="string"){placeholder={id:"",text:placeholder}}return placeholder};HidePlaceholder.prototype.removePlaceholder=function(_,data){var modifiedData=data.slice(0);for(var d=data.length-1;d>=0;d--){var item=data[d];if(this.placeholder.id===item.id){modifiedData.splice(d,1)}}return modifiedData};return HidePlaceholder});S2.define("select2/dropdown/infiniteScroll",["jquery"],function($){function InfiniteScroll(decorated,$element,options,dataAdapter){this.lastParams={};decorated.call(this,$element,options,dataAdapter);this.$loadingMore=this.createLoadingMore();this.loading=false}InfiniteScroll.prototype.append=function(decorated,data){this.$loadingMore.remove();this.loading=false;decorated.call(this,data);if(this.showLoadingMore(data)){this.$results.append(this.$loadingMore)}};InfiniteScroll.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container);container.on("query",function(params){self.lastParams=params;self.loading=true});container.on("query:append",function(params){self.lastParams=params;self.loading=true});this.$results.on("scroll",function(){var isLoadMoreVisible=$.contains(document.documentElement,self.$loadingMore[0]);if(self.loading||!isLoadMoreVisible){return}var currentOffset=self.$results.offset().top+self.$results.outerHeight(false);var loadingMoreOffset=self.$loadingMore.offset().top+self.$loadingMore.outerHeight(false);if(currentOffset+50>=loadingMoreOffset){self.loadMore()}})};InfiniteScroll.prototype.loadMore=function(){this.loading=true;var params=$.extend({},{page:1},this.lastParams);params.page++;this.trigger("query:append",params)};InfiniteScroll.prototype.showLoadingMore=function(_,data){return data.pagination&&data.pagination.more};InfiniteScroll.prototype.createLoadingMore=function(){var $option=$('<li class="option load-more" role="treeitem"></li>');var message=this.options.get("translations").get("loadingMore");$option.html(message(this.lastParams));return $option};return InfiniteScroll});S2.define("select2/dropdown/attachBody",["jquery","../utils"],function($,Utils){function AttachBody(decorated,$element,options){this.$dropdownParent=options.get("dropdownParent")||document.body;decorated.call(this,$element,options)}AttachBody.prototype.bind=function(decorated,container,$container){var self=this;var setupResultsEvents=false;decorated.call(this,container,$container);container.on("open",function(){self._showDropdown();self._attachPositioningHandler(container);if(!setupResultsEvents){setupResultsEvents=true;container.on("results:all",function(){self._positionDropdown();self._resizeDropdown()});container.on("results:append",function(){self._positionDropdown();self._resizeDropdown()})}});container.on("close",function(){self._hideDropdown();self._detachPositioningHandler(container)});this.$dropdownContainer.on("mousedown",function(evt){evt.stopPropagation()})};AttachBody.prototype.position=function(decorated,$dropdown,$container){$dropdown.attr("class",$container.attr("class"));$dropdown.removeClass("select2");$dropdown.addClass("select2-container--open");$dropdown.css({position:"absolute",top:-999999});this.$container=$container};AttachBody.prototype.render=function(decorated){var $container=$("<span></span>");var $dropdown=decorated.call(this);$container.append($dropdown);this.$dropdownContainer=$container;return $container};AttachBody.prototype._hideDropdown=function(decorated){this.$dropdownContainer.detach()};AttachBody.prototype._attachPositioningHandler=function(container){var self=this;var scrollEvent="scroll.select2."+container.id;var resizeEvent="resize.select2."+container.id;var orientationEvent="orientationchange.select2."+container.id;var $watchers=this.$container.parents().filter(Utils.hasScroll);$watchers.each(function(){$(this).data("select2-scroll-position",{x:$(this).scrollLeft(),y:$(this).scrollTop()})});$watchers.on(scrollEvent,function(ev){var position=$(this).data("select2-scroll-position");$(this).scrollTop(position.y)});$(window).on(scrollEvent+" "+resizeEvent+" "+orientationEvent,function(e){self._positionDropdown();self._resizeDropdown()})};AttachBody.prototype._detachPositioningHandler=function(container){var scrollEvent="scroll.select2."+container.id;var resizeEvent="resize.select2."+container.id;var orientationEvent="orientationchange.select2."+container.id;var $watchers=this.$container.parents().filter(Utils.hasScroll);$watchers.off(scrollEvent);$(window).off(scrollEvent+" "+resizeEvent+" "+orientationEvent)};AttachBody.prototype._positionDropdown=function(){var $window=$(window);var isCurrentlyAbove=this.$dropdown.hasClass("select2-dropdown--above");var isCurrentlyBelow=this.$dropdown.hasClass("select2-dropdown--below");var newDirection=null;var position=this.$container.position();var offset=this.$container.offset();offset.bottom=offset.top+this.$container.outerHeight(false);var container={height:this.$container.outerHeight(false)};container.top=offset.top;container.bottom=offset.top+container.height;var dropdown={height:this.$dropdown.outerHeight(false)};var viewport={top:$window.scrollTop(),bottom:$window.scrollTop()+$window.height()};var enoughRoomAbove=viewport.top<(offset.top-dropdown.height);var enoughRoomBelow=viewport.bottom>(offset.bottom+dropdown.height);var css={left:offset.left,top:container.bottom};if(!isCurrentlyAbove&&!isCurrentlyBelow){newDirection="below"}if(!enoughRoomBelow&&enoughRoomAbove&&!isCurrentlyAbove){newDirection="above"}else{if(!enoughRoomAbove&&enoughRoomBelow&&isCurrentlyAbove){newDirection="below"}}if(newDirection=="above"||(isCurrentlyAbove&&newDirection!=="below")){css.top=container.top-dropdown.height}if(newDirection!=null){this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+newDirection);this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+newDirection)}this.$dropdownContainer.css(css)};AttachBody.prototype._resizeDropdown=function(){this.$dropdownContainer.width();var css={width:this.$container.outerWidth(false)+"px"};if(this.options.get("dropdownAutoWidth")){css.minWidth=css.width;css.width="auto"}this.$dropdown.css(css)};AttachBody.prototype._showDropdown=function(decorated){this.$dropdownContainer.appendTo(this.$dropdownParent);this._positionDropdown();this._resizeDropdown()};return AttachBody});S2.define("select2/dropdown/minimumResultsForSearch",[],function(){function countResults(data){var count=0;for(var d=0;d<data.length;d++){var item=data[d];if(item.children){count+=countResults(item.children)}else{count++}}return count}function MinimumResultsForSearch(decorated,$element,options,dataAdapter){this.minimumResultsForSearch=options.get("minimumResultsForSearch");if(this.minimumResultsForSearch<0){this.minimumResultsForSearch=Infinity}decorated.call(this,$element,options,dataAdapter)}MinimumResultsForSearch.prototype.showSearch=function(decorated,params){if(countResults(params.data.results)<this.minimumResultsForSearch){return false}return decorated.call(this,params)};return MinimumResultsForSearch});S2.define("select2/dropdown/selectOnClose",[],function(){function SelectOnClose(){}SelectOnClose.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container);container.on("close",function(){self._handleSelectOnClose()})};SelectOnClose.prototype._handleSelectOnClose=function(){var $highlightedResults=this.getHighlightedResults();if($highlightedResults.length<1){return}this.trigger("select",{data:$highlightedResults.data("data")})};return SelectOnClose});S2.define("select2/dropdown/closeOnSelect",[],function(){function CloseOnSelect(){}CloseOnSelect.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container);container.on("select",function(evt){self._selectTriggered(evt)});container.on("unselect",function(evt){self._selectTriggered(evt)})};CloseOnSelect.prototype._selectTriggered=function(_,evt){var originalEvent=evt.originalEvent;if(originalEvent&&originalEvent.ctrlKey){return}this.trigger("close")};return CloseOnSelect});S2.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(args){var overChars=args.input.length-args.maximum;var message="Please delete "+overChars+" character";if(overChars!=1){message+="s"}return message},inputTooShort:function(args){var remainingChars=args.minimum-args.input.length;var message="Please enter "+remainingChars+" or more characters";return message},loadingMore:function(){return"Loading more resultsâ¦"},maximumSelected:function(args){var message="You can only select "+args.maximum+" item";if(args.maximum!=1){message+="s"}return message},noResults:function(){return"No results found"},searching:function(){return"Searchingâ¦"}}});S2.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function($,require,ResultsList,SingleSelection,MultipleSelection,Placeholder,AllowClear,SelectionSearch,EventRelay,Utils,Translation,DIACRITICS,SelectData,ArrayData,AjaxData,Tags,Tokenizer,MinimumInputLength,MaximumInputLength,MaximumSelectionLength,Dropdown,DropdownSearch,HidePlaceholder,InfiniteScroll,AttachBody,MinimumResultsForSearch,SelectOnClose,CloseOnSelect,EnglishTranslation){function Defaults(){this.reset()}Defaults.prototype.apply=function(options){options=$.extend({},this.defaults,options);if(options.dataAdapter==null){if(options.ajax!=null){options.dataAdapter=AjaxData}else{if(options.data!=null){options.dataAdapter=ArrayData}else{options.dataAdapter=SelectData}}if(options.minimumInputLength>0){options.dataAdapter=Utils.Decorate(options.dataAdapter,MinimumInputLength)}if(options.maximumInputLength>0){options.dataAdapter=Utils.Decorate(options.dataAdapter,MaximumInputLength)}if(options.maximumSelectionLength>0){options.dataAdapter=Utils.Decorate(options.dataAdapter,MaximumSelectionLength)}if(options.tags){options.dataAdapter=Utils.Decorate(options.dataAdapter,Tags)}if(options.tokenSeparators!=null||options.tokenizer!=null){options.dataAdapter=Utils.Decorate(options.dataAdapter,Tokenizer)}if(options.query!=null){var Query=require(options.amdBase+"compat/query");options.dataAdapter=Utils.Decorate(options.dataAdapter,Query)}if(options.initSelection!=null){var InitSelection=require(options.amdBase+"compat/initSelection");options.dataAdapter=Utils.Decorate(options.dataAdapter,InitSelection)}}if(options.resultsAdapter==null){options.resultsAdapter=ResultsList;if(options.ajax!=null){options.resultsAdapter=Utils.Decorate(options.resultsAdapter,InfiniteScroll)}if(options.placeholder!=null){options.resultsAdapter=Utils.Decorate(options.resultsAdapter,HidePlaceholder)}if(options.selectOnClose){options.resultsAdapter=Utils.Decorate(options.resultsAdapter,SelectOnClose)}}if(options.dropdownAdapter==null){if(options.multiple){options.dropdownAdapter=Dropdown}else{var SearchableDropdown=Utils.Decorate(Dropdown,DropdownSearch);options.dropdownAdapter=SearchableDropdown}if(options.minimumResultsForSearch!==0){options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,MinimumResultsForSearch)}if(options.closeOnSelect){options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,CloseOnSelect)}if(options.dropdownCssClass!=null||options.dropdownCss!=null||options.adaptDropdownCssClass!=null){var DropdownCSS=require(options.amdBase+"compat/dropdownCss");options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,DropdownCSS)}options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,AttachBody)}if(options.selectionAdapter==null){if(options.multiple){options.selectionAdapter=MultipleSelection}else{options.selectionAdapter=SingleSelection}if(options.placeholder!=null){options.selectionAdapter=Utils.Decorate(options.selectionAdapter,Placeholder)}if(options.allowClear){options.selectionAdapter=Utils.Decorate(options.selectionAdapter,AllowClear)}if(options.multiple){options.selectionAdapter=Utils.Decorate(options.selectionAdapter,SelectionSearch)}if(options.containerCssClass!=null||options.containerCss!=null||options.adaptContainerCssClass!=null){var ContainerCSS=require(options.amdBase+"compat/containerCss");options.selectionAdapter=Utils.Decorate(options.selectionAdapter,ContainerCSS)}options.selectionAdapter=Utils.Decorate(options.selectionAdapter,EventRelay)}if(typeof options.language==="string"){if(options.language.indexOf("-")>0){var languageParts=options.language.split("-");var baseLanguage=languageParts[0];options.language=[options.language,baseLanguage]}else{options.language=[options.language]}}if($.isArray(options.language)){var languages=new Translation();options.language.push("en");var languageNames=options.language;for(var l=0;l<languageNames.length;l++){var name=languageNames[l];var language={};try{language=Translation.loadPath(name)}catch(e){try{name=this.defaults.amdLanguageBase+name;language=Translation.loadPath(name)}catch(ex){if(options.debug&&window.console&&console.warn){console.warn('Select2: The language file for "'+name+'" could not be automatically loaded. A fallback will be used instead.')}continue}}languages.extend(language)}options.translations=languages}else{var baseTranslation=Translation.loadPath(this.defaults.amdLanguageBase+"en");var customTranslation=new Translation(options.language);customTranslation.extend(baseTranslation);options.translations=customTranslation}return options};Defaults.prototype.reset=function(){function stripDiacritics(text){function match(a){return DIACRITICS[a]||a}return text.replace(/[^\u0000-\u007E]/g,match)}function matcher(params,data){if($.trim(params.term)===""){return data}if(data.children&&data.children.length>0){var match=$.extend(true,{},data);for(var c=data.children.length-1;c>=0;c--){var child=data.children[c];var matches=matcher(params,child);if(matches==null){match.children.splice(c,1)}}if(match.children.length>0){return match}return matcher(params,match)}var original=stripDiacritics(data.text).toUpperCase();var term=stripDiacritics(params.term).toUpperCase();if(original.indexOf(term)>-1){return data}return null}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:true,debug:false,dropdownAutoWidth:false,escapeMarkup:Utils.escapeMarkup,language:EnglishTranslation,matcher:matcher,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:false,sorter:function(data){return data},templateResult:function(result){return result.text},templateSelection:function(selection){return selection.text},theme:"default",width:"resolve"}};Defaults.prototype.set=function(key,value){var camelKey=$.camelCase(key);var data={};data[camelKey]=value;var convertedData=Utils._convertData(data);$.extend(this.defaults,convertedData)};var defaults=new Defaults();return defaults});S2.define("select2/options",["require","jquery","./defaults","./utils"],function(require,$,Defaults,Utils){function Options(options,$element){this.options=options;if($element!=null){this.fromElement($element)}this.options=Defaults.apply(this.options);if($element&&$element.is("input")){var InputCompat=require(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=Utils.Decorate(this.options.dataAdapter,InputCompat)}}Options.prototype.fromElement=function($e){var excludedData=["select2"];if(this.options.multiple==null){this.options.multiple=$e.prop("multiple")}if(this.options.disabled==null){this.options.disabled=$e.prop("disabled")}if(this.options.language==null){if($e.prop("lang")){this.options.language=$e.prop("lang").toLowerCase()}else{if($e.closest("[lang]").prop("lang")){this.options.language=$e.closest("[lang]").prop("lang")}}}if(this.options.dir==null){if($e.prop("dir")){this.options.dir=$e.prop("dir")}else{if($e.closest("[dir]").prop("dir")){this.options.dir=$e.closest("[dir]").prop("dir")}else{this.options.dir="ltr"}}}$e.prop("disabled",this.options.disabled);$e.prop("multiple",this.options.multiple);if($e.data("select2Tags")){if(this.options.debug&&window.console&&console.warn){console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.')}$e.data("data",$e.data("select2Tags"));$e.data("tags",true)}if($e.data("ajaxUrl")){if(this.options.debug&&window.console&&console.warn){console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2.")}$e.attr("ajax--url",$e.data("ajaxUrl"));$e.data("ajax--url",$e.data("ajaxUrl"))}var dataset={};if($.fn.jquery&&$.fn.jquery.substr(0,2)=="1."&&$e[0].dataset){dataset=$.extend(true,{},$e[0].dataset,$e.data())}else{dataset=$e.data()}var data=$.extend(true,{},dataset);data=Utils._convertData(data);for(var key in data){if($.inArray(key,excludedData)>-1){continue}if($.isPlainObject(this.options[key])){$.extend(this.options[key],data[key])}else{this.options[key]=data[key]}}return this};Options.prototype.get=function(key){return this.options[key]};Options.prototype.set=function(key,val){this.options[key]=val};return Options});S2.define("select2/core",["jquery","./options","./utils","./keys"],function($,Options,Utils,KEYS){var Select2=function($element,options){if($element.data("select2")!=null){$element.data("select2").destroy()}this.$element=$element;this.id=this._generateId($element);options=options||{};this.options=new Options(options,$element);Select2.__super__.constructor.call(this);var tabindex=$element.attr("tabindex")||0;$element.data("old-tabindex",tabindex);$element.attr("tabindex","-1");var DataAdapter=this.options.get("dataAdapter");this.dataAdapter=new DataAdapter($element,this.options);var $container=this.render();this._placeContainer($container);var SelectionAdapter=this.options.get("selectionAdapter");this.selection=new SelectionAdapter($element,this.options);this.$selection=this.selection.render();this.selection.position(this.$selection,$container);var DropdownAdapter=this.options.get("dropdownAdapter");this.dropdown=new DropdownAdapter($element,this.options);this.$dropdown=this.dropdown.render();this.dropdown.position(this.$dropdown,$container);var ResultsAdapter=this.options.get("resultsAdapter");this.results=new ResultsAdapter($element,this.options,this.dataAdapter);this.$results=this.results.render();this.results.position(this.$results,this.$dropdown);var self=this;this._bindAdapters();this._registerDomEvents();this._registerDataEvents();this._registerSelectionEvents();this._registerDropdownEvents();this._registerResultsEvents();this._registerEvents();this.dataAdapter.current(function(initialData){self.trigger("selection:update",{data:initialData})});$element.addClass("select2-hidden-accessible");$element.attr("aria-hidden","true");this._syncAttributes();$element.data("select2",this)};Utils.Extend(Select2,Utils.Observable);Select2.prototype._generateId=function($element){var id="";if($element.attr("id")!=null){id=$element.attr("id")}else{if($element.attr("name")!=null){id=$element.attr("name")+"-"+Utils.generateChars(2)}else{id=Utils.generateChars(4)}}id="select2-"+id;return id};Select2.prototype._placeContainer=function($container){$container.insertAfter(this.$element);var width=this._resolveWidth(this.$element,this.options.get("width"));if(width!=null){$container.css("width",width)}};Select2.prototype._resolveWidth=function($element,method){var WIDTH=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if(method=="resolve"){var styleWidth=this._resolveWidth($element,"style");if(styleWidth!=null){return styleWidth}return this._resolveWidth($element,"element")}if(method=="element"){var elementWidth=$element.outerWidth(false);if(elementWidth<=0){return"auto"}return elementWidth+"px"}if(method=="style"){var style=$element.attr("style");if(typeof(style)!=="string"){return null}var attrs=style.split(";");for(var i=0,l=attrs.length;i<l;i=i+1){var attr=attrs[i].replace(/\s/g,"");var matches=attr.match(WIDTH);if(matches!==null&&matches.length>=1){return matches[1]}}return null}return method};Select2.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container);this.selection.bind(this,this.$container);this.dropdown.bind(this,this.$container);this.results.bind(this,this.$container)};Select2.prototype._registerDomEvents=function(){var self=this;this.$element.on("change.select2",function(){self.dataAdapter.current(function(data){self.trigger("selection:update",{data:data})})});this._sync=Utils.bind(this._syncAttributes,this);if(this.$element[0].attachEvent){this.$element[0].attachEvent("onpropertychange",this._sync)}var observer=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(observer!=null){this._observer=new observer(function(mutations){$.each(mutations,self._sync)});this._observer.observe(this.$element[0],{attributes:true,subtree:false})}else{if(this.$element[0].addEventListener){this.$element[0].addEventListener("DOMAttrModified",self._sync,false)}}};Select2.prototype._registerDataEvents=function(){var self=this;this.dataAdapter.on("*",function(name,params){self.trigger(name,params)})};Select2.prototype._registerSelectionEvents=function(){var self=this;var nonRelayEvents=["toggle"];this.selection.on("toggle",function(){self.toggleDropdown()});this.selection.on("*",function(name,params){if($.inArray(name,nonRelayEvents)!==-1){return}self.trigger(name,params)})};Select2.prototype._registerDropdownEvents=function(){var self=this;this.dropdown.on("*",function(name,params){self.trigger(name,params)})};Select2.prototype._registerResultsEvents=function(){var self=this;this.results.on("*",function(name,params){self.trigger(name,params)})};Select2.prototype._registerEvents=function(){var self=this;this.on("open",function(){self.$container.addClass("select2-container--open")});this.on("close",function(){self.$container.removeClass("select2-container--open")});this.on("enable",function(){self.$container.removeClass("select2-container--disabled")});this.on("disable",function(){self.$container.addClass("select2-container--disabled")});this.on("focus",function(){self.$container.addClass("select2-container--focus")});this.on("blur",function(){self.$container.removeClass("select2-container--focus")});this.on("query",function(params){if(!self.isOpen()){self.trigger("open")}this.dataAdapter.query(params,function(data){self.trigger("results:all",{data:data,query:params})})});this.on("query:append",function(params){this.dataAdapter.query(params,function(data){self.trigger("results:append",{data:data,query:params})})});this.on("keypress",function(evt){var key=evt.which;if(self.isOpen()){if(key===KEYS.ENTER){self.trigger("results:select");evt.preventDefault()}else{if((key===KEYS.SPACE&&evt.ctrlKey)){self.trigger("results:toggle");evt.preventDefault()}else{if(key===KEYS.UP){self.trigger("results:previous");evt.preventDefault()}else{if(key===KEYS.DOWN){self.trigger("results:next");evt.preventDefault()}else{if(key===KEYS.ESC||key===KEYS.TAB){self.close();evt.preventDefault()}}}}}}else{if(key===KEYS.ENTER||key===KEYS.SPACE||((key===KEYS.DOWN||key===KEYS.UP)&&evt.altKey)){self.open();evt.preventDefault()}}})};Select2.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled"));if(this.options.get("disabled")){if(this.isOpen()){this.close()}this.trigger("disable")}else{this.trigger("enable")}};Select2.prototype.trigger=function(name,args){var actualTrigger=Select2.__super__.trigger;var preTriggerMap={open:"opening",close:"closing",select:"selecting",unselect:"unselecting"};if(name in preTriggerMap){var preTriggerName=preTriggerMap[name];var preTriggerArgs={prevented:false,name:name,args:args};actualTrigger.call(this,preTriggerName,preTriggerArgs);if(preTriggerArgs.prevented){args.prevented=true;return}}actualTrigger.call(this,name,args)};Select2.prototype.toggleDropdown=function(){if(this.options.get("disabled")){return}if(this.isOpen()){this.close()}else{this.open()}};Select2.prototype.open=function(){if(this.isOpen()){return}this.trigger("query",{});this.trigger("open")};Select2.prototype.close=function(){if(!this.isOpen()){return}this.trigger("close")};Select2.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")};Select2.prototype.enable=function(args){if(this.options.get("debug")&&window.console&&console.warn){console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.')}if(args==null||args.length===0){args=[true]}var disabled=!args[0];this.$element.prop("disabled",disabled)};Select2.prototype.data=function(){if(this.options.get("debug")&&arguments.length>0&&window.console&&console.warn){console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.')}var data=[];this.dataAdapter.current(function(currentData){data=currentData});return data};Select2.prototype.val=function(args){if(this.options.get("debug")&&window.console&&console.warn){console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.')}if(args==null||args.length===0){return this.$element.val()}var newVal=args[0];if($.isArray(newVal)){newVal=$.map(newVal,function(obj){return obj.toString()})}this.$element.val(newVal).trigger("change")};Select2.prototype.destroy=function(){this.$container.remove();if(this.$element[0].detachEvent){this.$element[0].detachEvent("onpropertychange",this._sync)}if(this._observer!=null){this._observer.disconnect();this._observer=null}else{if(this.$element[0].removeEventListener){this.$element[0].removeEventListener("DOMAttrModified",this._sync,false)}}this._sync=null;this.$element.off(".select2");this.$element.attr("tabindex",this.$element.data("old-tabindex"));this.$element.removeClass("select2-hidden-accessible");this.$element.attr("aria-hidden","false");this.$element.removeData("select2");this.dataAdapter.destroy();this.selection.destroy();this.dropdown.destroy();this.results.destroy();this.dataAdapter=null;this.selection=null;this.dropdown=null;this.results=null};Select2.prototype.render=function(){var $container=$('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');$container.attr("dir",this.options.get("dir"));this.$container=$container;this.$container.addClass("select2-container--"+this.options.get("theme"));$container.data("element",this.$element);return $container};return Select2});S2.define("jquery.select2",["jquery","require","./select2/core","./select2/defaults"],function($,require,Select2,Defaults){require("jquery.mousewheel");if($.fn.select2==null){var thisMethods=["open","close","destroy"];$.fn.select2=function(options){options=options||{};if(typeof options==="object"){this.each(function(){var instanceOptions=$.extend({},options,true);var instance=new Select2($(this),instanceOptions)});return this}else{if(typeof options==="string"){var instance=this.data("select2");if(instance==null&&window.console&&console.error){console.error("The select2('"+options+"') method was called on an element that is not using Select2.")}var args=Array.prototype.slice.call(arguments,1);var ret=instance[options](args);if($.inArray(options,thisMethods)>-1){return this}return ret}else{throw new Error("Invalid arguments for Select2: "+options)}}}}if($.fn.select2.defaults==null){$.fn.select2.defaults=Defaults}return Select2});S2.define("jquery.mousewheel",["jquery"],function($){return $});return{define:S2.define,require:S2.require}}());var select2=S2.require("jquery.select2");jQuery.fn.select2.amd=S2;return select2}));
/*
    localForage -- Offline Storage, Improved
    Version 1.4.2
    https://mozilla.github.io/localForage
    (c) 2013-2015 Mozilla, Apache License 2.0
*/
(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else{if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else{if(typeof global!=="undefined"){g=global}else{if(typeof self!=="undefined"){g=self}else{g=this}}}g.localforage=f()}}})(function(){var define,module,exports;return(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a){return a(o,!0)}if(i){return i(o,!0)}var f=new Error("Cannot find module '"+o+"'");throw (f.code="MODULE_NOT_FOUND",f)}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++){s(r[o])}return s})({1:[function(_dereq_,module,exports){(function(global){var Mutation=global.MutationObserver||global.WebKitMutationObserver;var scheduleDrain;if(Mutation){var called=0;var observer=new Mutation(nextTick);var element=global.document.createTextNode("");observer.observe(element,{characterData:true});scheduleDrain=function(){element.data=(called=++called%2)}}else{if(!global.setImmediate&&typeof global.MessageChannel!=="undefined"){var channel=new global.MessageChannel();channel.port1.onmessage=nextTick;scheduleDrain=function(){channel.port2.postMessage(0)}}else{if("document" in global&&"onreadystatechange" in global.document.createElement("script")){scheduleDrain=function(){var scriptEl=global.document.createElement("script");scriptEl.onreadystatechange=function(){nextTick();scriptEl.onreadystatechange=null;scriptEl.parentNode.removeChild(scriptEl);scriptEl=null};global.document.documentElement.appendChild(scriptEl)}}else{scheduleDrain=function(){setTimeout(nextTick,0)}}}}var draining;var queue=[];function nextTick(){draining=true;var i,oldQueue;var len=queue.length;while(len){oldQueue=queue;queue=[];i=-1;while(++i<len){oldQueue[i]()}len=queue.length}draining=false}module.exports=immediate;function immediate(task){if(queue.push(task)===1&&!draining){scheduleDrain()}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],2:[function(_dereq_,module,exports){var immediate=_dereq_(1);function INTERNAL(){}var handlers={};var REJECTED=["REJECTED"];var FULFILLED=["FULFILLED"];var PENDING=["PENDING"];module.exports=exports=Promise;function Promise(resolver){if(typeof resolver!=="function"){throw new TypeError("resolver must be a function")}this.state=PENDING;this.queue=[];this.outcome=void 0;if(resolver!==INTERNAL){safelyResolveThenable(this,resolver)}}Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected)};Promise.prototype.then=function(onFulfilled,onRejected){if(typeof onFulfilled!=="function"&&this.state===FULFILLED||typeof onRejected!=="function"&&this.state===REJECTED){return this}var promise=new this.constructor(INTERNAL);if(this.state!==PENDING){var resolver=this.state===FULFILLED?onFulfilled:onRejected;unwrap(promise,resolver,this.outcome)}else{this.queue.push(new QueueItem(promise,onFulfilled,onRejected))}return promise};function QueueItem(promise,onFulfilled,onRejected){this.promise=promise;if(typeof onFulfilled==="function"){this.onFulfilled=onFulfilled;this.callFulfilled=this.otherCallFulfilled}if(typeof onRejected==="function"){this.onRejected=onRejected;this.callRejected=this.otherCallRejected}}QueueItem.prototype.callFulfilled=function(value){handlers.resolve(this.promise,value)};QueueItem.prototype.otherCallFulfilled=function(value){unwrap(this.promise,this.onFulfilled,value)};QueueItem.prototype.callRejected=function(value){handlers.reject(this.promise,value)};QueueItem.prototype.otherCallRejected=function(value){unwrap(this.promise,this.onRejected,value)};function unwrap(promise,func,value){immediate(function(){var returnValue;try{returnValue=func(value)}catch(e){return handlers.reject(promise,e)}if(returnValue===promise){handlers.reject(promise,new TypeError("Cannot resolve promise with itself"))}else{handlers.resolve(promise,returnValue)}})}handlers.resolve=function(self,value){var result=tryCatch(getThen,value);if(result.status==="error"){return handlers.reject(self,result.value)}var thenable=result.value;if(thenable){safelyResolveThenable(self,thenable)}else{self.state=FULFILLED;self.outcome=value;var i=-1;var len=self.queue.length;while(++i<len){self.queue[i].callFulfilled(value)}}return self};handlers.reject=function(self,error){self.state=REJECTED;self.outcome=error;var i=-1;var len=self.queue.length;while(++i<len){self.queue[i].callRejected(error)}return self};function getThen(obj){var then=obj&&obj.then;if(obj&&typeof obj==="object"&&typeof then==="function"){return function appyThen(){then.apply(obj,arguments)}}}function safelyResolveThenable(self,thenable){var called=false;function onError(value){if(called){return}called=true;handlers.reject(self,value)}function onSuccess(value){if(called){return}called=true;handlers.resolve(self,value)}function tryToUnwrap(){thenable(onSuccess,onError)}var result=tryCatch(tryToUnwrap);if(result.status==="error"){onError(result.value)}}function tryCatch(func,value){var out={};try{out.value=func(value);out.status="success"}catch(e){out.status="error";out.value=e}return out}exports.resolve=resolve;function resolve(value){if(value instanceof this){return value}return handlers.resolve(new this(INTERNAL),value)}exports.reject=reject;function reject(reason){var promise=new this(INTERNAL);return handlers.reject(promise,reason)}exports.all=all;function all(iterable){var self=this;if(Object.prototype.toString.call(iterable)!=="[object Array]"){return this.reject(new TypeError("must be an array"))}var len=iterable.length;var called=false;if(!len){return this.resolve([])}var values=new Array(len);var resolved=0;var i=-1;var promise=new this(INTERNAL);while(++i<len){allResolver(iterable[i],i)}return promise;function allResolver(value,i){self.resolve(value).then(resolveFromAll,function(error){if(!called){called=true;handlers.reject(promise,error)}});function resolveFromAll(outValue){values[i]=outValue;if(++resolved===len&&!called){called=true;handlers.resolve(promise,values)}}}}exports.race=race;function race(iterable){var self=this;if(Object.prototype.toString.call(iterable)!=="[object Array]"){return this.reject(new TypeError("must be an array"))}var len=iterable.length;var called=false;if(!len){return this.resolve([])}var i=-1;var promise=new this(INTERNAL);while(++i<len){resolver(iterable[i])}return promise;function resolver(value){self.resolve(value).then(function(response){if(!called){called=true;handlers.resolve(promise,response)}},function(error){if(!called){called=true;handlers.reject(promise,error)}})}}},{"1":1}],3:[function(_dereq_,module,exports){(function(global){if(typeof global.Promise!=="function"){global.Promise=_dereq_(2)}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"2":2}],4:[function(_dereq_,module,exports){var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol?"symbol":typeof obj};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function getIDB(){if(typeof indexedDB!=="undefined"){return indexedDB}if(typeof webkitIndexedDB!=="undefined"){return webkitIndexedDB}if(typeof mozIndexedDB!=="undefined"){return mozIndexedDB}if(typeof OIndexedDB!=="undefined"){return OIndexedDB}if(typeof msIndexedDB!=="undefined"){return msIndexedDB}}var idb=getIDB();function isIndexedDBValid(){try{if(!idb){return false}if(typeof openDatabase!=="undefined"&&typeof navigator!=="undefined"&&navigator.userAgent&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)){return false}return idb&&typeof idb.open==="function"&&typeof IDBKeyRange!=="undefined"}catch(e){return false}}function isWebSQLValid(){return typeof openDatabase==="function"}function isLocalStorageValid(){try{return typeof localStorage!=="undefined"&&"setItem" in localStorage&&localStorage.setItem}catch(e){return false}}function createBlob(parts,properties){parts=parts||[];properties=properties||{};try{return new Blob(parts,properties)}catch(e){if(e.name!=="TypeError"){throw e}var Builder=typeof BlobBuilder!=="undefined"?BlobBuilder:typeof MSBlobBuilder!=="undefined"?MSBlobBuilder:typeof MozBlobBuilder!=="undefined"?MozBlobBuilder:WebKitBlobBuilder;var builder=new Builder();for(var i=0;i<parts.length;i+=1){builder.append(parts[i])}return builder.getBlob(properties.type)}}if(typeof Promise==="undefined"&&typeof _dereq_!=="undefined"){_dereq_(3)}var Promise$1=Promise;function executeCallback(promise,callback){if(callback){promise.then(function(result){callback(null,result)},function(error){callback(error)})}}function executeTwoCallbacks(promise,callback,errorCallback){if(typeof callback==="function"){promise.then(callback)}if(typeof errorCallback==="function"){promise["catch"](errorCallback)}}var DETECT_BLOB_SUPPORT_STORE="local-forage-detect-blob-support";var supportsBlobs;var dbContexts;var toString=Object.prototype.toString;function _binStringToArrayBuffer(bin){var length=bin.length;var buf=new ArrayBuffer(length);var arr=new Uint8Array(buf);for(var i=0;i<length;i++){arr[i]=bin.charCodeAt(i)}return buf}function _checkBlobSupportWithoutCaching(txn){return new Promise$1(function(resolve){var blob=createBlob([""]);txn.objectStore(DETECT_BLOB_SUPPORT_STORE).put(blob,"key");txn.onabort=function(e){e.preventDefault();e.stopPropagation();resolve(false)};txn.oncomplete=function(){var matchedChrome=navigator.userAgent.match(/Chrome\/(\d+)/);var matchedEdge=navigator.userAgent.match(/Edge\//);resolve(matchedEdge||!matchedChrome||parseInt(matchedChrome[1],10)>=43)}})["catch"](function(){return false})}function _checkBlobSupport(idb){if(typeof supportsBlobs==="boolean"){return Promise$1.resolve(supportsBlobs)}return _checkBlobSupportWithoutCaching(idb).then(function(value){supportsBlobs=value;return supportsBlobs})}function _deferReadiness(dbInfo){var dbContext=dbContexts[dbInfo.name];var deferredOperation={};deferredOperation.promise=new Promise$1(function(resolve){deferredOperation.resolve=resolve});dbContext.deferredOperations.push(deferredOperation);if(!dbContext.dbReady){dbContext.dbReady=deferredOperation.promise}else{dbContext.dbReady=dbContext.dbReady.then(function(){return deferredOperation.promise})}}function _advanceReadiness(dbInfo){var dbContext=dbContexts[dbInfo.name];var deferredOperation=dbContext.deferredOperations.pop();if(deferredOperation){deferredOperation.resolve()}}function _getConnection(dbInfo,upgradeNeeded){return new Promise$1(function(resolve,reject){if(dbInfo.db){if(upgradeNeeded){_deferReadiness(dbInfo);dbInfo.db.close()}else{return resolve(dbInfo.db)}}var dbArgs=[dbInfo.name];if(upgradeNeeded){dbArgs.push(dbInfo.version)}var openreq=idb.open.apply(idb,dbArgs);if(upgradeNeeded){openreq.onupgradeneeded=function(e){var db=openreq.result;try{db.createObjectStore(dbInfo.storeName);if(e.oldVersion<=1){db.createObjectStore(DETECT_BLOB_SUPPORT_STORE)}}catch(ex){if(ex.name==="ConstraintError"){console.warn('The database "'+dbInfo.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+dbInfo.storeName+'" already exists.')}else{throw ex}}}}openreq.onerror=function(){reject(openreq.error)};openreq.onsuccess=function(){resolve(openreq.result);_advanceReadiness(dbInfo)}})}function _getOriginalConnection(dbInfo){return _getConnection(dbInfo,false)}function _getUpgradedConnection(dbInfo){return _getConnection(dbInfo,true)}function _isUpgradeNeeded(dbInfo,defaultVersion){if(!dbInfo.db){return true}var isNewStore=!dbInfo.db.objectStoreNames.contains(dbInfo.storeName);var isDowngrade=dbInfo.version<dbInfo.db.version;var isUpgrade=dbInfo.version>dbInfo.db.version;if(isDowngrade){if(dbInfo.version!==defaultVersion){console.warn('The database "'+dbInfo.name+"\" can't be downgraded from version "+dbInfo.db.version+" to version "+dbInfo.version+".")}dbInfo.version=dbInfo.db.version}if(isUpgrade||isNewStore){if(isNewStore){var incVersion=dbInfo.db.version+1;if(incVersion>dbInfo.version){dbInfo.version=incVersion}}return true}return false}function _encodeBlob(blob){return new Promise$1(function(resolve,reject){var reader=new FileReader();reader.onerror=reject;reader.onloadend=function(e){var base64=btoa(e.target.result||"");resolve({__local_forage_encoded_blob:true,data:base64,type:blob.type})};reader.readAsBinaryString(blob)})}function _decodeBlob(encodedBlob){var arrayBuff=_binStringToArrayBuffer(atob(encodedBlob.data));return createBlob([arrayBuff],{type:encodedBlob.type})}function _isEncodedBlob(value){return value&&value.__local_forage_encoded_blob}function _fullyReady(callback){var self=this;var promise=self._initReady().then(function(){var dbContext=dbContexts[self._dbInfo.name];if(dbContext&&dbContext.dbReady){return dbContext.dbReady}});executeTwoCallbacks(promise,callback,callback);return promise}function _initStorage(options){var self=this;var dbInfo={db:null};if(options){for(var i in options){dbInfo[i]=options[i]}}if(!dbContexts){dbContexts={}}var dbContext=dbContexts[dbInfo.name];if(!dbContext){dbContext={forages:[],db:null,dbReady:null,deferredOperations:[]};dbContexts[dbInfo.name]=dbContext}dbContext.forages.push(self);if(!self._initReady){self._initReady=self.ready;self.ready=_fullyReady}var initPromises=[];function ignoreErrors(){return Promise$1.resolve()}for(var j=0;j<dbContext.forages.length;j++){var forage=dbContext.forages[j];if(forage!==self){initPromises.push(forage._initReady()["catch"](ignoreErrors))}}var forages=dbContext.forages.slice(0);return Promise$1.all(initPromises).then(function(){dbInfo.db=dbContext.db;return _getOriginalConnection(dbInfo)}).then(function(db){dbInfo.db=db;if(_isUpgradeNeeded(dbInfo,self._defaultConfig.version)){return _getUpgradedConnection(dbInfo)}return db}).then(function(db){dbInfo.db=dbContext.db=db;self._dbInfo=dbInfo;for(var k=0;k<forages.length;k++){var forage=forages[k];if(forage!==self){forage._dbInfo.db=dbInfo.db;forage._dbInfo.version=dbInfo.version}}})}function getItem(key,callback){var self=this;if(typeof key!=="string"){console.warn(key+" used as a key, but it is not a string.");key=String(key)}var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;var store=dbInfo.db.transaction(dbInfo.storeName,"readonly").objectStore(dbInfo.storeName);var req=store.get(key);req.onsuccess=function(){var value=req.result;if(value===undefined){value=null}if(_isEncodedBlob(value)){value=_decodeBlob(value)}resolve(value)};req.onerror=function(){reject(req.error)}})["catch"](reject)});executeCallback(promise,callback);return promise}function iterate(iterator,callback){var self=this;var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;var store=dbInfo.db.transaction(dbInfo.storeName,"readonly").objectStore(dbInfo.storeName);var req=store.openCursor();var iterationNumber=1;req.onsuccess=function(){var cursor=req.result;if(cursor){var value=cursor.value;if(_isEncodedBlob(value)){value=_decodeBlob(value)}var result=iterator(value,cursor.key,iterationNumber++);if(result!==void 0){resolve(result)}else{cursor["continue"]()}}else{resolve()}};req.onerror=function(){reject(req.error)}})["catch"](reject)});executeCallback(promise,callback);return promise}function setItem(key,value,callback){var self=this;if(typeof key!=="string"){console.warn(key+" used as a key, but it is not a string.");key=String(key)}var promise=new Promise$1(function(resolve,reject){var dbInfo;self.ready().then(function(){dbInfo=self._dbInfo;if(toString.call(value)==="[object Blob]"){return _checkBlobSupport(dbInfo.db).then(function(blobSupport){if(blobSupport){return value}return _encodeBlob(value)})}return value}).then(function(value){var transaction=dbInfo.db.transaction(dbInfo.storeName,"readwrite");var store=transaction.objectStore(dbInfo.storeName);if(value===null){value=undefined}transaction.oncomplete=function(){if(value===undefined){value=null}resolve(value)};transaction.onabort=transaction.onerror=function(){var err=req.error?req.error:req.transaction.error;reject(err)};var req=store.put(value,key)})["catch"](reject)});executeCallback(promise,callback);return promise}function removeItem(key,callback){var self=this;if(typeof key!=="string"){console.warn(key+" used as a key, but it is not a string.");key=String(key)}var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;var transaction=dbInfo.db.transaction(dbInfo.storeName,"readwrite");var store=transaction.objectStore(dbInfo.storeName);var req=store["delete"](key);transaction.oncomplete=function(){resolve()};transaction.onerror=function(){reject(req.error)};transaction.onabort=function(){var err=req.error?req.error:req.transaction.error;reject(err)}})["catch"](reject)});executeCallback(promise,callback);return promise}function clear(callback){var self=this;var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;var transaction=dbInfo.db.transaction(dbInfo.storeName,"readwrite");var store=transaction.objectStore(dbInfo.storeName);var req=store.clear();transaction.oncomplete=function(){resolve()};transaction.onabort=transaction.onerror=function(){var err=req.error?req.error:req.transaction.error;reject(err)}})["catch"](reject)});executeCallback(promise,callback);return promise}function length(callback){var self=this;var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;var store=dbInfo.db.transaction(dbInfo.storeName,"readonly").objectStore(dbInfo.storeName);var req=store.count();req.onsuccess=function(){resolve(req.result)};req.onerror=function(){reject(req.error)}})["catch"](reject)});executeCallback(promise,callback);return promise}function key(n,callback){var self=this;var promise=new Promise$1(function(resolve,reject){if(n<0){resolve(null);return}self.ready().then(function(){var dbInfo=self._dbInfo;var store=dbInfo.db.transaction(dbInfo.storeName,"readonly").objectStore(dbInfo.storeName);var advanced=false;var req=store.openCursor();req.onsuccess=function(){var cursor=req.result;if(!cursor){resolve(null);return}if(n===0){resolve(cursor.key)}else{if(!advanced){advanced=true;cursor.advance(n)}else{resolve(cursor.key)}}};req.onerror=function(){reject(req.error)}})["catch"](reject)});executeCallback(promise,callback);return promise}function keys(callback){var self=this;var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;var store=dbInfo.db.transaction(dbInfo.storeName,"readonly").objectStore(dbInfo.storeName);var req=store.openCursor();var keys=[];req.onsuccess=function(){var cursor=req.result;if(!cursor){resolve(keys);return}keys.push(cursor.key);cursor["continue"]()};req.onerror=function(){reject(req.error)}})["catch"](reject)});executeCallback(promise,callback);return promise}var asyncStorage={_driver:"asyncStorage",_initStorage:_initStorage,iterate:iterate,getItem:getItem,setItem:setItem,removeItem:removeItem,clear:clear,length:length,key:key,keys:keys};var BASE_CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var BLOB_TYPE_PREFIX="~~local_forage_type~";var BLOB_TYPE_PREFIX_REGEX=/^~~local_forage_type~([^~]+)~/;var SERIALIZED_MARKER="__lfsc__:";var SERIALIZED_MARKER_LENGTH=SERIALIZED_MARKER.length;var TYPE_ARRAYBUFFER="arbf";var TYPE_BLOB="blob";var TYPE_INT8ARRAY="si08";var TYPE_UINT8ARRAY="ui08";var TYPE_UINT8CLAMPEDARRAY="uic8";var TYPE_INT16ARRAY="si16";var TYPE_INT32ARRAY="si32";var TYPE_UINT16ARRAY="ur16";var TYPE_UINT32ARRAY="ui32";var TYPE_FLOAT32ARRAY="fl32";var TYPE_FLOAT64ARRAY="fl64";var TYPE_SERIALIZED_MARKER_LENGTH=SERIALIZED_MARKER_LENGTH+TYPE_ARRAYBUFFER.length;var toString$1=Object.prototype.toString;function stringToBuffer(serializedString){var bufferLength=serializedString.length*0.75;var len=serializedString.length;var i;var p=0;var encoded1,encoded2,encoded3,encoded4;if(serializedString[serializedString.length-1]==="="){bufferLength--;if(serializedString[serializedString.length-2]==="="){bufferLength--}}var buffer=new ArrayBuffer(bufferLength);var bytes=new Uint8Array(buffer);for(i=0;i<len;i+=4){encoded1=BASE_CHARS.indexOf(serializedString[i]);encoded2=BASE_CHARS.indexOf(serializedString[i+1]);encoded3=BASE_CHARS.indexOf(serializedString[i+2]);encoded4=BASE_CHARS.indexOf(serializedString[i+3]);bytes[p++]=encoded1<<2|encoded2>>4;bytes[p++]=(encoded2&15)<<4|encoded3>>2;bytes[p++]=(encoded3&3)<<6|encoded4&63}return buffer}function bufferToString(buffer){var bytes=new Uint8Array(buffer);var base64String="";var i;for(i=0;i<bytes.length;i+=3){base64String+=BASE_CHARS[bytes[i]>>2];base64String+=BASE_CHARS[(bytes[i]&3)<<4|bytes[i+1]>>4];base64String+=BASE_CHARS[(bytes[i+1]&15)<<2|bytes[i+2]>>6];base64String+=BASE_CHARS[bytes[i+2]&63]}if(bytes.length%3===2){base64String=base64String.substring(0,base64String.length-1)+"="}else{if(bytes.length%3===1){base64String=base64String.substring(0,base64String.length-2)+"=="}}return base64String}function serialize(value,callback){var valueType="";if(value){valueType=toString$1.call(value)}if(value&&(valueType==="[object ArrayBuffer]"||value.buffer&&toString$1.call(value.buffer)==="[object ArrayBuffer]")){var buffer;var marker=SERIALIZED_MARKER;if(value instanceof ArrayBuffer){buffer=value;marker+=TYPE_ARRAYBUFFER}else{buffer=value.buffer;if(valueType==="[object Int8Array]"){marker+=TYPE_INT8ARRAY}else{if(valueType==="[object Uint8Array]"){marker+=TYPE_UINT8ARRAY}else{if(valueType==="[object Uint8ClampedArray]"){marker+=TYPE_UINT8CLAMPEDARRAY}else{if(valueType==="[object Int16Array]"){marker+=TYPE_INT16ARRAY}else{if(valueType==="[object Uint16Array]"){marker+=TYPE_UINT16ARRAY}else{if(valueType==="[object Int32Array]"){marker+=TYPE_INT32ARRAY}else{if(valueType==="[object Uint32Array]"){marker+=TYPE_UINT32ARRAY}else{if(valueType==="[object Float32Array]"){marker+=TYPE_FLOAT32ARRAY}else{if(valueType==="[object Float64Array]"){marker+=TYPE_FLOAT64ARRAY}else{callback(new Error("Failed to get type for BinaryArray"))}}}}}}}}}}callback(marker+bufferToString(buffer))}else{if(valueType==="[object Blob]"){var fileReader=new FileReader();fileReader.onload=function(){var str=BLOB_TYPE_PREFIX+value.type+"~"+bufferToString(this.result);callback(SERIALIZED_MARKER+TYPE_BLOB+str)};fileReader.readAsArrayBuffer(value)}else{try{callback(JSON.stringify(value))}catch(e){console.error("Couldn't convert value into a JSON string: ",value);callback(null,e)}}}}function deserialize(value){if(value.substring(0,SERIALIZED_MARKER_LENGTH)!==SERIALIZED_MARKER){return JSON.parse(value)}var serializedString=value.substring(TYPE_SERIALIZED_MARKER_LENGTH);var type=value.substring(SERIALIZED_MARKER_LENGTH,TYPE_SERIALIZED_MARKER_LENGTH);var blobType;if(type===TYPE_BLOB&&BLOB_TYPE_PREFIX_REGEX.test(serializedString)){var matcher=serializedString.match(BLOB_TYPE_PREFIX_REGEX);blobType=matcher[1];serializedString=serializedString.substring(matcher[0].length)}var buffer=stringToBuffer(serializedString);switch(type){case TYPE_ARRAYBUFFER:return buffer;case TYPE_BLOB:return createBlob([buffer],{type:blobType});case TYPE_INT8ARRAY:return new Int8Array(buffer);case TYPE_UINT8ARRAY:return new Uint8Array(buffer);case TYPE_UINT8CLAMPEDARRAY:return new Uint8ClampedArray(buffer);case TYPE_INT16ARRAY:return new Int16Array(buffer);case TYPE_UINT16ARRAY:return new Uint16Array(buffer);case TYPE_INT32ARRAY:return new Int32Array(buffer);case TYPE_UINT32ARRAY:return new Uint32Array(buffer);case TYPE_FLOAT32ARRAY:return new Float32Array(buffer);case TYPE_FLOAT64ARRAY:return new Float64Array(buffer);default:throw new Error("Unkown type: "+type)}}var localforageSerializer={serialize:serialize,deserialize:deserialize,stringToBuffer:stringToBuffer,bufferToString:bufferToString};function _initStorage$1(options){var self=this;var dbInfo={db:null};if(options){for(var i in options){dbInfo[i]=typeof options[i]!=="string"?options[i].toString():options[i]}}var dbInfoPromise=new Promise$1(function(resolve,reject){try{dbInfo.db=openDatabase(dbInfo.name,String(dbInfo.version),dbInfo.description,dbInfo.size)}catch(e){return reject(e)}dbInfo.db.transaction(function(t){t.executeSql("CREATE TABLE IF NOT EXISTS "+dbInfo.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){self._dbInfo=dbInfo;resolve()},function(t,error){reject(error)})})});dbInfo.serializer=localforageSerializer;return dbInfoPromise}function getItem$1(key,callback){var self=this;if(typeof key!=="string"){console.warn(key+" used as a key, but it is not a string.");key=String(key)}var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT * FROM "+dbInfo.storeName+" WHERE key = ? LIMIT 1",[key],function(t,results){var result=results.rows.length?results.rows.item(0).value:null;if(result){result=dbInfo.serializer.deserialize(result)}resolve(result)},function(t,error){reject(error)})})})["catch"](reject)});executeCallback(promise,callback);return promise}function iterate$1(iterator,callback){var self=this;var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT * FROM "+dbInfo.storeName,[],function(t,results){var rows=results.rows;var length=rows.length;for(var i=0;i<length;i++){var item=rows.item(i);var result=item.value;if(result){result=dbInfo.serializer.deserialize(result)}result=iterator(result,item.key,i+1);if(result!==void 0){resolve(result);return}}resolve()},function(t,error){reject(error)})})})["catch"](reject)});executeCallback(promise,callback);return promise}function setItem$1(key,value,callback){var self=this;if(typeof key!=="string"){console.warn(key+" used as a key, but it is not a string.");key=String(key)}var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){if(value===undefined){value=null}var originalValue=value;var dbInfo=self._dbInfo;dbInfo.serializer.serialize(value,function(value,error){if(error){reject(error)}else{dbInfo.db.transaction(function(t){t.executeSql("INSERT OR REPLACE INTO "+dbInfo.storeName+" (key, value) VALUES (?, ?)",[key,value],function(){resolve(originalValue)},function(t,error){reject(error)})},function(sqlError){if(sqlError.code===sqlError.QUOTA_ERR){reject(sqlError)}})}})})["catch"](reject)});executeCallback(promise,callback);return promise}function removeItem$1(key,callback){var self=this;if(typeof key!=="string"){console.warn(key+" used as a key, but it is not a string.");key=String(key)}var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("DELETE FROM "+dbInfo.storeName+" WHERE key = ?",[key],function(){resolve()},function(t,error){reject(error)})})})["catch"](reject)});executeCallback(promise,callback);return promise}function clear$1(callback){var self=this;var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("DELETE FROM "+dbInfo.storeName,[],function(){resolve()},function(t,error){reject(error)})})})["catch"](reject)});executeCallback(promise,callback);return promise}function length$1(callback){var self=this;var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT COUNT(key) as c FROM "+dbInfo.storeName,[],function(t,results){var result=results.rows.item(0).c;resolve(result)},function(t,error){reject(error)})})})["catch"](reject)});executeCallback(promise,callback);return promise}function key$1(n,callback){var self=this;var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT key FROM "+dbInfo.storeName+" WHERE id = ? LIMIT 1",[n+1],function(t,results){var result=results.rows.length?results.rows.item(0).key:null;resolve(result)},function(t,error){reject(error)})})})["catch"](reject)});executeCallback(promise,callback);return promise}function keys$1(callback){var self=this;var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT key FROM "+dbInfo.storeName,[],function(t,results){var keys=[];for(var i=0;i<results.rows.length;i++){keys.push(results.rows.item(i).key)}resolve(keys)},function(t,error){reject(error)})})})["catch"](reject)});executeCallback(promise,callback);return promise}var webSQLStorage={_driver:"webSQLStorage",_initStorage:_initStorage$1,iterate:iterate$1,getItem:getItem$1,setItem:setItem$1,removeItem:removeItem$1,clear:clear$1,length:length$1,key:key$1,keys:keys$1};function _initStorage$2(options){var self=this;var dbInfo={};if(options){for(var i in options){dbInfo[i]=options[i]}}dbInfo.keyPrefix=dbInfo.name+"/";if(dbInfo.storeName!==self._defaultConfig.storeName){dbInfo.keyPrefix+=dbInfo.storeName+"/"}self._dbInfo=dbInfo;dbInfo.serializer=localforageSerializer;return Promise$1.resolve()}function clear$2(callback){var self=this;var promise=self.ready().then(function(){var keyPrefix=self._dbInfo.keyPrefix;for(var i=localStorage.length-1;i>=0;i--){var key=localStorage.key(i);if(key.indexOf(keyPrefix)===0){localStorage.removeItem(key)}}});executeCallback(promise,callback);return promise}function getItem$2(key,callback){var self=this;if(typeof key!=="string"){console.warn(key+" used as a key, but it is not a string.");key=String(key)}var promise=self.ready().then(function(){var dbInfo=self._dbInfo;var result=localStorage.getItem(dbInfo.keyPrefix+key);if(result){result=dbInfo.serializer.deserialize(result)}return result});executeCallback(promise,callback);return promise}function iterate$2(iterator,callback){var self=this;var promise=self.ready().then(function(){var dbInfo=self._dbInfo;var keyPrefix=dbInfo.keyPrefix;var keyPrefixLength=keyPrefix.length;var length=localStorage.length;var iterationNumber=1;for(var i=0;i<length;i++){var key=localStorage.key(i);if(key.indexOf(keyPrefix)!==0){continue}var value=localStorage.getItem(key);if(value){value=dbInfo.serializer.deserialize(value)}value=iterator(value,key.substring(keyPrefixLength),iterationNumber++);if(value!==void 0){return value}}});executeCallback(promise,callback);return promise}function key$2(n,callback){var self=this;var promise=self.ready().then(function(){var dbInfo=self._dbInfo;var result;try{result=localStorage.key(n)}catch(error){result=null}if(result){result=result.substring(dbInfo.keyPrefix.length)}return result});executeCallback(promise,callback);return promise}function keys$2(callback){var self=this;var promise=self.ready().then(function(){var dbInfo=self._dbInfo;var length=localStorage.length;var keys=[];for(var i=0;i<length;i++){if(localStorage.key(i).indexOf(dbInfo.keyPrefix)===0){keys.push(localStorage.key(i).substring(dbInfo.keyPrefix.length))}}return keys});executeCallback(promise,callback);return promise}function length$2(callback){var self=this;var promise=self.keys().then(function(keys){return keys.length});executeCallback(promise,callback);return promise}function removeItem$2(key,callback){var self=this;if(typeof key!=="string"){console.warn(key+" used as a key, but it is not a string.");key=String(key)}var promise=self.ready().then(function(){var dbInfo=self._dbInfo;localStorage.removeItem(dbInfo.keyPrefix+key)});executeCallback(promise,callback);return promise}function setItem$2(key,value,callback){var self=this;if(typeof key!=="string"){console.warn(key+" used as a key, but it is not a string.");key=String(key)}var promise=self.ready().then(function(){if(value===undefined){value=null}var originalValue=value;return new Promise$1(function(resolve,reject){var dbInfo=self._dbInfo;dbInfo.serializer.serialize(value,function(value,error){if(error){reject(error)}else{try{localStorage.setItem(dbInfo.keyPrefix+key,value);resolve(originalValue)}catch(e){if(e.name==="QuotaExceededError"||e.name==="NS_ERROR_DOM_QUOTA_REACHED"){reject(e)}reject(e)}}})})});executeCallback(promise,callback);return promise}var localStorageWrapper={_driver:"localStorageWrapper",_initStorage:_initStorage$2,iterate:iterate$2,getItem:getItem$2,setItem:setItem$2,removeItem:removeItem$2,clear:clear$2,length:length$2,key:key$2,keys:keys$2};var CustomDrivers={};var DriverType={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"};var DefaultDriverOrder=[DriverType.INDEXEDDB,DriverType.WEBSQL,DriverType.LOCALSTORAGE];var LibraryMethods=["clear","getItem","iterate","key","keys","length","removeItem","setItem"];var DefaultConfig={description:"",driver:DefaultDriverOrder.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};var driverSupport={};driverSupport[DriverType.INDEXEDDB]=isIndexedDBValid();driverSupport[DriverType.WEBSQL]=isWebSQLValid();driverSupport[DriverType.LOCALSTORAGE]=isLocalStorageValid();var isArray=Array.isArray||function(arg){return Object.prototype.toString.call(arg)==="[object Array]"};function callWhenReady(localForageInstance,libraryMethod){localForageInstance[libraryMethod]=function(){var _args=arguments;return localForageInstance.ready().then(function(){return localForageInstance[libraryMethod].apply(localForageInstance,_args)})}}function extend(){for(var i=1;i<arguments.length;i++){var arg=arguments[i];if(arg){for(var key in arg){if(arg.hasOwnProperty(key)){if(isArray(arg[key])){arguments[0][key]=arg[key].slice()}else{arguments[0][key]=arg[key]}}}}}return arguments[0]}function isLibraryDriver(driverName){for(var driver in DriverType){if(DriverType.hasOwnProperty(driver)&&DriverType[driver]===driverName){return true}}return false}var LocalForage=function(){function LocalForage(options){_classCallCheck(this,LocalForage);this.INDEXEDDB=DriverType.INDEXEDDB;this.LOCALSTORAGE=DriverType.LOCALSTORAGE;this.WEBSQL=DriverType.WEBSQL;this._defaultConfig=extend({},DefaultConfig);this._config=extend({},this._defaultConfig,options);this._driverSet=null;this._initDriver=null;this._ready=false;this._dbInfo=null;this._wrapLibraryMethodsWithReady();this.setDriver(this._config.driver)}LocalForage.prototype.config=function config(options){if((typeof options==="undefined"?"undefined":_typeof(options))==="object"){if(this._ready){return new Error("Can't call config() after localforage has been used.")}for(var i in options){if(i==="storeName"){options[i]=options[i].replace(/\W/g,"_")}this._config[i]=options[i]}if("driver" in options&&options.driver){this.setDriver(this._config.driver)}return true}else{if(typeof options==="string"){return this._config[options]}else{return this._config}}};LocalForage.prototype.defineDriver=function defineDriver(driverObject,callback,errorCallback){var promise=new Promise$1(function(resolve,reject){try{var driverName=driverObject._driver;var complianceError=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");var namingError=new Error("Custom driver name already in use: "+driverObject._driver);if(!driverObject._driver){reject(complianceError);return}if(isLibraryDriver(driverObject._driver)){reject(namingError);return}var customDriverMethods=LibraryMethods.concat("_initStorage");for(var i=0;i<customDriverMethods.length;i++){var customDriverMethod=customDriverMethods[i];if(!customDriverMethod||!driverObject[customDriverMethod]||typeof driverObject[customDriverMethod]!=="function"){reject(complianceError);return}}var supportPromise=Promise$1.resolve(true);if("_support" in driverObject){if(driverObject._support&&typeof driverObject._support==="function"){supportPromise=driverObject._support()}else{supportPromise=Promise$1.resolve(!!driverObject._support)}}supportPromise.then(function(supportResult){driverSupport[driverName]=supportResult;CustomDrivers[driverName]=driverObject;resolve()},reject)}catch(e){reject(e)}});executeTwoCallbacks(promise,callback,errorCallback);return promise};LocalForage.prototype.driver=function driver(){return this._driver||null};LocalForage.prototype.getDriver=function getDriver(driverName,callback,errorCallback){var self=this;var getDriverPromise=Promise$1.resolve().then(function(){if(isLibraryDriver(driverName)){switch(driverName){case self.INDEXEDDB:return asyncStorage;case self.LOCALSTORAGE:return localStorageWrapper;case self.WEBSQL:return webSQLStorage}}else{if(CustomDrivers[driverName]){return CustomDrivers[driverName]}else{throw new Error("Driver not found.")}}});executeTwoCallbacks(getDriverPromise,callback,errorCallback);return getDriverPromise};LocalForage.prototype.getSerializer=function getSerializer(callback){var serializerPromise=Promise$1.resolve(localforageSerializer);executeTwoCallbacks(serializerPromise,callback);return serializerPromise};LocalForage.prototype.ready=function ready(callback){var self=this;var promise=self._driverSet.then(function(){if(self._ready===null){self._ready=self._initDriver()}return self._ready});executeTwoCallbacks(promise,callback,callback);return promise};LocalForage.prototype.setDriver=function setDriver(drivers,callback,errorCallback){var self=this;if(!isArray(drivers)){drivers=[drivers]}var supportedDrivers=this._getSupportedDrivers(drivers);function setDriverToConfig(){self._config.driver=self.driver()}function initDriver(supportedDrivers){return function(){var currentDriverIndex=0;function driverPromiseLoop(){while(currentDriverIndex<supportedDrivers.length){var driverName=supportedDrivers[currentDriverIndex];currentDriverIndex++;self._dbInfo=null;self._ready=null;return self.getDriver(driverName).then(function(driver){self._extend(driver);setDriverToConfig();self._ready=self._initStorage(self._config);return self._ready})["catch"](driverPromiseLoop)}setDriverToConfig();var error=new Error("No available storage method found.");self._driverSet=Promise$1.reject(error);return self._driverSet}return driverPromiseLoop()}}var oldDriverSetDone=this._driverSet!==null?this._driverSet["catch"](function(){return Promise$1.resolve()}):Promise$1.resolve();this._driverSet=oldDriverSetDone.then(function(){var driverName=supportedDrivers[0];self._dbInfo=null;self._ready=null;return self.getDriver(driverName).then(function(driver){self._driver=driver._driver;setDriverToConfig();self._wrapLibraryMethodsWithReady();self._initDriver=initDriver(supportedDrivers)})})["catch"](function(){setDriverToConfig();var error=new Error("No available storage method found.");self._driverSet=Promise$1.reject(error);return self._driverSet});executeTwoCallbacks(this._driverSet,callback,errorCallback);return this._driverSet};LocalForage.prototype.supports=function supports(driverName){return !!driverSupport[driverName]};LocalForage.prototype._extend=function _extend(libraryMethodsAndProperties){extend(this,libraryMethodsAndProperties)};LocalForage.prototype._getSupportedDrivers=function _getSupportedDrivers(drivers){var supportedDrivers=[];for(var i=0,len=drivers.length;i<len;i++){var driverName=drivers[i];if(this.supports(driverName)){supportedDrivers.push(driverName)}}return supportedDrivers};LocalForage.prototype._wrapLibraryMethodsWithReady=function _wrapLibraryMethodsWithReady(){for(var i=0;i<LibraryMethods.length;i++){callWhenReady(this,LibraryMethods[i])}};LocalForage.prototype.createInstance=function createInstance(options){return new LocalForage(options)};return LocalForage}();var localforage_js=new LocalForage();module.exports=localforage_js},{"3":3}]},{},[4])(4)});(function(){var Promise=(typeof module!=="undefined"&&module.exports)?require("promise"):this.Promise;var globalObject=this;var serializer=null;var sessionStorage=null;function getSupport(){try{if(globalObject.sessionStorage&&("setItem" in globalObject.sessionStorage)){return true}}catch(e){}return false}if(getSupport()){sessionStorage=this.sessionStorage}else{return}var ModuleType={DEFINE:1,EXPORT:2,WINDOW:3};var moduleType=ModuleType.WINDOW;if(typeof define==="function"&&define.amd){moduleType=ModuleType.DEFINE}else{if(typeof module!=="undefined"&&module.exports){moduleType=ModuleType.EXPORT}}function _initStorage(options){var self=this;var dbInfo={};if(options){for(var i in options){dbInfo[i]=options[i]}}dbInfo.keyPrefix=dbInfo.name+"/";self._dbInfo=dbInfo;var serializerPromise=new Promise(function(resolve,reject){if(typeof self.getSerializer==="function"){self.getSerializer().then(resolve,reject);return}if(moduleType===ModuleType.DEFINE){require(["localforageSerializer"],resolve)}else{if(moduleType===ModuleType.EXPORT){resolve(require("./../utils/serializer"))}else{resolve(globalObject.localforageSerializer)}}});return serializerPromise.then(function(lib){serializer=lib;return Promise.resolve()})}function clear(callback){var self=this;var promise=self.ready().then(function(){var keyPrefix=self._dbInfo.keyPrefix;for(var i=sessionStorage.length-1;i>=0;i--){var key=sessionStorage.key(i);if(key.indexOf(keyPrefix)===0){sessionStorage.removeItem(key)}}});executeCallback(promise,callback);return promise}function getItem(key,callback){var self=this;if(typeof key!=="string"){window.console.warn(key+" used as a key, but it is not a string.");key=String(key)}var promise=self.ready().then(function(){var dbInfo=self._dbInfo;var result=sessionStorage.getItem(dbInfo.keyPrefix+key);if(result){result=serializer.deserialize(result)}return result});executeCallback(promise,callback);return promise}function iterate(iterator,callback){var self=this;var promise=self.ready().then(function(){var keyPrefix=self._dbInfo.keyPrefix;var keyPrefixLength=keyPrefix.length;var length=sessionStorage.length;for(var i=0;i<length;i++){var key=sessionStorage.key(i);var value=sessionStorage.getItem(key);if(value){value=serializer.deserialize(value)}value=iterator(value,key.substring(keyPrefixLength),i+1);if(value!==void (0)){return value}}});executeCallback(promise,callback);return promise}function key(n,callback){var self=this;var promise=self.ready().then(function(){var dbInfo=self._dbInfo;var result;try{result=sessionStorage.key(n)}catch(error){result=null}if(result){result=result.substring(dbInfo.keyPrefix.length)}return result});executeCallback(promise,callback);return promise}function keys(callback){var self=this;var promise=self.ready().then(function(){var dbInfo=self._dbInfo;var length=sessionStorage.length;var keys=[];for(var i=0;i<length;i++){if(sessionStorage.key(i).indexOf(dbInfo.keyPrefix)===0){keys.push(sessionStorage.key(i).substring(dbInfo.keyPrefix.length))}}return keys});executeCallback(promise,callback);return promise}function length(callback){var self=this;var promise=self.keys().then(function(keys){return keys.length});executeCallback(promise,callback);return promise}function removeItem(key,callback){var self=this;if(typeof key!=="string"){window.console.warn(key+" used as a key, but it is not a string.");key=String(key)}var promise=self.ready().then(function(){var dbInfo=self._dbInfo;sessionStorage.removeItem(dbInfo.keyPrefix+key)});executeCallback(promise,callback);return promise}function setItem(key,value,callback){var self=this;if(typeof key!=="string"){window.console.warn(key+" used as a key, but it is not a string.");key=String(key)}var promise=self.ready().then(function(){if(value===undefined){value=null}var originalValue=value;return new Promise(function(resolve,reject){serializer.serialize(value,function(value,error){if(error){reject(error)}else{try{var dbInfo=self._dbInfo;sessionStorage.setItem(dbInfo.keyPrefix+key,value);resolve(originalValue)}catch(e){if(e.name==="QuotaExceededError"||e.name==="NS_ERROR_DOM_QUOTA_REACHED"){reject(e)}reject(e)}}})})});executeCallback(promise,callback);return promise}function executeCallback(promise,callback){if(callback){promise.then(function(result){callback(null,result)},function(error){callback(error)})}}var sessionStorageWrapper={_driver:"sessionStorageWrapper",_initStorage:_initStorage,_support:function(){return new Promise(function(resolve){resolve(getSupport())})},iterate:iterate,getItem:getItem,setItem:setItem,removeItem:removeItem,clear:clear,length:length,key:key,keys:keys};if(moduleType===ModuleType.DEFINE){define("sessionStorageWrapper",function(){return sessionStorageWrapper})}else{if(moduleType===ModuleType.EXPORT){module.exports=sessionStorageWrapper}else{this.sessionStorageWrapper=sessionStorageWrapper}}}).call(window);window.cadesplugin_skip_extension_install=true;window.allow_firefox_cadesplugin_async=1;(function(){if(!window.FogSoftSignerOptions||window.FogSoftSignerOptions.UseDigitalSignature==="False"){return}if(window.cadesplugin){return}var pluginObject;var plugin_resolved=0;var plugin_reject;var plugin_resolve;var isOpera=0;var isYaBrowser=0;var isFireFox=0;var failed_extensions=0;var canPromise=!!window.Promise;var cadesplugin;if(canPromise){cadesplugin=new Promise(function(resolve,reject){plugin_resolve=resolve;plugin_reject=reject})}else{cadesplugin={}}function cpcsp_console_log(level,msg){if(typeof(console)=="undefined"){return}if(level<=cadesplugin.current_log_level){if(level==cadesplugin.LOG_LEVEL_DEBUG){console.log("DEBUG: %s",msg)}if(level==cadesplugin.LOG_LEVEL_INFO){console.info("INFO: %s",msg)}if(level==cadesplugin.LOG_LEVEL_ERROR){console.error("ERROR: %s",msg)}return}}function set_log_level(level){if(!((level==cadesplugin.LOG_LEVEL_DEBUG)||(level==cadesplugin.LOG_LEVEL_INFO)||(level==cadesplugin.LOG_LEVEL_ERROR))){cpcsp_console_log(cadesplugin.LOG_LEVEL_ERROR,"cadesplugin_api.js: Incorrect log_level: "+level);return}cadesplugin.current_log_level=level;if(cadesplugin.current_log_level==cadesplugin.LOG_LEVEL_DEBUG){cpcsp_console_log(cadesplugin.LOG_LEVEL_INFO,"cadesplugin_api.js: log_level = DEBUG")}if(cadesplugin.current_log_level==cadesplugin.LOG_LEVEL_INFO){cpcsp_console_log(cadesplugin.LOG_LEVEL_INFO,"cadesplugin_api.js: log_level = INFO")}if(cadesplugin.current_log_level==cadesplugin.LOG_LEVEL_ERROR){cpcsp_console_log(cadesplugin.LOG_LEVEL_INFO,"cadesplugin_api.js: log_level = ERROR")}if(isNativeMessageSupported()){if(cadesplugin.current_log_level==cadesplugin.LOG_LEVEL_DEBUG){window.postMessage("set_log_level=debug","*")}if(cadesplugin.current_log_level==cadesplugin.LOG_LEVEL_INFO){window.postMessage("set_log_level=info","*")}if(cadesplugin.current_log_level==cadesplugin.LOG_LEVEL_ERROR){window.postMessage("set_log_level=error","*")}}}function set_constantValues(){cadesplugin.CAPICOM_LOCAL_MACHINE_STORE=1;cadesplugin.CAPICOM_CURRENT_USER_STORE=2;cadesplugin.CADESCOM_LOCAL_MACHINE_STORE=1;cadesplugin.CADESCOM_CURRENT_USER_STORE=2;cadesplugin.CADESCOM_CONTAINER_STORE=100;cadesplugin.CAPICOM_MY_STORE="My";cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED=2;cadesplugin.CAPICOM_CERTIFICATE_FIND_SUBJECT_NAME=1;cadesplugin.CADESCOM_XML_SIGNATURE_TYPE_ENVELOPED=0;cadesplugin.CADESCOM_XML_SIGNATURE_TYPE_ENVELOPING=1;cadesplugin.CADESCOM_XML_SIGNATURE_TYPE_TEMPLATE=2;cadesplugin.XmlDsigGost3410UrlObsolete="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411";cadesplugin.XmlDsigGost3411UrlObsolete="http://www.w3.org/2001/04/xmldsig-more#gostr3411";cadesplugin.XmlDsigGost3410Url="urn:ietf:params:xml:ns:cpxmlsec:algorithms:gostr34102001-gostr3411";cadesplugin.XmlDsigGost3411Url="urn:ietf:params:xml:ns:cpxmlsec:algorithms:gostr3411";cadesplugin.CADESCOM_CADES_DEFAULT=0;cadesplugin.CADESCOM_CADES_BES=1;cadesplugin.CADESCOM_CADES_T=5;cadesplugin.CADESCOM_CADES_X_LONG_TYPE_1=93;cadesplugin.CADESCOM_ENCODE_BASE64=0;cadesplugin.CADESCOM_ENCODE_BINARY=1;cadesplugin.CADESCOM_ENCODE_ANY=-1;cadesplugin.CAPICOM_CERTIFICATE_INCLUDE_CHAIN_EXCEPT_ROOT=0;cadesplugin.CAPICOM_CERTIFICATE_INCLUDE_WHOLE_CHAIN=1;cadesplugin.CAPICOM_CERTIFICATE_INCLUDE_END_ENTITY_ONLY=2;cadesplugin.CAPICOM_CERT_INFO_SUBJECT_SIMPLE_NAME=0;cadesplugin.CAPICOM_CERT_INFO_ISSUER_SIMPLE_NAME=1;cadesplugin.CAPICOM_CERTIFICATE_FIND_SHA1_HASH=0;cadesplugin.CAPICOM_CERTIFICATE_FIND_SUBJECT_NAME=1;cadesplugin.CAPICOM_CERTIFICATE_FIND_ISSUER_NAME=2;cadesplugin.CAPICOM_CERTIFICATE_FIND_ROOT_NAME=3;cadesplugin.CAPICOM_CERTIFICATE_FIND_TEMPLATE_NAME=4;cadesplugin.CAPICOM_CERTIFICATE_FIND_EXTENSION=5;cadesplugin.CAPICOM_CERTIFICATE_FIND_EXTENDED_PROPERTY=6;cadesplugin.CAPICOM_CERTIFICATE_FIND_APPLICATION_POLICY=7;cadesplugin.CAPICOM_CERTIFICATE_FIND_CERTIFICATE_POLICY=8;cadesplugin.CAPICOM_CERTIFICATE_FIND_TIME_VALID=9;cadesplugin.CAPICOM_CERTIFICATE_FIND_TIME_NOT_YET_VALID=10;cadesplugin.CAPICOM_CERTIFICATE_FIND_TIME_EXPIRED=11;cadesplugin.CAPICOM_CERTIFICATE_FIND_KEY_USAGE=12;cadesplugin.CAPICOM_DIGITAL_SIGNATURE_KEY_USAGE=128;cadesplugin.CAPICOM_PROPID_ENHKEY_USAGE=9;cadesplugin.CAPICOM_OID_OTHER=0;cadesplugin.CAPICOM_OID_KEY_USAGE_EXTENSION=10;cadesplugin.CAPICOM_EKU_CLIENT_AUTH=2;cadesplugin.CAPICOM_EKU_SMARTCARD_LOGON=5;cadesplugin.CAPICOM_EKU_OTHER=0;cadesplugin.CAPICOM_AUTHENTICATED_ATTRIBUTE_SIGNING_TIME=0;cadesplugin.CADESCOM_AUTHENTICATED_ATTRIBUTE_DOCUMENT_NAME=1;cadesplugin.CADESCOM_AUTHENTICATED_ATTRIBUTE_DOCUMENT_DESCRIPTION=2;cadesplugin.CADESCOM_ATTRIBUTE_OTHER=-1;cadesplugin.CADESCOM_STRING_TO_UCS2LE=0;cadesplugin.CADESCOM_BASE64_TO_BINARY=1;cadesplugin.CADESCOM_DISPLAY_DATA_NONE=0;cadesplugin.CADESCOM_DISPLAY_DATA_CONTENT=1;cadesplugin.CADESCOM_DISPLAY_DATA_ATTRIBUTE=2;cadesplugin.CADESCOM_ENCRYPTION_ALGORITHM_RC2=0;cadesplugin.CADESCOM_ENCRYPTION_ALGORITHM_RC4=1;cadesplugin.CADESCOM_ENCRYPTION_ALGORITHM_DES=2;cadesplugin.CADESCOM_ENCRYPTION_ALGORITHM_3DES=3;cadesplugin.CADESCOM_ENCRYPTION_ALGORITHM_AES=4;cadesplugin.CADESCOM_ENCRYPTION_ALGORITHM_GOST_28147_89=25;cadesplugin.CADESCOM_HASH_ALGORITHM_SHA1=0;cadesplugin.CADESCOM_HASH_ALGORITHM_MD2=1;cadesplugin.CADESCOM_HASH_ALGORITHM_MD4=2;cadesplugin.CADESCOM_HASH_ALGORITHM_MD5=3;cadesplugin.CADESCOM_HASH_ALGORITHM_SHA_256=4;cadesplugin.CADESCOM_HASH_ALGORITHM_SHA_384=5;cadesplugin.CADESCOM_HASH_ALGORITHM_SHA_512=6;cadesplugin.CADESCOM_HASH_ALGORITHM_CP_GOST_3411=100;cadesplugin.CADESCOM_HASH_ALGORITHM_CP_GOST_3411_2012_256=101;cadesplugin.CADESCOM_HASH_ALGORITHM_CP_GOST_3411_2012_512=102;cadesplugin.LOG_LEVEL_DEBUG=4;cadesplugin.LOG_LEVEL_INFO=2;cadesplugin.LOG_LEVEL_ERROR=1}function async_spawn(generatorFunc){function continuer(verb,arg){var result;try{result=generator[verb](arg)}catch(err){return Promise.reject(err)}if(result.done){return result.value}else{return Promise.resolve(result.value).then(onFulfilled,onRejected)}}var generator=generatorFunc(Array.prototype.slice.call(arguments,1));var onFulfilled=continuer.bind(continuer,"next");var onRejected=continuer.bind(continuer,"throw");return onFulfilled()}function isIE(){var retVal=(("Microsoft Internet Explorer"==navigator.appName)||navigator.userAgent.match(/Trident\/./i));return retVal}function isIOS(){var retVal=(navigator.userAgent.match(/ipod/i)||navigator.userAgent.match(/ipad/i)||navigator.userAgent.match(/iphone/i));return retVal}function isNativeMessageSupported(){var retVal_chrome=navigator.userAgent.match(/chrome/i);isOpera=navigator.userAgent.match(/opr/i);isYaBrowser=navigator.userAgent.match(/YaBrowser/i);isFireFox=navigator.userAgent.match(/Firefox/i);if(isFireFox&&window.allow_firefox_cadesplugin_async){return true}if(retVal_chrome==null){return false}else{if(retVal_chrome.length>0||isOpera!=null){return true}}return false}function CreateObject(name){if(isIOS()){return call_ru_cryptopro_npcades_10_native_bridge("CreateObject",[name])}if(isIE()){if(name.match(/X509Enrollment/i)){try{var objCertEnrollClassFactory=document.getElementById("certEnrollClassFactory");return objCertEnrollClassFactory.CreateObject(name)}catch(e){throw ("ÐÐ»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð¾Ð±ÑÐµÐºÑÐ¾Ð² X509Enrollment ÑÐ»ÐµÐ´ÑÐµÑ Ð½Ð°ÑÑÑÐ¾Ð¸ÑÑ Ð²ÐµÐ±-ÑÐ·ÐµÐ» Ð½Ð° Ð¸ÑÐ¿Ð¾Ð»ÑÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿ÑÐ¾Ð²ÐµÑÐºÐ¸ Ð¿Ð¾Ð´Ð»Ð¸Ð½Ð½Ð¾ÑÑÐ¸ Ð¿Ð¾ Ð¿ÑÐ¾ÑÐ¾ÐºÐ¾Ð»Ñ HTTPS")}}try{var objWebClassFactory=document.getElementById("webClassFactory");return objWebClassFactory.CreateObject(name)}catch(e){return new ActiveXObject(name)}}return pluginObject.CreateObject(name)}function decimalToHexString(number){if(number<0){number=4294967295+number+1}return number.toString(16).toUpperCase()}function GetMessageFromException(e){var err=e.message;if(!err){err=e}else{if(e.number){err+=" (0x"+decimalToHexString(e.number)+")"}}return err}function getLastError(exception){if(isNativeMessageSupported()||isIE()||isIOS()){return GetMessageFromException(exception)}try{return pluginObject.getLastError()}catch(e){return GetMessageFromException(exception)}}function CreateObjectAsync(name){return pluginObject.CreateObjectAsync(name)}var ru_cryptopro_npcades_10_native_bridge={callbacksCount:1,callbacks:{},resultForCallback:function resultForCallback(callbackId,resultArray){var callback=ru_cryptopro_npcades_10_native_bridge.callbacks[callbackId];if(!callback){return}callback.apply(null,resultArray)},call:function call(functionName,args,callback){var hasCallback=callback&&typeof callback=="function";var callbackId=hasCallback?ru_cryptopro_npcades_10_native_bridge.callbacksCount++:0;if(hasCallback){ru_cryptopro_npcades_10_native_bridge.callbacks[callbackId]=callback}var iframe=document.createElement("IFRAME");var arrObjs=new Array("_CPNP_handle");try{iframe.setAttribute("src","cpnp-js-call:"+functionName+":"+callbackId+":"+encodeURIComponent(JSON.stringify(args,arrObjs)))}catch(e){alert(e)}document.documentElement.appendChild(iframe);iframe.parentNode.removeChild(iframe);iframe=null}};function call_ru_cryptopro_npcades_10_native_bridge(functionName,array){var tmpobj;var ex;ru_cryptopro_npcades_10_native_bridge.call(functionName,array,function(e,response){ex=e;var str="tmpobj="+response;eval(str);if(typeof(tmpobj)=="string"){tmpobj=tmpobj.replace(/\\\n/gm,"\n");tmpobj=tmpobj.replace(/\\\r/gm,"\r")}});if(ex){throw ex}return tmpobj}function install_opera_extension(){if(!window.cadesplugin_skip_extension_install){document.addEventListener("DOMContentLoaded",function(){var ovr=document.createElement("div");ovr.id="cadesplugin_ovr";ovr.style="visibility: hidden; position: fixed; left: 0px; top: 0px; width:100%; height:100%; background-color: rgba(0,0,0,0.7)";ovr.innerHTML="<div id='cadesplugin_ovr_item' style='position:relative; width:400px; margin:100px auto; background-color:#fff; border:2px solid #000; padding:10px; text-align:center; opacity: 1; z-index: 1500'><button id='cadesplugin_close_install' style='float: right; font-size: 10px; background: transparent; border: 1; margin: -5px'>X</button><p>ÐÐ»Ñ ÑÐ°Ð±Ð¾ÑÑ ÐÑÐ¸Ð¿ÑÐ¾ÐÑÐ¾ Ð­Ð¦Ð Browser plugin Ð½Ð° Ð´Ð°Ð½Ð½Ð¾Ð¼ ÑÐ°Ð¹ÑÐµ Ð½ÐµÐ¾Ð±ÑÐ¾Ð´Ð¸Ð¼Ð¾ ÑÑÑÐ°Ð½Ð¾Ð²Ð¸ÑÑ ÑÐ°ÑÑÐ¸ÑÐµÐ½Ð¸Ðµ Ð¸Ð· ÐºÐ°ÑÐ°Ð»Ð¾Ð³Ð° Ð´Ð¾Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ð¹ Opera.<p><button id='cadesplugin_install' style='font:12px Arial'>Ð£ÑÑÐ°Ð½Ð¾Ð²Ð¸ÑÑ ÑÐ°ÑÑÐ¸ÑÐµÐ½Ð¸Ðµ</button></p></div>";document.getElementsByTagName("Body")[0].appendChild(ovr);var btn_install=document.getElementById("cadesplugin_install");btn_install.addEventListener("click",function(event){opr.addons.installExtension("epebfcehmdedogndhlcacafjaacknbcm",function(){document.getElementById("cadesplugin_ovr").style.visibility="hidden";location.reload()},function(){})});document.getElementById("cadesplugin_close_install").addEventListener("click",function(){plugin_loaded_error("ÐÐ»Ð°Ð³Ð¸Ð½ Ð½ÐµÐ´Ð¾ÑÑÑÐ¿ÐµÐ½");document.getElementById("cadesplugin_ovr").style.visibility="hidden"});ovr.addEventListener("click",function(){plugin_loaded_error("ÐÐ»Ð°Ð³Ð¸Ð½ Ð½ÐµÐ´Ð¾ÑÑÑÐ¿ÐµÐ½");document.getElementById("cadesplugin_ovr").style.visibility="hidden"});ovr.style.visibility="visible";document.getElementById("cadesplugin_ovr_item").addEventListener("click",function(e){e.stopPropagation()})})}else{plugin_loaded_error("ÐÐ»Ð°Ð³Ð¸Ð½ Ð½ÐµÐ´Ð¾ÑÑÑÐ¿ÐµÐ½")}}function firefox_nmcades_onload(){cpcsp_chrome_nmcades.check_chrome_plugin(plugin_loaded,plugin_loaded_error)}function nmcades_api_onload(){window.postMessage("cadesplugin_echo_request","*");window.addEventListener("message",function(event){if(typeof(event.data)!="string"||!event.data.match("cadesplugin_loaded")){return}if(isFireFox){var url=event.data.substring(event.data.indexOf("url:")+4);var fileref=document.createElement("script");fileref.setAttribute("type","text/javascript");fileref.setAttribute("src",url);fileref.onerror=plugin_loaded_error;fileref.onload=firefox_nmcades_onload;document.getElementsByTagName("head")[0].appendChild(fileref)}else{cpcsp_chrome_nmcades.check_chrome_plugin(plugin_loaded,plugin_loaded_error)}},false)}function load_extension(){if(isFireFox){nmcades_api_onload();return}else{var fileref=document.createElement("script");fileref.setAttribute("type","text/javascript");fileref.setAttribute("src","chrome-extension://iifchhfnnmpdbibifmljnfjhpififfog/nmcades_plugin_api.js");fileref.onerror=plugin_loaded_error;fileref.onload=nmcades_api_onload;document.getElementsByTagName("head")[0].appendChild(fileref);fileref=document.createElement("script");fileref.setAttribute("type","text/javascript");fileref.setAttribute("src","chrome-extension://epebfcehmdedogndhlcacafjaacknbcm/nmcades_plugin_api.js");fileref.onerror=plugin_loaded_error;fileref.onload=nmcades_api_onload;document.getElementsByTagName("head")[0].appendChild(fileref)}}function load_npapi_plugin(){var elem=document.createElement("object");elem.setAttribute("id","cadesplugin_object");elem.setAttribute("type","application/x-cades");elem.setAttribute("style","visibility: hidden");document.getElementsByTagName("body")[0].appendChild(elem);pluginObject=document.getElementById("cadesplugin_object");if(isIE()){var elem1=document.createElement("object");elem1.setAttribute("id","certEnrollClassFactory");elem1.setAttribute("classid","clsid:884e2049-217d-11da-b2a4-000e7bbb2b09");elem1.setAttribute("style","visibility: hidden");document.getElementsByTagName("body")[0].appendChild(elem1);var elem2=document.createElement("object");elem2.setAttribute("id","webClassFactory");elem2.setAttribute("classid","clsid:B04C8637-10BD-484E-B0DA-B8A039F60024");elem2.setAttribute("style","visibility: hidden");document.getElementsByTagName("body")[0].appendChild(elem2)}}function plugin_loaded(){plugin_resolved=1;if(canPromise){plugin_resolve()}else{window.postMessage("cadesplugin_loaded","*")}}function plugin_loaded_error(msg){if(isNativeMessageSupported()){failed_extensions++;if(failed_extensions<2){return}if(isOpera&&(typeof(msg)=="undefined"||typeof(msg)=="object")){install_opera_extension();return}}if(typeof(msg)=="undefined"||typeof(msg)=="object"){msg="ÐÐ»Ð°Ð³Ð¸Ð½ Ð½ÐµÐ´Ð¾ÑÑÑÐ¿ÐµÐ½"}plugin_resolved=1;if(canPromise){plugin_reject(msg)}else{window.postMessage("cadesplugin_load_error","*")}}function check_load_timeout(){if(plugin_resolved==1){return}plugin_resolved=1;if(canPromise){plugin_reject("ÐÑÑÐµÐºÐ»Ð¾ Ð²ÑÐµÐ¼Ñ Ð¾Ð¶Ð¸Ð´Ð°Ð½Ð¸Ñ Ð·Ð°Ð³ÑÑÐ·ÐºÐ¸ Ð¿Ð»Ð°Ð³Ð¸Ð½Ð°")}else{window.postMessage("cadesplugin_load_error","*")}}function createPromise(arg){return new Promise(arg)}function check_npapi_plugin(){try{var oAbout=CreateObject("CAdESCOM.About");plugin_loaded()}catch(err){document.getElementById("cadesplugin_object").style.display="none";var mimetype=navigator.mimeTypes["application/x-cades"];if(mimetype){var plugin=mimetype.enabledPlugin;if(plugin){plugin_loaded_error("ÐÐ»Ð°Ð³Ð¸Ð½ Ð·Ð°Ð³ÑÑÐ¶ÐµÐ½, Ð½Ð¾ Ð½Ðµ ÑÐ¾Ð·Ð´Ð°ÑÑÑÑ Ð¾Ð±ÑÐµÐºÑÑ")}else{plugin_loaded_error("ÐÑÐ¸Ð±ÐºÐ° Ð¿ÑÐ¸ Ð·Ð°Ð³ÑÑÐ·ÐºÐµ Ð¿Ð»Ð°Ð³Ð¸Ð½Ð°")}}else{plugin_loaded_error("ÐÐ»Ð°Ð³Ð¸Ð½ Ð½ÐµÐ´Ð¾ÑÑÑÐ¿ÐµÐ½")}}}function check_plugin_working(){var div=document.createElement("div");div.innerHTML="<!--[if lt IE 9]><iecheck></iecheck><![endif]-->";var isIeLessThan9=(div.getElementsByTagName("iecheck").length==1);if(isIeLessThan9){plugin_loaded_error("Internet Explorer Ð²ÐµÑÑÐ¸Ð¸ 8 Ð¸ Ð½Ð¸Ð¶Ðµ Ð½Ðµ Ð¿Ð¾Ð´Ð´ÐµÑÐ¶Ð¸Ð²Ð°ÐµÑÑÑ");return}if(isNativeMessageSupported()){load_extension()}else{if(!canPromise){window.addEventListener("message",function(event){if(event.data!="cadesplugin_echo_request"){return}load_npapi_plugin();check_npapi_plugin()},false)}else{window.addEventListener("load",function(event){load_npapi_plugin();check_npapi_plugin()},false)}}}function set_pluginObject(obj){pluginObject=obj}cadesplugin.JSModuleVersion="2.1.0";cadesplugin.async_spawn=async_spawn;cadesplugin.set=set_pluginObject;cadesplugin.set_log_level=set_log_level;cadesplugin.getLastError=getLastError;if(isNativeMessageSupported()){cadesplugin.CreateObjectAsync=CreateObjectAsync}if(!isNativeMessageSupported()){cadesplugin.CreateObject=CreateObject}if(window.cadesplugin_load_timeout){setTimeout(check_load_timeout,window.cadesplugin_load_timeout)}else{setTimeout(check_load_timeout,20000)}set_constantValues();cadesplugin.current_log_level=cadesplugin.LOG_LEVEL_ERROR;window.cadesplugin=cadesplugin;check_plugin_working()}());
/* PhotoSwipe - v4.1.2 - 2017-04-05
* http://photoswipe.com
* Copyright (c) 2017 Dmitry Semenov; */
(function(root,factory){if(typeof define==="function"&&define.amd){define(factory)}else{if(typeof exports==="object"){module.exports=factory()}else{root.PhotoSwipe=factory()}}})(this,function(){var PhotoSwipe=function(template,UiClass,items,options){var framework={features:null,bind:function(target,type,listener,unbind){var methodName=(unbind?"remove":"add")+"EventListener";type=type.split(" ");for(var i=0;i<type.length;i++){if(type[i]){target[methodName](type[i],listener,false)}}},isArray:function(obj){return(obj instanceof Array)},createEl:function(classes,tag){var el=document.createElement(tag||"div");if(classes){el.className=classes}return el},getScrollY:function(){var yOffset=window.pageYOffset;return yOffset!==undefined?yOffset:document.documentElement.scrollTop},unbind:function(target,type,listener){framework.bind(target,type,listener,true)},removeClass:function(el,className){var reg=new RegExp("(\\s|^)"+className+"(\\s|$)");el.className=el.className.replace(reg," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")},addClass:function(el,className){if(!framework.hasClass(el,className)){el.className+=(el.className?" ":"")+className}},hasClass:function(el,className){return el.className&&new RegExp("(^|\\s)"+className+"(\\s|$)").test(el.className)},getChildByClass:function(parentEl,childClassName){var node=parentEl.firstChild;while(node){if(framework.hasClass(node,childClassName)){return node}node=node.nextSibling}},arraySearch:function(array,value,key){var i=array.length;while(i--){if(array[i][key]===value){return i}}return -1},extend:function(o1,o2,preventOverwrite){for(var prop in o2){if(o2.hasOwnProperty(prop)){if(preventOverwrite&&o1.hasOwnProperty(prop)){continue}o1[prop]=o2[prop]}}},easing:{sine:{out:function(k){return Math.sin(k*(Math.PI/2))},inOut:function(k){return -(Math.cos(Math.PI*k)-1)/2}},cubic:{out:function(k){return --k*k*k+1}}},detectFeatures:function(){if(framework.features){return framework.features}var helperEl=framework.createEl(),helperStyle=helperEl.style,vendor="",features={};features.oldIE=document.all&&!document.addEventListener;features.touch="ontouchstart" in window;if(window.requestAnimationFrame){features.raf=window.requestAnimationFrame;features.caf=window.cancelAnimationFrame}features.pointerEvent=navigator.pointerEnabled||navigator.msPointerEnabled;if(!features.pointerEvent){var ua=navigator.userAgent;if(/iP(hone|od)/.test(navigator.platform)){var v=(navigator.appVersion).match(/OS (\d+)_(\d+)_?(\d+)?/);if(v&&v.length>0){v=parseInt(v[1],10);if(v>=1&&v<8){features.isOldIOSPhone=true}}}var match=ua.match(/Android\s([0-9\.]*)/);var androidversion=match?match[1]:0;androidversion=parseFloat(androidversion);if(androidversion>=1){if(androidversion<4.4){features.isOldAndroid=true}features.androidVersion=androidversion}features.isMobileOpera=/opera mini|opera mobi/i.test(ua)}var styleChecks=["transform","perspective","animationName"],vendors=["","webkit","Moz","ms","O"],styleCheckItem,styleName;for(var i=0;i<4;i++){vendor=vendors[i];for(var a=0;a<3;a++){styleCheckItem=styleChecks[a];styleName=vendor+(vendor?styleCheckItem.charAt(0).toUpperCase()+styleCheckItem.slice(1):styleCheckItem);if(!features[styleCheckItem]&&styleName in helperStyle){features[styleCheckItem]=styleName}}if(vendor&&!features.raf){vendor=vendor.toLowerCase();features.raf=window[vendor+"RequestAnimationFrame"];if(features.raf){features.caf=window[vendor+"CancelAnimationFrame"]||window[vendor+"CancelRequestAnimationFrame"]}}}if(!features.raf){var lastTime=0;features.raf=function(fn){var currTime=new Date().getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){fn(currTime+timeToCall)},timeToCall);lastTime=currTime+timeToCall;return id};features.caf=function(id){clearTimeout(id)}}features.svg=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect;framework.features=features;return features}};framework.detectFeatures();if(framework.features.oldIE){framework.bind=function(target,type,listener,unbind){type=type.split(" ");var methodName=(unbind?"detach":"attach")+"Event",evName,_handleEv=function(){listener.handleEvent.call(listener)};for(var i=0;i<type.length;i++){evName=type[i];if(evName){if(typeof listener==="object"&&listener.handleEvent){if(!unbind){listener["oldIE"+evName]=_handleEv}else{if(!listener["oldIE"+evName]){return false}}target[methodName]("on"+evName,listener["oldIE"+evName])}else{target[methodName]("on"+evName,listener)}}}}}var self=this;var DOUBLE_TAP_RADIUS=25,NUM_HOLDERS=3;var _options={allowPanToNext:true,spacing:0.12,bgOpacity:1,mouseUsed:false,loop:true,pinchToClose:true,closeOnScroll:true,closeOnVerticalDrag:true,verticalDragRange:0.75,hideAnimationDuration:333,showAnimationDuration:333,showHideOpacity:false,focus:true,escKey:true,arrowKeys:true,mainScrollEndFriction:0.35,panEndFriction:0.35,isClickableElement:function(el){return el.tagName==="A"},getDoubleTapZoom:function(isMouseClick,item){if(isMouseClick){return 1}else{return item.initialZoomLevel<0.7?1:1.33}},maxSpreadZoom:1.33,modal:true,scaleMode:"fit"};framework.extend(_options,options);var _getEmptyPoint=function(){return{x:0,y:0}};var _isOpen,_isDestroying,_closedByScroll,_currentItemIndex,_containerStyle,_containerShiftIndex,_currPanDist=_getEmptyPoint(),_startPanOffset=_getEmptyPoint(),_panOffset=_getEmptyPoint(),_upMoveEvents,_downEvents,_globalEventHandlers,_viewportSize={},_currZoomLevel,_startZoomLevel,_translatePrefix,_translateSufix,_updateSizeInterval,_itemsNeedUpdate,_currPositionIndex=0,_offset={},_slideSize=_getEmptyPoint(),_itemHolders,_prevItemIndex,_indexDiff=0,_dragStartEvent,_dragMoveEvent,_dragEndEvent,_dragCancelEvent,_transformKey,_pointerEventEnabled,_isFixedPosition=true,_likelyTouchDevice,_modules=[],_requestAF,_cancelAF,_initalClassName,_initalWindowScrollY,_oldIE,_currentWindowScrollY,_features,_windowVisibleSize={},_renderMaxResolution=false,_orientationChangeTimeout,_registerModule=function(name,module){framework.extend(self,module.publicMethods);_modules.push(name)},_getLoopedId=function(index){var numSlides=_getNumItems();if(index>numSlides-1){return index-numSlides}else{if(index<0){return numSlides+index}}return index},_listeners={},_listen=function(name,fn){if(!_listeners[name]){_listeners[name]=[]}return _listeners[name].push(fn)},_shout=function(name){var listeners=_listeners[name];if(listeners){var args=Array.prototype.slice.call(arguments);args.shift();for(var i=0;i<listeners.length;i++){listeners[i].apply(self,args)}}},_getCurrentTime=function(){return new Date().getTime()},_applyBgOpacity=function(opacity){_bgOpacity=opacity;self.bg.style.opacity=opacity*_options.bgOpacity},_applyZoomTransform=function(styleObj,x,y,zoom,item){if(!_renderMaxResolution||(item&&item!==self.currItem)){zoom=zoom/(item?item.fitRatio:self.currItem.fitRatio)}styleObj[_transformKey]=_translatePrefix+x+"px, "+y+"px"+_translateSufix+" scale("+zoom+")"},_applyCurrentZoomPan=function(allowRenderResolution){if(_currZoomElementStyle){if(allowRenderResolution){if(_currZoomLevel>self.currItem.fitRatio){if(!_renderMaxResolution){_setImageSize(self.currItem,false,true);_renderMaxResolution=true}}else{if(_renderMaxResolution){_setImageSize(self.currItem);_renderMaxResolution=false}}}_applyZoomTransform(_currZoomElementStyle,_panOffset.x,_panOffset.y,_currZoomLevel)}},_applyZoomPanToItem=function(item){if(item.container){_applyZoomTransform(item.container.style,item.initialPosition.x,item.initialPosition.y,item.initialZoomLevel,item)}},_setTranslateX=function(x,elStyle){elStyle[_transformKey]=_translatePrefix+x+"px, 0px"+_translateSufix},_moveMainScroll=function(x,dragging){if(!_options.loop&&dragging){var newSlideIndexOffset=_currentItemIndex+(_slideSize.x*_currPositionIndex-x)/_slideSize.x,delta=Math.round(x-_mainScrollPos.x);if((newSlideIndexOffset<0&&delta>0)||(newSlideIndexOffset>=_getNumItems()-1&&delta<0)){x=_mainScrollPos.x+delta*_options.mainScrollEndFriction}}_mainScrollPos.x=x;_setTranslateX(x,_containerStyle)},_calculatePanOffset=function(axis,zoomLevel){var m=_midZoomPoint[axis]-_offset[axis];return _startPanOffset[axis]+_currPanDist[axis]+m-m*(zoomLevel/_startZoomLevel)},_equalizePoints=function(p1,p2){p1.x=p2.x;p1.y=p2.y;if(p2.id){p1.id=p2.id}},_roundPoint=function(p){p.x=Math.round(p.x);p.y=Math.round(p.y)},_mouseMoveTimeout=null,_onFirstMouseMove=function(){if(_mouseMoveTimeout){framework.unbind(document,"mousemove",_onFirstMouseMove);framework.addClass(template,"pswp--has_mouse");_options.mouseUsed=true;_shout("mouseUsed")}_mouseMoveTimeout=setTimeout(function(){_mouseMoveTimeout=null},100)},_bindEvents=function(){framework.bind(document,"keydown",self);if(_features.transform){framework.bind(self.scrollWrap,"click",self)}if(!_options.mouseUsed){framework.bind(document,"mousemove",_onFirstMouseMove)}framework.bind(window,"resize scroll orientationchange",self);_shout("bindEvents")},_unbindEvents=function(){framework.unbind(window,"resize scroll orientationchange",self);framework.unbind(window,"scroll",_globalEventHandlers.scroll);framework.unbind(document,"keydown",self);framework.unbind(document,"mousemove",_onFirstMouseMove);if(_features.transform){framework.unbind(self.scrollWrap,"click",self)}if(_isDragging){framework.unbind(window,_upMoveEvents,self)}clearTimeout(_orientationChangeTimeout);_shout("unbindEvents")},_calculatePanBounds=function(zoomLevel,update){var bounds=_calculateItemSize(self.currItem,_viewportSize,zoomLevel);if(update){_currPanBounds=bounds}return bounds},_getMinZoomLevel=function(item){if(!item){item=self.currItem}return item.initialZoomLevel},_getMaxZoomLevel=function(item){if(!item){item=self.currItem}return item.w>0?_options.maxSpreadZoom:1},_modifyDestPanOffset=function(axis,destPanBounds,destPanOffset,destZoomLevel){if(destZoomLevel===self.currItem.initialZoomLevel){destPanOffset[axis]=self.currItem.initialPosition[axis];return true}else{destPanOffset[axis]=_calculatePanOffset(axis,destZoomLevel);if(destPanOffset[axis]>destPanBounds.min[axis]){destPanOffset[axis]=destPanBounds.min[axis];return true}else{if(destPanOffset[axis]<destPanBounds.max[axis]){destPanOffset[axis]=destPanBounds.max[axis];return true}}}return false},_setupTransforms=function(){if(_transformKey){var allow3dTransform=_features.perspective&&!_likelyTouchDevice;_translatePrefix="translate"+(allow3dTransform?"3d(":"(");_translateSufix=_features.perspective?", 0px)":")";return}_transformKey="left";framework.addClass(template,"pswp--ie");_setTranslateX=function(x,elStyle){elStyle.left=x+"px"};_applyZoomPanToItem=function(item){var zoomRatio=item.fitRatio>1?1:item.fitRatio,s=item.container.style,w=zoomRatio*item.w,h=zoomRatio*item.h;s.width=w+"px";s.height=h+"px";s.left=item.initialPosition.x+"px";s.top=item.initialPosition.y+"px"};_applyCurrentZoomPan=function(){if(_currZoomElementStyle){var s=_currZoomElementStyle,item=self.currItem,zoomRatio=item.fitRatio>1?1:item.fitRatio,w=zoomRatio*item.w,h=zoomRatio*item.h;s.width=w+"px";s.height=h+"px";s.left=_panOffset.x+"px";s.top=_panOffset.y+"px"}}},_onKeyDown=function(e){var keydownAction="";if(_options.escKey&&e.keyCode===27){keydownAction="close"}else{if(_options.arrowKeys){if(e.keyCode===37){keydownAction="prev"}else{if(e.keyCode===39){keydownAction="next"}}}}if(keydownAction){if(!e.ctrlKey&&!e.altKey&&!e.shiftKey&&!e.metaKey){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}self[keydownAction]()}}},_onGlobalClick=function(e){if(!e){return}if(_moved||_zoomStarted||_mainScrollAnimating||_verticalDragInitiated){e.preventDefault();e.stopPropagation()}},_updatePageScrollOffset=function(){self.setScrollOffset(0,framework.getScrollY())};var _animations={},_numAnimations=0,_stopAnimation=function(name){if(_animations[name]){if(_animations[name].raf){_cancelAF(_animations[name].raf)}_numAnimations--;delete _animations[name]}},_registerStartAnimation=function(name){if(_animations[name]){_stopAnimation(name)}if(!_animations[name]){_numAnimations++;_animations[name]={}}},_stopAllAnimations=function(){for(var prop in _animations){if(_animations.hasOwnProperty(prop)){_stopAnimation(prop)}}},_animateProp=function(name,b,endProp,d,easingFn,onUpdate,onComplete){var startAnimTime=_getCurrentTime(),t;_registerStartAnimation(name);var animloop=function(){if(_animations[name]){t=_getCurrentTime()-startAnimTime;if(t>=d){_stopAnimation(name);onUpdate(endProp);if(onComplete){onComplete()}return}onUpdate((endProp-b)*easingFn(t/d)+b);_animations[name].raf=_requestAF(animloop)}};animloop()};var publicMethods={shout:_shout,listen:_listen,viewportSize:_viewportSize,options:_options,isMainScrollAnimating:function(){return _mainScrollAnimating},getZoomLevel:function(){return _currZoomLevel},getCurrentIndex:function(){return _currentItemIndex},isDragging:function(){return _isDragging},isZooming:function(){return _isZooming},setScrollOffset:function(x,y){_offset.x=x;_currentWindowScrollY=_offset.y=y;_shout("updateScrollOffset",_offset)},applyZoomPan:function(zoomLevel,panX,panY,allowRenderResolution){_panOffset.x=panX;_panOffset.y=panY;_currZoomLevel=zoomLevel;_applyCurrentZoomPan(allowRenderResolution)},init:function(){if(_isOpen||_isDestroying){return}var i;self.framework=framework;self.template=template;self.bg=framework.getChildByClass(template,"pswp__bg");_initalClassName=template.className;_isOpen=true;_features=framework.detectFeatures();_requestAF=_features.raf;_cancelAF=_features.caf;_transformKey=_features.transform;_oldIE=_features.oldIE;self.scrollWrap=framework.getChildByClass(template,"pswp__scroll-wrap");self.container=framework.getChildByClass(self.scrollWrap,"pswp__container");_containerStyle=self.container.style;self.itemHolders=_itemHolders=[{el:self.container.children[0],wrap:0,index:-1},{el:self.container.children[1],wrap:0,index:-1},{el:self.container.children[2],wrap:0,index:-1}];_itemHolders[0].el.style.display=_itemHolders[2].el.style.display="none";_setupTransforms();_globalEventHandlers={resize:self.updateSize,orientationchange:function(){clearTimeout(_orientationChangeTimeout);_orientationChangeTimeout=setTimeout(function(){if(_viewportSize.x!==self.scrollWrap.clientWidth){self.updateSize()}},500)},scroll:_updatePageScrollOffset,keydown:_onKeyDown,click:_onGlobalClick};var oldPhone=_features.isOldIOSPhone||_features.isOldAndroid||_features.isMobileOpera;if(!_features.animationName||!_features.transform||oldPhone){_options.showAnimationDuration=_options.hideAnimationDuration=0}for(i=0;i<_modules.length;i++){self["init"+_modules[i]]()}if(UiClass){var ui=self.ui=new UiClass(self,framework);ui.init()}_shout("firstUpdate");_currentItemIndex=_currentItemIndex||_options.index||0;if(isNaN(_currentItemIndex)||_currentItemIndex<0||_currentItemIndex>=_getNumItems()){_currentItemIndex=0}self.currItem=_getItemAt(_currentItemIndex);if(_features.isOldIOSPhone||_features.isOldAndroid){_isFixedPosition=false}template.setAttribute("aria-hidden","false");if(_options.modal){if(!_isFixedPosition){template.style.position="absolute";template.style.top=framework.getScrollY()+"px"}else{template.style.position="fixed"}}if(_currentWindowScrollY===undefined){_shout("initialLayout");_currentWindowScrollY=_initalWindowScrollY=framework.getScrollY()}var rootClasses="pswp--open ";if(_options.mainClass){rootClasses+=_options.mainClass+" "}if(_options.showHideOpacity){rootClasses+="pswp--animate_opacity "}rootClasses+=_likelyTouchDevice?"pswp--touch":"pswp--notouch";rootClasses+=_features.animationName?" pswp--css_animation":"";rootClasses+=_features.svg?" pswp--svg":"";framework.addClass(template,rootClasses);self.updateSize();_containerShiftIndex=-1;_indexDiff=null;for(i=0;i<NUM_HOLDERS;i++){_setTranslateX((i+_containerShiftIndex)*_slideSize.x,_itemHolders[i].el.style)}if(!_oldIE){framework.bind(self.scrollWrap,_downEvents,self)}_listen("initialZoomInEnd",function(){self.setContent(_itemHolders[0],_currentItemIndex-1);self.setContent(_itemHolders[2],_currentItemIndex+1);_itemHolders[0].el.style.display=_itemHolders[2].el.style.display="block";if(_options.focus){template.focus()}_bindEvents()});self.setContent(_itemHolders[1],_currentItemIndex);self.updateCurrItem();_shout("afterInit");if(!_isFixedPosition){_updateSizeInterval=setInterval(function(){if(!_numAnimations&&!_isDragging&&!_isZooming&&(_currZoomLevel===self.currItem.initialZoomLevel)){self.updateSize()}},1000)}framework.addClass(template,"pswp--visible")},close:function(){if(!_isOpen){return}_isOpen=false;_isDestroying=true;_shout("close");_unbindEvents();_showOrHide(self.currItem,null,true,self.destroy)},destroy:function(){_shout("destroy");if(_showOrHideTimeout){clearTimeout(_showOrHideTimeout)}template.setAttribute("aria-hidden","true");template.className=_initalClassName;if(_updateSizeInterval){clearInterval(_updateSizeInterval)}framework.unbind(self.scrollWrap,_downEvents,self);framework.unbind(window,"scroll",self);_stopDragUpdateLoop();_stopAllAnimations();_listeners=null},panTo:function(x,y,force){if(!force){if(x>_currPanBounds.min.x){x=_currPanBounds.min.x}else{if(x<_currPanBounds.max.x){x=_currPanBounds.max.x}}if(y>_currPanBounds.min.y){y=_currPanBounds.min.y}else{if(y<_currPanBounds.max.y){y=_currPanBounds.max.y}}}_panOffset.x=x;_panOffset.y=y;_applyCurrentZoomPan()},handleEvent:function(e){e=e||window.event;if(_globalEventHandlers[e.type]){_globalEventHandlers[e.type](e)}},goTo:function(index){index=_getLoopedId(index);var diff=index-_currentItemIndex;_indexDiff=diff;_currentItemIndex=index;self.currItem=_getItemAt(_currentItemIndex);_currPositionIndex-=diff;_moveMainScroll(_slideSize.x*_currPositionIndex);_stopAllAnimations();_mainScrollAnimating=false;self.updateCurrItem()},next:function(){self.goTo(_currentItemIndex+1)},prev:function(){self.goTo(_currentItemIndex-1)},updateCurrZoomItem:function(emulateSetContent){if(emulateSetContent){_shout("beforeChange",0)}if(_itemHolders[1].el.children.length){var zoomElement=_itemHolders[1].el.children[0];if(framework.hasClass(zoomElement,"pswp__zoom-wrap")){_currZoomElementStyle=zoomElement.style}else{_currZoomElementStyle=null}}else{_currZoomElementStyle=null}_currPanBounds=self.currItem.bounds;_startZoomLevel=_currZoomLevel=self.currItem.initialZoomLevel;_panOffset.x=_currPanBounds.center.x;_panOffset.y=_currPanBounds.center.y;if(emulateSetContent){_shout("afterChange")}},invalidateCurrItems:function(){_itemsNeedUpdate=true;for(var i=0;i<NUM_HOLDERS;i++){if(_itemHolders[i].item){_itemHolders[i].item.needsUpdate=true}}},updateCurrItem:function(beforeAnimation){if(_indexDiff===0){return}var diffAbs=Math.abs(_indexDiff),tempHolder;if(beforeAnimation&&diffAbs<2){return}self.currItem=_getItemAt(_currentItemIndex);_renderMaxResolution=false;_shout("beforeChange",_indexDiff);if(diffAbs>=NUM_HOLDERS){_containerShiftIndex+=_indexDiff+(_indexDiff>0?-NUM_HOLDERS:NUM_HOLDERS);diffAbs=NUM_HOLDERS}for(var i=0;i<diffAbs;i++){if(_indexDiff>0){tempHolder=_itemHolders.shift();_itemHolders[NUM_HOLDERS-1]=tempHolder;_containerShiftIndex++;_setTranslateX((_containerShiftIndex+2)*_slideSize.x,tempHolder.el.style);self.setContent(tempHolder,_currentItemIndex-diffAbs+i+1+1)}else{tempHolder=_itemHolders.pop();_itemHolders.unshift(tempHolder);_containerShiftIndex--;_setTranslateX(_containerShiftIndex*_slideSize.x,tempHolder.el.style);self.setContent(tempHolder,_currentItemIndex+diffAbs-i-1-1)}}if(_currZoomElementStyle&&Math.abs(_indexDiff)===1){var prevItem=_getItemAt(_prevItemIndex);if(prevItem.initialZoomLevel!==_currZoomLevel){_calculateItemSize(prevItem,_viewportSize);_setImageSize(prevItem);_applyZoomPanToItem(prevItem)}}_indexDiff=0;self.updateCurrZoomItem();_prevItemIndex=_currentItemIndex;_shout("afterChange")},updateSize:function(force){if(!_isFixedPosition&&_options.modal){var windowScrollY=framework.getScrollY();if(_currentWindowScrollY!==windowScrollY){template.style.top=windowScrollY+"px";_currentWindowScrollY=windowScrollY}if(!force&&_windowVisibleSize.x===window.innerWidth&&_windowVisibleSize.y===window.innerHeight){return}_windowVisibleSize.x=window.innerWidth;_windowVisibleSize.y=window.innerHeight;template.style.height=_windowVisibleSize.y+"px"}_viewportSize.x=self.scrollWrap.clientWidth;_viewportSize.y=self.scrollWrap.clientHeight;_updatePageScrollOffset();_slideSize.x=_viewportSize.x+Math.round(_viewportSize.x*_options.spacing);_slideSize.y=_viewportSize.y;_moveMainScroll(_slideSize.x*_currPositionIndex);_shout("beforeResize");if(_containerShiftIndex!==undefined){var holder,item,hIndex;for(var i=0;i<NUM_HOLDERS;i++){holder=_itemHolders[i];_setTranslateX((i+_containerShiftIndex)*_slideSize.x,holder.el.style);hIndex=_currentItemIndex+i-1;if(_options.loop&&_getNumItems()>2){hIndex=_getLoopedId(hIndex)}item=_getItemAt(hIndex);if(item&&(_itemsNeedUpdate||item.needsUpdate||!item.bounds)){self.cleanSlide(item);self.setContent(holder,hIndex);if(i===1){self.currItem=item;self.updateCurrZoomItem(true)}item.needsUpdate=false}else{if(holder.index===-1&&hIndex>=0){self.setContent(holder,hIndex)}}if(item&&item.container){_calculateItemSize(item,_viewportSize);_setImageSize(item);_applyZoomPanToItem(item)}}_itemsNeedUpdate=false}_startZoomLevel=_currZoomLevel=self.currItem.initialZoomLevel;_currPanBounds=self.currItem.bounds;if(_currPanBounds){_panOffset.x=_currPanBounds.center.x;_panOffset.y=_currPanBounds.center.y;_applyCurrentZoomPan(true)}_shout("resize")},zoomTo:function(destZoomLevel,centerPoint,speed,easingFn,updateFn){if(centerPoint){_startZoomLevel=_currZoomLevel;_midZoomPoint.x=Math.abs(centerPoint.x)-_panOffset.x;_midZoomPoint.y=Math.abs(centerPoint.y)-_panOffset.y;_equalizePoints(_startPanOffset,_panOffset)}var destPanBounds=_calculatePanBounds(destZoomLevel,false),destPanOffset={};_modifyDestPanOffset("x",destPanBounds,destPanOffset,destZoomLevel);_modifyDestPanOffset("y",destPanBounds,destPanOffset,destZoomLevel);var initialZoomLevel=_currZoomLevel;var initialPanOffset={x:_panOffset.x,y:_panOffset.y};_roundPoint(destPanOffset);var onUpdate=function(now){if(now===1){_currZoomLevel=destZoomLevel;_panOffset.x=destPanOffset.x;_panOffset.y=destPanOffset.y}else{_currZoomLevel=(destZoomLevel-initialZoomLevel)*now+initialZoomLevel;_panOffset.x=(destPanOffset.x-initialPanOffset.x)*now+initialPanOffset.x;_panOffset.y=(destPanOffset.y-initialPanOffset.y)*now+initialPanOffset.y}if(updateFn){updateFn(now)}_applyCurrentZoomPan(now===1)};if(speed){_animateProp("customZoomTo",0,1,speed,easingFn||framework.easing.sine.inOut,onUpdate)}else{onUpdate(1)}}};var MIN_SWIPE_DISTANCE=30,DIRECTION_CHECK_OFFSET=10;var _gestureStartTime,_gestureCheckSpeedTime,p={},p2={},delta={},_currPoint={},_startPoint={},_currPointers=[],_startMainScrollPos={},_releaseAnimData,_posPoints=[],_tempPoint={},_isZoomingIn,_verticalDragInitiated,_oldAndroidTouchEndTimeout,_currZoomedItemIndex=0,_centerPoint=_getEmptyPoint(),_lastReleaseTime=0,_isDragging,_isMultitouch,_zoomStarted,_moved,_dragAnimFrame,_mainScrollShifted,_currentPoints,_isZooming,_currPointsDistance,_startPointsDistance,_currPanBounds,_mainScrollPos=_getEmptyPoint(),_currZoomElementStyle,_mainScrollAnimating,_midZoomPoint=_getEmptyPoint(),_currCenterPoint=_getEmptyPoint(),_direction,_isFirstMove,_opacityChanged,_bgOpacity,_wasOverInitialZoom,_isEqualPoints=function(p1,p2){return p1.x===p2.x&&p1.y===p2.y},_isNearbyPoints=function(touch0,touch1){return Math.abs(touch0.x-touch1.x)<DOUBLE_TAP_RADIUS&&Math.abs(touch0.y-touch1.y)<DOUBLE_TAP_RADIUS},_calculatePointsDistance=function(p1,p2){_tempPoint.x=Math.abs(p1.x-p2.x);_tempPoint.y=Math.abs(p1.y-p2.y);return Math.sqrt(_tempPoint.x*_tempPoint.x+_tempPoint.y*_tempPoint.y)},_stopDragUpdateLoop=function(){if(_dragAnimFrame){_cancelAF(_dragAnimFrame);_dragAnimFrame=null}},_dragUpdateLoop=function(){if(_isDragging){_dragAnimFrame=_requestAF(_dragUpdateLoop);_renderMovement()}},_canPan=function(){return !(_options.scaleMode==="fit"&&_currZoomLevel===self.currItem.initialZoomLevel)},_closestElement=function(el,fn){if(!el||el===document){return false}if(el.getAttribute("class")&&el.getAttribute("class").indexOf("pswp__scroll-wrap")>-1){return false}if(fn(el)){return el}return _closestElement(el.parentNode,fn)},_preventObj={},_preventDefaultEventBehaviour=function(e,isDown){_preventObj.prevent=!_closestElement(e.target,_options.isClickableElement);_shout("preventDragEvent",e,isDown,_preventObj);return _preventObj.prevent},_convertTouchToPoint=function(touch,p){p.x=touch.pageX;p.y=touch.pageY;p.id=touch.identifier;return p},_findCenterOfPoints=function(p1,p2,pCenter){pCenter.x=(p1.x+p2.x)*0.5;pCenter.y=(p1.y+p2.y)*0.5},_pushPosPoint=function(time,x,y){if(time-_gestureCheckSpeedTime>50){var o=_posPoints.length>2?_posPoints.shift():{};o.x=x;o.y=y;_posPoints.push(o);_gestureCheckSpeedTime=time}},_calculateVerticalDragOpacityRatio=function(){var yOffset=_panOffset.y-self.currItem.initialPosition.y;return 1-Math.abs(yOffset/(_viewportSize.y/2))},_ePoint1={},_ePoint2={},_tempPointsArr=[],_tempCounter,_getTouchPoints=function(e){while(_tempPointsArr.length>0){_tempPointsArr.pop()}if(!_pointerEventEnabled){if(e.type.indexOf("touch")>-1){if(e.touches&&e.touches.length>0){_tempPointsArr[0]=_convertTouchToPoint(e.touches[0],_ePoint1);if(e.touches.length>1){_tempPointsArr[1]=_convertTouchToPoint(e.touches[1],_ePoint2)}}}else{_ePoint1.x=e.pageX;_ePoint1.y=e.pageY;_ePoint1.id="";_tempPointsArr[0]=_ePoint1}}else{_tempCounter=0;_currPointers.forEach(function(p){if(_tempCounter===0){_tempPointsArr[0]=p}else{if(_tempCounter===1){_tempPointsArr[1]=p}}_tempCounter++})}return _tempPointsArr},_panOrMoveMainScroll=function(axis,delta){var panFriction,overDiff=0,newOffset=_panOffset[axis]+delta[axis],startOverDiff,dir=delta[axis]>0,newMainScrollPosition=_mainScrollPos.x+delta.x,mainScrollDiff=_mainScrollPos.x-_startMainScrollPos.x,newPanPos,newMainScrollPos;if(newOffset>_currPanBounds.min[axis]||newOffset<_currPanBounds.max[axis]){panFriction=_options.panEndFriction}else{panFriction=1}newOffset=_panOffset[axis]+delta[axis]*panFriction;if(_options.allowPanToNext||_currZoomLevel===self.currItem.initialZoomLevel){if(!_currZoomElementStyle){newMainScrollPos=newMainScrollPosition}else{if(_direction==="h"&&axis==="x"&&!_zoomStarted){if(dir){if(newOffset>_currPanBounds.min[axis]){panFriction=_options.panEndFriction;overDiff=_currPanBounds.min[axis]-newOffset;startOverDiff=_currPanBounds.min[axis]-_startPanOffset[axis]}if((startOverDiff<=0||mainScrollDiff<0)&&_getNumItems()>1){newMainScrollPos=newMainScrollPosition;if(mainScrollDiff<0&&newMainScrollPosition>_startMainScrollPos.x){newMainScrollPos=_startMainScrollPos.x}}else{if(_currPanBounds.min.x!==_currPanBounds.max.x){newPanPos=newOffset}}}else{if(newOffset<_currPanBounds.max[axis]){panFriction=_options.panEndFriction;overDiff=newOffset-_currPanBounds.max[axis];startOverDiff=_startPanOffset[axis]-_currPanBounds.max[axis]}if((startOverDiff<=0||mainScrollDiff>0)&&_getNumItems()>1){newMainScrollPos=newMainScrollPosition;if(mainScrollDiff>0&&newMainScrollPosition<_startMainScrollPos.x){newMainScrollPos=_startMainScrollPos.x}}else{if(_currPanBounds.min.x!==_currPanBounds.max.x){newPanPos=newOffset}}}}}if(axis==="x"){if(newMainScrollPos!==undefined){_moveMainScroll(newMainScrollPos,true);if(newMainScrollPos===_startMainScrollPos.x){_mainScrollShifted=false}else{_mainScrollShifted=true}}if(_currPanBounds.min.x!==_currPanBounds.max.x){if(newPanPos!==undefined){_panOffset.x=newPanPos}else{if(!_mainScrollShifted){_panOffset.x+=delta.x*panFriction}}}return newMainScrollPos!==undefined}}if(!_mainScrollAnimating){if(!_mainScrollShifted){if(_currZoomLevel>self.currItem.fitRatio){_panOffset[axis]+=delta[axis]*panFriction}}}},_onDragStart=function(e){if(e.type==="mousedown"&&e.button>0){return}if(_initialZoomRunning){e.preventDefault();return}if(_oldAndroidTouchEndTimeout&&e.type==="mousedown"){return}if(_preventDefaultEventBehaviour(e,true)){e.preventDefault()}_shout("pointerDown");if(_pointerEventEnabled){var pointerIndex=framework.arraySearch(_currPointers,e.pointerId,"id");if(pointerIndex<0){pointerIndex=_currPointers.length}_currPointers[pointerIndex]={x:e.pageX,y:e.pageY,id:e.pointerId}}var startPointsList=_getTouchPoints(e),numPoints=startPointsList.length;_currentPoints=null;_stopAllAnimations();if(!_isDragging||numPoints===1){_isDragging=_isFirstMove=true;framework.bind(window,_upMoveEvents,self);_isZoomingIn=_wasOverInitialZoom=_opacityChanged=_verticalDragInitiated=_mainScrollShifted=_moved=_isMultitouch=_zoomStarted=false;_direction=null;_shout("firstTouchStart",startPointsList);_equalizePoints(_startPanOffset,_panOffset);_currPanDist.x=_currPanDist.y=0;_equalizePoints(_currPoint,startPointsList[0]);_equalizePoints(_startPoint,_currPoint);_startMainScrollPos.x=_slideSize.x*_currPositionIndex;_posPoints=[{x:_currPoint.x,y:_currPoint.y}];_gestureCheckSpeedTime=_gestureStartTime=_getCurrentTime();_calculatePanBounds(_currZoomLevel,true);_stopDragUpdateLoop();_dragUpdateLoop()}if(!_isZooming&&numPoints>1&&!_mainScrollAnimating&&!_mainScrollShifted){_startZoomLevel=_currZoomLevel;_zoomStarted=false;_isZooming=_isMultitouch=true;_currPanDist.y=_currPanDist.x=0;_equalizePoints(_startPanOffset,_panOffset);_equalizePoints(p,startPointsList[0]);_equalizePoints(p2,startPointsList[1]);_findCenterOfPoints(p,p2,_currCenterPoint);_midZoomPoint.x=Math.abs(_currCenterPoint.x)-_panOffset.x;_midZoomPoint.y=Math.abs(_currCenterPoint.y)-_panOffset.y;_currPointsDistance=_startPointsDistance=_calculatePointsDistance(p,p2)}},_onDragMove=function(e){e.preventDefault();if(_pointerEventEnabled){var pointerIndex=framework.arraySearch(_currPointers,e.pointerId,"id");if(pointerIndex>-1){var p=_currPointers[pointerIndex];p.x=e.pageX;p.y=e.pageY}}if(_isDragging){var touchesList=_getTouchPoints(e);if(!_direction&&!_moved&&!_isZooming){if(_mainScrollPos.x!==_slideSize.x*_currPositionIndex){_direction="h"}else{var diff=Math.abs(touchesList[0].x-_currPoint.x)-Math.abs(touchesList[0].y-_currPoint.y);if(Math.abs(diff)>=DIRECTION_CHECK_OFFSET){_direction=diff>0?"h":"v";_currentPoints=touchesList}}}else{_currentPoints=touchesList}}},_renderMovement=function(){if(!_currentPoints){return}var numPoints=_currentPoints.length;if(numPoints===0){return}_equalizePoints(p,_currentPoints[0]);delta.x=p.x-_currPoint.x;delta.y=p.y-_currPoint.y;if(_isZooming&&numPoints>1){_currPoint.x=p.x;_currPoint.y=p.y;if(!delta.x&&!delta.y&&_isEqualPoints(_currentPoints[1],p2)){return}_equalizePoints(p2,_currentPoints[1]);if(!_zoomStarted){_zoomStarted=true;_shout("zoomGestureStarted")}var pointsDistance=_calculatePointsDistance(p,p2);var zoomLevel=_calculateZoomLevel(pointsDistance);if(zoomLevel>self.currItem.initialZoomLevel+self.currItem.initialZoomLevel/15){_wasOverInitialZoom=true}var zoomFriction=1,minZoomLevel=_getMinZoomLevel(),maxZoomLevel=_getMaxZoomLevel();if(zoomLevel<minZoomLevel){if(_options.pinchToClose&&!_wasOverInitialZoom&&_startZoomLevel<=self.currItem.initialZoomLevel){var minusDiff=minZoomLevel-zoomLevel;var percent=1-minusDiff/(minZoomLevel/1.2);_applyBgOpacity(percent);_shout("onPinchClose",percent);_opacityChanged=true}else{zoomFriction=(minZoomLevel-zoomLevel)/minZoomLevel;if(zoomFriction>1){zoomFriction=1}zoomLevel=minZoomLevel-zoomFriction*(minZoomLevel/3)}}else{if(zoomLevel>maxZoomLevel){zoomFriction=(zoomLevel-maxZoomLevel)/(minZoomLevel*6);if(zoomFriction>1){zoomFriction=1}zoomLevel=maxZoomLevel+zoomFriction*minZoomLevel}}if(zoomFriction<0){zoomFriction=0}_currPointsDistance=pointsDistance;_findCenterOfPoints(p,p2,_centerPoint);_currPanDist.x+=_centerPoint.x-_currCenterPoint.x;_currPanDist.y+=_centerPoint.y-_currCenterPoint.y;_equalizePoints(_currCenterPoint,_centerPoint);_panOffset.x=_calculatePanOffset("x",zoomLevel);_panOffset.y=_calculatePanOffset("y",zoomLevel);_isZoomingIn=zoomLevel>_currZoomLevel;_currZoomLevel=zoomLevel;_applyCurrentZoomPan()}else{if(!_direction){return}if(_isFirstMove){_isFirstMove=false;if(Math.abs(delta.x)>=DIRECTION_CHECK_OFFSET){delta.x-=_currentPoints[0].x-_startPoint.x}if(Math.abs(delta.y)>=DIRECTION_CHECK_OFFSET){delta.y-=_currentPoints[0].y-_startPoint.y}}_currPoint.x=p.x;_currPoint.y=p.y;if(delta.x===0&&delta.y===0){return}if(_direction==="v"&&_options.closeOnVerticalDrag){if(!_canPan()){_currPanDist.y+=delta.y;_panOffset.y+=delta.y;var opacityRatio=_calculateVerticalDragOpacityRatio();_verticalDragInitiated=true;_shout("onVerticalDrag",opacityRatio);_applyBgOpacity(opacityRatio);_applyCurrentZoomPan();return}}_pushPosPoint(_getCurrentTime(),p.x,p.y);_moved=true;_currPanBounds=self.currItem.bounds;var mainScrollChanged=_panOrMoveMainScroll("x",delta);if(!mainScrollChanged){_panOrMoveMainScroll("y",delta);_roundPoint(_panOffset);_applyCurrentZoomPan()}}},_onDragRelease=function(e){if(_features.isOldAndroid){if(_oldAndroidTouchEndTimeout&&e.type==="mouseup"){return}if(e.type.indexOf("touch")>-1){clearTimeout(_oldAndroidTouchEndTimeout);_oldAndroidTouchEndTimeout=setTimeout(function(){_oldAndroidTouchEndTimeout=0},600)}}_shout("pointerUp");if(_preventDefaultEventBehaviour(e,false)){e.preventDefault()}var releasePoint;if(_pointerEventEnabled){var pointerIndex=framework.arraySearch(_currPointers,e.pointerId,"id");if(pointerIndex>-1){releasePoint=_currPointers.splice(pointerIndex,1)[0];if(navigator.pointerEnabled){releasePoint.type=e.pointerType||"mouse"}else{var MSPOINTER_TYPES={4:"mouse",2:"touch",3:"pen"};releasePoint.type=MSPOINTER_TYPES[e.pointerType];if(!releasePoint.type){releasePoint.type=e.pointerType||"mouse"}}}}var touchList=_getTouchPoints(e),gestureType,numPoints=touchList.length;if(e.type==="mouseup"){numPoints=0}if(numPoints===2){_currentPoints=null;return true}if(numPoints===1){_equalizePoints(_startPoint,touchList[0])}if(numPoints===0&&!_direction&&!_mainScrollAnimating){if(!releasePoint){if(e.type==="mouseup"){releasePoint={x:e.pageX,y:e.pageY,type:"mouse"}}else{if(e.changedTouches&&e.changedTouches[0]){releasePoint={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY,type:"touch"}}}}_shout("touchRelease",e,releasePoint)}var releaseTimeDiff=-1;if(numPoints===0){_isDragging=false;framework.unbind(window,_upMoveEvents,self);_stopDragUpdateLoop();if(_isZooming){releaseTimeDiff=0}else{if(_lastReleaseTime!==-1){releaseTimeDiff=_getCurrentTime()-_lastReleaseTime}}}_lastReleaseTime=numPoints===1?_getCurrentTime():-1;if(releaseTimeDiff!==-1&&releaseTimeDiff<150){gestureType="zoom"}else{gestureType="swipe"}if(_isZooming&&numPoints<2){_isZooming=false;if(numPoints===1){gestureType="zoomPointerUp"}_shout("zoomGestureEnded")}_currentPoints=null;if(!_moved&&!_zoomStarted&&!_mainScrollAnimating&&!_verticalDragInitiated){return}_stopAllAnimations();if(!_releaseAnimData){_releaseAnimData=_initDragReleaseAnimationData()}_releaseAnimData.calculateSwipeSpeed("x");if(_verticalDragInitiated){var opacityRatio=_calculateVerticalDragOpacityRatio();if(opacityRatio<_options.verticalDragRange){self.close()}else{var initalPanY=_panOffset.y,initialBgOpacity=_bgOpacity;_animateProp("verticalDrag",0,1,300,framework.easing.cubic.out,function(now){_panOffset.y=(self.currItem.initialPosition.y-initalPanY)*now+initalPanY;_applyBgOpacity((1-initialBgOpacity)*now+initialBgOpacity);_applyCurrentZoomPan()});_shout("onVerticalDrag",1)}return}if((_mainScrollShifted||_mainScrollAnimating)&&numPoints===0){var itemChanged=_finishSwipeMainScrollGesture(gestureType,_releaseAnimData);if(itemChanged){return}gestureType="zoomPointerUp"}if(_mainScrollAnimating){return}if(gestureType!=="swipe"){_completeZoomGesture();return}if(!_mainScrollShifted&&_currZoomLevel>self.currItem.fitRatio){_completePanGesture(_releaseAnimData)}},_initDragReleaseAnimationData=function(){var lastFlickDuration,tempReleasePos;var s={lastFlickOffset:{},lastFlickDist:{},lastFlickSpeed:{},slowDownRatio:{},slowDownRatioReverse:{},speedDecelerationRatio:{},speedDecelerationRatioAbs:{},distanceOffset:{},backAnimDestination:{},backAnimStarted:{},calculateSwipeSpeed:function(axis){if(_posPoints.length>1){lastFlickDuration=_getCurrentTime()-_gestureCheckSpeedTime+50;tempReleasePos=_posPoints[_posPoints.length-2][axis]}else{lastFlickDuration=_getCurrentTime()-_gestureStartTime;tempReleasePos=_startPoint[axis]}s.lastFlickOffset[axis]=_currPoint[axis]-tempReleasePos;s.lastFlickDist[axis]=Math.abs(s.lastFlickOffset[axis]);if(s.lastFlickDist[axis]>20){s.lastFlickSpeed[axis]=s.lastFlickOffset[axis]/lastFlickDuration}else{s.lastFlickSpeed[axis]=0}if(Math.abs(s.lastFlickSpeed[axis])<0.1){s.lastFlickSpeed[axis]=0}s.slowDownRatio[axis]=0.95;s.slowDownRatioReverse[axis]=1-s.slowDownRatio[axis];s.speedDecelerationRatio[axis]=1},calculateOverBoundsAnimOffset:function(axis,speed){if(!s.backAnimStarted[axis]){if(_panOffset[axis]>_currPanBounds.min[axis]){s.backAnimDestination[axis]=_currPanBounds.min[axis]}else{if(_panOffset[axis]<_currPanBounds.max[axis]){s.backAnimDestination[axis]=_currPanBounds.max[axis]}}if(s.backAnimDestination[axis]!==undefined){s.slowDownRatio[axis]=0.7;s.slowDownRatioReverse[axis]=1-s.slowDownRatio[axis];if(s.speedDecelerationRatioAbs[axis]<0.05){s.lastFlickSpeed[axis]=0;s.backAnimStarted[axis]=true;_animateProp("bounceZoomPan"+axis,_panOffset[axis],s.backAnimDestination[axis],speed||300,framework.easing.sine.out,function(pos){_panOffset[axis]=pos;_applyCurrentZoomPan()})}}}},calculateAnimOffset:function(axis){if(!s.backAnimStarted[axis]){s.speedDecelerationRatio[axis]=s.speedDecelerationRatio[axis]*(s.slowDownRatio[axis]+s.slowDownRatioReverse[axis]-s.slowDownRatioReverse[axis]*s.timeDiff/10);s.speedDecelerationRatioAbs[axis]=Math.abs(s.lastFlickSpeed[axis]*s.speedDecelerationRatio[axis]);s.distanceOffset[axis]=s.lastFlickSpeed[axis]*s.speedDecelerationRatio[axis]*s.timeDiff;_panOffset[axis]+=s.distanceOffset[axis]}},panAnimLoop:function(){if(_animations.zoomPan){_animations.zoomPan.raf=_requestAF(s.panAnimLoop);s.now=_getCurrentTime();s.timeDiff=s.now-s.lastNow;s.lastNow=s.now;s.calculateAnimOffset("x");s.calculateAnimOffset("y");_applyCurrentZoomPan();s.calculateOverBoundsAnimOffset("x");s.calculateOverBoundsAnimOffset("y");if(s.speedDecelerationRatioAbs.x<0.05&&s.speedDecelerationRatioAbs.y<0.05){_panOffset.x=Math.round(_panOffset.x);_panOffset.y=Math.round(_panOffset.y);_applyCurrentZoomPan();_stopAnimation("zoomPan");return}}}};return s},_completePanGesture=function(animData){animData.calculateSwipeSpeed("y");_currPanBounds=self.currItem.bounds;animData.backAnimDestination={};animData.backAnimStarted={};if(Math.abs(animData.lastFlickSpeed.x)<=0.05&&Math.abs(animData.lastFlickSpeed.y)<=0.05){animData.speedDecelerationRatioAbs.x=animData.speedDecelerationRatioAbs.y=0;animData.calculateOverBoundsAnimOffset("x");animData.calculateOverBoundsAnimOffset("y");return true}_registerStartAnimation("zoomPan");animData.lastNow=_getCurrentTime();animData.panAnimLoop()},_finishSwipeMainScrollGesture=function(gestureType,_releaseAnimData){var itemChanged;if(!_mainScrollAnimating){_currZoomedItemIndex=_currentItemIndex}var itemsDiff;if(gestureType==="swipe"){var totalShiftDist=_currPoint.x-_startPoint.x,isFastLastFlick=_releaseAnimData.lastFlickDist.x<10;if(totalShiftDist>MIN_SWIPE_DISTANCE&&(isFastLastFlick||_releaseAnimData.lastFlickOffset.x>20)){itemsDiff=-1}else{if(totalShiftDist<-MIN_SWIPE_DISTANCE&&(isFastLastFlick||_releaseAnimData.lastFlickOffset.x<-20)){itemsDiff=1}}}var nextCircle;if(itemsDiff){_currentItemIndex+=itemsDiff;if(_currentItemIndex<0){_currentItemIndex=_options.loop?_getNumItems()-1:0;nextCircle=true}else{if(_currentItemIndex>=_getNumItems()){_currentItemIndex=_options.loop?0:_getNumItems()-1;nextCircle=true}}if(!nextCircle||_options.loop){_indexDiff+=itemsDiff;_currPositionIndex-=itemsDiff;itemChanged=true}}var animateToX=_slideSize.x*_currPositionIndex;var animateToDist=Math.abs(animateToX-_mainScrollPos.x);var finishAnimDuration;if(!itemChanged&&animateToX>_mainScrollPos.x!==_releaseAnimData.lastFlickSpeed.x>0){finishAnimDuration=333}else{finishAnimDuration=Math.abs(_releaseAnimData.lastFlickSpeed.x)>0?animateToDist/Math.abs(_releaseAnimData.lastFlickSpeed.x):333;finishAnimDuration=Math.min(finishAnimDuration,400);finishAnimDuration=Math.max(finishAnimDuration,250)}if(_currZoomedItemIndex===_currentItemIndex){itemChanged=false}_mainScrollAnimating=true;_shout("mainScrollAnimStart");_animateProp("mainScroll",_mainScrollPos.x,animateToX,finishAnimDuration,framework.easing.cubic.out,_moveMainScroll,function(){_stopAllAnimations();_mainScrollAnimating=false;_currZoomedItemIndex=-1;if(itemChanged||_currZoomedItemIndex!==_currentItemIndex){self.updateCurrItem()}_shout("mainScrollAnimComplete")});if(itemChanged){self.updateCurrItem(true)}return itemChanged},_calculateZoomLevel=function(touchesDistance){return 1/_startPointsDistance*touchesDistance*_startZoomLevel},_completeZoomGesture=function(){var destZoomLevel=_currZoomLevel,minZoomLevel=_getMinZoomLevel(),maxZoomLevel=_getMaxZoomLevel();if(_currZoomLevel<minZoomLevel){destZoomLevel=minZoomLevel}else{if(_currZoomLevel>maxZoomLevel){destZoomLevel=maxZoomLevel}}var destOpacity=1,onUpdate,initialOpacity=_bgOpacity;if(_opacityChanged&&!_isZoomingIn&&!_wasOverInitialZoom&&_currZoomLevel<minZoomLevel){self.close();return true}if(_opacityChanged){onUpdate=function(now){_applyBgOpacity((destOpacity-initialOpacity)*now+initialOpacity)}}self.zoomTo(destZoomLevel,0,200,framework.easing.cubic.out,onUpdate);return true};_registerModule("Gestures",{publicMethods:{initGestures:function(){var addEventNames=function(pref,down,move,up,cancel){_dragStartEvent=pref+down;_dragMoveEvent=pref+move;_dragEndEvent=pref+up;if(cancel){_dragCancelEvent=pref+cancel}else{_dragCancelEvent=""}};_pointerEventEnabled=_features.pointerEvent;if(_pointerEventEnabled&&_features.touch){_features.touch=false}if(_pointerEventEnabled){if(navigator.pointerEnabled){addEventNames("pointer","down","move","up","cancel")}else{addEventNames("MSPointer","Down","Move","Up","Cancel")}}else{if(_features.touch){addEventNames("touch","start","move","end","cancel");_likelyTouchDevice=true}else{addEventNames("mouse","down","move","up")}}_upMoveEvents=_dragMoveEvent+" "+_dragEndEvent+" "+_dragCancelEvent;_downEvents=_dragStartEvent;if(_pointerEventEnabled&&!_likelyTouchDevice){_likelyTouchDevice=(navigator.maxTouchPoints>1)||(navigator.msMaxTouchPoints>1)}self.likelyTouchDevice=_likelyTouchDevice;_globalEventHandlers[_dragStartEvent]=_onDragStart;_globalEventHandlers[_dragMoveEvent]=_onDragMove;_globalEventHandlers[_dragEndEvent]=_onDragRelease;if(_dragCancelEvent){_globalEventHandlers[_dragCancelEvent]=_globalEventHandlers[_dragEndEvent]}if(_features.touch){_downEvents+=" mousedown";_upMoveEvents+=" mousemove mouseup";_globalEventHandlers.mousedown=_globalEventHandlers[_dragStartEvent];_globalEventHandlers.mousemove=_globalEventHandlers[_dragMoveEvent];_globalEventHandlers.mouseup=_globalEventHandlers[_dragEndEvent]}if(!_likelyTouchDevice){_options.allowPanToNext=false}}}});var _showOrHideTimeout,_showOrHide=function(item,img,out,completeFn){if(_showOrHideTimeout){clearTimeout(_showOrHideTimeout)}_initialZoomRunning=true;_initialContentSet=true;var thumbBounds;if(item.initialLayout){thumbBounds=item.initialLayout;item.initialLayout=null}else{thumbBounds=_options.getThumbBoundsFn&&_options.getThumbBoundsFn(_currentItemIndex)}var duration=out?_options.hideAnimationDuration:_options.showAnimationDuration;var onComplete=function(){_stopAnimation("initialZoom");if(!out){_applyBgOpacity(1);if(img){img.style.display="block"}framework.addClass(template,"pswp--animated-in");_shout("initialZoom"+(out?"OutEnd":"InEnd"))}else{self.template.removeAttribute("style");self.bg.removeAttribute("style")}if(completeFn){completeFn()}_initialZoomRunning=false};if(!duration||!thumbBounds||thumbBounds.x===undefined){_shout("initialZoom"+(out?"Out":"In"));_currZoomLevel=item.initialZoomLevel;_equalizePoints(_panOffset,item.initialPosition);_applyCurrentZoomPan();template.style.opacity=out?0:1;_applyBgOpacity(1);if(duration){setTimeout(function(){onComplete()},duration)}else{onComplete()}return}var startAnimation=function(){var closeWithRaf=_closedByScroll,fadeEverything=!self.currItem.src||self.currItem.loadError||_options.showHideOpacity;if(item.miniImg){item.miniImg.style.webkitBackfaceVisibility="hidden"}if(!out){_currZoomLevel=thumbBounds.w/item.w;_panOffset.x=thumbBounds.x;_panOffset.y=thumbBounds.y-_initalWindowScrollY;self[fadeEverything?"template":"bg"].style.opacity=0.001;_applyCurrentZoomPan()}_registerStartAnimation("initialZoom");if(out&&!closeWithRaf){framework.removeClass(template,"pswp--animated-in")}if(fadeEverything){if(out){framework[(closeWithRaf?"remove":"add")+"Class"](template,"pswp--animate_opacity")}else{setTimeout(function(){framework.addClass(template,"pswp--animate_opacity")},30)}}_showOrHideTimeout=setTimeout(function(){_shout("initialZoom"+(out?"Out":"In"));if(!out){_currZoomLevel=item.initialZoomLevel;_equalizePoints(_panOffset,item.initialPosition);_applyCurrentZoomPan();_applyBgOpacity(1);if(fadeEverything){template.style.opacity=1}else{_applyBgOpacity(1)}_showOrHideTimeout=setTimeout(onComplete,duration+20)}else{var destZoomLevel=thumbBounds.w/item.w,initialPanOffset={x:_panOffset.x,y:_panOffset.y},initialZoomLevel=_currZoomLevel,initalBgOpacity=_bgOpacity,onUpdate=function(now){if(now===1){_currZoomLevel=destZoomLevel;_panOffset.x=thumbBounds.x;_panOffset.y=thumbBounds.y-_currentWindowScrollY}else{_currZoomLevel=(destZoomLevel-initialZoomLevel)*now+initialZoomLevel;_panOffset.x=(thumbBounds.x-initialPanOffset.x)*now+initialPanOffset.x;_panOffset.y=(thumbBounds.y-_currentWindowScrollY-initialPanOffset.y)*now+initialPanOffset.y}_applyCurrentZoomPan();if(fadeEverything){template.style.opacity=1-now}else{_applyBgOpacity(initalBgOpacity-now*initalBgOpacity)}};if(closeWithRaf){_animateProp("initialZoom",0,1,duration,framework.easing.cubic.out,onUpdate,onComplete)}else{onUpdate(1);_showOrHideTimeout=setTimeout(onComplete,duration+20)}}},out?25:90)};startAnimation()};var _items,_tempPanAreaSize={},_imagesToAppendPool=[],_initialContentSet,_initialZoomRunning,_controllerDefaultOptions={index:0,errorMsg:'<div class="pswp__error-msg"><a href="%url%" target="_blank">The image</a> could not be loaded.</div>',forceProgressiveLoading:false,preload:[1,1],getNumItemsFn:function(){return _items.length}};var _getItemAt,_getNumItems,_initialIsLoop,_getZeroBounds=function(){return{center:{x:0,y:0},max:{x:0,y:0},min:{x:0,y:0}}},_calculateSingleItemPanBounds=function(item,realPanElementW,realPanElementH){var bounds=item.bounds;bounds.center.x=Math.round((_tempPanAreaSize.x-realPanElementW)/2);bounds.center.y=Math.round((_tempPanAreaSize.y-realPanElementH)/2)+item.vGap.top;bounds.max.x=(realPanElementW>_tempPanAreaSize.x)?Math.round(_tempPanAreaSize.x-realPanElementW):bounds.center.x;bounds.max.y=(realPanElementH>_tempPanAreaSize.y)?Math.round(_tempPanAreaSize.y-realPanElementH)+item.vGap.top:bounds.center.y;bounds.min.x=(realPanElementW>_tempPanAreaSize.x)?0:bounds.center.x;bounds.min.y=(realPanElementH>_tempPanAreaSize.y)?item.vGap.top:bounds.center.y},_calculateItemSize=function(item,viewportSize,zoomLevel){if(item.src&&!item.loadError){var isInitial=!zoomLevel;if(isInitial){if(!item.vGap){item.vGap={top:0,bottom:0}}_shout("parseVerticalMargin",item)}_tempPanAreaSize.x=viewportSize.x;_tempPanAreaSize.y=viewportSize.y-item.vGap.top-item.vGap.bottom;if(isInitial){var hRatio=_tempPanAreaSize.x/item.w;var vRatio=_tempPanAreaSize.y/item.h;item.fitRatio=hRatio<vRatio?hRatio:vRatio;var scaleMode=_options.scaleMode;if(scaleMode==="orig"){zoomLevel=1}else{if(scaleMode==="fit"){zoomLevel=item.fitRatio}}if(zoomLevel>1){zoomLevel=1}item.initialZoomLevel=zoomLevel;if(!item.bounds){item.bounds=_getZeroBounds()}}if(!zoomLevel){return}_calculateSingleItemPanBounds(item,item.w*zoomLevel,item.h*zoomLevel);if(isInitial&&zoomLevel===item.initialZoomLevel){item.initialPosition=item.bounds.center}return item.bounds}else{item.w=item.h=0;item.initialZoomLevel=item.fitRatio=1;item.bounds=_getZeroBounds();item.initialPosition=item.bounds.center;return item.bounds}},_appendImage=function(index,item,baseDiv,img,preventAnimation,keepPlaceholder){if(item.loadError){return}if(img){item.imageAppended=true;_setImageSize(item,img,(item===self.currItem&&_renderMaxResolution));baseDiv.appendChild(img);if(keepPlaceholder){setTimeout(function(){if(item&&item.loaded&&item.placeholder){item.placeholder.style.display="none";item.placeholder=null}},500)}}},_preloadImage=function(item){item.loading=true;item.loaded=false;var img=item.img=framework.createEl("pswp__img","img");var onComplete=function(){item.loading=false;item.loaded=true;if(item.loadComplete){item.loadComplete(item)}else{item.img=null}img.onload=img.onerror=null;img=null};img.onload=onComplete;img.onerror=function(){item.loadError=true;onComplete()};img.src=item.src;return img},_checkForError=function(item,cleanUp){if(item.src&&item.loadError&&item.container){if(cleanUp){item.container.innerHTML=""}item.container.innerHTML=_options.errorMsg.replace("%url%",item.src);return true}},_setImageSize=function(item,img,maxRes){if(!item.src){return}if(!img){img=item.container.lastChild}var w=maxRes?item.w:Math.round(item.w*item.fitRatio),h=maxRes?item.h:Math.round(item.h*item.fitRatio);if(item.placeholder&&!item.loaded){item.placeholder.style.width=w+"px";item.placeholder.style.height=h+"px"}img.style.width=w+"px";img.style.height=h+"px"},_appendImagesPool=function(){if(_imagesToAppendPool.length){var poolItem;for(var i=0;i<_imagesToAppendPool.length;i++){poolItem=_imagesToAppendPool[i];if(poolItem.holder.index===poolItem.index){_appendImage(poolItem.index,poolItem.item,poolItem.baseDiv,poolItem.img,false,poolItem.clearPlaceholder)}}_imagesToAppendPool=[]}};_registerModule("Controller",{publicMethods:{lazyLoadItem:function(index){index=_getLoopedId(index);var item=_getItemAt(index);if(!item||((item.loaded||item.loading)&&!_itemsNeedUpdate)){return}_shout("gettingData",index,item);if(!item.src){return}_preloadImage(item)},initController:function(){framework.extend(_options,_controllerDefaultOptions,true);self.items=_items=items;_getItemAt=self.getItemAt;_getNumItems=_options.getNumItemsFn;_initialIsLoop=_options.loop;if(_getNumItems()<3){_options.loop=false}_listen("beforeChange",function(diff){var p=_options.preload,isNext=diff===null?true:(diff>=0),preloadBefore=Math.min(p[0],_getNumItems()),preloadAfter=Math.min(p[1],_getNumItems()),i;for(i=1;i<=(isNext?preloadAfter:preloadBefore);i++){self.lazyLoadItem(_currentItemIndex+i)}for(i=1;i<=(isNext?preloadBefore:preloadAfter);i++){self.lazyLoadItem(_currentItemIndex-i)}});_listen("initialLayout",function(){self.currItem.initialLayout=_options.getThumbBoundsFn&&_options.getThumbBoundsFn(_currentItemIndex)});_listen("mainScrollAnimComplete",_appendImagesPool);_listen("initialZoomInEnd",_appendImagesPool);_listen("destroy",function(){var item;for(var i=0;i<_items.length;i++){item=_items[i];if(item.container){item.container=null}if(item.placeholder){item.placeholder=null}if(item.img){item.img=null}if(item.preloader){item.preloader=null}if(item.loadError){item.loaded=item.loadError=false}}_imagesToAppendPool=null})},getItemAt:function(index){if(index>=0){return _items[index]!==undefined?_items[index]:false}return false},allowProgressiveImg:function(){return _options.forceProgressiveLoading||!_likelyTouchDevice||_options.mouseUsed||screen.width>1200},setContent:function(holder,index){if(_options.loop){index=_getLoopedId(index)}var prevItem=self.getItemAt(holder.index);if(prevItem){prevItem.container=null}var item=self.getItemAt(index),img;if(!item){holder.el.innerHTML="";return}_shout("gettingData",index,item);holder.index=index;holder.item=item;var baseDiv=item.container=framework.createEl("pswp__zoom-wrap");if(!item.src&&item.html){if(item.html.tagName){baseDiv.appendChild(item.html)}else{baseDiv.innerHTML=item.html}}_checkForError(item);_calculateItemSize(item,_viewportSize);if(item.src&&!item.loadError&&!item.loaded){item.loadComplete=function(item){if(!_isOpen){return}if(holder&&holder.index===index){if(_checkForError(item,true)){item.loadComplete=item.img=null;_calculateItemSize(item,_viewportSize);_applyZoomPanToItem(item);if(holder.index===_currentItemIndex){self.updateCurrZoomItem()}return}if(!item.imageAppended){if(_features.transform&&(_mainScrollAnimating||_initialZoomRunning)){_imagesToAppendPool.push({item:item,baseDiv:baseDiv,img:item.img,index:index,holder:holder,clearPlaceholder:true})}else{_appendImage(index,item,baseDiv,item.img,_mainScrollAnimating||_initialZoomRunning,true)}}else{if(!_initialZoomRunning&&item.placeholder){item.placeholder.style.display="none";item.placeholder=null}}}item.loadComplete=null;item.img=null;_shout("imageLoadComplete",index,item)};if(framework.features.transform){var placeholderClassName="pswp__img pswp__img--placeholder";placeholderClassName+=(item.msrc?"":" pswp__img--placeholder--blank");var placeholder=framework.createEl(placeholderClassName,item.msrc?"img":"");if(item.msrc){placeholder.src=item.msrc}_setImageSize(item,placeholder);baseDiv.appendChild(placeholder);item.placeholder=placeholder}if(!item.loading){_preloadImage(item)}if(self.allowProgressiveImg()){if(!_initialContentSet&&_features.transform){_imagesToAppendPool.push({item:item,baseDiv:baseDiv,img:item.img,index:index,holder:holder})}else{_appendImage(index,item,baseDiv,item.img,true,true)}}}else{if(item.src&&!item.loadError){img=framework.createEl("pswp__img","img");img.style.opacity=1;img.src=item.src;_setImageSize(item,img);_appendImage(index,item,baseDiv,img,true)}}if(!_initialContentSet&&index===_currentItemIndex){_currZoomElementStyle=baseDiv.style;_showOrHide(item,(img||item.img))}else{_applyZoomPanToItem(item)}holder.el.innerHTML="";holder.el.appendChild(baseDiv)},cleanSlide:function(item){if(item.img){item.img.onload=item.img.onerror=null}item.loaded=item.loading=item.img=item.imageAppended=false}}});var tapTimer,tapReleasePoint={},_dispatchTapEvent=function(origEvent,releasePoint,pointerType){var e=document.createEvent("CustomEvent"),eDetail={origEvent:origEvent,target:origEvent.target,releasePoint:releasePoint,pointerType:pointerType||"touch"};e.initCustomEvent("pswpTap",true,true,eDetail);origEvent.target.dispatchEvent(e)};_registerModule("Tap",{publicMethods:{initTap:function(){_listen("firstTouchStart",self.onTapStart);_listen("touchRelease",self.onTapRelease);_listen("destroy",function(){tapReleasePoint={};tapTimer=null})},onTapStart:function(touchList){if(touchList.length>1){clearTimeout(tapTimer);tapTimer=null}},onTapRelease:function(e,releasePoint){if(!releasePoint){return}if(!_moved&&!_isMultitouch&&!_numAnimations){var p0=releasePoint;if(tapTimer){clearTimeout(tapTimer);tapTimer=null;if(_isNearbyPoints(p0,tapReleasePoint)){_shout("doubleTap",p0);return}}if(releasePoint.type==="mouse"){_dispatchTapEvent(e,releasePoint,"mouse");return}var clickedTagName=e.target.tagName.toUpperCase();if(clickedTagName==="BUTTON"||framework.hasClass(e.target,"pswp__single-tap")){_dispatchTapEvent(e,releasePoint);return}_equalizePoints(tapReleasePoint,p0);tapTimer=setTimeout(function(){_dispatchTapEvent(e,releasePoint);tapTimer=null},300)}}}});var _wheelDelta;_registerModule("DesktopZoom",{publicMethods:{initDesktopZoom:function(){if(_oldIE){return}if(_likelyTouchDevice){_listen("mouseUsed",function(){self.setupDesktopZoom()})}else{self.setupDesktopZoom(true)}},setupDesktopZoom:function(onInit){_wheelDelta={};var events="wheel mousewheel DOMMouseScroll";_listen("bindEvents",function(){framework.bind(template,events,self.handleMouseWheel)});_listen("unbindEvents",function(){if(_wheelDelta){framework.unbind(template,events,self.handleMouseWheel)}});self.mouseZoomedIn=false;var hasDraggingClass,updateZoomable=function(){if(self.mouseZoomedIn){framework.removeClass(template,"pswp--zoomed-in");self.mouseZoomedIn=false}if(_currZoomLevel<1){framework.addClass(template,"pswp--zoom-allowed")}else{framework.removeClass(template,"pswp--zoom-allowed")}removeDraggingClass()},removeDraggingClass=function(){if(hasDraggingClass){framework.removeClass(template,"pswp--dragging");hasDraggingClass=false}};_listen("resize",updateZoomable);_listen("afterChange",updateZoomable);_listen("pointerDown",function(){if(self.mouseZoomedIn){hasDraggingClass=true;framework.addClass(template,"pswp--dragging")}});_listen("pointerUp",removeDraggingClass);if(!onInit){updateZoomable()}},handleMouseWheel:function(e){if(_currZoomLevel<=self.currItem.fitRatio){if(_options.modal){if(!_options.closeOnScroll||_numAnimations||_isDragging){e.preventDefault()}else{if(_transformKey&&Math.abs(e.deltaY)>2){_closedByScroll=true;self.close()}}}return true}e.stopPropagation();_wheelDelta.x=0;if("deltaX" in e){if(e.deltaMode===1){_wheelDelta.x=e.deltaX*18;_wheelDelta.y=e.deltaY*18}else{_wheelDelta.x=e.deltaX;_wheelDelta.y=e.deltaY}}else{if("wheelDelta" in e){if(e.wheelDeltaX){_wheelDelta.x=-0.16*e.wheelDeltaX}if(e.wheelDeltaY){_wheelDelta.y=-0.16*e.wheelDeltaY}else{_wheelDelta.y=-0.16*e.wheelDelta}}else{if("detail" in e){_wheelDelta.y=e.detail}else{return}}}_calculatePanBounds(_currZoomLevel,true);var newPanX=_panOffset.x-_wheelDelta.x,newPanY=_panOffset.y-_wheelDelta.y;if(_options.modal||(newPanX<=_currPanBounds.min.x&&newPanX>=_currPanBounds.max.x&&newPanY<=_currPanBounds.min.y&&newPanY>=_currPanBounds.max.y)){e.preventDefault()}self.panTo(newPanX,newPanY)},toggleDesktopZoom:function(centerPoint){centerPoint=centerPoint||{x:_viewportSize.x/2+_offset.x,y:_viewportSize.y/2+_offset.y};var doubleTapZoomLevel=_options.getDoubleTapZoom(true,self.currItem);var zoomOut=_currZoomLevel===doubleTapZoomLevel;self.mouseZoomedIn=!zoomOut;self.zoomTo(zoomOut?self.currItem.initialZoomLevel:doubleTapZoomLevel,centerPoint,333);framework[(!zoomOut?"add":"remove")+"Class"](template,"pswp--zoomed-in")}}});var _historyDefaultOptions={history:true,galleryUID:1};var _historyUpdateTimeout,_hashChangeTimeout,_hashAnimCheckTimeout,_hashChangedByScript,_hashChangedByHistory,_hashReseted,_initialHash,_historyChanged,_closedFromURL,_urlChangedOnce,_windowLoc,_supportsPushState,_getHash=function(){return _windowLoc.hash.substring(1)},_cleanHistoryTimeouts=function(){if(_historyUpdateTimeout){clearTimeout(_historyUpdateTimeout)}if(_hashAnimCheckTimeout){clearTimeout(_hashAnimCheckTimeout)}},_parseItemIndexFromURL=function(){var hash=_getHash(),params={};if(hash.length<5){return params}var i,vars=hash.split("&");for(i=0;i<vars.length;i++){if(!vars[i]){continue}var pair=vars[i].split("=");if(pair.length<2){continue}params[pair[0]]=pair[1]}if(_options.galleryPIDs){var searchfor=params.pid;params.pid=0;for(i=0;i<_items.length;i++){if(_items[i].pid===searchfor){params.pid=i;break}}}else{params.pid=parseInt(params.pid,10)-1}if(params.pid<0){params.pid=0}return params},_updateHash=function(){if(_hashAnimCheckTimeout){clearTimeout(_hashAnimCheckTimeout)}if(_numAnimations||_isDragging){_hashAnimCheckTimeout=setTimeout(_updateHash,500);return}if(_hashChangedByScript){clearTimeout(_hashChangeTimeout)}else{_hashChangedByScript=true}var pid=(_currentItemIndex+1);var item=_getItemAt(_currentItemIndex);if(item.hasOwnProperty("pid")){pid=item.pid}var newHash=_initialHash+"&gid="+_options.galleryUID+"&pid="+pid;if(!_historyChanged){if(_windowLoc.hash.indexOf(newHash)===-1){_urlChangedOnce=true}}var newURL=_windowLoc.href.split("#")[0]+"#"+newHash;if(_supportsPushState){if("#"+newHash!==window.location.hash){history[_historyChanged?"replaceState":"pushState"]("",document.title,newURL)}}else{if(_historyChanged){_windowLoc.replace(newURL)}else{_windowLoc.hash=newHash}}_historyChanged=true;_hashChangeTimeout=setTimeout(function(){_hashChangedByScript=false},60)};_registerModule("History",{publicMethods:{initHistory:function(){framework.extend(_options,_historyDefaultOptions,true);if(!_options.history){return}_windowLoc=window.location;_urlChangedOnce=false;_closedFromURL=false;_historyChanged=false;_initialHash=_getHash();_supportsPushState=("pushState" in history);if(_initialHash.indexOf("gid=")>-1){_initialHash=_initialHash.split("&gid=")[0];_initialHash=_initialHash.split("?gid=")[0]}_listen("afterChange",self.updateURL);_listen("unbindEvents",function(){framework.unbind(window,"hashchange",self.onHashChange)});var returnToOriginal=function(){_hashReseted=true;if(!_closedFromURL){if(_urlChangedOnce){history.back()}else{if(_initialHash){_windowLoc.hash=_initialHash}else{if(_supportsPushState){history.pushState("",document.title,_windowLoc.pathname+_windowLoc.search)}else{_windowLoc.hash=""}}}}_cleanHistoryTimeouts()};_listen("unbindEvents",function(){if(_closedByScroll){returnToOriginal()}});_listen("destroy",function(){if(!_hashReseted){returnToOriginal()}});_listen("firstUpdate",function(){_currentItemIndex=_parseItemIndexFromURL().pid});var index=_initialHash.indexOf("pid=");if(index>-1){_initialHash=_initialHash.substring(0,index);if(_initialHash.slice(-1)==="&"){_initialHash=_initialHash.slice(0,-1)}}setTimeout(function(){if(_isOpen){framework.bind(window,"hashchange",self.onHashChange)}},40)},onHashChange:function(){if(_getHash()===_initialHash){_closedFromURL=true;self.close();return}if(!_hashChangedByScript){_hashChangedByHistory=true;self.goTo(_parseItemIndexFromURL().pid);_hashChangedByHistory=false}},updateURL:function(){_cleanHistoryTimeouts();if(_hashChangedByHistory){return}if(!_historyChanged){_updateHash()}else{_historyUpdateTimeout=setTimeout(_updateHash,800)}}}});framework.extend(self,publicMethods)};return PhotoSwipe});
/* PhotoSwipe Default UI - 4.1.2 - 2017-04-05
* http://photoswipe.com
* Copyright (c) 2017 Dmitry Semenov; */
(function(root,factory){if(typeof define==="function"&&define.amd){define(factory)}else{if(typeof exports==="object"){module.exports=factory()}else{root.PhotoSwipeUI_Default=factory()}}})(this,function(){var PhotoSwipeUI_Default=function(pswp,framework){var ui=this;var _overlayUIUpdated=false,_controlsVisible=true,_fullscrenAPI,_controls,_captionContainer,_fakeCaptionContainer,_indexIndicator,_shareButton,_shareModal,_shareModalHidden=true,_initalCloseOnScrollValue,_isIdle,_listen,_loadingIndicator,_loadingIndicatorHidden,_loadingIndicatorTimeout,_galleryHasOneSlide,_options,_defaultUIOptions={barsSize:{top:44,bottom:"auto"},closeElClasses:["item","caption","zoom-wrap","ui","top-bar"],timeToIdle:4000,timeToIdleOutside:1000,loadingIndicatorDelay:1000,addCaptionHTMLFn:function(item,captionEl){if(!item.title){captionEl.children[0].innerHTML="";return false}captionEl.children[0].innerHTML=item.title;return true},closeEl:true,captionEl:true,fullscreenEl:true,zoomEl:true,shareEl:true,counterEl:true,arrowEl:true,preloaderEl:true,tapToClose:false,tapToToggleControls:true,clickToCloseNonZoomable:true,shareButtons:[{id:"facebook",label:"Share on Facebook",url:"https://www.facebook.com/sharer/sharer.php?u={{url}}"},{id:"twitter",label:"Tweet",url:"https://twitter.com/intent/tweet?text={{text}}&url={{url}}"},{id:"pinterest",label:"Pin it",url:"http://www.pinterest.com/pin/create/button/?url={{url}}&media={{image_url}}&description={{text}}"},{id:"download",label:"Download image",url:"{{raw_image_url}}",download:true}],getImageURLForShare:function(){return pswp.currItem.src||""},getPageURLForShare:function(){return window.location.href},getTextForShare:function(){return pswp.currItem.title||""},indexIndicatorSep:" / ",fitControlsWidth:1200},_blockControlsTap,_blockControlsTapTimeout;var _onControlsTap=function(e){if(_blockControlsTap){return true}e=e||window.event;if(_options.timeToIdle&&_options.mouseUsed&&!_isIdle){_onIdleMouseMove()}var target=e.target||e.srcElement,uiElement,clickedClass=target.getAttribute("class")||"",found;for(var i=0;i<_uiElements.length;i++){uiElement=_uiElements[i];if(uiElement.onTap&&clickedClass.indexOf("pswp__"+uiElement.name)>-1){uiElement.onTap();found=true}}if(found){if(e.stopPropagation){e.stopPropagation()}_blockControlsTap=true;var tapDelay=framework.features.isOldAndroid?600:30;_blockControlsTapTimeout=setTimeout(function(){_blockControlsTap=false},tapDelay)}},_fitControlsInViewport=function(){return !pswp.likelyTouchDevice||_options.mouseUsed||screen.width>_options.fitControlsWidth},_togglePswpClass=function(el,cName,add){framework[(add?"add":"remove")+"Class"](el,"pswp__"+cName)},_countNumItems=function(){var hasOneSlide=(_options.getNumItemsFn()===1);if(hasOneSlide!==_galleryHasOneSlide){_togglePswpClass(_controls,"ui--one-slide",hasOneSlide);_galleryHasOneSlide=hasOneSlide}},_toggleShareModalClass=function(){_togglePswpClass(_shareModal,"share-modal--hidden",_shareModalHidden)},_toggleShareModal=function(){_shareModalHidden=!_shareModalHidden;if(!_shareModalHidden){_toggleShareModalClass();setTimeout(function(){if(!_shareModalHidden){framework.addClass(_shareModal,"pswp__share-modal--fade-in")}},30)}else{framework.removeClass(_shareModal,"pswp__share-modal--fade-in");setTimeout(function(){if(_shareModalHidden){_toggleShareModalClass()}},300)}if(!_shareModalHidden){_updateShareURLs()}return false},_openWindowPopup=function(e){e=e||window.event;var target=e.target||e.srcElement;pswp.shout("shareLinkClick",e,target);if(!target.href){return false}if(target.hasAttribute("download")){return true}window.open(target.href,"pswp_share","scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,top=100,left="+(window.screen?Math.round(screen.width/2-275):100));if(!_shareModalHidden){_toggleShareModal()}return false},_updateShareURLs=function(){var shareButtonOut="",shareButtonData,shareURL,image_url,page_url,share_text;for(var i=0;i<_options.shareButtons.length;i++){shareButtonData=_options.shareButtons[i];image_url=_options.getImageURLForShare(shareButtonData);page_url=_options.getPageURLForShare(shareButtonData);share_text=_options.getTextForShare(shareButtonData);shareURL=shareButtonData.url.replace("{{url}}",encodeURIComponent(page_url)).replace("{{image_url}}",encodeURIComponent(image_url)).replace("{{raw_image_url}}",image_url).replace("{{text}}",encodeURIComponent(share_text));shareButtonOut+='<a href="'+shareURL+'" target="_blank" class="pswp__share--'+shareButtonData.id+'"'+(shareButtonData.download?"download":"")+">"+shareButtonData.label+"</a>";if(_options.parseShareButtonOut){shareButtonOut=_options.parseShareButtonOut(shareButtonData,shareButtonOut)}}_shareModal.children[0].innerHTML=shareButtonOut;_shareModal.children[0].onclick=_openWindowPopup},_hasCloseClass=function(target){for(var i=0;i<_options.closeElClasses.length;i++){if(framework.hasClass(target,"pswp__"+_options.closeElClasses[i])){return true}}},_idleInterval,_idleTimer,_idleIncrement=0,_onIdleMouseMove=function(){clearTimeout(_idleTimer);_idleIncrement=0;if(_isIdle){ui.setIdle(false)}},_onMouseLeaveWindow=function(e){e=e?e:window.event;var from=e.relatedTarget||e.toElement;if(!from||from.nodeName==="HTML"){clearTimeout(_idleTimer);_idleTimer=setTimeout(function(){ui.setIdle(true)},_options.timeToIdleOutside)}},_setupFullscreenAPI=function(){if(_options.fullscreenEl&&!framework.features.isOldAndroid){if(!_fullscrenAPI){_fullscrenAPI=ui.getFullscreenAPI()}if(_fullscrenAPI){framework.bind(document,_fullscrenAPI.eventK,ui.updateFullscreen);ui.updateFullscreen();framework.addClass(pswp.template,"pswp--supports-fs")}else{framework.removeClass(pswp.template,"pswp--supports-fs")}}},_setupLoadingIndicator=function(){if(_options.preloaderEl){_toggleLoadingIndicator(true);_listen("beforeChange",function(){clearTimeout(_loadingIndicatorTimeout);_loadingIndicatorTimeout=setTimeout(function(){if(pswp.currItem&&pswp.currItem.loading){if(!pswp.allowProgressiveImg()||(pswp.currItem.img&&!pswp.currItem.img.naturalWidth)){_toggleLoadingIndicator(false)}}else{_toggleLoadingIndicator(true)}},_options.loadingIndicatorDelay)});_listen("imageLoadComplete",function(index,item){if(pswp.currItem===item){_toggleLoadingIndicator(true)}})}},_toggleLoadingIndicator=function(hide){if(_loadingIndicatorHidden!==hide){_togglePswpClass(_loadingIndicator,"preloader--active",!hide);_loadingIndicatorHidden=hide}},_applyNavBarGaps=function(item){var gap=item.vGap;if(_fitControlsInViewport()){var bars=_options.barsSize;if(_options.captionEl&&bars.bottom==="auto"){if(!_fakeCaptionContainer){_fakeCaptionContainer=framework.createEl("pswp__caption pswp__caption--fake");_fakeCaptionContainer.appendChild(framework.createEl("pswp__caption__center"));_controls.insertBefore(_fakeCaptionContainer,_captionContainer);framework.addClass(_controls,"pswp__ui--fit")}if(_options.addCaptionHTMLFn(item,_fakeCaptionContainer,true)){var captionSize=_fakeCaptionContainer.clientHeight;gap.bottom=parseInt(captionSize,10)||44}else{gap.bottom=bars.top}}else{gap.bottom=bars.bottom==="auto"?0:bars.bottom}gap.top=bars.top}else{gap.top=gap.bottom=0}},_setupIdle=function(){if(_options.timeToIdle){_listen("mouseUsed",function(){framework.bind(document,"mousemove",_onIdleMouseMove);framework.bind(document,"mouseout",_onMouseLeaveWindow);_idleInterval=setInterval(function(){_idleIncrement++;if(_idleIncrement===2){ui.setIdle(true)}},_options.timeToIdle/2)})}},_setupHidingControlsDuringGestures=function(){_listen("onVerticalDrag",function(now){if(_controlsVisible&&now<0.95){ui.hideControls()}else{if(!_controlsVisible&&now>=0.95){ui.showControls()}}});var pinchControlsHidden;_listen("onPinchClose",function(now){if(_controlsVisible&&now<0.9){ui.hideControls();pinchControlsHidden=true}else{if(pinchControlsHidden&&!_controlsVisible&&now>0.9){ui.showControls()}}});_listen("zoomGestureEnded",function(){pinchControlsHidden=false;if(pinchControlsHidden&&!_controlsVisible){ui.showControls()}})};var _uiElements=[{name:"caption",option:"captionEl",onInit:function(el){_captionContainer=el}},{name:"share-modal",option:"shareEl",onInit:function(el){_shareModal=el},onTap:function(){_toggleShareModal()}},{name:"button--share",option:"shareEl",onInit:function(el){_shareButton=el},onTap:function(){_toggleShareModal()}},{name:"button--zoom",option:"zoomEl",onTap:pswp.toggleDesktopZoom},{name:"counter",option:"counterEl",onInit:function(el){_indexIndicator=el}},{name:"button--close",option:"closeEl",onTap:pswp.close},{name:"button--arrow--left",option:"arrowEl",onTap:pswp.prev},{name:"button--arrow--right",option:"arrowEl",onTap:pswp.next},{name:"button--fs",option:"fullscreenEl",onTap:function(){if(_fullscrenAPI.isFullscreen()){_fullscrenAPI.exit()}else{_fullscrenAPI.enter()}}},{name:"preloader",option:"preloaderEl",onInit:function(el){_loadingIndicator=el}}];var _setupUIElements=function(){var item,classAttr,uiElement;var loopThroughChildElements=function(sChildren){if(!sChildren){return}var l=sChildren.length;for(var i=0;i<l;i++){item=sChildren[i];classAttr=item.className;for(var a=0;a<_uiElements.length;a++){uiElement=_uiElements[a];if(classAttr.indexOf("pswp__"+uiElement.name)>-1){if(_options[uiElement.option]){framework.removeClass(item,"pswp__element--disabled");if(uiElement.onInit){uiElement.onInit(item)}}else{framework.addClass(item,"pswp__element--disabled")}}}}};loopThroughChildElements(_controls.children);var topBar=framework.getChildByClass(_controls,"pswp__top-bar");if(topBar){loopThroughChildElements(topBar.children)}};ui.init=function(){framework.extend(pswp.options,_defaultUIOptions,true);_options=pswp.options;_controls=framework.getChildByClass(pswp.scrollWrap,"pswp__ui");_listen=pswp.listen;_setupHidingControlsDuringGestures();_listen("beforeChange",ui.update);_listen("doubleTap",function(point){var initialZoomLevel=pswp.currItem.initialZoomLevel;if(pswp.getZoomLevel()!==initialZoomLevel){pswp.zoomTo(initialZoomLevel,point,333)}else{pswp.zoomTo(_options.getDoubleTapZoom(false,pswp.currItem),point,333)}});_listen("preventDragEvent",function(e,isDown,preventObj){var t=e.target||e.srcElement;if(t&&t.getAttribute("class")&&e.type.indexOf("mouse")>-1&&(t.getAttribute("class").indexOf("__caption")>0||(/(SMALL|STRONG|EM)/i).test(t.tagName))){preventObj.prevent=false}});_listen("bindEvents",function(){framework.bind(_controls,"pswpTap click",_onControlsTap);framework.bind(pswp.scrollWrap,"pswpTap",ui.onGlobalTap);if(!pswp.likelyTouchDevice){framework.bind(pswp.scrollWrap,"mouseover",ui.onMouseOver)}});_listen("unbindEvents",function(){if(!_shareModalHidden){_toggleShareModal()}if(_idleInterval){clearInterval(_idleInterval)}framework.unbind(document,"mouseout",_onMouseLeaveWindow);framework.unbind(document,"mousemove",_onIdleMouseMove);framework.unbind(_controls,"pswpTap click",_onControlsTap);framework.unbind(pswp.scrollWrap,"pswpTap",ui.onGlobalTap);framework.unbind(pswp.scrollWrap,"mouseover",ui.onMouseOver);if(_fullscrenAPI){framework.unbind(document,_fullscrenAPI.eventK,ui.updateFullscreen);if(_fullscrenAPI.isFullscreen()){_options.hideAnimationDuration=0;_fullscrenAPI.exit()}_fullscrenAPI=null}});_listen("destroy",function(){if(_options.captionEl){if(_fakeCaptionContainer){_controls.removeChild(_fakeCaptionContainer)}framework.removeClass(_captionContainer,"pswp__caption--empty")}if(_shareModal){_shareModal.children[0].onclick=null}framework.removeClass(_controls,"pswp__ui--over-close");framework.addClass(_controls,"pswp__ui--hidden");ui.setIdle(false)});if(!_options.showAnimationDuration){framework.removeClass(_controls,"pswp__ui--hidden")}_listen("initialZoomIn",function(){if(_options.showAnimationDuration){framework.removeClass(_controls,"pswp__ui--hidden")}});_listen("initialZoomOut",function(){framework.addClass(_controls,"pswp__ui--hidden")});_listen("parseVerticalMargin",_applyNavBarGaps);_setupUIElements();if(_options.shareEl&&_shareButton&&_shareModal){_shareModalHidden=true}_countNumItems();_setupIdle();_setupFullscreenAPI();_setupLoadingIndicator()};ui.setIdle=function(isIdle){_isIdle=isIdle;_togglePswpClass(_controls,"ui--idle",isIdle)};ui.update=function(){if(_controlsVisible&&pswp.currItem){ui.updateIndexIndicator();if(_options.captionEl){_options.addCaptionHTMLFn(pswp.currItem,_captionContainer);_togglePswpClass(_captionContainer,"caption--empty",!pswp.currItem.title)}_overlayUIUpdated=true}else{_overlayUIUpdated=false}if(!_shareModalHidden){_toggleShareModal()}_countNumItems()};ui.updateFullscreen=function(e){if(e){setTimeout(function(){pswp.setScrollOffset(0,framework.getScrollY())},50)}framework[(_fullscrenAPI.isFullscreen()?"add":"remove")+"Class"](pswp.template,"pswp--fs")};ui.updateIndexIndicator=function(){if(_options.counterEl){_indexIndicator.innerHTML=(pswp.getCurrentIndex()+1)+_options.indexIndicatorSep+_options.getNumItemsFn()}};ui.onGlobalTap=function(e){e=e||window.event;var target=e.target||e.srcElement;if(_blockControlsTap){return}if(e.detail&&e.detail.pointerType==="mouse"){if(_hasCloseClass(target)){pswp.close();return}if(framework.hasClass(target,"pswp__img")){if(pswp.getZoomLevel()===1&&pswp.getZoomLevel()<=pswp.currItem.fitRatio){if(_options.clickToCloseNonZoomable){pswp.close()}}else{pswp.toggleDesktopZoom(e.detail.releasePoint)}}}else{if(_options.tapToToggleControls){if(_controlsVisible){ui.hideControls()}else{ui.showControls()}}if(_options.tapToClose&&(framework.hasClass(target,"pswp__img")||_hasCloseClass(target))){pswp.close();return}}};ui.onMouseOver=function(e){e=e||window.event;var target=e.target||e.srcElement;_togglePswpClass(_controls,"ui--over-close",_hasCloseClass(target))};ui.hideControls=function(){framework.addClass(_controls,"pswp__ui--hidden");_controlsVisible=false};ui.showControls=function(){_controlsVisible=true;if(!_overlayUIUpdated){ui.update()}framework.removeClass(_controls,"pswp__ui--hidden")};ui.supportsFullscreen=function(){var d=document;return !!(d.exitFullscreen||d.mozCancelFullScreen||d.webkitExitFullscreen||d.msExitFullscreen)};ui.getFullscreenAPI=function(){var dE=document.documentElement,api,tF="fullscreenchange";if(dE.requestFullscreen){api={enterK:"requestFullscreen",exitK:"exitFullscreen",elementK:"fullscreenElement",eventK:tF}}else{if(dE.mozRequestFullScreen){api={enterK:"mozRequestFullScreen",exitK:"mozCancelFullScreen",elementK:"mozFullScreenElement",eventK:"moz"+tF}}else{if(dE.webkitRequestFullscreen){api={enterK:"webkitRequestFullscreen",exitK:"webkitExitFullscreen",elementK:"webkitFullscreenElement",eventK:"webkit"+tF}}else{if(dE.msRequestFullscreen){api={enterK:"msRequestFullscreen",exitK:"msExitFullscreen",elementK:"msFullscreenElement",eventK:"MSFullscreenChange"}}}}}if(api){api.enter=function(){_initalCloseOnScrollValue=_options.closeOnScroll;_options.closeOnScroll=false;if(this.enterK==="webkitRequestFullscreen"){pswp.template[this.enterK](Element.ALLOW_KEYBOARD_INPUT)}else{return pswp.template[this.enterK]()}};api.exit=function(){_options.closeOnScroll=_initalCloseOnScrollValue;return document[this.exitK]()};api.isFullscreen=function(){return document[this.elementK]}}return api}};return PhotoSwipeUI_Default});!function(e){e(["jquery"],function(e){return function(){function t(e,t,n){return g({type:O.error,iconClass:m().iconClasses.error,message:e,optionsOverride:n,title:t})}function n(t,n){return t||(t=m()),v=e("#"+t.containerId),v.length?v:(n&&(v=d(t)),v)}function o(e,t,n){return g({type:O.info,iconClass:m().iconClasses.info,message:e,optionsOverride:n,title:t})}function s(e){C=e}function i(e,t,n){return g({type:O.success,iconClass:m().iconClasses.success,message:e,optionsOverride:n,title:t})}function a(e,t,n){return g({type:O.warning,iconClass:m().iconClasses.warning,message:e,optionsOverride:n,title:t})}function r(e,t){var o=m();v||n(o),u(e,o,t)||l(o)}function c(t){var o=m();return v||n(o),t&&0===e(":focus",t).length?void h(t):void (v.children().length&&v.remove())}function l(t){for(var n=v.children(),o=n.length-1;o>=0;o--){u(e(n[o]),t)}}function u(t,n,o){var s=!(!o||!o.force)&&o.force;return !(!t||!s&&0!==e(":focus",t).length)&&(t[n.hideMethod]({duration:n.hideDuration,easing:n.hideEasing,complete:function(){h(t)}}),!0)}function d(t){return v=e("<div/>").attr("id",t.containerId).addClass(t.positionClass),v.appendTo(e(t.target)),v}function p(){return{tapToDismiss:!0,toastClass:"toast",containerId:"toast-container",debug:!1,showMethod:"fadeIn",showDuration:300,showEasing:"swing",onShown:void 0,hideMethod:"fadeOut",hideDuration:1000,hideEasing:"swing",onHidden:void 0,closeMethod:!1,closeDuration:!1,closeEasing:!1,closeOnHover:!0,extendedTimeOut:1000,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},iconClass:"toast-info",positionClass:"toast-top-right",timeOut:5000,titleClass:"toast-title",messageClass:"toast-message",escapeHtml:!1,target:"body",closeHtml:'<button type="button">&times;</button>',closeClass:"toast-close-button",newestOnTop:!0,preventDuplicates:!1,progressBar:!1,progressClass:"toast-progress",rtl:!1}}function f(e){C&&C(e)}function g(t){function o(e){return null==e&&(e=""),e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function s(){c(),u(),d(),p(),g(),C(),l(),i()}function i(){var e="";switch(t.iconClass){case"toast-success":case"toast-info":e="polite";break;default:e="assertive"}I.attr("aria-live",e)}function a(){E.closeOnHover&&I.hover(H,D),!E.onclick&&E.tapToDismiss&&I.click(b),E.closeButton&&j&&j.click(function(e){e.stopPropagation?e.stopPropagation():void 0!==e.cancelBubble&&e.cancelBubble!==!0&&(e.cancelBubble=!0),E.onCloseClick&&E.onCloseClick(e),b(!0)}),E.onclick&&I.click(function(e){E.onclick(e),b()})}function r(){I.hide(),I[E.showMethod]({duration:E.showDuration,easing:E.showEasing,complete:E.onShown}),E.timeOut>0&&(k=setTimeout(b,E.timeOut),F.maxHideTime=parseFloat(E.timeOut),F.hideEta=(new Date).getTime()+F.maxHideTime,E.progressBar&&(F.intervalId=setInterval(x,10)))}function c(){t.iconClass&&I.addClass(E.toastClass).addClass(y)}function l(){E.newestOnTop?v.prepend(I):v.append(I)}function u(){if(t.title){var e=t.title;E.escapeHtml&&(e=o(t.title)),M.append(e).addClass(E.titleClass),I.append(M)}}function d(){if(t.message){var e=t.message;E.escapeHtml&&(e=o(t.message)),B.append(e).addClass(E.messageClass),I.append(B)}}function p(){E.closeButton&&(j.addClass(E.closeClass).attr("role","button"),I.prepend(j))}function g(){E.progressBar&&(q.addClass(E.progressClass),I.prepend(q))}function C(){E.rtl&&I.addClass("rtl")}function O(e,t){if(e.preventDuplicates){if(t.message===w){return !0}w=t.message}return !1}function b(t){var n=t&&E.closeMethod!==!1?E.closeMethod:E.hideMethod,o=t&&E.closeDuration!==!1?E.closeDuration:E.hideDuration,s=t&&E.closeEasing!==!1?E.closeEasing:E.hideEasing;if(!e(":focus",I).length||t){return clearTimeout(F.intervalId),I[n]({duration:o,easing:s,complete:function(){h(I),clearTimeout(k),E.onHidden&&"hidden"!==P.state&&E.onHidden(),P.state="hidden",P.endTime=new Date,f(P)}})}}function D(){(E.timeOut>0||E.extendedTimeOut>0)&&(k=setTimeout(b,E.extendedTimeOut),F.maxHideTime=parseFloat(E.extendedTimeOut),F.hideEta=(new Date).getTime()+F.maxHideTime)}function H(){clearTimeout(k),F.hideEta=0,I.stop(!0,!0)[E.showMethod]({duration:E.showDuration,easing:E.showEasing})}function x(){var e=(F.hideEta-(new Date).getTime())/F.maxHideTime*100;q.width(e+"%")}var E=m(),y=t.iconClass||E.iconClass;if("undefined"!=typeof t.optionsOverride&&(E=e.extend(E,t.optionsOverride),y=t.optionsOverride.iconClass||y),!O(E,t)){T++,v=n(E,!0);var k=null,I=e("<div/>"),M=e("<div/>"),B=e("<div/>"),q=e("<div/>"),j=e(E.closeHtml),F={intervalId:null,hideEta:null,maxHideTime:null},P={toastId:T,state:"visible",startTime:new Date,options:E,map:t};return s(),r(),a(),f(P),E.debug&&console&&console.log(P),I}}function m(){return e.extend({},p(),b.options)}function h(e){v||(v=n()),e.is(":visible")||(e.remove(),e=null,0===v.children().length&&(v.remove(),w=void 0))}var v,C,w,T=0,O={error:"error",info:"info",success:"success",warning:"warning"},b={clear:r,remove:c,error:t,getContainer:n,info:o,options:{},subscribe:s,success:i,version:"2.1.4",warning:a};return b}()})}("function"==typeof define&&define.amd?define:function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):window.toastr=t(window.jQuery)});(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?factory(require("jquery")):typeof define==="function"&&define.amd?define(["jquery"],factory):(factory(global.jQuery))}(this,(function($){$=$&&$.hasOwnProperty("default")?$["default"]:$;var lang_util={isArray:function(array){return Array.isArray(array)},isFunction:function(it){return Object.prototype.toString.call(it)==="[object Function]"},isEmptyObject:function(obj){return Object.keys(obj).length===0&&obj.constructor===Object},isPlainObject:function(obj){if(obj===undefined||typeof obj!=="object"||obj===null||obj.nodeType||obj===obj.window){return false}if(obj.constructor&&!Object.prototype.hasOwnProperty.call(obj.constructor.prototype,"isPrototypeOf")){return false}return true}};var collection_util={compact:function(array){return array.filter(function(el){return !!el})},each:function(obj,callback){if(Array.isArray(obj)){obj.some(function(el,idx){return callback(el,idx)===false});return}Object.keys(obj).some(function(key){var value=obj[key];return callback(value,key)===false})},intersect:function(array1,array2){var result=[];if(!Array.isArray(array1)||!Array.isArray(array2)){return result}return array1.filter(function(el){return array2.indexOf(el)!==-1})},minus:function(array1,array2){if(!array2||array2.length===0){return array1}return array1.filter(function(el){return array2.indexOf(el)===-1})},makeArray:function(arrayLike){if(lang_util.isArray(arrayLike)){return Array.prototype.slice.call(arrayLike)}else{return[arrayLike]}},minusWithPartialMatching:function(array1,array2){if(!array2||array2.length===0){return array1}return array1.filter(function(el){return !array2.some(function(el2){return el2.indexOf(el)===0})})},slice:function(obj,start){return Array.prototype.slice.call(obj,start)}};var func_util={delay:function(handler,delay){return setTimeout(handler,delay||0)}};var object_util={areSame:function self(a,b){var same=true;if(typeof a!=typeof b){return false}if(typeof a=="object"&&a!=null&&b!=null){collection_util.each(a,function(value,i){return(same=self(value,b[i]))});return same}return a===b},assign:function(target,varArgs){if(typeof Object.assign==="function"){return Object.assign.apply(null,arguments)}if(target==null){throw new TypeError("Cannot convert undefined or null to object")}var to=Object(target);for(var index=1;index<arguments.length;index++){var nextSource=arguments[index];if(nextSource!=null){for(var nextKey in nextSource){if(Object.prototype.hasOwnProperty.call(nextSource,nextKey)){to[nextKey]=nextSource[nextKey]}}}}return to},clone:function(obj){return JSON.parse(JSON.stringify(obj))},compact:function(obj){var copy=object_util.clone(obj);collection_util.each(copy,function(val,key){if(val===null||val===undefined||val===""){delete copy[key]}});return copy},fieldsAreNotEmpty:function(obj,fields){if(!lang_util.isPlainObject(obj)){return false}var result=true;collection_util.each(fields,function(field,i){result=!!obj[field];return result});return result},getDeepValue:function self(obj,name){var path=name.split("."),step=path.shift();return(obj&&(path.length?self(obj[step],path.join(".")):obj[step]))},indexObjectsById:function(objectsArray,idField,indexField){var result={};collection_util.each(objectsArray,function(obj,idx){var key=obj[idField];var val={};if(indexField){val[indexField]=idx}result[key]=object_util.assign(val,obj)});return result}};var KEYS={ENTER:13,ESC:27,TAB:9,SPACE:32,UP:38,DOWN:40};var CLASSES={hint:"suggestions-hint",mobile:"suggestions-mobile",nowrap:"suggestions-nowrap",promo:"suggestions-promo",selected:"suggestions-selected",suggestion:"suggestions-suggestion",subtext:"suggestions-subtext",subtext_inline:"suggestions-subtext suggestions-subtext_inline",subtext_delimiter:"suggestions-subtext-delimiter",subtext_label:"suggestions-subtext suggestions-subtext_label",removeConstraint:"suggestions-remove",value:"suggestions-value"};var EVENT_NS=".suggestions";var DATA_ATTR_KEY="suggestions";var WORD_DELIMITERS="\\s\"'~\\*\\.,:\\|\\[\\]\\(\\)\\{\\}<>â";var WORD_PARTS_DELIMITERS="\\-\\+\\\\\\?!@#$%^&";var WORD_SPLITTER=new RegExp("["+WORD_DELIMITERS+"]+","g");var WORD_PARTS_SPLITTER=new RegExp("["+WORD_PARTS_DELIMITERS+"]+","g");var text_util={escapeHtml:function(str){var map={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};if(str){collection_util.each(map,function(html,ch){str=str.replace(new RegExp(ch,"g"),html)})}return str},escapeRegExChars:function(value){return value.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},formatToken:function(token){return token&&token.toLowerCase().replace(/[ÑÐ]/g,"Ðµ")},getWordExtractorRegExp:function(){return new RegExp("([^"+WORD_DELIMITERS+"]*)(["+WORD_DELIMITERS+"]*)","g")},normalize:function(str,stopwords){return text_util.split(str,stopwords).join(" ")},padEnd:function(sourceString,targetLength,padString){if(String.prototype.padEnd){return sourceString.padEnd(targetLength,padString)}targetLength=targetLength>>0;padString=String(typeof padString!=="undefined"?padString:" ");if(sourceString.length>targetLength){return String(sourceString)}else{targetLength=targetLength-sourceString.length;if(targetLength>padString.length){padString+=padString.repeat(targetLength/padString.length)}return String(sourceString)+padString.slice(0,targetLength)}},split:function(str,stopwords){var cleanStr=str.toLowerCase().replace("Ñ","Ðµ").replace(/(\d+)([Ð°-Ñ]{2,})/g,"$1 $2").replace(/([Ð°-Ñ]+)(\d+)/g,"$1 $2");var words=collection_util.compact(cleanStr.split(WORD_SPLITTER));if(!words.length){return[]}var lastWord=words.pop();var goodWords=collection_util.minus(words,stopwords);goodWords.push(lastWord);return goodWords},splitTokens:function(tokens){var result=[];collection_util.each(tokens,function(token,i){var subtokens=token.split(WORD_PARTS_SPLITTER);result=result.concat(collection_util.compact(subtokens))});return result},stringEncloses:function(str1,str2){return(str1.length>str2.length&&str1.toLowerCase().indexOf(str2.toLowerCase())!==-1)},tokenize:function(value,unformattableTokens){var tokens=collection_util.compact(text_util.formatToken(value).split(WORD_SPLITTER));var preferredTokens=collection_util.minus(tokens,unformattableTokens);var otherTokens=collection_util.minus(tokens,preferredTokens);tokens=text_util.withSubTokens(preferredTokens.concat(otherTokens));return tokens},withSubTokens:function(tokens){var result=[];collection_util.each(tokens,function(token,i){var subtokens=token.split(WORD_PARTS_SPLITTER);result.push(token);if(subtokens.length>1){result=result.concat(collection_util.compact(subtokens))}});return result}};var jqapi={Deferred:function(){return $.Deferred()},ajax:function(settings){return $.ajax(settings)},extend:function(){return $.extend.apply(null,arguments)},isJqObject:function(obj){return obj instanceof $},param:function(obj){return $.param(obj)},proxy:function(func,context){return $.proxy(func,context)},select:function(selector){return $(selector)},supportsCors:function(){return $.support.cors}};var ajax={getDefaultType:function(){return jqapi.supportsCors()?"POST":"GET"},getDefaultContentType:function(){return jqapi.supportsCors()?"application/json":"application/x-www-form-urlencoded"},fixURLProtocol:function(url){return jqapi.supportsCors()?url:url.replace(/^https?:/,location.protocol)},addUrlParams:function(url,params){return url+(/\?/.test(url)?"&":"?")+jqapi.param(params)},serialize:function(data){if(jqapi.supportsCors()){return JSON.stringify(data,function(key,value){return value===null?undefined:value})}else{data=object_util.compact(data);return jqapi.param(data,true)}}};var generateId=(function(){var counter=0;return function(prefix){return(prefix||"")+ ++counter}})();var utils={escapeRegExChars:text_util.escapeRegExChars,escapeHtml:text_util.escapeHtml,formatToken:text_util.formatToken,normalize:text_util.normalize,reWordExtractor:text_util.getWordExtractorRegExp,stringEncloses:text_util.stringEncloses,addUrlParams:ajax.addUrlParams,getDefaultContentType:ajax.getDefaultContentType,getDefaultType:ajax.getDefaultType,fixURLProtocol:ajax.fixURLProtocol,serialize:ajax.serialize,arrayMinus:collection_util.minus,arrayMinusWithPartialMatching:collection_util.minusWithPartialMatching,arraysIntersection:collection_util.intersect,compact:collection_util.compact,each:collection_util.each,makeArray:collection_util.makeArray,slice:collection_util.slice,delay:func_util.delay,areSame:object_util.areSame,compactObject:object_util.compact,getDeepValue:object_util.getDeepValue,fieldsNotEmpty:object_util.fieldsAreNotEmpty,indexBy:object_util.indexObjectsById,isArray:lang_util.isArray,isEmptyObject:lang_util.isEmptyObject,isFunction:lang_util.isFunction,isPlainObject:lang_util.isPlainObject,uniqueId:generateId};var DEFAULT_OPTIONS={$helpers:null,autoSelectFirst:false,containerClass:"suggestions-suggestions",count:5,deferRequestBy:100,enrichmentEnabled:true,formatResult:null,formatSelected:null,headers:null,hint:"ÐÑÐ±ÐµÑÐ¸ÑÐµ Ð²Ð°ÑÐ¸Ð°Ð½Ñ Ð¸Ð»Ð¸ Ð¿ÑÐ¾Ð´Ð¾Ð»Ð¶Ð¸ÑÐµ Ð²Ð²Ð¾Ð´",initializeInterval:100,language:null,minChars:1,mobileWidth:600,noCache:false,noSuggestionsHint:null,onInvalidateSelection:null,onSearchComplete:$.noop,onSearchError:$.noop,onSearchStart:$.noop,onSelect:null,onSelectNothing:null,onSuggestionsFetch:null,paramName:"query",params:{},preventBadQueries:false,requestMode:"suggest",scrollOnFocus:false,serviceUrl:"https://suggestions.dadata.ru/suggestions/api/4_1/rs",tabDisabled:false,timeout:3000,triggerSelectOnBlur:true,triggerSelectOnEnter:true,triggerSelectOnSpace:false,type:null,url:null};function sameParentChecker(preprocessFn){return function(suggestions){if(suggestions.length===0){return false}if(suggestions.length===1){return true}var parentValue=preprocessFn(suggestions[0].value),aliens=suggestions.filter(function(suggestion){return(preprocessFn(suggestion.value).indexOf(parentValue)!==0)});return aliens.length===0}}var haveSameParent=sameParentChecker(function(val){return val});function _matchByWords(stopwords,parentCheckerFn){return function(query,suggestions){var queryTokens;var matches=[];if(parentCheckerFn(suggestions)){queryTokens=text_util.splitTokens(text_util.split(query,stopwords));collection_util.each(suggestions,function(suggestion,i){var suggestedValue=suggestion.value;if(text_util.stringEncloses(query,suggestedValue)){return false}var suggestionWords=text_util.splitTokens(text_util.split(suggestedValue,stopwords));if(collection_util.minus(queryTokens,suggestionWords).length===0){matches.push(i)}})}return matches.length===1?matches[0]:-1}}var matchers={matchByNormalizedQuery:function(stopwords){return function(query,suggestions){var normalizedQuery=text_util.normalize(query,stopwords);var matches=[];collection_util.each(suggestions,function(suggestion,i){var suggestedValue=suggestion.value.toLowerCase();if(text_util.stringEncloses(query,suggestedValue)){return false}if(suggestedValue.indexOf(normalizedQuery)>0){return false}if(normalizedQuery===text_util.normalize(suggestedValue,stopwords)){matches.push(i)}});return matches.length===1?matches[0]:-1}},matchByWords:function(stopwords){return _matchByWords(stopwords,haveSameParent)},matchByWordsAddress:function(stopwords){return _matchByWords(stopwords,haveSameParent)},matchByFields:function(fields){return function(query,suggestions){var tokens=text_util.splitTokens(text_util.split(query));var suggestionWords=[];if(suggestions.length===1){if(fields){collection_util.each(fields,function(stopwords,field){var fieldValue=object_util.getDeepValue(suggestions[0],field);var fieldWords=fieldValue&&text_util.splitTokens(text_util.split(fieldValue,stopwords));if(fieldWords&&fieldWords.length){suggestionWords=suggestionWords.concat(fieldWords)}})}if(collection_util.minusWithPartialMatching(tokens,suggestionWords).length===0){return 0}}return -1}}};var ADDRESS_STOPWORDS=["Ð°Ð¾","Ð°Ð¾Ð±Ð»","Ð´Ð¾Ð¼","ÑÐµÑÐ¿","Ð°/Ñ","Ð°Ð°Ð»","Ð°Ð²ÑÐ¾Ð´Ð¾ÑÐ¾Ð³Ð°","Ð°Ð»Ð»ÐµÑ","Ð°ÑÐ±Ð°Ð½","Ð°ÑÐ»","Ð±-Ñ","Ð±ÐµÑÐµÐ³","Ð±ÑÐ³Ð¾Ñ","Ð²Ð°Ð»","Ð²Ð»","Ð²Ð¾Ð»Ð¾ÑÑÑ","Ð²ÑÐµÐ·Ð´","Ð²ÑÑÐµÐ»","Ð³","Ð³Ð¾ÑÐ¾Ð´Ð¾Ðº","Ð³ÑÐº","Ð´","Ð´Ð²Ð»Ð´","Ð´Ð½Ð¿","Ð´Ð¾Ñ","Ð´Ð¿","Ð¶/Ð´_Ð±ÑÐ´ÐºÐ°","Ð¶/Ð´_ÐºÐ°Ð·Ð°ÑÐ¼","Ð¶/Ð´_Ð¾Ð¿","Ð¶/Ð´_Ð¿Ð»Ð°ÑÑ","Ð¶/Ð´_Ð¿Ð¾ÑÑ","Ð¶/Ð´_ÑÐ·Ð´","Ð¶/Ð´_ÑÑ","Ð¶Ð¸Ð»Ð·Ð¾Ð½Ð°","Ð¶Ð¸Ð»ÑÐ°Ð¹Ð¾Ð½","Ð¶Ñ","Ð·Ð°ÐµÐ·Ð´","Ð·Ð°Ð¸Ð¼ÐºÐ°","Ð·Ð¾Ð½Ð°","Ðº","ÐºÐ°Ð·Ð°ÑÐ¼Ð°","ÐºÐ°Ð½Ð°Ð»","ÐºÐ²","ÐºÐ²-Ð»","ÐºÐ¼","ÐºÐ¾Ð»ÑÑÐ¾","ÐºÐ¾Ð¼Ð½","ÐºÐ¾ÑÐ´Ð¾Ð½","ÐºÐ¾ÑÐ°","ÐºÐ¿","ÐºÑÐ°Ð¹","Ð»Ð¸Ð½Ð¸Ñ","Ð»Ð¿Ñ","Ð¼","Ð¼Ð°ÑÑÐ¸Ð²","Ð¼ÐµÑÑÐ½Ð¾ÑÑÑ","Ð¼ÐºÑ","Ð¼Ð¾ÑÑ","Ð½/Ð¿","Ð½Ð°Ð±","Ð½Ð¿","Ð¾Ð±Ð»","Ð¾ÐºÑÑÐ³","Ð¾ÑÑÑÐ¾Ð²","Ð¾Ñ","Ð¿","Ð¿/Ð¾","Ð¿/Ñ","Ð¿/ÑÑ","Ð¿Ð°ÑÐº","Ð¿Ð³Ñ","Ð¿ÐµÑ","Ð¿ÐµÑÐµÐµÐ·Ð´","Ð¿Ð»","Ð¿Ð»-ÐºÐ°","Ð¿Ð»Ð°ÑÑ","Ð¿Ð¾Ð³Ð¾ÑÑ","Ð¿Ð¾Ð»ÑÑÑÐ°Ð½Ð¾Ðº","Ð¿Ð¾ÑÐ¸Ð½Ð¾Ðº","Ð¿Ñ-ÐºÑ","Ð¿ÑÐ¾ÐµÐ·Ð´","Ð¿ÑÐ¾Ð¼Ð·Ð¾Ð½Ð°","Ð¿ÑÐ¾ÑÐµÐº","Ð¿ÑÐ¾ÑÐµÐºÐ°","Ð¿ÑÐ¾ÑÐµÐ»Ð¾Ðº","Ð¿ÑÐ¾ÑÐ¾Ðº","Ð¿ÑÐ¾ÑÐ¾ÐºÐ°","Ð¿ÑÐ¾ÑÐ»Ð¾Ðº","Ñ-Ð½","ÑÐ·Ð´","ÑÐ¾ÑÑÐ¸Ñ","ÑÐ¿","ÑÑÐ´Ñ","Ñ","Ñ/Ð°","Ñ/Ð¼Ð¾","Ñ/Ð¾","Ñ/Ð¿","Ñ/Ñ","ÑÐ°Ð´","ÑÐºÐ²ÐµÑ","ÑÐ»","ÑÐ½Ñ","ÑÐ¿ÑÑÐº","ÑÑ","ÑÑ-ÑÐ°","ÑÑÑ","ÑÐµÑ","ÑÑÐ°ÐºÑ","ÑÑÐ¿","Ñ","ÑÐ»","ÑÑ-Ðº","Ñ/Ñ","ÑÐµÑÐ¼Ð°","Ñ","Ñ","Ð±ÑÐ»ÑÐ²Ð°Ñ","Ð²Ð»Ð°Ð´ÐµÐ½Ð¸Ðµ","Ð²ÑÑÐµÐ»ÐºÐ¸","Ð³Ð°ÑÐ°Ð¶Ð½Ð¾-ÑÑÑÐ¾Ð¸ÑÐµÐ»ÑÐ½ÑÐ¹","Ð³Ð¾ÑÐ¾Ð´","Ð´ÐµÑÐµÐ²Ð½Ñ","Ð´Ð¾Ð¼Ð¾Ð²Ð»Ð°Ð´ÐµÐ½Ð¸Ðµ","Ð´Ð¾ÑÐ¾Ð³Ð°","ÐºÐ²Ð°ÑÑÐ°Ð»","ÐºÐ¸Ð»Ð¾Ð¼ÐµÑÑ","ÐºÐ¾Ð¼Ð½Ð°ÑÐ°","ÐºÐ¾ÑÐ¿ÑÑ","Ð»Ð¸ÑÐµÑ","Ð»ÐµÑÐ¿ÑÐ¾Ð¼ÑÐ¾Ð·","Ð¼ÐµÑÑÐµÑÐºÐ¾","Ð¼Ð¸ÐºÑÐ¾ÑÐ°Ð¹Ð¾Ð½","Ð½Ð°Ð±ÐµÑÐµÐ¶Ð½Ð°Ñ","Ð¾Ð±Ð»Ð°ÑÑÑ","Ð¿ÐµÑÐµÑÐ»Ð¾Ðº","Ð¿Ð»Ð°ÑÑÐ¾ÑÐ¼Ð°","Ð¿Ð»Ð¾ÑÐ°Ð´ÐºÐ°","Ð¿Ð»Ð¾ÑÐ°Ð´Ñ","Ð¿Ð¾ÑÐµÐ»ÐµÐ½Ð¸Ðµ","Ð¿Ð¾ÑÐµÐ»Ð¾Ðº","Ð¿ÑÐ¾ÑÐ¿ÐµÐºÑ","ÑÐ°Ð·ÑÐµÐ·Ð´","ÑÐ°Ð¹Ð¾Ð½","ÑÐµÑÐ¿ÑÐ±Ð»Ð¸ÐºÐ°","ÑÐµÐ»Ð¾","ÑÐµÐ»ÑÑÐ¾Ð²ÐµÑ","ÑÐ»Ð¾Ð±Ð¾Ð´Ð°","ÑÐ¾Ð¾ÑÑÐ¶ÐµÐ½Ð¸Ðµ","ÑÑÐ°Ð½Ð¸ÑÐ°","ÑÑÐ°Ð½ÑÐ¸Ñ","ÑÑÑÐ¾ÐµÐ½Ð¸Ðµ","ÑÐµÑÑÐ¸ÑÐ¾ÑÐ¸Ñ","ÑÑÐ¿Ð¸Ðº","ÑÐ»Ð¸ÑÐ°","ÑÐ»ÑÑ","ÑÑÐ°ÑÑÐ¾Ðº","ÑÑÑÐ¾Ñ","ÑÐ¾ÑÑÐµ"];var ADDRESS_COMPONENTS=[{id:"kladr_id",fields:["kladr_id"],forBounds:false,forLocations:true},{id:"postal_code",fields:["postal_code"],forBounds:false,forLocations:true},{id:"country_iso_code",fields:["country_iso_code"],forBounds:false,forLocations:true},{id:"country",fields:["country"],forBounds:true,forLocations:true,kladrFormat:{digits:0,zeros:13},fiasType:"country_iso_code"},{id:"region_iso_code",fields:["region_iso_code"],forBounds:false,forLocations:true},{id:"region_fias_id",fields:["region_fias_id"],forBounds:false,forLocations:true},{id:"region_type_full",fields:["region_type_full"],forBounds:false,forLocations:true,kladrFormat:{digits:2,zeros:11},fiasType:"region_fias_id"},{id:"region",fields:["region","region_type","region_type_full","region_with_type"],forBounds:true,forLocations:true,kladrFormat:{digits:2,zeros:11},fiasType:"region_fias_id"},{id:"area_fias_id",fields:["area_fias_id"],forBounds:false,forLocations:true},{id:"area_type_full",fields:["area_type_full"],forBounds:false,forLocations:true,kladrFormat:{digits:5,zeros:8},fiasType:"area_fias_id"},{id:"area",fields:["area","area_type","area_type_full","area_with_type"],forBounds:true,forLocations:true,kladrFormat:{digits:5,zeros:8},fiasType:"area_fias_id"},{id:"city_fias_id",fields:["city_fias_id"],forBounds:false,forLocations:true},{id:"city_type_full",fields:["city_type_full"],forBounds:false,forLocations:true,kladrFormat:{digits:8,zeros:5},fiasType:"city_fias_id"},{id:"city",fields:["city","city_type","city_type_full","city_with_type"],forBounds:true,forLocations:true,kladrFormat:{digits:8,zeros:5},fiasType:"city_fias_id"},{id:"city_district_fias_id",fields:["city_district_fias_id"],forBounds:false,forLocations:true},{id:"city_district_type_full",fields:["city_district_type_full"],forBounds:false,forLocations:true,kladrFormat:{digits:11,zeros:2},fiasType:"city_district_fias_id"},{id:"city_district",fields:["city_district","city_district_type","city_district_type_full","city_district_with_type"],forBounds:true,forLocations:true,kladrFormat:{digits:11,zeros:2},fiasType:"city_district_fias_id"},{id:"settlement_fias_id",fields:["settlement_fias_id"],forBounds:false,forLocations:true},{id:"settlement_type_full",fields:["settlement_type_full"],forBounds:false,forLocations:true,kladrFormat:{digits:11,zeros:2},fiasType:"settlement_fias_id"},{id:"settlement",fields:["settlement","settlement_type","settlement_type_full","settlement_with_type"],forBounds:true,forLocations:true,kladrFormat:{digits:11,zeros:2},fiasType:"settlement_fias_id"},{id:"street_fias_id",fields:["street_fias_id"],forBounds:false,forLocations:true},{id:"street_type_full",fields:["street_type_full"],forBounds:false,forLocations:true,kladrFormat:{digits:15,zeros:2},fiasType:"street_fias_id"},{id:"street",fields:["street","street_type","street_type_full","street_with_type"],forBounds:true,forLocations:true,kladrFormat:{digits:15,zeros:2},fiasType:"street_fias_id"},{id:"house",fields:["house","house_type","house_type_full","block","block_type"],forBounds:true,forLocations:false,kladrFormat:{digits:19}}];var ADDRESS_TYPE={urlSuffix:"address",noSuggestionsHint:"ÐÐµÐ¸Ð·Ð²ÐµÑÑÐ½ÑÐ¹ Ð°Ð´ÑÐµÑ",matchers:[matchers.matchByNormalizedQuery(ADDRESS_STOPWORDS),matchers.matchByWordsAddress(ADDRESS_STOPWORDS)],dataComponents:ADDRESS_COMPONENTS,dataComponentsById:object_util.indexObjectsById(ADDRESS_COMPONENTS,"id","index"),unformattableTokens:ADDRESS_STOPWORDS,enrichmentEnabled:true,enrichmentMethod:"suggest",enrichmentParams:{count:1,locations:null,locations_boost:null,from_bound:null,to_bound:null},getEnrichmentQuery:function(suggestion){return suggestion.unrestricted_value},geoEnabled:true,isDataComplete:function(suggestion){var fields=[this.bounds.to||"flat"],data=suggestion.data;return(!lang_util.isPlainObject(data)||object_util.fieldsAreNotEmpty(data,fields))},composeValue:function(data,options){var country=data.country,region=data.region_with_type||collection_util.compact([data.region,data.region_type]).join(" ")||data.region_type_full,area=data.area_with_type||collection_util.compact([data.area_type,data.area]).join(" ")||data.area_type_full,city=data.city_with_type||collection_util.compact([data.city_type,data.city]).join(" ")||data.city_type_full,settelement=data.settlement_with_type||collection_util.compact([data.settlement_type,data.settlement]).join(" ")||data.settlement_type_full,cityDistrict=data.city_district_with_type||collection_util.compact([data.city_district_type,data.city_district]).join(" ")||data.city_district_type_full,street=data.street_with_type||collection_util.compact([data.street_type,data.street]).join(" ")||data.street_type_full,house=collection_util.compact([data.house_type,data.house,data.block_type,data.block]).join(" "),flat=collection_util.compact([data.flat_type,data.flat]).join(" "),postal_box=data.postal_box&&"Ð°/Ñ "+data.postal_box,result;if(region===city){region=""}if(!(options&&options.saveCityDistrict)){if(options&&options.excludeCityDistrict){cityDistrict=""}else{if(cityDistrict&&!data.city_district_fias_id){cityDistrict=""}}}result=collection_util.compact([country,region,area,city,cityDistrict,settelement,street,house,flat,postal_box]).join(", ");return result},formatResult:(function(){var componentsUnderCityDistrict=[],_underCityDistrict=false;ADDRESS_COMPONENTS.forEach(function(component){if(_underCityDistrict){componentsUnderCityDistrict.push(component.id)}if(component.id==="city_district"){_underCityDistrict=true}});return function(value,currentValue,suggestion,options){var that=this,district=suggestion.data&&suggestion.data.city_district_with_type,unformattableTokens=options&&options.unformattableTokens,historyValues=suggestion.data&&suggestion.data.history_values,tokens,unusedTokens,formattedHistoryValues;if(historyValues&&historyValues.length>0){tokens=text_util.tokenize(currentValue,unformattableTokens);unusedTokens=this.type.findUnusedTokens(tokens,value);formattedHistoryValues=this.type.getFormattedHistoryValues(unusedTokens,historyValues);if(formattedHistoryValues){value+=formattedHistoryValues}}value=that.highlightMatches(value,currentValue,suggestion,options);value=that.wrapFormattedValue(value,suggestion);if(district&&(!that.bounds.own.length||that.bounds.own.indexOf("street")>=0)&&!lang_util.isEmptyObject(that.copyDataComponents(suggestion.data,componentsUnderCityDistrict))){value+='<div class="'+that.classes.subtext+'">'+that.highlightMatches(district,currentValue,suggestion)+"</div>"}return value}})(),findUnusedTokens:function(tokens,value){var tokenIndex,token,unused=[];unused=tokens.filter(function(token){return value.indexOf(token)===-1});return unused},getFormattedHistoryValues:function(unusedTokens,historyValues){var tokenIndex,token,historyValueIndex,historyValue,values=[],formatted="";historyValues.forEach(function(historyValue){collection_util.each(unusedTokens,function(token){if(historyValue.toLowerCase().indexOf(token)>=0){values.push(historyValue);return false}})});if(values.length>0){formatted=" (Ð±ÑÐ²Ñ. "+values.join(", ")+")"}return formatted},getSuggestionValue:function(instance,options){var formattedValue=null;if(options.hasSameValues){if(instance.options.restrict_value){formattedValue=this.getValueWithinConstraints(instance,options.suggestion)}else{if(instance.bounds.own.length){formattedValue=this.getValueWithinBounds(instance,options.suggestion)}else{formattedValue=options.suggestion.unrestricted_value}}}else{if(options.hasBeenEnriched){if(instance.options.restrict_value){formattedValue=this.getValueWithinConstraints(instance,options.suggestion,{excludeCityDistrict:true})}}}return formattedValue},getValueWithinConstraints:function(instance,suggestion,options){return this.composeValue(instance.getUnrestrictedData(suggestion.data),options)},getValueWithinBounds:function(instance,suggestion,options){var data=instance.copyDataComponents(suggestion.data,instance.bounds.own.concat(["city_district_fias_id"]));return this.composeValue(data,options)}};var FIAS_COMPONENTS=[{id:"kladr_id",fields:["kladr_id"],forBounds:false,forLocations:true},{id:"region_fias_id",fields:["region_fias_id"],forBounds:false,forLocations:true},{id:"region_type_full",fields:["region_type_full"],forBounds:false,forLocations:true,kladrFormat:{digits:2,zeros:11},fiasType:"region_fias_id"},{id:"region",fields:["region","region_type","region_type_full","region_with_type"],forBounds:true,forLocations:true,kladrFormat:{digits:2,zeros:11},fiasType:"region_fias_id"},{id:"area_fias_id",fields:["area_fias_id"],forBounds:false,forLocations:true},{id:"area_type_full",fields:["area_type_full"],forBounds:false,forLocations:true,kladrFormat:{digits:5,zeros:8},fiasType:"area_fias_id"},{id:"area",fields:["area","area_type","area_type_full","area_with_type"],forBounds:true,forLocations:true,kladrFormat:{digits:5,zeros:8},fiasType:"area_fias_id"},{id:"city_fias_id",fields:["city_fias_id"],forBounds:false,forLocations:true},{id:"city_type_full",fields:["city_type_full"],forBounds:false,forLocations:true,kladrFormat:{digits:8,zeros:5},fiasType:"city_fias_id"},{id:"city",fields:["city","city_type","city_type_full","city_with_type"],forBounds:true,forLocations:true,kladrFormat:{digits:8,zeros:5},fiasType:"city_fias_id"},{id:"city_district_fias_id",fields:["city_district_fias_id"],forBounds:false,forLocations:true},{id:"city_district_type_full",fields:["city_district_type_full"],forBounds:false,forLocations:true,kladrFormat:{digits:11,zeros:2},fiasType:"city_district_fias_id"},{id:"city_district",fields:["city_district","city_district_type","city_district_type_full","city_district_with_type"],forBounds:true,forLocations:true,kladrFormat:{digits:11,zeros:2},fiasType:"city_district_fias_id"},{id:"settlement_fias_id",fields:["settlement_fias_id"],forBounds:false,forLocations:true},{id:"settlement_type_full",fields:["settlement_type_full"],forBounds:false,forLocations:true,kladrFormat:{digits:11,zeros:2},fiasType:"settlement_fias_id"},{id:"settlement",fields:["settlement","settlement_type","settlement_type_full","settlement_with_type"],forBounds:true,forLocations:true,kladrFormat:{digits:11,zeros:2},fiasType:"settlement_fias_id"},{id:"planning_structure_fias_id",fields:["planning_structure_fias_id"],forBounds:false,forLocations:true},{id:"planning_structure_type_full",fields:["planning_structure_type_full"],forBounds:false,forLocations:true,kladrFormat:{digits:15,zeros:2},fiasType:"planning_structure_fias_id"},{id:"planning_structure",fields:["planning_structure","planning_structure_type","planning_structure_type_full","planning_structure_with_type"],forBounds:true,forLocations:true,kladrFormat:{digits:15,zeros:2},fiasType:"planning_structure_fias_id"},{id:"street_fias_id",fields:["street_fias_id"],forBounds:false,forLocations:true},{id:"street_type_full",fields:["street_type_full"],forBounds:false,forLocations:true,kladrFormat:{digits:15,zeros:2},fiasType:"street_fias_id"},{id:"street",fields:["street","street_type","street_type_full","street_with_type"],forBounds:true,forLocations:true,kladrFormat:{digits:15,zeros:2},fiasType:"street_fias_id"},{id:"house",fields:["house","house_type","block","building_type","building"],forBounds:true,forLocations:false,kladrFormat:{digits:19}}];var FIAS_TYPE={urlSuffix:"fias",noSuggestionsHint:"ÐÐµÐ¸Ð·Ð²ÐµÑÑÐ½ÑÐ¹ Ð°Ð´ÑÐµÑ",matchers:[matchers.matchByNormalizedQuery(ADDRESS_STOPWORDS),matchers.matchByWordsAddress(ADDRESS_STOPWORDS)],dataComponents:FIAS_COMPONENTS,dataComponentsById:object_util.indexObjectsById(FIAS_COMPONENTS,"id","index"),unformattableTokens:ADDRESS_STOPWORDS,isDataComplete:function(suggestion){var fields=[this.bounds.to||"house"],data=suggestion.data;return(!lang_util.isPlainObject(data)||object_util.fieldsAreNotEmpty(data,fields))},composeValue:function(data,options){var country=data.country,region=data.region_with_type||collection_util.compact([data.region,data.region_type]).join(" ")||data.region_type_full,area=data.area_with_type||collection_util.compact([data.area_type,data.area]).join(" ")||data.area_type_full,city=data.city_with_type||collection_util.compact([data.city_type,data.city]).join(" ")||data.city_type_full,settelement=data.settlement_with_type||collection_util.compact([data.settlement_type,data.settlement]).join(" ")||data.settlement_type_full,cityDistrict=data.city_district_with_type||collection_util.compact([data.city_district_type,data.city_district]).join(" ")||data.city_district_type_full,planning_structure=data.planning_structure_with_type||collection_util.compact([data.planning_structure_type,data.planning_structure]).join(" ")||data.planning_structure_type_full,street=data.street_with_type||collection_util.compact([data.street_type,data.street]).join(" ")||data.street_type_full,house=collection_util.compact([data.house_type,data.house,data.block_type,data.block]).join(" "),flat=collection_util.compact([data.flat_type,data.flat]).join(" "),postal_box=data.postal_box&&"Ð°/Ñ "+data.postal_box,result;if(region===city){region=""}if(!(options&&options.saveCityDistrict)){if(options&&options.excludeCityDistrict){cityDistrict=""}else{if(cityDistrict&&!data.city_district_fias_id){cityDistrict=""}}}result=collection_util.compact([country,region,area,city,cityDistrict,settelement,planning_structure,street,house,flat,postal_box]).join(", ");return result},formatResult:(function(){return function(value,currentValue,suggestion,options){var that=this;value=that.highlightMatches(value,currentValue,suggestion,options);value=that.wrapFormattedValue(value,suggestion);return value}})(),getSuggestionValue:ADDRESS_TYPE.getSuggestionValue,getValueWithinConstraints:ADDRESS_TYPE.getValueWithinConstraints,getValueWithinBounds:ADDRESS_TYPE.getValueWithinBounds};function valueStartsWith(suggestion,field){var fieldValue=suggestion.data&&suggestion.data[field];return(fieldValue&&new RegExp("^"+text_util.escapeRegExChars(fieldValue)+"(["+WORD_DELIMITERS+"]|$)","i").test(suggestion.value))}var NAME_TYPE={urlSuffix:"fio",noSuggestionsHint:false,matchers:[matchers.matchByNormalizedQuery(),matchers.matchByWords()],fieldNames:{surname:"ÑÐ°Ð¼Ð¸Ð»Ð¸Ñ",name:"Ð¸Ð¼Ñ",patronymic:"Ð¾ÑÑÐµÑÑÐ²Ð¾"},isDataComplete:function(suggestion){var that=this,params=that.options.params,data=suggestion.data,fields;if(lang_util.isFunction(params)){params=params.call(that.element,suggestion.value)}if(params&&params.parts){fields=params.parts.map(function(part){return part.toLowerCase()})}else{fields=["surname","name"];if(valueStartsWith(suggestion,"surname")){fields.push("patronymic")}}return object_util.fieldsAreNotEmpty(data,fields)},composeValue:function(data){return collection_util.compact([data.surname,data.name,data.patronymic]).join(" ")}};var innPartsLengths={LEGAL:[2,2,5,1],INDIVIDUAL:[2,2,6,2]};function chooseFormattedField(formattedMain,formattedAlt){var rHasMatch=/<strong>/;return rHasMatch.test(formattedAlt)&&!rHasMatch.test(formattedMain)?formattedAlt:formattedMain}function formattedField(main,alt,currentValue,suggestion,options){var that=this,formattedMain=that.highlightMatches(main,currentValue,suggestion,options),formattedAlt=that.highlightMatches(alt,currentValue,suggestion,options);return chooseFormattedField(formattedMain,formattedAlt)}var PARTY_TYPE={urlSuffix:"party",noSuggestionsHint:"ÐÐµÐ¸Ð·Ð²ÐµÑÑÐ½Ð°Ñ Ð¾ÑÐ³Ð°Ð½Ð¸Ð·Ð°ÑÐ¸Ñ",matchers:[matchers.matchByFields({value:null,"data.address.value":ADDRESS_STOPWORDS,"data.inn":null,"data.ogrn":null})],dataComponents:ADDRESS_COMPONENTS,enrichmentEnabled:true,enrichmentMethod:"findById",enrichmentParams:{count:1,locations_boost:null},getEnrichmentQuery:function(suggestion){return suggestion.data.hid},geoEnabled:true,formatResult:function(value,currentValue,suggestion,options){var that=this,formattedInn=that.type.formatResultInn.call(that,suggestion,currentValue),formatterOGRN=that.highlightMatches(object_util.getDeepValue(suggestion.data,"ogrn"),currentValue,suggestion),formattedInnOGRN=chooseFormattedField(formattedInn,formatterOGRN),formattedFIO=that.highlightMatches(object_util.getDeepValue(suggestion.data,"management.name"),currentValue,suggestion),address=object_util.getDeepValue(suggestion.data,"address.value")||"";if(that.isMobile){(options||(options={})).maxLength=50}value=formattedField.call(that,value,object_util.getDeepValue(suggestion.data,"name.latin"),currentValue,suggestion,options);value=that.wrapFormattedValue(value,suggestion);if(address){address=address.replace(/^(\d{6}|Ð Ð¾ÑÑÐ¸Ñ),\s+/i,"");if(that.isMobile){address=address.replace(new RegExp("^([^"+WORD_DELIMITERS+"]+["+WORD_DELIMITERS+"]+[^"+WORD_DELIMITERS+"]+).*"),"$1")}else{address=that.highlightMatches(address,currentValue,suggestion,{unformattableTokens:ADDRESS_STOPWORDS})}}if(formattedInnOGRN||address||formattedFIO){value+='<div class="'+that.classes.subtext+'"><span class="'+that.classes.subtext_inline+'">'+(formattedInnOGRN||"")+"</span>"+(chooseFormattedField(address,formattedFIO)||"")+"</div>"}return value},formatResultInn:function(suggestion,currentValue){var that=this,inn=suggestion.data&&suggestion.data.inn,innPartsLength=innPartsLengths[suggestion.data&&suggestion.data.type],innParts,formattedInn,rDigit=/\d/;if(inn){formattedInn=that.highlightMatches(inn,currentValue,suggestion);if(innPartsLength){formattedInn=formattedInn.split("");innParts=innPartsLength.map(function(partLength){var formattedPart="",ch;while(partLength&&(ch=formattedInn.shift())){formattedPart+=ch;if(rDigit.test(ch)){partLength--}}return formattedPart});formattedInn=innParts.join('<span class="'+that.classes.subtext_delimiter+'"></span>')+formattedInn.join("")}return formattedInn}}};var EMAIL_TYPE={urlSuffix:"email",noSuggestionsHint:false,matchers:[matchers.matchByNormalizedQuery()],isQueryRequestable:function(query){return this.options.suggest_local||query.indexOf("@")>=0}};var BANK_TYPE={urlSuffix:"bank",noSuggestionsHint:"ÐÐµÐ¸Ð·Ð²ÐµÑÑÐ½ÑÐ¹ Ð±Ð°Ð½Ðº",matchers:[matchers.matchByFields({value:null,"data.bic":null,"data.swift":null})],dataComponents:ADDRESS_COMPONENTS,geoEnabled:true,formatResult:function(value,currentValue,suggestion,options){var that=this,formattedBIC=that.highlightMatches(object_util.getDeepValue(suggestion.data,"bic"),currentValue,suggestion),address=object_util.getDeepValue(suggestion.data,"address.value")||"";value=that.highlightMatches(value,currentValue,suggestion,options);value=that.wrapFormattedValue(value,suggestion);if(address){address=address.replace(/^\d{6}( Ð ÐÐ¡Ð¡ÐÐ¯)?, /i,"");if(that.isMobile){address=address.replace(new RegExp("^([^"+WORD_DELIMITERS+"]+["+WORD_DELIMITERS+"]+[^"+WORD_DELIMITERS+"]+).*"),"$1")}else{address=that.highlightMatches(address,currentValue,suggestion,{unformattableTokens:ADDRESS_STOPWORDS})}}if(formattedBIC||address){value+='<div class="'+that.classes.subtext+'"><span class="'+that.classes.subtext_inline+'">'+formattedBIC+"</span>"+address+"</div>"}return value},formatSelected:function(suggestion){return(object_util.getDeepValue(suggestion,"data.name.payment")||null)}};function Outward(name){this.urlSuffix=name.toLowerCase();this.noSuggestionsHint="ÐÐµÐ¸Ð·Ð²ÐµÑÑÐ½Ð¾Ðµ Ð·Ð½Ð°ÑÐµÐ½Ð¸Ðµ";this.matchers=[matchers.matchByNormalizedQuery(),matchers.matchByWords()]}var types={NAME:NAME_TYPE,ADDRESS:ADDRESS_TYPE,FIAS:FIAS_TYPE,PARTY:PARTY_TYPE,EMAIL:EMAIL_TYPE,BANK:BANK_TYPE};types.get=function(type){if(types.hasOwnProperty(type)){return types[type]}else{return new Outward(type)}};jqapi.extend(DEFAULT_OPTIONS,{suggest_local:true});var notificator={chains:{},on:function(name,method){this.get(name).push(method);return this},get:function(name){var chains=this.chains;return chains[name]||(chains[name]=[])}};var serviceMethods={suggest:{defaultParams:{type:utils.getDefaultType(),dataType:"json",contentType:utils.getDefaultContentType()},addTypeInUrl:true},"iplocate/address":{defaultParams:{type:"GET",dataType:"json"},addTypeInUrl:false},status:{defaultParams:{type:"GET",dataType:"json"},addTypeInUrl:true},findById:{defaultParams:{type:utils.getDefaultType(),dataType:"json",contentType:utils.getDefaultContentType()},addTypeInUrl:true}};var requestModes={suggest:{method:"suggest",userSelect:true,updateValue:true,enrichmentEnabled:true},findById:{method:"findById",userSelect:false,updateValue:false,enrichmentEnabled:false}};function Suggestions(el,options){var that=this;that.element=el;that.el=$(el);that.suggestions=[];that.badQueries=[];that.selectedIndex=-1;that.currentValue=that.element.value;that.intervalId=0;that.cachedResponse={};that.enrichmentCache={};that.currentRequest=null;that.inputPhase=$.Deferred();that.fetchPhase=$.Deferred();that.enrichPhase=$.Deferred();that.onChangeTimeout=null;that.triggering={};that.$wrapper=null;that.options=$.extend({},DEFAULT_OPTIONS,options);that.classes=CLASSES;that.disabled=false;that.selection=null;that.$viewport=$(window);that.$body=$(document.body);that.type=null;that.status={};that.setupElement();that.initializer=$.Deferred();if(that.el.is(":visible")){that.initializer.resolve()}else{that.deferInitialization()}that.initializer.done($.proxy(that.initialize,that))}Suggestions.prototype={initialize:function(){var that=this;that.uniqueId=utils.uniqueId("i");that.createWrapper();that.notify("initialize");that.bindWindowEvents();that.setOptions();that.inferIsMobile();that.notify("ready")},deferInitialization:function(){var that=this,events="mouseover focus keydown",timer,callback=function(){that.initializer.resolve();that.enable()};that.initializer.always(function(){that.el.off(events,callback);clearInterval(timer)});that.disabled=true;that.el.on(events,callback);timer=setInterval(function(){if(that.el.is(":visible")){callback()}},that.options.initializeInterval)},isInitialized:function(){return this.initializer.state()==="resolved"},dispose:function(){var that=this;that.initializer.reject();that.notify("dispose");that.el.removeData(DATA_ATTR_KEY).removeClass("suggestions-input");that.unbindWindowEvents();that.removeWrapper();that.el.trigger("suggestions-dispose")},notify:function(chainName){var that=this,args=utils.slice(arguments,1);return $.map(notificator.get(chainName),function(method){return method.apply(that,args)})},createWrapper:function(){var that=this;that.$wrapper=$('<div class="suggestions-wrapper"/>');that.el.after(that.$wrapper);that.$wrapper.on("mousedown"+EVENT_NS,$.proxy(that.onMousedown,that))},removeWrapper:function(){var that=this;if(that.$wrapper){that.$wrapper.remove()}$(that.options.$helpers).off(EVENT_NS)},onMousedown:function(e){var that=this;e.preventDefault();that.cancelBlur=true;utils.delay(function(){delete that.cancelBlur});if($(e.target).closest(".ui-menu-item").length==0){utils.delay(function(){$(document).one("mousedown",function(e){var $elements=that.el.add(that.$wrapper).add(that.options.$helpers);if(that.options.floating){$elements=$elements.add(that.$container)}$elements=$elements.filter(function(){return this===e.target||$.contains(this,e.target)});if(!$elements.length){that.hide()}})})}},bindWindowEvents:function(){var handler=$.proxy(this.inferIsMobile,this);this.$viewport.on("resize"+EVENT_NS+this.uniqueId,handler)},unbindWindowEvents:function(){this.$viewport.off("resize"+EVENT_NS+this.uniqueId)},scrollToTop:function(){var that=this,scrollTarget=that.options.scrollOnFocus;if(scrollTarget===true){scrollTarget=that.el}if(scrollTarget instanceof $&&scrollTarget.length>0){$("body,html").animate({scrollTop:scrollTarget.offset().top},"fast")}},setOptions:function(suppliedOptions){var that=this;$.extend(that.options,suppliedOptions);that.type=types.get(that.options.type);$.each({requestMode:requestModes},function(option,available){that[option]=available[that.options[option]];if(!that[option]){that.disable();throw"`"+option+"` option is incorrect! Must be one of: "+$.map(available,function(value,name){return'"'+name+'"'}).join(", ")}});$(that.options.$helpers).off(EVENT_NS).on("mousedown"+EVENT_NS,$.proxy(that.onMousedown,that));if(that.isInitialized()){that.notify("setOptions")}},inferIsMobile:function(){this.isMobile=this.$viewport.width()<=this.options.mobileWidth},clearCache:function(){this.cachedResponse={};this.enrichmentCache={};this.badQueries=[]},clear:function(){var that=this,currentSelection=that.selection;if(that.isInitialized()){that.clearCache();that.currentValue="";that.selection=null;that.hide();that.suggestions=[];that.el.val("");that.el.trigger("suggestions-clear");that.notify("clear");that.trigger("InvalidateSelection",currentSelection)}},disable:function(){var that=this;that.disabled=true;that.abortRequest();if(that.visible){that.hide()}},enable:function(){this.disabled=false},isUnavailable:function(){return this.disabled},update:function(){var that=this,query=that.el.val();if(that.isInitialized()){that.currentValue=query;if(that.isQueryRequestable(query)){that.updateSuggestions(query)}else{that.hide()}}},setSuggestion:function(suggestion){var that=this,data,value;if($.isPlainObject(suggestion)&&$.isPlainObject(suggestion.data)){suggestion=$.extend(true,{},suggestion);if(that.isUnavailable()&&that.initializer&&that.initializer.state()==="pending"){that.initializer.resolve();that.enable()}if(that.bounds.own.length){that.checkValueBounds(suggestion);data=that.copyDataComponents(suggestion.data,that.bounds.all);if(suggestion.data.kladr_id){data.kladr_id=that.getBoundedKladrId(suggestion.data.kladr_id,that.bounds.all)}suggestion.data=data}that.selection=suggestion;that.suggestions=[suggestion];value=that.getSuggestionValue(suggestion)||"";that.currentValue=value;that.el.val(value);that.abortRequest();that.el.trigger("suggestions-set")}},fixData:function(){var that=this,fullQuery=that.extendedCurrentValue(),currentValue=that.el.val(),resolver=$.Deferred();resolver.done(function(suggestion){that.selectSuggestion(suggestion,0,currentValue,{hasBeenEnriched:true});that.el.trigger("suggestions-fixdata",suggestion)}).fail(function(){that.selection=null;that.el.trigger("suggestions-fixdata")});if(that.isQueryRequestable(fullQuery)){that.currentValue=fullQuery;that.getSuggestions(fullQuery,{count:1,from_bound:null,to_bound:null}).done(function(suggestions){var suggestion=suggestions[0];if(suggestion){resolver.resolve(suggestion)}else{resolver.reject()}}).fail(function(){resolver.reject()})}else{resolver.reject()}},extendedCurrentValue:function(){var that=this,parentInstance=that.getParentInstance(),parentValue=parentInstance&&parentInstance.extendedCurrentValue(),currentValue=$.trim(that.el.val());return utils.compact([parentValue,currentValue]).join(" ")},getAjaxParams:function(method,custom){var that=this,token=$.trim(that.options.token),partner=$.trim(that.options.partner),serviceUrl=that.options.serviceUrl,url=that.options.url,serviceMethod=serviceMethods[method],params=$.extend({timeout:that.options.timeout},serviceMethod.defaultParams),headers={};if(url){serviceUrl=url}else{if(!/\/$/.test(serviceUrl)){serviceUrl+="/"}serviceUrl+=method;if(serviceMethod.addTypeInUrl){serviceUrl+="/"+that.type.urlSuffix}}serviceUrl=utils.fixURLProtocol(serviceUrl);if($.support.cors){if(token){headers.Authorization="Token "+token}if(partner){headers["X-Partner"]=partner}headers["X-Version"]=Suggestions.version;if(!params.headers){params.headers={}}if(!params.xhrFields){params.xhrFields={}}$.extend(params.headers,that.options.headers,headers);params.xhrFields.withCredentials=false}else{if(token){headers.token=token}if(partner){headers.partner=partner}headers.version=Suggestions.version;serviceUrl=utils.addUrlParams(serviceUrl,headers)}params.url=serviceUrl;return $.extend(params,custom)},isQueryRequestable:function(query){var that=this,result;result=query.length>=that.options.minChars;if(result&&that.type.isQueryRequestable){result=that.type.isQueryRequestable.call(that,query)}return result},constructRequestParams:function(query,customParams){var that=this,options=that.options,params=$.isFunction(options.params)?options.params.call(that.element,query):$.extend({},options.params);if(that.type.constructRequestParams){$.extend(params,that.type.constructRequestParams.call(that))}$.each(that.notify("requestParams"),function(i,hookParams){$.extend(params,hookParams)});params[options.paramName]=query;if($.isNumeric(options.count)&&options.count>0){params.count=options.count}if(options.language){params.language=options.language}return $.extend(params,customParams)},updateSuggestions:function(query){var that=this;that.fetchPhase=that.getSuggestions(query).done(function(suggestions){that.assignSuggestions(suggestions,query)})},getSuggestions:function(query,customParams,requestOptions){var response,that=this,options=that.options,noCallbacks=requestOptions&&requestOptions.noCallbacks,useEnrichmentCache=requestOptions&&requestOptions.useEnrichmentCache,method=(requestOptions&&requestOptions.method)||that.requestMode.method,params=that.constructRequestParams(query,customParams),cacheKey=$.param(params||{}),resolver=$.Deferred();response=that.cachedResponse[cacheKey];if(response&&$.isArray(response.suggestions)){resolver.resolve(response.suggestions)}else{if(that.isBadQuery(query)){resolver.reject()}else{if(!noCallbacks&&options.onSearchStart.call(that.element,params)===false){resolver.reject()}else{that.doGetSuggestions(params,method).done(function(response){if(that.processResponse(response)&&query==that.currentValue){if(!options.noCache){if(useEnrichmentCache){that.enrichmentCache[query]=response.suggestions[0]}else{that.enrichResponse(response,query);that.cachedResponse[cacheKey]=response;if(options.preventBadQueries&&response.suggestions.length===0){that.badQueries.push(query)}}}resolver.resolve(response.suggestions)}else{resolver.reject()}if(!noCallbacks){options.onSearchComplete.call(that.element,query,response.suggestions)}}).fail(function(jqXHR,textStatus,errorThrown){resolver.reject();if(!noCallbacks&&textStatus!=="abort"){options.onSearchError.call(that.element,query,jqXHR,textStatus,errorThrown)}})}}}return resolver},doGetSuggestions:function(params,method){var that=this,request=$.ajax(that.getAjaxParams(method,{data:utils.serialize(params)}));that.abortRequest();that.currentRequest=request;that.notify("request");request.always(function(){that.currentRequest=null;that.notify("request")});return request},isBadQuery:function(q){if(!this.options.preventBadQueries){return false}var result=false;$.each(this.badQueries,function(i,query){return !(result=q.indexOf(query)===0)});return result},abortRequest:function(){var that=this;if(that.currentRequest){that.currentRequest.abort()}},processResponse:function(response){var that=this,suggestions;if(!response||!$.isArray(response.suggestions)){return false}that.verifySuggestionsFormat(response.suggestions);that.setUnrestrictedValues(response.suggestions);if($.isFunction(that.options.onSuggestionsFetch)){suggestions=that.options.onSuggestionsFetch.call(that.element,response.suggestions);if($.isArray(suggestions)){response.suggestions=suggestions}}return true},verifySuggestionsFormat:function(suggestions){if(typeof suggestions[0]==="string"){$.each(suggestions,function(i,value){suggestions[i]={value:value,data:null}})}},getSuggestionValue:function(suggestion,selectionOptions){var that=this,formatSelected=that.options.formatSelected||that.type.formatSelected,hasSameValues=selectionOptions&&selectionOptions.hasSameValues,hasBeenEnriched=selectionOptions&&selectionOptions.hasBeenEnriched,formattedValue,typeFormattedValue=null;if($.isFunction(formatSelected)){formattedValue=formatSelected.call(that,suggestion)}if(typeof formattedValue!=="string"){formattedValue=suggestion.value;if(that.type.getSuggestionValue){typeFormattedValue=that.type.getSuggestionValue(that,{suggestion:suggestion,hasSameValues:hasSameValues,hasBeenEnriched:hasBeenEnriched});if(typeFormattedValue!==null){formattedValue=typeFormattedValue}}}return formattedValue},hasSameValues:function(suggestion){var hasSame=false;$.each(this.suggestions,function(i,anotherSuggestion){if(anotherSuggestion.value===suggestion.value&&anotherSuggestion!==suggestion){hasSame=true;return false}});return hasSame},assignSuggestions:function(suggestions,query){var that=this;that.suggestions=suggestions;that.notify("assignSuggestions",query)},shouldRestrictValues:function(){var that=this;return(that.options.restrict_value&&that.constraints&&Object.keys(that.constraints).length==1)},setUnrestrictedValues:function(suggestions){var that=this,shouldRestrict=that.shouldRestrictValues(),label=that.getFirstConstraintLabel();$.each(suggestions,function(i,suggestion){if(!suggestion.unrestricted_value){suggestion.unrestricted_value=shouldRestrict?label+", "+suggestion.value:suggestion.value}})},areSuggestionsSame:function(a,b){return a&&b&&a.value===b.value&&utils.areSame(a.data,b.data)},getNoSuggestionsHint:function(){var that=this;if(that.options.noSuggestionsHint===false){return false}return that.options.noSuggestionsHint||that.type.noSuggestionsHint}};var methods={setupElement:function(){this.el.attr("autocomplete","off").attr("autocorrect","off").attr("autocapitalize","off").attr("spellcheck","false").addClass("suggestions-input").css("box-sizing","border-box")},bindElementEvents:function(){var that=this;that.el.on("keydown"+EVENT_NS,$.proxy(that.onElementKeyDown,that));that.el.on(["keyup"+EVENT_NS,"cut"+EVENT_NS,"paste"+EVENT_NS,"input"+EVENT_NS].join(" "),$.proxy(that.onElementKeyUp,that));that.el.on("blur"+EVENT_NS,$.proxy(that.onElementBlur,that));that.el.on("focus"+EVENT_NS,$.proxy(that.onElementFocus,that))},unbindElementEvents:function(){this.el.off(EVENT_NS)},onElementBlur:function(){var that=this;if(that.cancelBlur){that.cancelBlur=false;return}if(that.options.triggerSelectOnBlur){if(!that.isUnavailable()){that.selectCurrentValue({noSpace:true}).always(function(){that.hide()})}}else{that.hide()}if(that.fetchPhase.abort){that.fetchPhase.abort()}},onElementFocus:function(){var that=this;if(!that.cancelFocus){utils.delay($.proxy(that.completeOnFocus,that))}that.cancelFocus=false},onElementKeyDown:function(e){var that=this;if(that.isUnavailable()){return}if(!that.visible){switch(e.which){case KEYS.DOWN:that.suggest();break;case KEYS.ENTER:if(that.options.triggerSelectOnEnter){that.triggerOnSelectNothing()}break}return}switch(e.which){case KEYS.ESC:that.el.val(that.currentValue);that.hide();that.abortRequest();break;case KEYS.TAB:if(that.options.tabDisabled===false){return}break;case KEYS.ENTER:if(that.options.triggerSelectOnEnter){that.selectCurrentValue()}break;case KEYS.SPACE:if(that.options.triggerSelectOnSpace&&that.isCursorAtEnd()){e.preventDefault();that.selectCurrentValue({continueSelecting:true,dontEnrich:true}).fail(function(){that.currentValue+=" ";that.el.val(that.currentValue);that.proceedChangedValue()})}return;case KEYS.UP:that.moveUp();break;case KEYS.DOWN:that.moveDown();break;default:return}e.stopImmediatePropagation();e.preventDefault()},onElementKeyUp:function(e){var that=this;if(that.isUnavailable()){return}switch(e.which){case KEYS.UP:case KEYS.DOWN:case KEYS.ENTER:return}clearTimeout(that.onChangeTimeout);that.inputPhase.reject();if(that.currentValue!==that.el.val()){that.proceedChangedValue()}},proceedChangedValue:function(){var that=this;that.abortRequest();that.inputPhase=$.Deferred().done($.proxy(that.onValueChange,that));if(that.options.deferRequestBy>0){that.onChangeTimeout=utils.delay(function(){that.inputPhase.resolve()},that.options.deferRequestBy)}else{that.inputPhase.resolve()}},onValueChange:function(){var that=this,currentSelection;if(that.selection){currentSelection=that.selection;that.selection=null;that.trigger("InvalidateSelection",currentSelection)}that.selectedIndex=-1;that.update();that.notify("valueChange")},completeOnFocus:function(){var that=this;if(that.isUnavailable()){return}if(that.isElementFocused()){that.update();if(that.isMobile){that.setCursorAtEnd();that.scrollToTop()}}},isElementFocused:function(){return document.activeElement===this.element},isElementDisabled:function(){return Boolean(this.element.getAttribute("disabled")||this.element.getAttribute("readonly"))},isCursorAtEnd:function(){var that=this,valLength=that.el.val().length,selectionStart,range;try{selectionStart=that.element.selectionStart;if(typeof selectionStart==="number"){return selectionStart===valLength}}catch(ex){}if(document.selection){range=document.selection.createRange();range.moveStart("character",-valLength);return valLength===range.text.length}return true},setCursorAtEnd:function(){var element=this.element;try{element.selectionEnd=element.selectionStart=element.value.length;element.scrollLeft=element.scrollWidth}catch(ex){element.value=element.value}}};$.extend(Suggestions.prototype,methods);notificator.on("initialize",methods.bindElementEvents).on("dispose",methods.unbindElementEvents);var statusRequests={};function resetTokens(){utils.each(statusRequests,function(req){req.abort()});statusRequests={}}resetTokens();var methods$1={checkStatus:function(){var that=this,token=(that.options.token&&that.options.token.trim())||"",requestKey=that.options.type+token,request=statusRequests[requestKey];if(!request){request=statusRequests[requestKey]=jqapi.ajax(that.getAjaxParams("status"))}request.done(function(status,textStatus,request){if(status.search){var plan=request.getResponseHeader("X-Plan");status.plan=plan;jqapi.extend(that.status,status)}else{triggerError("Service Unavailable")}}).fail(function(){triggerError(request.statusText)});function triggerError(errorThrown){if(utils.isFunction(that.options.onSearchError)){that.options.onSearchError.call(that.element,null,request,"error",errorThrown)}}}};Suggestions.resetTokens=resetTokens;jqapi.extend(Suggestions.prototype,methods$1);notificator.on("setOptions",methods$1.checkStatus);var locationRequest;var defaultGeoLocation=true;function resetLocation(){locationRequest=null;DEFAULT_OPTIONS.geoLocation=defaultGeoLocation}var methods$2={checkLocation:function(){var that=this,providedLocation=that.options.geoLocation;if(!that.type.geoEnabled||!providedLocation){return}that.geoLocation=$.Deferred();if($.isPlainObject(providedLocation)||$.isArray(providedLocation)){that.geoLocation.resolve(providedLocation)}else{if(!locationRequest){locationRequest=$.ajax(that.getAjaxParams("iplocate/address"))}locationRequest.done(function(resp){var locationData=resp&&resp.location&&resp.location.data;if(locationData&&locationData.kladr_id){that.geoLocation.resolve({kladr_id:locationData.kladr_id})}else{that.geoLocation.reject()}}).fail(function(){that.geoLocation.reject()})}},getGeoLocation:function(){return this.geoLocation},constructParams:function(){var that=this,params={};if(that.geoLocation&&$.isFunction(that.geoLocation.promise)&&that.geoLocation.state()=="resolved"){that.geoLocation.done(function(locationData){params.locations_boost=$.makeArray(locationData)})}return params}};if(utils.getDefaultType()!="GET"){$.extend(DEFAULT_OPTIONS,{geoLocation:defaultGeoLocation});$.extend(Suggestions,{resetLocation:resetLocation});$.extend(Suggestions.prototype,{getGeoLocation:methods$2.getGeoLocation});notificator.on("setOptions",methods$2.checkLocation).on("requestParams",methods$2.constructParams)}var methods$3={enrichSuggestion:function(suggestion,selectionOptions){var that=this,resolver=$.Deferred();if(!that.options.enrichmentEnabled||!that.type.enrichmentEnabled||!that.requestMode.enrichmentEnabled||(selectionOptions&&selectionOptions.dontEnrich)){return resolver.resolve(suggestion)}if(suggestion.data&&suggestion.data.qc!=null){return resolver.resolve(suggestion)}that.disableDropdown();var query=that.type.getEnrichmentQuery(suggestion);var customParams=that.type.enrichmentParams;var requestOptions={noCallbacks:true,useEnrichmentCache:true,method:that.type.enrichmentMethod};that.currentValue=query;that.enrichPhase=that.getSuggestions(query,customParams,requestOptions).always(function(){that.enableDropdown()}).done(function(suggestions){var enrichedSuggestion=suggestions&&suggestions[0];resolver.resolve(enrichedSuggestion||suggestion,!!enrichedSuggestion)}).fail(function(){resolver.resolve(suggestion)});return resolver},enrichResponse:function(response,query){var that=this,enrichedSuggestion=that.enrichmentCache[query];if(enrichedSuggestion){$.each(response.suggestions,function(i,suggestion){if(suggestion.value===query){response.suggestions[i]=enrichedSuggestion;return false}})}}};$.extend(Suggestions.prototype,methods$3);function highlightMatches(chunks){return $.map(chunks,function(chunk){var text=utils.escapeHtml(chunk.text);if(text&&chunk.matched){text="<strong>"+text+"</strong>"}return text}).join("")}function nowrapLinkedParts(formattedStr,nowrapClass){var delimitedParts=formattedStr.split(", ");if(delimitedParts.length===1){return formattedStr}return $.map(delimitedParts,function(part){return'<span class="'+nowrapClass+'">'+part+"</span>"}).join(", ")}function hasAnotherSuggestion(suggestions,suggestion){var result=false;$.each(suggestions,function(i,s){result=s.value==suggestion.value&&s!=suggestion;if(result){return false}});return result}var optionsUsed={width:"auto",floating:false};var methods$4={createContainer:function(){var that=this,suggestionSelector="."+that.classes.suggestion,options=that.options,$container=$("<div/>").addClass(options.containerClass).css({display:"none"});that.$container=$container;$container.on("click"+EVENT_NS,suggestionSelector,$.proxy(that.onSuggestionClick,that))},showContainer:function(){this.$container.appendTo(this.options.floating?this.$body:this.$wrapper)},getContainer:function(){return this.$container.get(0)},removeContainer:function(){var that=this;if(that.options.floating){that.$container.remove()}},setContainerOptions:function(){var that=this,mousedownEvent="mousedown"+EVENT_NS;that.$container.off(mousedownEvent);if(that.options.floating){that.$container.on(mousedownEvent,$.proxy(that.onMousedown,that))}},onSuggestionClick:function(e){var that=this,$el=$(e.target),index;if(!that.dropdownDisabled){that.cancelFocus=true;that.el.focus();while($el.length&&!(index=$el.attr("data-index"))){$el=$el.closest("."+that.classes.suggestion)}if(index&&!isNaN(index)){that.select(+index)}}},getSuggestionsItems:function(){return this.$container.children("."+this.classes.suggestion)},toggleDropdownEnabling:function(enable){this.dropdownDisabled=!enable;this.$container.attr("disabled",!enable)},disableDropdown:function(){this.toggleDropdownEnabling(false)},enableDropdown:function(){this.toggleDropdownEnabling(true)},hasSuggestionsToChoose:function(){var that=this;return(that.suggestions.length>1||(that.suggestions.length===1&&(!that.selection||$.trim(that.suggestions[0].value)!==$.trim(that.selection.value))))},suggest:function(){var that=this,options=that.options,formatResult,html=[];if(!that.requestMode.userSelect){return}if(!that.hasSuggestionsToChoose()){if(that.suggestions.length){that.hide();return}else{var noSuggestionsHint=that.getNoSuggestionsHint();if(noSuggestionsHint){html.push('<div class="'+that.classes.hint+'">'+noSuggestionsHint+"</div>")}else{that.hide();return}}}else{if(options.hint&&that.suggestions.length){html.push('<div class="'+that.classes.hint+'">'+options.hint+"</div>")}that.selectedIndex=-1;that.suggestions.forEach(function(suggestion,i){if(suggestion==that.selection){that.selectedIndex=i}that.buildSuggestionHtml(suggestion,i,html)})}html.push('<div class="'+CLASSES.promo+'"></div>');html.push("</div>");that.$container.html(html.join(""));if(options.autoSelectFirst&&that.selectedIndex===-1){that.selectedIndex=0}if(that.selectedIndex!==-1){that.getSuggestionsItems().eq(that.selectedIndex).addClass(that.classes.selected)}if($.isFunction(options.beforeRender)){options.beforeRender.call(that.element,that.$container)}that.$container.show();that.visible=true},buildSuggestionHtml:function(suggestion,ordinal,html){html.push('<div class="'+this.classes.suggestion+'" data-index="'+ordinal+'">');var formatResult=this.options.formatResult||this.type.formatResult||this.formatResult;html.push(formatResult.call(this,suggestion.value,this.currentValue,suggestion,{unformattableTokens:this.type.unformattableTokens}));var labels=this.makeSuggestionLabel(this.suggestions,suggestion);if(labels){html.push('<span class="'+this.classes.subtext_label+'">'+utils.escapeHtml(labels)+"</span>")}html.push("</div>")},wrapFormattedValue:function(value,suggestion){var that=this,status=utils.getDeepValue(suggestion.data,"state.status");return('<span class="'+that.classes.value+'"'+(status?' data-suggestion-status="'+status+'"':"")+">"+value+"</span>")},formatResult:function(value,currentValue,suggestion,options){var that=this;value=that.highlightMatches(value,currentValue,suggestion,options);return that.wrapFormattedValue(value,suggestion)},highlightMatches:function(value,currentValue,suggestion,options){var that=this,chunks=[],unformattableTokens=options&&options.unformattableTokens,maxLength=options&&options.maxLength,tokens,tokenMatchers,preferredTokens,rWords=utils.reWordExtractor(),match,word,i,chunk,formattedStr;if(!value){return""}tokens=text_util.tokenize(currentValue,unformattableTokens);tokenMatchers=$.map(tokens,function(token){return new RegExp("^((.*)(["+WORD_PARTS_DELIMITERS+"]+))?("+utils.escapeRegExChars(token)+")([^"+WORD_PARTS_DELIMITERS+"]*["+WORD_PARTS_DELIMITERS+"]*)","i")});while((match=rWords.exec(value))&&match[0]){word=match[1];chunks.push({text:word,hasUpperCase:word.toLowerCase()!==word,formatted:utils.formatToken(word),matchable:true});if(match[2]){chunks.push({text:match[2]})}}for(i=0;i<chunks.length;i++){chunk=chunks[i];if(chunk.matchable&&!chunk.matched&&($.inArray(chunk.formatted,unformattableTokens)===-1||chunk.hasUpperCase)){$.each(tokenMatchers,function(j,matcher){var tokenMatch=matcher.exec(chunk.formatted),length,nextIndex=i+1;if(tokenMatch){tokenMatch={before:tokenMatch[1]||"",beforeText:tokenMatch[2]||"",beforeDelimiter:tokenMatch[3]||"",text:tokenMatch[4]||"",after:tokenMatch[5]||""};if(tokenMatch.before){chunks.splice(i,0,{text:chunk.text.substr(0,tokenMatch.beforeText.length),formatted:tokenMatch.beforeText,matchable:true},{text:tokenMatch.beforeDelimiter});nextIndex+=2;length=tokenMatch.before.length;chunk.text=chunk.text.substr(length);chunk.formatted=chunk.formatted.substr(length);i--}length=tokenMatch.text.length+tokenMatch.after.length;if(chunk.formatted.length>length){chunks.splice(nextIndex,0,{text:chunk.text.substr(length),formatted:chunk.formatted.substr(length),matchable:true});chunk.text=chunk.text.substr(0,length);chunk.formatted=chunk.formatted.substr(0,length)}if(tokenMatch.after){length=tokenMatch.text.length;chunks.splice(nextIndex,0,{text:chunk.text.substr(length),formatted:chunk.formatted.substr(length)});chunk.text=chunk.text.substr(0,length);chunk.formatted=chunk.formatted.substr(0,length)}chunk.matched=true;return false}})}}if(maxLength){for(i=0;i<chunks.length&&maxLength>=0;i++){chunk=chunks[i];maxLength-=chunk.text.length;if(maxLength<0){chunk.text=chunk.text.substr(0,chunk.text.length+maxLength)+"..."}}chunks.length=i}formattedStr=highlightMatches(chunks);return nowrapLinkedParts(formattedStr,that.classes.nowrap)},makeSuggestionLabel:function(suggestions,suggestion){var that=this,fieldNames=that.type.fieldNames,nameData={},rWords=utils.reWordExtractor(),match,word,labels=[];if(fieldNames&&hasAnotherSuggestion(suggestions,suggestion)&&suggestion.data){$.each(fieldNames,function(field){var value=suggestion.data[field];if(value){nameData[field]=utils.formatToken(value)}});if(!$.isEmptyObject(nameData)){while((match=rWords.exec(utils.formatToken(suggestion.value)))&&(word=match[1])){$.each(nameData,function(i,value){if(value==word){labels.push(fieldNames[i]);delete nameData[i];return false}})}if(labels.length){return labels.join(", ")}}}},hide:function(){var that=this;that.visible=false;that.selectedIndex=-1;that.$container.hide().empty()},activate:function(index){var that=this,$activeItem,selected=that.classes.selected,$children;if(!that.dropdownDisabled){$children=that.getSuggestionsItems();$children.removeClass(selected);that.selectedIndex=index;if(that.selectedIndex!==-1&&$children.length>that.selectedIndex){$activeItem=$children.eq(that.selectedIndex);$activeItem.addClass(selected);return $activeItem}}return null},deactivate:function(restoreValue){var that=this;if(!that.dropdownDisabled){that.selectedIndex=-1;that.getSuggestionsItems().removeClass(that.classes.selected);if(restoreValue){that.el.val(that.currentValue)}}},moveUp:function(){var that=this;if(that.dropdownDisabled){return}if(that.selectedIndex===-1){if(that.suggestions.length){that.adjustScroll(that.suggestions.length-1)}return}if(that.selectedIndex===0){that.deactivate(true);return}that.adjustScroll(that.selectedIndex-1)},moveDown:function(){var that=this;if(that.dropdownDisabled){return}if(that.selectedIndex===that.suggestions.length-1){that.deactivate(true);return}that.adjustScroll(that.selectedIndex+1)},adjustScroll:function(index){var that=this,$activeItem=that.activate(index),itemTop,itemBottom,scrollTop=that.$container.scrollTop(),containerHeight;if(!$activeItem||!$activeItem.length){return}itemTop=$activeItem.position().top;if(itemTop<0){that.$container.scrollTop(scrollTop+itemTop)}else{itemBottom=itemTop+$activeItem.outerHeight();containerHeight=that.$container.innerHeight();if(itemBottom>containerHeight){that.$container.scrollTop(scrollTop-containerHeight+itemBottom)}}that.el.val(that.suggestions[index].value)}};$.extend(DEFAULT_OPTIONS,optionsUsed);$.extend(Suggestions.prototype,methods$4);notificator.on("initialize",methods$4.createContainer).on("dispose",methods$4.removeContainer).on("setOptions",methods$4.setContainerOptions).on("ready",methods$4.showContainer).on("assignSuggestions",methods$4.suggest);var optionsUsed$1={constraints:null,restrict_value:false};var fiasParamNames=["country_iso_code","region_iso_code","region_fias_id","area_fias_id","city_fias_id","city_district_fias_id","settlement_fias_id","planning_structure_fias_id","street_fias_id"];function belongsToArea(suggestion,instance){var parentSuggestion=instance.selection,result=parentSuggestion&&parentSuggestion.data&&instance.bounds;if(result){collection_util.each(instance.bounds.all,function(bound,i){return(result=parentSuggestion.data[bound]===suggestion.data[bound])})}return result}function getSignificantKladrId(kladr_id){var significantKladrId=kladr_id.replace(/^(\d{2})(\d*?)(0+)$/g,"$1$2");var length=significantKladrId.length;var significantLength=-1;if(length<=2){significantLength=2}else{if(length>2&&length<=5){significantLength=5}else{if(length>5&&length<=8){significantLength=8}else{if(length>8&&length<=11){significantLength=11}else{if(length>11&&length<=15){significantLength=15}else{if(length>15){significantLength=19}}}}}}return text_util.padEnd(significantKladrId,significantLength,"0")}var ConstraintLocation=function(data,instance){var that=this,fieldNames,fiasFieldNames,fiasFields={};that.instance=instance;that.fields={};that.specificity=-1;if(lang_util.isPlainObject(data)&&instance.type.dataComponents){collection_util.each(instance.type.dataComponents,function(component,i){var fieldName=component.id;if(component.forLocations&&data[fieldName]){that.fields[fieldName]=data[fieldName];that.specificity=i}})}fieldNames=Object.keys(that.fields);fiasFieldNames=collection_util.intersect(fieldNames,fiasParamNames);if(fiasFieldNames.length){collection_util.each(fiasFieldNames,function(fieldName,index){fiasFields[fieldName]=that.fields[fieldName]});that.fields=fiasFields;that.specificity=that.getFiasSpecificity(fiasFieldNames)}else{if(that.fields.kladr_id){that.fields={kladr_id:that.fields.kladr_id};that.significantKladr=getSignificantKladrId(that.fields.kladr_id);that.specificity=that.getKladrSpecificity(that.significantKladr)}}};jqapi.extend(ConstraintLocation.prototype,{getLabel:function(){return this.instance.type.composeValue(this.fields,{saveCityDistrict:true})},getFields:function(){return this.fields},isValid:function(){return !lang_util.isEmptyObject(this.fields)},getKladrSpecificity:function(kladr_id){var specificity=-1;var kladrLength=kladr_id.length;collection_util.each(this.instance.type.dataComponents,function(component,i){if(component.kladrFormat&&kladrLength===component.kladrFormat.digits){specificity=i}});return specificity},getFiasSpecificity:function(fiasFieldNames){var specificity=-1;collection_util.each(this.instance.type.dataComponents,function(component,i){if(component.fiasType&&fiasFieldNames.indexOf(component.fiasType)>-1&&specificity<i){specificity=i}});return specificity},containsData:function(data){var result=true;if(this.fields.kladr_id){return(!!data.kladr_id&&data.kladr_id.indexOf(this.significantKladr)===0)}else{collection_util.each(this.fields,function(value,fieldName){return(result=!!data[fieldName]&&data[fieldName].toLowerCase()===value.toLowerCase())});return result}}});Suggestions.ConstraintLocation=ConstraintLocation;var Constraint=function(data,instance){this.id=generateId("c");this.deletable=!!data.deletable;this.instance=instance;var locationsArray=collection_util.makeArray(data&&(data.locations||data.restrictions));this.locations=locationsArray.map(function(data){return new ConstraintLocation(data,instance)});this.locations=this.locations.filter(function(location){return location.isValid()});this.label=data.label;if(this.label==null&&instance.type.composeValue){this.label=this.locations.map(function(location){return location.getLabel()}).join(", ")}};jqapi.extend(Constraint.prototype,{isValid:function(){return this.locations.length>0},getFields:function(){return this.locations.map(function(location){return location.getFields()})}});var methods$5={createConstraints:function(){var that=this;that.constraints={}},setupConstraints:function(){var that=this,constraints=that.options.constraints,$parent;if(!constraints){that.unbindFromParent();return}if(jqapi.isJqObject(constraints)||typeof constraints==="string"||typeof constraints.nodeType==="number"){$parent=jqapi.select(constraints);if(!$parent.is(that.constraints)){that.unbindFromParent();if(!$parent.is(that.el)){that.constraints=$parent;that.bindToParent()}}}else{collection_util.each(that.constraints,function(_,id){that.removeConstraint(id)});collection_util.each(collection_util.makeArray(constraints),function(constraint,i){that.addConstraint(constraint)})}},filteredLocation:function(data){var locationComponents=[],location={};collection_util.each(this.type.dataComponents,function(){if(this.forLocations){locationComponents.push(this.id)}});if(lang_util.isPlainObject(data)){collection_util.each(data,function(value,key){if(value&&locationComponents.indexOf(key)>=0){location[key]=value}})}if(!lang_util.isEmptyObject(location)){return location.kladr_id?{kladr_id:location.kladr_id}:location}},addConstraint:function(constraint){var that=this;constraint=new Constraint(constraint,that);if(constraint.isValid()){that.constraints[constraint.id]=constraint}},removeConstraint:function(id){var that=this;delete that.constraints[id]},constructConstraintsParams:function(){var that=this,locations=[],constraints=that.constraints,parentInstance,parentData,params={};while(jqapi.isJqObject(constraints)&&(parentInstance=constraints.suggestions())&&!(parentData=object_util.getDeepValue(parentInstance,"selection.data"))){constraints=parentInstance.constraints}if(jqapi.isJqObject(constraints)){parentData=new ConstraintLocation(parentData,parentInstance).getFields();if(parentData){if(that.bounds.own.indexOf("city")>-1){delete parentData.city_fias_id}params.locations=[parentData];params.restrict_value=true}}else{if(constraints){collection_util.each(constraints,function(constraint,id){locations=locations.concat(constraint.getFields())});if(locations.length){params.locations=locations;params.restrict_value=that.options.restrict_value}}}return params},getFirstConstraintLabel:function(){var that=this,constraints_id=lang_util.isPlainObject(that.constraints)&&Object.keys(that.constraints)[0];return constraints_id?that.constraints[constraints_id].label:""},bindToParent:function(){var that=this;that.constraints.on(["suggestions-select."+that.uniqueId,"suggestions-invalidateselection."+that.uniqueId,"suggestions-clear."+that.uniqueId].join(" "),jqapi.proxy(that.onParentSelectionChanged,that)).on("suggestions-dispose."+that.uniqueId,jqapi.proxy(that.onParentDispose,that))},unbindFromParent:function(){var that=this,$parent=that.constraints;if(jqapi.isJqObject($parent)){$parent.off("."+that.uniqueId)}},onParentSelectionChanged:function(e,suggestion,valueChanged){if(e.type!=="suggestions-select"||valueChanged){this.clear()}},onParentDispose:function(e){this.unbindFromParent()},getParentInstance:function(){return(jqapi.isJqObject(this.constraints)&&this.constraints.suggestions())},shareWithParent:function(suggestion){var that=this.getParentInstance();if(!that||that.type!==this.type||belongsToArea(suggestion,that)){return}that.shareWithParent(suggestion);that.setSuggestion(suggestion)},getUnrestrictedData:function(data){var that=this,restrictedKeys=[],unrestrictedData={},maxSpecificity=-1;collection_util.each(that.constraints,function(constraint,id){collection_util.each(constraint.locations,function(location,i){if(location.containsData(data)&&location.specificity>maxSpecificity){maxSpecificity=location.specificity}})});if(maxSpecificity>=0){if(data.region_kladr_id&&data.region_kladr_id===data.city_kladr_id){restrictedKeys.push.apply(restrictedKeys,that.type.dataComponentsById.city.fields)}collection_util.each(that.type.dataComponents.slice(0,maxSpecificity+1),function(component,i){restrictedKeys.push.apply(restrictedKeys,component.fields)});collection_util.each(data,function(value,key){if(restrictedKeys.indexOf(key)===-1){unrestrictedData[key]=value}})}else{unrestrictedData=data}return unrestrictedData}};jqapi.extend(DEFAULT_OPTIONS,optionsUsed$1);jqapi.extend(Suggestions.prototype,methods$5);if(ajax.getDefaultType()!="GET"){notificator.on("initialize",methods$5.createConstraints).on("setOptions",methods$5.setupConstraints).on("requestParams",methods$5.constructConstraintsParams).on("dispose",methods$5.unbindFromParent)}var methods$6={proceedQuery:function(query){var that=this;if(query.length>=that.options.minChars){that.updateSuggestions(query)}else{that.hide()}},selectCurrentValue:function(selectionOptions){var that=this,result=jqapi.Deferred();that.inputPhase.resolve();that.fetchPhase.done(function(){var index;if(that.selection&&!that.visible){result.reject()}else{index=that.findSuggestionIndex();that.select(index,selectionOptions);if(index===-1){result.reject()}else{result.resolve(index)}}}).fail(function(){result.reject()});return result},selectFoundSuggestion:function(){var that=this;if(!that.requestMode.userSelect){that.select(0)}},findSuggestionIndex:function(){var that=this,index=that.selectedIndex,value;if(index===-1){value=that.el.val().trim();if(value){that.type.matchers.some(function(matcher){index=matcher(value,that.suggestions);return index!==-1})}}return index},select:function(index,selectionOptions){var that=this,suggestion=that.suggestions[index],continueSelecting=selectionOptions&&selectionOptions.continueSelecting,currentValue=that.currentValue,hasSameValues;if(that.triggering.Select){return}if(!suggestion){if(!continueSelecting&&!that.selection){that.triggerOnSelectNothing()}that.onSelectComplete(continueSelecting);return}hasSameValues=that.hasSameValues(suggestion);that.enrichSuggestion(suggestion,selectionOptions).done(function(enrichedSuggestion,hasBeenEnriched){var newSelectionOptions=jqapi.extend({hasBeenEnriched:hasBeenEnriched,hasSameValues:hasSameValues},selectionOptions);that.selectSuggestion(enrichedSuggestion,index,currentValue,newSelectionOptions)})},selectSuggestion:function(suggestion,index,lastValue,selectionOptions){var that=this,continueSelecting=selectionOptions.continueSelecting,assumeDataComplete=!that.type.isDataComplete||that.type.isDataComplete.call(that,suggestion),currentSelection=that.selection;if(that.triggering.Select){return}if(that.type.alwaysContinueSelecting){continueSelecting=true}if(assumeDataComplete){continueSelecting=false}if(selectionOptions.hasBeenEnriched&&that.suggestions[index]){that.suggestions[index].data=suggestion.data}if(that.requestMode.updateValue){that.checkValueBounds(suggestion);that.currentValue=that.getSuggestionValue(suggestion,selectionOptions);if(that.currentValue&&!selectionOptions.noSpace&&!assumeDataComplete){that.currentValue+=" "}that.el.val(that.currentValue)}if(that.currentValue){that.selection=suggestion;if(!that.areSuggestionsSame(suggestion,currentSelection)){that.trigger("Select",suggestion,that.currentValue!=lastValue)}if(that.requestMode.userSelect){that.onSelectComplete(continueSelecting)}}else{that.selection=null;that.triggerOnSelectNothing()}that.shareWithParent(suggestion)},onSelectComplete:function(continueSelecting){var that=this;if(continueSelecting){that.selectedIndex=-1;that.updateSuggestions(that.currentValue)}else{that.hide()}},triggerOnSelectNothing:function(){var that=this;if(!that.triggering.SelectNothing){that.trigger("SelectNothing",that.currentValue)}},trigger:function(event){var that=this,args=utils.slice(arguments,1),callback=that.options["on"+event];that.triggering[event]=true;if(utils.isFunction(callback)){callback.apply(that.element,args)}that.el.trigger.call(that.el,"suggestions-"+event.toLowerCase(),args);that.triggering[event]=false}};jqapi.extend(Suggestions.prototype,methods$6);notificator.on("assignSuggestions",methods$6.selectFoundSuggestion);var optionsUsed$2={bounds:null};var methods$7={setupBounds:function(){this.bounds={from:null,to:null}},setBoundsOptions:function(){var that=this,boundsAvailable=[],newBounds=$.trim(that.options.bounds).split("-"),boundFrom=newBounds[0],boundTo=newBounds[newBounds.length-1],boundsOwn=[],boundIsOwn,boundsAll=[],indexTo;if(that.type.dataComponents){$.each(that.type.dataComponents,function(){if(this.forBounds){boundsAvailable.push(this.id)}})}if($.inArray(boundFrom,boundsAvailable)===-1){boundFrom=null}indexTo=$.inArray(boundTo,boundsAvailable);if(indexTo===-1||indexTo===boundsAvailable.length-1){boundTo=null}if(boundFrom||boundTo){boundIsOwn=!boundFrom;$.each(boundsAvailable,function(i,bound){if(bound==boundFrom){boundIsOwn=true}boundsAll.push(bound);if(boundIsOwn){boundsOwn.push(bound)}if(bound==boundTo){return false}})}that.bounds.from=boundFrom;that.bounds.to=boundTo;that.bounds.all=boundsAll;that.bounds.own=boundsOwn},constructBoundsParams:function(){var that=this,params={};if(that.bounds.from){params.from_bound={value:that.bounds.from}}if(that.bounds.to){params.to_bound={value:that.bounds.to}}return params},checkValueBounds:function(suggestion){var that=this,valueData;if(that.bounds.own.length&&that.type.composeValue){var bounds=that.bounds.own.slice(0);if(bounds.length===1&&bounds[0]==="city_district"){bounds.push("city_district_fias_id")}valueData=that.copyDataComponents(suggestion.data,bounds);suggestion.value=that.type.composeValue(valueData)}},copyDataComponents:function(data,components){var result={},dataComponentsById=this.type.dataComponentsById;if(dataComponentsById){$.each(components,function(i,component){$.each(dataComponentsById[component].fields,function(i,field){if(data[field]!=null){result[field]=data[field]}})})}return result},getBoundedKladrId:function(kladr_id,boundsRange){var boundTo=boundsRange[boundsRange.length-1],kladrFormat;$.each(this.type.dataComponents,function(i,component){if(component.id===boundTo){kladrFormat=component.kladrFormat;return false}});return(kladr_id.substr(0,kladrFormat.digits)+new Array((kladrFormat.zeros||0)+1).join("0"))}};$.extend(DEFAULT_OPTIONS,optionsUsed$2);$.extend(Suggestions.prototype,methods$7);notificator.on("initialize",methods$7.setupBounds).on("setOptions",methods$7.setBoundsOptions).on("requestParams",methods$7.constructBoundsParams);var dom={selectByClass:function(classname,parent){var selector="."+classname;if(parent){return parent.querySelector(selector)}else{return document.querySelector(selector)}},addClass:function(element,className){var list=element.className.split(" ");if(list.indexOf(className)===-1){list.push(className)}element.className=list.join(" ")},setStyle:function(element,name,value){element.style[name]=value},listenTo:function(element,eventName,namespace,callback){element.addEventListener(eventName,callback,false);if(namespace){if(!eventsByNamespace[namespace]){eventsByNamespace[namespace]=[]}eventsByNamespace[namespace].push({eventName:eventName,element:element,callback:callback})}},stopListeningNamespace:function(namespace){var events=eventsByNamespace[namespace];if(events){events.forEach(function(event){event.element.removeEventListener(event.eventName,event.callback,false)})}}};var FREE_PLAN="FREE";var LINK="https://dadata.ru/suggestions/?utm_source=dadata&utm_medium=module&utm_campaign=suggestions-jquery";var PREFIX="";var SUFFIX="";var IMAGE='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 167.55 38.92"><defs><style>.cls-1{fill:#cdcccc;}.cls-2{fill:#ef4741;}.cls-3{fill:#fff;}</style></defs><title>dadata-logo</title><path class="cls-1" d="M192.61,153.07H196v-3.15h-3.39Zm9.55-14.46v-2.45h-3v16.91h3.14V142.2a4.39,4.39,0,0,1,4.23-3.7h1.75v-2.69h-1.54C203.75,135.81,202.35,137.76,202.16,138.61Zm20.2-2.45v11.3a5,5,0,0,1-4.65,3.66,7.19,7.19,0,0,1-2-.23,2,2,0,0,1-1.12-.6,2.38,2.38,0,0,1-.44-.86,4.38,4.38,0,0,1-.1-1V136.16h-3.14v12.4a4.83,4.83,0,0,0,1.26,3.65q1.26,1.21,4.61,1.21c3.38,0,4.62-.91,5.56-2.34v2h3.14V136.16Z" transform="translate(-57.96 -122.27)"/><rect class="cls-2" width="131.91" height="38.92" rx="3" ry="3"/><path class="cls-3" d="M119.34,130.39h-9.18v22.68h10.23c3.84,0,10.18-.35,10.18-6.88v-8.91C130.56,130.74,123.18,130.39,119.34,130.39Zm5.77,15.2c0,3.27-2.38,3.6-5.09,3.6h-4.41V134.27H119c2.71,0,6.14.33,6.14,3.6Zm-48-15.2H68v22.68H78.18c3.84,0,10.18-.35,10.18-6.88v-8.91C88.36,130.74,81,130.39,77.14,130.39Zm5.77,15.2c0,3.27-2.38,3.6-5.09,3.6H73.41V134.27h3.36c2.71,0,6.14.33,6.14,3.6Zm74-14.32h-5.1V148a6.28,6.28,0,0,0,.4,2.36,4,4,0,0,0,1,1.54,4.56,4.56,0,0,0,1.57.88,8.16,8.16,0,0,0,1.85.42q.89.08,2.08.09a24.23,24.23,0,0,0,2.83-.17v-2.87h-1.82a3.08,3.08,0,0,1-2.31-.61,3.79,3.79,0,0,1-.52-2.36V139h4.65v-3.14h-4.65Zm21,5.68q-1.82-1.14-6.5-1.13h-5.92v.25l.73,2.9h5.19a5,5,0,0,1,2.5.5,2.37,2.37,0,0,1,.72,2v1.15H168.9q-3,0-4.12,1.17T163.62,148c0,2.21.37,3.14,1.12,3.84s2.2,1.22,4.48,1.22h7.06c1.76,0,3.45-.83,3.45-2.82v-8.81Q179.73,138.08,177.91,136.94Zm-3.29,13.3h-3.35a4.27,4.27,0,0,1-2.22-.35q-.44-.35-.44-2t.42-2.06a3.55,3.55,0,0,1,2.1-.38h3.49Zm-27.5-13.3q-1.82-1.14-6.5-1.13h-5.92v.25l.73,2.9h5.19a5,5,0,0,1,2.5.5,2.38,2.38,0,0,1,.72,2v1.15h-5.73q-3,0-4.12,1.17T132.84,148c0,2.21.37,3.14,1.12,3.84s2.2,1.22,4.48,1.22h7.06c1.77,0,3.45-.83,3.45-2.82v-8.81Q148.94,138.08,147.13,136.94Zm-3.28,13.3h-3.35a4.27,4.27,0,0,1-2.22-.35q-.44-.35-.44-2t.42-2.06a3.55,3.55,0,0,1,2.1-.38h3.49Zm-38.92-13.3q-1.82-1.14-6.5-1.13H92.5v.25l.73,2.9h5.19a5,5,0,0,1,2.5.5,2.38,2.38,0,0,1,.72,2v1.15H95.91q-3,0-4.12,1.17T90.63,148c0,2.21.37,3.14,1.12,3.84s2.2,1.22,4.48,1.22h7.06c1.77,0,3.45-.83,3.45-2.82v-8.81Q106.74,138.08,104.92,136.94Zm-3.28,13.3H98.29a4.27,4.27,0,0,1-2.22-.35q-.44-.35-.44-2t.42-2.06a3.55,3.55,0,0,1,2.1-.38h3.49Z" transform="translate(-57.96 -122.27)"/></svg>';function Promo(plugin){this.plan=plugin.status.plan;var container=plugin.getContainer();this.element=dom.selectByClass(CLASSES.promo,container)}Promo.prototype.show=function(){if(this.plan!==FREE_PLAN){return}if(!this.element){return}this.setStyles();this.setHtml()};Promo.prototype.setStyles=function(){this.element.style.display="block"};Promo.prototype.setHtml=function(){this.element.innerHTML='<a target="_blank" tabindex="-1" href="'+LINK+'">'+PREFIX+IMAGE+SUFFIX+"</a>"};function show(){new Promo(this).show()}notificator.on("assignSuggestions",show);Suggestions.defaultOptions=DEFAULT_OPTIONS;Suggestions.version="20.3.0";$.Suggestions=Suggestions;$.fn.suggestions=function(options,args){if(arguments.length===0){return this.first().data(DATA_ATTR_KEY)}return this.each(function(){var inputElement=$(this),instance=inputElement.data(DATA_ATTR_KEY);if(typeof options==="string"){if(instance&&typeof instance[options]==="function"){instance[options](args)}}else{if(instance&&instance.dispose){instance.dispose()}instance=new Suggestions(this,options);inputElement.data(DATA_ATTR_KEY,instance)}})}})));var FogSoft=(function(module,$,_,localforage,sessionStorageWrapper){var dataTables=module.DataTable=module.DataTable||{};var commonModule=FogSoft.Common;var debug=false;var emptyGroupCode="_emptyGroupCode_";function writeDebug(){if(debug){console.log(writeDebug.caller.name)}}var getCompiledTemplate=function(tmplStr){var tmpl;if(tmplStr.indexOf("${")==0){tmpl=$("<span></span>").text(tmplStr).template()}else{tmpl=$.template(tmplStr.indexOf("#")==0?$(tmplStr):$("<div/>").append(tmplStr))}return tmpl};var cellFormatter=function(templateCache,value,columnDef,dataContext){var renderTemplate=function(_tmpl,tmplOptions){var compiledTmpl=templateCache[columnDef.id||_tmpl];if(!compiledTmpl){compiledTmpl=getCompiledTemplate(_tmpl);if(compiledTmpl&&$.type(compiledTmpl)=="function"){templateCache[columnDef.id||_tmpl]=compiledTmpl}}return compiledTmpl?$.tmpl(compiledTmpl,dataContext,tmplOptions):$()};var templateOptions={value:value,columnDef:columnDef,common:commonModule};var cellValue=value;var pattern=columnDef.pattern;var dataType=columnDef.dataType;var cssClass=columnDef.cssClass;if(cellValue&&cellValue.__is_cell__===true){var def=cellValue;cellValue=def.value;pattern=def.pattern||pattern;dataType=def.dataType||dataType;cssClass=def.cssClass||cssClass}var encodeHtml=true;if(columnDef.template){encodeHtml=false;var renderedTemplate=renderTemplate(columnDef.template,templateOptions);cellValue=$("<div/>").append(renderedTemplate).html()}else{if(dataType=="Bool"||dataType=="Boolean"){cellValue=commonModule.formatBoolean(cellValue,pattern)}else{if(dataType=="Number"||dataType=="Money"){cellValue=commonModule.formatNumber(cellValue,pattern,dataType)}else{if(dataType&&(dataType.indexOf("Date")!=-1||dataType.indexOf("Time")!=-1)){cellValue=commonModule.formatDateTime(cellValue,pattern,dataType)}}}}templateOptions.value=cellValue;if(columnDef.url||columnDef.action){var $a=$("<a></a>");var href="",onclick="";if(columnDef.url){href=columnDef.url}if(columnDef.action){if(!columnDef.url){href="#"}onclick=columnDef.action}href&&$a.attr("data-href",href);onclick&&$a.attr("data-onclick",onclick);$a.html("${$item.value}");var tmpl=$a.wrap("<div>").parent().html();var $link=renderTemplate(tmpl,templateOptions).first();var hrefValue=$link.attr("data-href");var onclickValue=$link.attr("data-onclick")||"";href&&$link.removeAttr("data-href");onclick&&$link.removeAttr("data-onclick");hrefValue&&$link.attr("href",hrefValue);onclickValue&&$link.attr("onclick",onclickValue);if(hrefValue){if(hrefValue.length===1&&hrefValue[0]==="#"){if(onclickValue.length===0){return commonModule.htmlEncode(value)}}return $link.wrap("<div>").parent().html()}}if(cssClass){cellValue='<span class="'+cssClass+'">'+cellValue+"</span>";encodeHtml=false}return encodeHtml?commonModule.htmlEncode(cellValue):cellValue};var resolveCellType=function(dataType){if(!dataType){return"string"}else{if(dataType=="Bool"||dataType=="Boolean"){return"string"}else{if(dataType=="Number"){return"num"}else{if(dataType=="Money"){return"num-fmt"}else{if(dataType&&(dataType.indexOf("Date")!=-1||dataType.indexOf("Time")!=-1)){return"date"}}}}}return"string"};var parseResponse=function(json,loader){if(json.Success){return json.Rows}loader.model.onDataError.trigger({data:json});return[]};function DataGridEvent(el,name){this.trigger=function(args){$(el).trigger(name,args)};this.subscribe=function(callback){$(el).on(name,callback)}}function Loader($el,options){var loader=this;_.extend(this,options);loader.rowSelection=loader.rowSelection||{};this.Sorting={SortColumn:options.sortColumn,SortAsc:options.sortAsc};loader.templateCache={};loader.columnsById={};this.model={onDataLoading:new DataGridEvent($el,"onDataLoading"),onDataLoaded:new DataGridEvent($el,"onDataLoaded"),onDataError:new DataGridEvent($el,"onDataError"),onInitialized:new DataGridEvent($el,"initialized."+loader.id)};this.grid={getSelectedRows:function(){return loader.getSelectedData(true)},setSelectedRows:function(rowIndexes){if(!rowIndexes||rowIndexes.length===0){loader.table.selectAll(false)}else{_.each(rowIndexes,function(index){var row=loader.table.row(index);row.selectRow(true);row.updateCheckState(true)})}},onActiveCellChanged:new DataGridEvent($el,"onActiveCellChanged"),onSelectedRowsChanged:new DataGridEvent($el,"selectedRowsChanged"),resetActiveCell:function(){var activeCell=$(loader.table.table().node()).find("td.active");activeCell.removeClass("active");loader.grid.onActiveCellChanged.trigger({})}};loader.columns=filterColumnsForLoader(loader.columns);function filterColumnsForLoader(allColumns){var sortColumnIds=allColumns.filter(function(c){return c.sortColumn}).map(function(c){return c.sortColumn});return _.filter(allColumns,function(cd){return cd.visible!==false||(loader.groupColumn&&cd.id===loader.groupColumn)||(loader.groupNameColumn&&cd.id===loader.groupNameColumn)||sortColumnIds.includes(cd.id)})}var isRowSelectionModel=options.selectionModel=="row";if(isRowSelectionModel&&options.selectionWidget){loader.withSelector=true;var selectorData={id:"__rows_selector",sortable:false,cssClass:"all datatable-rows-selector",customRender:function(data,type,row,meta){var $input=$("<input/>");$input.attr("type",options.selectionWidget.toLowerCase());var canChangeSelection=loader.canChangeSelectionProperty?row[loader.canChangeSelectionProperty]:true;if(!canChangeSelection){$input.prop("disabled",true)}var outerHtml=$input.prop("outerHTML");return outerHtml}};loader.columns.unshift(selectorData)}function getColumnIdx(id,fallbackIndex){var columnIdx=fallbackIndex;$.each(loader.columns,function(idx,el){if(el.id===id){columnIdx=idx;return false}});return columnIdx}var widths={};var totalWidth=_.reduce(loader.columns,function(acc,columnDef){var width=columnDef.width||0;acc+=width;return acc},0);_.forEach(loader.columns,function(columnDef,index){var value="auto";if(columnDef.width){value=((columnDef.width/totalWidth)*100)+"%"}widths[index]=value});var columnDefs=_.map(loader.columns,function(columnDef,index){columnDef.index=index;loader.columnsById[columnDef.id]=columnDef;var result={className:columnDef.cssClass,customRender:columnDef.customRender,width:widths[index],targets:index,orderable:columnDef.sortable,visible:columnDef.visible!==false,data:function(row,type,set,meta){if(type==="display"||type==="sort"){return deepSearch(row,columnDef.id)}if(type==="type"){var columnDataType=getColumnDataType(columnDef,row);return resolveCellType(columnDataType)}return null},render:function(data,type,row,meta){if(meta.col===0&&loader.withSelector===true&&type==="display"){var aoColumn=meta.settings.aoColumns[meta.col];if(typeof aoColumn.customRender==="function"){return aoColumn.customRender(data,type,row,meta)}}if(data==undefined){return columnDef.nullDisplayText||""}else{if(type==="display"){return cellFormatter(loader.templateCache,data,columnDef,row)}else{if(type==="sort"){var dataForSort=data;if(data&&data.__is_cell__===true){dataForSort=data.value}return dataForSort}else{if(type==="type"){return data}}}}return null}};if(columnDef.sortColumn){result.orderData=getColumnIdx(columnDef.sortColumn,index)}return result});function getColumnDataType(columnDef,rowData){if(columnDef.dataType){return columnDef.dataType}var dataColumnDef=deepSearch(rowData,columnDef.id);if(dataColumnDef&&dataColumnDef.__is_cell__===true){if(dataColumnDef.dataType){return dataColumnDef.dataType}}return null}function deepSearch(row,id){var current=row;$.each(id.split("."),function(idx,property){if(current){current=current[property]}});return current}var columns={columnDefs:columnDefs};$.fn.dataTable.ext.type.detect.push(function(data,settings){if(data==="num"||data==="num-fmt"){return data}return null});$.fn.dataTable.ext.feature.push({fnInit:function(oSettings){var $el=$(oSettings.oInstance);var buttons=oSettings.oInit.buttons;if(buttons.length){var $toolBar=$('<div class="dataTables_btn_toolbar btn-toolbar"></div>');$.each(buttons,function(i,btn){var $btn=$('<button class="btn" type="button"></button>').appendTo($toolBar);btn.cssClass&&$btn.addClass(btn.cssClass);btn.iconCssClass&&$btn.append('<i class="'+btn.iconCssClass+'"></i>');btn.text&&$btn.append(" "+btn.text);btn.attributes&&$btn.attr(btn.attributes);if(btn.beforeEvent||btn.event){$btn.on("click",function(){var $this=$(this);if(btn.beforeEvent){var e=$.Event(btn.beforeEvent,{relatedTarget:$this});$el.trigger(e);if(e.isDefaultPrevented()||e.result===false){return}}btn.event&&$el.trigger({type:btn.event,relatedTarget:$this,args:$this.data()})})}});FogSoft.Common.init($toolBar);return $toolBar}else{return null}},cFeature:"E"});var dataTableOpts=_.extend({bPaginate:!options.hidePaging,language:dataTables.messages,filter:false,buttons:options.buttons,aaSorting:[],bAutoWidth:false,lengthMenu:options.lengthMenu,createdRow:function(rowEl,data){var $row=$(rowEl);if(loader.hideRowProperty&&data[loader.hideRowProperty]){$row.toggleClass("hidden",true)}if(loader.objectIdProperty&&data[loader.objectIdProperty]){$row.prop("id",data[loader.objectIdProperty])}var row=this.api().row(rowEl);$row.click(function(ev){$el.trigger("rowClick.dt",{row:row,ev:ev})});if(loader.rowCssClassProvider){var rowClass=loader.rowCssClassProvider(data);if(rowClass){$row.addClass(rowClass)}}},fnDrawCallback:function(oSettings){var dataTablesPaging=$(oSettings.nTableWrapper).find(".dataTables_paginate");var dataTablesLength=$(oSettings.nTableWrapper).find(".dataTables_length");if(oSettings._iDisplayLength>=oSettings.fnRecordsDisplay()){dataTablesPaging.hide();if(options.hideTableLengthSelectIfAllRowShown){dataTablesLength.hide()}}else{dataTablesPaging.show();dataTablesLength.show()}}},columns);if(loader.loadDataUrl&&(typeof loader.autoLoad==="undefined"||loader.autoLoad||typeof loader.data==="undefined")){var remoteOpts={serverSide:true,ajax:{method:"POST",dataType:"json",url:options.loadDataUrl,dataSrc:function(json){return parseResponse(json,loader)}}};dataTableOpts=_.extend(dataTableOpts,remoteOpts)}else{var localOpts={data:loader.data.Rows};dataTableOpts=_.extend(dataTableOpts,localOpts);var paging=loader.data.Paging;if(paging.SortColumn){var sortColumnDef=loader.columnsById[paging.SortColumn];if(sortColumnDef){var sortDirection=paging.SortAsc?"asc":"desc";dataTableOpts.aaSorting=[[sortColumnDef.index,sortDirection]]}}}dataTableOpts.scrollX=loader.scrollX;if(loader.scrollY){dataTableOpts.scrollY=loader.scrollY;dataTableOpts.scrollCollapse=true}var groupColumn=loader.groupColumn;var groupNameColumn=loader.groupNameColumn;if(groupColumn){var groupColumnDef=loader.columnsById[groupColumn];var idx=groupColumnDef.index;if(groupColumnDef.sortColumn){idx=getColumnIdx(groupColumnDef.sortColumn,idx)}dataTableOpts.orderFixed=[idx,loader.Sorting.SortAsc?"asc":"desc"];dataTableOpts.rowGroup={dataSrc:function(data){return data[groupColumn]},startRender:function(group,groupId){var name=groupId;if(groupNameColumn){var data=group.data();var row=data[0];if(row&&typeof row[groupNameColumn]!=="undefined"){name=row[groupNameColumn]}}if(loader.groupTemplate){var data=group.data();var row=data[0];var canChangeSelection=loader.canChangeSelectionProperty?row[loader.canChangeSelectionProperty]:true;return $(loader.groupTemplate).tmpl({group:group,groupId:groupId,groupName:name,firstRow:row,groupRowIndexes:group[0],canChangeSelection:canChangeSelection})}if(loader.groupSelectionAllowed===true){var div=$("<div/>");var groupSelector=$("<input/>");groupSelector.addClass("table-group-selector");groupSelector.attr("type","checkbox");groupSelector.data("group-id",groupId||emptyGroupCode);groupSelector.on("change",function(){var row=group.row(group.eq(0)[0]);row.group().selectGroup(groupSelector.prop("checked"))});setTimeout(function(){var row=group.row(group.eq(0)[0]);row.group().updateGroupSelect()},1);div.append(groupSelector);div.append(name);name=div}return name}};var emptyDataGroup=loader.emptyDataGroup;if(typeof emptyDataGroup!=="undefined"){dataTableOpts.rowGroup.emptyDataGroup=emptyDataGroup}}if(loader.hideInfo){dataTableOpts.info=false}if(typeof loader.responsive==="undefined"||loader.responsive==="Enabled"||loader.responsive==="Default"){dataTableOpts.responsive={details:{display:$.fn.dataTable.Responsive.display.childRowImmediate,type:"none",target:""},selectedClass:"selected"}}else{dataTableOpts.responsive=false}this.dataTableOpts=dataTableOpts;this.$tableEl=$el;$el.data("loader",loader);var linkedForm=$("[data-linked-data-grid-id='"+options.id+"']");if(!loader.data&&(loader.autoLoad===false||linkedForm.length)){dataTableOpts.deferLoading=0}loader.isColumnMetadataDifferent=function(dataResult){if(dataResult.GroupColumn!==loader.groupColumn){return true}var newColumns=dataResult.Columns;if(!newColumns||!newColumns.length){return false}var newFilteredColumns=filterColumnsForLoader(dataResult.Columns);var loaderColumnsById=loader.columnsById;var loaderColumns=loader.columns;if(newFilteredColumns.length!==loaderColumns.length){return true}for(var i=0;i<newFilteredColumns.length;i++){var newColumn=newFilteredColumns[i];var currentColumn=loaderColumnsById[newColumn.id];if(!currentColumn){return true}}return false};var storageInstance=localforage.createInstance({name:"DataTable"});function setLoaderKeys(){loader.storageKey=loader.id+"_"+window.location.href.split("#")[0];loader.pageStateKey=loader.$tableEl.closest(".ui-block, .tab-pane").length?(loader.id+"_page"):"page"}function initializeLoader(){$(document.body).trigger("initializing."+loader.id,loader);loader.init()}function initializeDataTableOptions(state){var modal=loader.$tableEl.closest(".modal");dataTableOpts.stateSave=dataTableOpts.stateSave!==false&&modal.length===0;dataTableOpts.stateLoadCallback=function(settings){state=state||{};var length=state.length||settings._iDisplayLength;var page=parseInt($.bbq.getState(loader.pageStateKey))-1||0;var displayStart=length*page;if($.isEmptyObject(state)){settings._iDisplayStart=displayStart;settings.iInitDisplayStart=displayStart}else{state.start=displayStart}return state};dataTableOpts.stateSaveCallback=function(settings,data){delete data.start;storageInstance.setItem(loader.storageKey,data)}}if(sessionStorageWrapper){storageInstance.defineDriver(sessionStorageWrapper).then(function(){storageInstance.setDriver(sessionStorageWrapper._driver)}).then(function(){setLoaderKeys();storageInstance.getItem(loader.storageKey).then(initializeDataTableOptions).then(initializeLoader)})}else{setLoaderKeys();storageInstance.getItem(loader.storageKey).then(initializeDataTableOptions).then(initializeLoader).then(function(){loader.refresh()})}function addVerificationToken(postData){var tokenName="__RequestVerificationToken";if(_.some(postData,(function(x){return x.name==tokenName}))){return}var tokenValue=$('form input[name="'+tokenName+'"]').val();postData.push({name:tokenName,value:tokenValue})}function exportData(exportType){if(loader.model.onDataLoading){var cType=$.type(exportType)==="string"?exportType:(exportType&&exportType.args&&exportType.args.exportType)||"text/csv",postData=[{name:"offset",value:0},{name:"limit",value:65536},{name:"sortColumn",value:loader.Sorting.SortColumn},{name:"sortAsc",value:loader.Sorting.SortAsc},{name:"X-HTTP-Accept-Override",value:cType}];loader.model.onDataLoading.trigger({from:0,to:0,data:postData});addVerificationToken(postData);commonModule.blockUi();$.fileDownload(options.loadDataUrl,{httpMethod:"POST",data:postData,successCallback:commonModule.unblockUi,failCallback:commonModule.unblockUi,clearCookieBeforeDownload:true})}}$el.on("refresh.datagrid.data-api",function(){loader.refresh(true)});$el.on("export.datagrid.data-api",exportData)}_.extend(Loader.prototype,{selectionAvailable:function(){return !!(this.selectionWidget&&this.selectionModel)},isSelected:function(data){var ids=Object.keys(this.rowSelection||{});var id=data[this.objectIdProperty];return id&&ids.indexOf(id.toString())>-1},selectedChanged:function(){this.grid.onSelectedRowsChanged.trigger()},setRowCssClassProvider:function(provider){this.rowCssClassProvider=provider},getRowData:function(rowIndex){var row=this.table.row(rowIndex);return row.data()},setData:function(data){var table=this.$tableEl.dataTable();var page=this.$tableEl.DataTable().page();table.fnClearTable();if(data.length!=0){table.fnAddData(data);table.fnPageChange(page)}},getData:function(){var table=this.$tableEl.dataTable();return table.fnGetData()},init:function(){this.initHandlers();this.listenDtEvents();this.table=this.$tableEl.DataTable(this.dataTableOpts);$(document.body).on("initialized.dataBlock.data-api",function(eventArgs,block){var $block=$(block);var $dataTables=$block.find(".dataTables_wrapper");if($dataTables.length>0){$block.addClass("has-self-padding-content")}});$(document.body).on("initialized."+this.id,function(eventArgs,loader){var $block=$(loader.$tableEl).parents(".ui-block-content");$block.addClass("has-self-padding-content")});$(document.body).trigger("preInitialized."+this.id,this)},clearSelection:function(){this.rowSelection={};this.table.selectAll(false)},getSelected:function(){return $.map(this.rowSelection,function(value,key){return value})},setSelectedDataByIds:function(ids){var loader=this;var table=loader.table;table.rows().eq(0).each(function(index){var row=table.row(index);var rowData=row.data();var id=rowData[loader.objectIdProperty];var selected=ids.indexOf(id)>-1;row.selectRow(selected);row.updateCheckState(selected)})},getSelectedData:function(dataColumns){var loader=this;var idProp=this.objectIdProperty;var idOnly;if(dataColumns===true){dataColumns=idProp?[idProp]:[];idOnly=true}else{dataColumns=$.map(arguments,function(el){if($.type(el)==="string"&&el){return el}})}var selectedRows=loader.getSelected();var selected=$.map(selectedRows,function(rowData){if(idOnly){return rowData[idProp]}if(dataColumns.length===0){return rowData}else{return _.pick(rowData,dataColumns)}});return selected},validateSelectionExists:function(id,errorMessage,e){if(this.grid.getSelectedRows().length>0){return true}FogSoft.Common.showErrorMessage(errorMessage||FogSoft.Common.messages.dataGridNoSelectedRowsError);e.stopImmediatePropagation();return false},refresh:function(resetPaging,resetSelection){var loader=this;var refreshFn=function(){loader.table.ajax.reload(undefined,resetPaging);loader.updateFooter();if(resetSelection===true){loader.clearSelection()}};if(loader.table){refreshFn()}else{$(document.body).one("preInitialized."+loader.id,refreshFn)}},initHandlers:function(){var loader=this;if(loader.eventHandlers){$.each(loader.eventHandlers,function(index,eh){$(document.body).on(eh.eventName+"."+loader.id,function(){var gridEl=$("#"+loader.id);if(!gridEl.length){$(document.body).off(eh.eventName+"."+loader.id)}else{return eh.handler.apply(loader,Array.prototype.slice.call(arguments))}})})}if(loader.dataTableOpts.stateSave){var ns=Date.now();function getState(){return parseInt($.bbq.getState(loader.pageStateKey))-1||0}$(window).on("hashchange."+ns,function(){var statePage=getState();if(!$("html").has(loader.$tableEl).length){$(window).off("hashchange."+ns);return false}if(loader.table.page()!=statePage){loader.table.page(statePage);loader.refresh(false)}})}$(document.body).one("initialized."+loader.id,loader.updateFooter.bind(loader))},destroy:function(clearTable,clearState){var loader=this;loader.$tableEl.removeData("loader");$(document.body).off("."+loader.id);loader.$tableEl.off(".data-api");loader.table.destroy();if(clearTable){loader.$tableEl.empty()}if(clearState){loader.table.state.clear()}},updateSelectedRowsInfo:function(){var loader=this;var add=function(target,name,num){target.append($('<span class="select-item"/>').append(loader.table.i18n("select."+name+"s",{_:"%d "+name+"s selected",0:"",1:"1 "+name+" selected"},num)))};if(!loader.table||!loader.table.settings){return}var tableSettings=loader.table.settings()[0];if(tableSettings.aanFeatures.i){$.each(tableSettings.aanFeatures.i,function(_,el){var output=$('<span class="select-info"/>');add(output,"row",Object.keys(loader.rowSelection).length);el=$(el);var existing=el.children("span.select-info");if(existing.length){existing.remove()}if(output.text()!==""){el.append(output)}})}},listenDtEvents:function(){var loader=this;var select=function(row,srcEl){if(!loader.selectionAvailable()){return false}if(!loader.multiSelect){loader.clearSelection()}var data=row.data();var canChangeSelection=loader.canChangeSelectionProperty?data[loader.canChangeSelectionProperty]:true;if(!canChangeSelection){return false}var isSelected=loader.isSelected(data);row.selectRow(!isSelected);row.table().updateAllSelect();if(loader.groupSelectionAllowed){row.group().updateGroupSelect()}loader.selectedChanged();if(srcEl){if($(srcEl).is("td")){var cell=row.cell(srcEl);var indexData=cell.index();if(indexData){loader.grid.onActiveCellChanged.trigger({cell:indexData.column,row:indexData.row})}}}return !isSelected};var responsiveDisplayEvent="responsive-display.dt.datatable.loader";loader.$tableEl.off(responsiveDisplayEvent).on(responsiveDisplayEvent,function(ev,dt,row,res,update){var child=row.child();$(child).off("click.childClick").on("click.childClick",function(ev){var $this=$(this);loader.$tableEl.trigger("childClick.dt",{child:$this,row:row,ev:ev})})});var rowClickEvent="rowClick.dt.datatable.loader";loader.$tableEl.off(rowClickEvent).on(rowClickEvent,function rowClick(farg,args){var el=args.ev.target||args.ev.srcElement;var row=args.row;var isSelected=select(row,el);row.updateCheckState(isSelected)});var childClickEvent="childClick.dt.datatable.loader";loader.$tableEl.off(childClickEvent).on(childClickEvent,function childClick(farg,args){var el=args.ev.target||args.ev.srcElement;var row=args.row;var isSelected=select(row,el);row.updateCheckState(isSelected)});var preInitEvent="preInit.dt.datatable.loader";loader.$tableEl.off(preInitEvent).on(preInitEvent,function preInitTable(){writeDebug();var table=loader.$tableEl.DataTable();loader.table=table;loader.$tableEl.data("loader",loader);if(!loader.selectionAvailable()){return}var rows=table.rows().eq(0);if(loader.selectedIds){var rowSelection={};rows.each(function(index){var row=table.row(index);var rowData=row.data();var id=rowData[loader.objectIdProperty];if(loader.selectedIds.indexOf(id)>-1){rowSelection[id]=rowData}});loader.rowSelection=rowSelection;loader.selectedIds=null}});var drawEvent="draw.dt.datatable.loader";loader.$tableEl.off(drawEvent).on(drawEvent,function draw(ev,settings){writeDebug();var table=loader.table;if(!loader.selectionAvailable()){return}var rows=table.rows().eq(0);var keys=Object.keys(loader.rowSelection);var allSelected=rows.length>0&&loader.selectionWidget!==undefined;rows.each(function(index){var row=table.row(index);var rowData=row.data();var id=rowData[loader.objectIdProperty];var selected=keys.indexOf(id)>-1;row.selectRow(selected);row.updateCheckState(selected);allSelected=allSelected&&selected});loader.updateSelectedRowsInfo();table.updateAllSelect()});var initEvent="init.dt.datatable.loader";loader.$tableEl.off(initEvent).on(initEvent,function initTable(ev,settings,ordering,dirs){writeDebug();if(loader.selectionWidget&&loader.selectionWidget.toLowerCase()==="checkbox"){var selectAllCheckbox=loader.$tableEl.find(".data_table_select_all_checkbox");selectAllCheckbox.on("click.selectAll.datatable.loader",function(){var $this=$(this);var checked=$this.prop("checked");loader.table.selectAll(checked);loader.selectedChanged()})}Fogsoft.Common.initPopovers($(this));Fogsoft.Common.initDataTableTabs($(this));$(document.body).trigger("initialized."+loader.id,loader)});var preXhrEvent="preXhr.dt.datatable.loader";loader.$tableEl.off(preXhrEvent).on(preXhrEvent,function preXhr(ev,settings,json){var limit=json.length;var offset=json.start;if(json.order.length>0){var sortAscStr=json.order[0].dir;var sortColumnIndex=json.order[0].column;var sortColumn=loader.columns[sortColumnIndex].id;if(loader.Sorting.SortColumn){loader.Sorting.SortColumn=sortColumn;loader.Sorting.SortAsc=sortAscStr==="asc"}}var data=[];data.push({name:"offset",value:offset});data.push({name:"limit",value:limit});data.push({name:"sortColumn",value:loader.Sorting.SortColumn});data.push({name:"sortAsc",value:loader.Sorting.SortAsc});var args={data:data};loader.model.onDataLoading.trigger(args);var ajax=settings.ajax;if(ajax.data){_.each(ajax.data,function(value,key){data.push({name:key,value:value})})}settings.ajax.data=data});var xhrEvent="xhr.dt.datatable.loader";loader.$tableEl.off(xhrEvent).on(xhrEvent,function xhr(ev,settings,json){if(json&&json.Success&&json.Paging){var p=json.Paging;_.extend(loader.Sorting,p);if(loader.dataTableOpts.stateSave){var currentPage=loader.table.page();var statePage=$.bbq.getState(loader.pageStateKey);if(currentPage||statePage){var state={};state[loader.pageStateKey]=currentPage+1;$.bbq.pushState(state)}}json.recordsTotal=p.Total;json.recordsFiltered=p.Total;if(p.SortColumn){var sortColumnId=p.SortColumn;var sortAsc=p.SortAsc;var col=loader.columnsById[sortColumnId];if(col){var index=col.index;var sortAscStr=sortAsc?"asc":"desc";loader.table.order([[index,sortAscStr]])}else{}}var args={data:json};loader.model.onDataLoaded.trigger(args)}})},updateFooter:function(){var loader=this;if(loader.loadFooterUrl){$.ajax({method:"POST",url:loader.loadFooterUrl,success:function(data){if(data.Data){loader.$tableEl.find("tfoot th").html(data.Data)}else{loader.$tableEl.find("tfoot").remove()}}})}}});dataTables.init=function($el,options){var loader=new Loader($el,options);return loader};function updateRowSelectionData(loader,data,selected){if(loader.selectionWidget){var objectIdProperty=loader.objectIdProperty;var id=data[objectIdProperty];if(selected){loader.rowSelection[id]=data}else{delete loader.rowSelection[id]}loader.updateSelectedRowsInfo()}}jQuery.fn.dataTable.Api.register("updateGroupsSelect()",function updateGroupsSelect(){var table=this;var loader=table.getLoader();if(!loader.groupSelectionAllowed){return}writeDebug();var groupData=collectGroups(table);var selection=Object.keys(loader.rowSelection);var groupSelection={};Object.keys(groupData.groups).forEach(function(groupId){var groupSelected=true;groupData.groups[groupId].forEach(function(id){groupSelected=groupSelected&&selection.indexOf(id)>-1});groupSelection[groupId]=groupSelected});table.updateGroupSelectors(groupSelection)});jQuery.fn.dataTable.Api.register("updateAllSelect()",function updateAllSelect(){writeDebug();var table=this;var loader=table.getLoader();var selection=loader.rowSelection;var objectIdProperty=loader.objectIdProperty;var selectedKeys=Object.keys(selection);var rows=table.rows({page:"current"}).eq(0);var allSelected=rows.length>0;rows.each(function(index){var row=table.row(index);var data=row.data();var id=data[objectIdProperty];allSelected=allSelected&&(selectedKeys.indexOf(id)>-1)});table.updateAllSelector(allSelected)});jQuery.fn.dataTable.Api.register("updateAllSelector()",function updateAllSelector(selected){writeDebug();var loader=this.getLoader();loader.$tableEl.find(".data_table_select_all_checkbox").prop("checked",selected)});jQuery.fn.dataTable.Api.register("selectAll()",function selectAll(selected){writeDebug();var table=this;var loader=this.getLoader();this.rows({page:"current"}).eq(0).each(function(index){var row=table.row(index);row.selectRow(selected);row.updateCheckState(selected)});if(loader.groupSelectionAllowed){table.updateGroupsSelect()}table.updateAllSelector(selected)});jQuery.fn.dataTable.Api.register("row().updateCheckState()",function updateCheckState(selected){var $node=$(this.node());var rowSelector=$node.find(".datatable-rows-selector input");rowSelector.prop("checked",selected).change()});jQuery.fn.dataTable.Api.register("row().selectRow()",function selectRow(selected){writeDebug();var data=this.data();var loader=this.getLoader();updateRowSelectionData(loader,data,selected);var $node=$(this.node());if(selected){$node.addClass("selected")}else{$node.removeClass("selected")}if(this.child()){var $child=$node.next("tr.child");if(selected){$child.addClass("selected")}else{$child.removeClass("selected")}}});function collectGroups(table){var loader=table.getLoader();var objectIdProperty=loader.objectIdProperty;var groupColumn=loader.groupColumn;var rows=table.rows({page:"current"}).eq(0);var groups={};var groupsByRowId={};rows.each(function(index){var row=table.row(index);var data=row.data();var id=data[objectIdProperty];var group=data[groupColumn]||emptyGroupCode;groups[group]=groups[group]||[];groups[group].push(id);groupsByRowId[id]=group});return{groups:groups,groupsByRowId:groupsByRowId}}jQuery.fn.dataTable.Api.register("row().group().updateGroupSelect()",function updateGroupSelect(){writeDebug();var loader=this.getLoader();if(!loader.groupColumn){return false}var table=this.table();var groupData=collectGroups(table);var selection=loader.rowSelection;var groupId=this.selector.groupId||emptyGroupCode;var rowsInGroup=groupData.groups[groupId];var selectedKeys=Object.keys(selection);var allSelected=rowsInGroup.length>0;$.each(rowsInGroup,function(_,rowId){allSelected=allSelected&&(selectedKeys.indexOf(rowId)>-1)});var currentIndex=this.index();this.row(currentIndex).group().updateGroupSelector(allSelected)});jQuery.fn.dataTable.Api.register("row().group()",function getRowGroup(){var loader=this.getLoader();if(loader.groupColumn){var data=this.data();var groupId=data[loader.groupColumn];if(groupId){this.selector.groupId=groupId}}return this});jQuery.fn.dataTable.Api.register("row().uid()",function(){var loader=this.getLoader();var objectIdProperty=loader.objectIdProperty;if(objectIdProperty){var data=this.data();return data[objectIdProperty]}});jQuery.fn.dataTable.Api.register("updateGroupSelectors()",function updateGroupSelectors(selectionData){writeDebug();$(this.nodes()[0]).find("tr.group input").each(function(){var $this=$(this);var id=$this.data("group-id");var checked=selectionData[id];$this.prop("checked",checked)})});jQuery.fn.dataTable.Api.register("row().group().updateGroupSelector()",function updateGroupSelector(selected){writeDebug();var groupId=this.selector.groupId||emptyGroupCode;var $node=$(this.node());var input=$node.siblings("tr.group").find('[data-group-id="'+groupId+'"]');input.prop("checked",selected)});jQuery.fn.dataTable.Api.register("row().group().groupId()",function getRowGroupId(){return this.selector.groupId});jQuery.fn.dataTable.Api.register("row().group().selectGroup()",function selectGroup(selected){writeDebug();var groupId=this.selector.groupId;var table=this.table();table.rows({page:"current"}).eq(0).each(function(index){var row=table.row(index);var groupData=row.group();if(groupData.selector.groupId==groupId){row.selectRow(selected);row.updateCheckState(selected)}});this.table().updateAllSelect()});jQuery.fn.dataTable.Api.register("getLoader()",function getLoader(){var node=$(this.table().node());return node.data("loader")});jQuery.fn.dataTable.Api.register("renderHeader()",function renderHeader(){writeDebug();var table=this;var loader=this.getLoader();var $header=$(this.table().header());var $oldTr=$header.find("tr");var $tr=$("<tr>");$tr.attr("role","row");if(loader.selectionWidget){var $selector=$("<th>");var $selectAllCheckbox=$("<input>");$selectAllCheckbox.addClass("data_table_select_all_checkbox");$selectAllCheckbox.attr("type",loader.selectionWidget.toLowerCase());$selector.append($selectAllCheckbox);$tr.append($selector);$selectAllCheckbox.on("click.selectAll.datatable.loader",function(){var $this=$(this);var checked=$this.prop("checked");table.selectAll(checked);loader.selectedChanged()})}$.each(loader.columns,function(_,column){if(column.visible!==false&&!column.customRender){var $th=$("<th>");$th.html(column.name);$tr.append($th)}});$oldTr.replaceWith($tr);table.updateAllSelect();table.updateGroupsSelect()});return module})(FogSoft||{},jQuery,_,window.localforage,window.sessionStorageWrapper);var FogSoft=(function(module){var commonModule=module.Common=module.Common||{};var inputSelector=":input:not([type=hidden])";var controlGroupSelector=".form-group";var controlLabelSelector="label.control-label";var eventName="form-search-parameters-updated";var isDebug=false;function debug(message,params){isDebug&&console.log(message,params)}function ensureSelectorSuccess(jQueryObject){ensureObjectIsJquery(jQueryObject,"jQueryObject");if(jQueryObject.length===0){throw new Error("Nothing found by selector: "+jQueryObject.selector||"undefined")}}function ensureObjectIsJquery(obj,name){if(obj instanceof jQuery){return}throw new Error("jQuery instance expected: "+name)}function getInputInfo($input){ensureObjectIsJquery($input,"input");var label=$input.closest(controlGroupSelector).find(controlLabelSelector);return{name:label.attr("for"),label:label.text()}}function isClassifierInput($input){var group=$input.closest(controlGroupSelector);var classifierContainer=group.find("div.classifier-control");return classifierContainer.length>0}function isDateIntervalInput($input){return $input.closest(controlGroupSelector).find("div.dateinterval").length>0}function getInputValue($input){var type=$input.prop("type");switch(type){case"checkbox":return $input.prop("checked")===true;case"select-one":var value=$input.find("option:selected").val();return(!!value?$input.find("option:selected").text():null);default:if($input.attr("tagName")==="SELECT"&&typeof $input.attr("multiple")!=="undefined"){return $input.find("option:selected").map(function(){return $(this).text()})}return $input.val()}}function processClassifierInput(name,$input,context){debug("processClassifierInput",[name]);var container=$input.closest("div.classifier-control");var classifierDataContaiter=container.find("[data-multiple]");ensureSelectorSuccess(classifierDataContaiter);var multiple=classifierDataContaiter.data("multiple");var inputData=context.inputs[name];inputData.type="classifier";inputData.multiple=multiple;inputData.getter=function(){var obj={};if(multiple===true){obj.value=[];var values=container.find("div.classifier-selection").find("[data-text]");values.each(function(){obj.value.push($(this).data("text"))})}else{obj.value=$input.val()}return obj};inputData.hasValue=function(data){return data.value&&data.value.length};context.visited.push(name)}function processDateIntervalInput(name,$input,context){debug("processDateIntervalInput",[name]);var container=$input.closest("div.dateinterval");var inputData=context.inputs[name];inputData.type="dateInterval";var inputs=container.find(inputSelector);var getters=[];inputs.each(function(){var $this=$(this);var inputName=$this.attr("name");context.visited.push(inputName);getters.push({key:inputName.substr(name.length+1),getter:function(){return getInputValue($this)}})});inputData.hasValue=function(data){return(data.BeginDate&&data.BeginDate.length)||(data.EndDate&&data.EndDate.length)};inputData.getter=function(){return getters.reduce(function(obj,getterObject){obj[getterObject.key]=getterObject.getter();return obj},{})}}function processRegularInput(name,$input,context){debug("processRegularInput",[name]);var inputData=context.inputs[name];inputData.type="regular";context.visited.push(name);inputData.hasValue=function(data){return data.value&&data.value.length};inputData.getter=function(){var obj={};obj.value=getInputValue($input);return obj}}function processInput($input,context){ensureObjectIsJquery($input,"$input");var name=$input.attr("name");if(context.visited.indexOf(name)>=0){return}var info=getInputInfo($input);context.inputs[info.name]={label:info.label};if(isClassifierInput($input)){processClassifierInput(info.name,$input,context)}else{if(isDateIntervalInput($input)){processDateIntervalInput(info.name,$input,context)}else{processRegularInput(info.name,$input,context)}}}function createDataLoader(fieldsContainer){var context={visited:[],inputs:{}};fieldsContainer.find(inputSelector).each(function(){var $input=$(this);processInput($input,context)});return function(){return Object.keys(context.inputs).map(function(key){var inputInfo=context.inputs[key];var data;if(inputInfo.getter){data=inputInfo.getter();data.label=inputInfo.label;data.type=inputInfo.type;data.hasValue=inputInfo.hasValue;data.multiple=inputInfo.multiple}else{data=inputInfo}return data})}}var initFormSearchParameters=function($parent){var selector="[data-search-parameters]";$parent.find(selector).each(function(){var $this=$(this);var formId=$this.data("search-parameters");var fieldsContainerSelector=$this.data("additional-fields-container-selector");var form=$("form#"+formId);ensureSelectorSuccess(form);var fieldsContainer=form.find(fieldsContainerSelector);ensureSelectorSuccess(fieldsContainer);var loader=createDataLoader(fieldsContainer);form.on("stateSaved.dataForm.data-api",function(){var data=loader();form.trigger(eventName,[data])})})};commonModule.initFormSearchParameters=initFormSearchParameters;return module}(FogSoft||{}));var FogSoft=(function(module,localforage,sessionStorageWrapper){var lfModule=module.LocalForage=module.LocalForage||{};var storages={};lfModule.isSupported=function(){return typeof localforage!=="undefined"};lfModule.create=function(name){var storage=storages[name]||(storages[name]=localforage.createInstance({name:name}));if(sessionStorageWrapper){return new Promise(function(resolve){storage.defineDriver(sessionStorageWrapper).then(function(){storage.setDriver(sessionStorageWrapper._driver);resolve(storage)})})}else{return Promise.resolve(storage)}};return module}(FogSoft||{},window.localforage,window.sessionStorageWrapper));var FogSoft=(function(module,$,_){var fileField=module.FileField=module.FileField||{};var deleteButtonTemplate='<button type="button" class="btn custom-icon-close btn-delete"></button>';fileField.init=function($container){var settings=$container.data("settings");var currentFiles=$container.data("current-files");var $form=$container.closest("form");var $parent=$container.closest(".modal");var previewContainerId=$container.data("image-preview");var previewContainer=null;if(previewContainerId){previewContainerId="#image-preview-"+previewContainerId;previewContainer=$container.find(previewContainerId)}var autosave=$form.data("autosave-allowed")===true;function submitForm(){autosave&&$form.submit()}function getFilesList(){return currentFiles}function removeFile(urn){var files=getFilesList();var file=_.find(files,function(item){return item.urn===urn});var fileIndex=_.indexOf(files,file);if(fileIndex>-1){files.splice(fileIndex,1);setFilesList(files);submitForm();updateFilesList()}}function setFilesList(files){currentFiles=files;var data=currentFiles.map(function(fileInfo){return{name:fileInfo.name,urn:fileInfo.urn}});setData(data)}var valueContainer=$container.find('input[type="hidden"]');function setData(data){var serializedData=JSON.stringify(data);valueContainer.val(serializedData);valueContainer.closest("form").dataForm("setChanged",true)}if(settings.canEdit){var uploadButton=$container.find(".btn.trigger").get(0);createUploadButton(uploadButton)}var currentUploadCount=0;function createUploadButton(button){new qq.FineUploaderBasic({button:button,request:{endpoint:settings.uploadUrl,inputName:"filename"},debug:false,validation:{allowedExtensions:settings.allowedExtensions||[],sizeLimit:settings.sizeLimit||0},messages:settings.uploaderMessages,callbacks:{onValidate:function(fileData){var fileName=fileData[0].name;if(settings.allFilesSizeLimit){var totalSize=0;getFilesList().forEach(function(item){totalSize+=item.size});fileData.forEach(function(item){totalSize+=item.size});if(totalSize>settings.allFilesSizeLimit){FogSoft.Common.showErrorMessage(settings.allFilesSizeTooLargeMessage,settings.cannotUploadFileTitle+" "+fileName,$parent);return false}}if(typeof settings.maxFileCount!=="undefined"){var currentFilesCount=getFilesList().length;if(currentFilesCount+fileData.length>settings.maxFileCount){FogSoft.Common.showErrorMessage(settings.filesCountExceededMessage,settings.cannotUploadFileTitle+" "+fileName,$parent);return false}}return true},onUpload:function(id,fileName){FogSoft.Common.blockUi();currentUploadCount++},onError:function(id,fileName,errorReason,beforeUpload){FogSoft.Common.showErrorMessage(errorReason,settings.cannotUploadFileTitle+" "+fileName,$parent)},onComplete:function(id,fileName,responseJSON){currentUploadCount--;if(responseJSON.success){var data=responseJSON.data;onFileUploaded(data)}FogSoft.Common.unblockUi()}}})}function onFileUploaded(fileInfo){var filesList=getFilesList();filesList.push(fileInfo);setFilesList(filesList);updateFilesList();if(currentUploadCount===0){submitForm()}}var list=$container.find(".file-field-files-list");function updateFilesList(){var data=getFilesList();list.empty();data.forEach(function(item){var extension=item.extension;var file=$("<div/>").prop("class","file-field-file doc-group-content");var docFile=$("<div/>").prop("class","doc-file");var icon=$("<div/>").prop("class","doc-icn file-"+extension);var name=$("<span/>").prop("class","file-name").text(item.name);var link=$("<a/>").prop({href:item.downloadUrl,"class":"file-download",rel:"tooltip",title:item.name});link.attr("data-placement","top");link.attr("data-file-download","true");link.tooltip();if(item.signatures&&item.signatures.length>0&&settings.canEdit===true){name.addClass("link-file-signature-icon")}link.prepend(name);docFile.append(icon);docFile.append(link);if(item.signatures&&item.signatures.length>0){item.signatures.forEach(function(signature){var signIcon=$("<i>").prop({"class":"doc-icn-certificate icon-certificate-small-ok icon-large file-view-signature-icon clickable",rel:"tooltip",title:settings.signatureWebResources.fileSignedTitle});signIcon.attr("data-placement","top");signIcon.attr("data-view-signature-url",signature.viewUrl);signIcon.click(function(){FogSoft.Common.modal({title:settings.signatureWebResources.fileDigitalSignatureTitle,loadUrl:$(this).data("viewSignatureUrl"),buttons:[{id:null,url:null,title:settings.signatureWebResources.signDetailsCancelButtonText,cssClass:null,type:"Cancel"}]})});docFile.append(signIcon)})}file.append(docFile);if(settings.canEdit===true){var button=$(deleteButtonTemplate);file.append(button);button.click(function(e){e.preventDefault();removeFile(item.urn)})}list.append(file)});tryUpdatePreview(data)}updateFilesList();function tryUpdatePreview(data){if(previewContainer){previewContainer.empty();$.each(data,function(index,value){var $a=$("<a/>");var $img=$("<img/>");var downloadUrl=value.downloadUrl;var name=value.name;$img.prop("src",downloadUrl);$img.data("title",name);$img.addClass("image-preview");$a.attr("href",downloadUrl);$a.append($img);previewContainer.append($a)});reinitPreviewEngine()}}function reinitPreviewEngine(){FogSoft.DocumentsPreview.initPhotoSwipeFromDOM(previewContainerId)}};return module}(FogSoft||{},jQuery,_));(function($){$(window).load(function(){var params=$.deparam.querystring();if(params.scroll){$("html, body").scrollTop(params.scroll)}});var localeItems=$(".available-locale");localeItems.find("a").click(function(e){e.preventDefault()});localeItems.not(".active").click(function(e){var $eventObject=$(e.target);var locale=$eventObject.closest("[data-locale]").data("locale");var params=$.deparam.querystring();var scroll=$(document).scrollTop();if(scroll!=0){params.scroll=scroll}else{delete params.scroll}var currentUrl=$.param.querystring(location.href,params,2);var setLanguageUrl=$(".locale-selector").data("setLocaleUrl");FogSoft.Common.goTo($.param.querystring(setLanguageUrl,{locale:locale,returnUrl:currentUrl},0))})}(jQuery));(function($){$.fn.getHiddenDimensions=function(includeMargin){var $item=this,props={position:"absolute",visibility:"hidden",display:"block"},dim={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},$hiddenParents=$item.parents().andSelf().not(":visible");includeMargin=(includeMargin==null)?false:includeMargin;var oldProps=[];$hiddenParents.each(function(){var old={};for(var name in props){old[name]=this.style[name];this.style[name]=props[name]}oldProps.push(old)});dim.width=$item.width();dim.outerWidth=$item.outerWidth(includeMargin);dim.innerWidth=$item.innerWidth();dim.height=$item.height();dim.innerHeight=$item.innerHeight();dim.outerHeight=$item.outerHeight(includeMargin);$hiddenParents.each(function(i){var old=oldProps[i];for(var name in props){this.style[name]=old[name]}});return dim}}(jQuery));var FogSoft=(function(module,$){var utilsModule=module.Utils=module.Utils||{};utilsModule.getValue=function(obj,propChain,defaultValue){if(!obj||!propChain){return defaultValue}var val=defaultValue,iterObj=obj,paramType=$.type(propChain),propPath=paramType=="array"?propChain:paramType=="string"?propChain.split("."):[propChain.toString()];for(var i=0,len=propPath.length;i<len;i++){if(!(propPath[i] in iterObj)){val=defaultValue;break}val=iterObj=iterObj[propPath[i]]}return val};utilsModule.toLowerCamelCase=function(str){return str.charAt(0).toLowerCase()+str.slice(1)};utilsModule.updateQueryString=function(propertyName,value){var params=FogSoft.Common.getQueryParameters();var key=utilsModule.toLowerCamelCase(propertyName);if(value){if(key in params){params[key]=value}else{params[key]=value}}else{delete params[key]}return $.param(params,true)};return module}(FogSoft||{},jQuery));Number.prototype.toFixedNumber=function(precision){return +(Math.round(this+("e+"+precision))+("e-"+precision))};String.prototype.truncateWithEllipsesAndTooltip=function(max){var commonModule=FogSoft.Common;var longText=commonModule.htmlEncode(this);var shortText=longText.substr(0,max-1)+(longText.length>max?"â¦":"");var html=longText.length>max?'<span rel="tooltip" title="'+longText+'" data-toggle="tooltip" data-placement="bottom">'+shortText+"</span>":shortText;return html};var FogSoft=(function(module,$,_){var commonModule=module.Common=module.Common||{};var rquery=/\?/,rts=/(\?|&)_=.*?(&|$)/,alertContainerSelector=".notification-container";var modalBackdrop,modalBusy,blockCallCount=0,blockCallbackTimeout=-1;var showMessage=function(message,msgConfig){var msgArr=!message?[]:!$.isArray(message)?[message]:message,cfg=msgConfig||{},$parent=cfg.parent&&cfg.parent.length>0?cfg.parent:$(document.body);if(msgArr.length==0){return}var content=$("<ul></ul>");$.each(msgArr,function(i,el){$("<li></li>").append(el.Text||el).appendTo(content)});if(module.NotificationArea&&$parent.is(document.body)){module.NotificationArea.notificationArea("append",$.extend({},cfg,{text:content}))}else{var $alertContainer=$parent.find(alertContainerSelector).first(),$msg=$("<div></div>").appendTo($alertContainer);cfg.header&&$.type(cfg.header)=="string"&&$msg.append('<span class="alert-heading">'+cfg.header+"</span>");$msg.append(content).prepend('<button type="button" class="close" data-dismiss="alert">Ã</button>').removeClass().addClass(["alert",cfg.cssClass].join(" ")).data("tags",cfg.tags).fadeIn()}};var closeMessages=function(cssClass,parent){var $parent=parent||$(document.body);var ff=cssClass?function(){var $m=$(this);return $m.hasClass(cssClass)||$m.is('[data-tags*="'+cssClass+'"]')}:null;if(module.NotificationArea&&$parent.is(document.body)){module.NotificationArea.notificationArea("clear",ff)}else{var $msg=$parent.find(alertContainerSelector).find(".alert"),$filtered=ff?$msg.filter(ff):$msg;$filtered.alert("close")}};var getCommandExecuteChain=function(options){var deferred=$.Deferred();function onResolve(){deferred.resolve()}function onReject(){deferred.reject()}if(options.invokeOtherCommands){function preExecuteValidate(previousSuccess){var validationCallbacks=commonModule.collectCallbacks(window,"preExecuteValidate."+options.eventNamespace);var validationAction=function(){if(previousSuccess===true){onResolve()}else{onReject()}};if($.isArray(validationCallbacks)&&validationCallbacks.length>0){commonModule.executeCallbacksAndAction(validationAction,validationAction,validationCallbacks,false,true)}else{validationAction()}}var unsavedFormsCallbacks=commonModule.collectCallbacks(window,"collectUnsavedFormsCallbacks");if($.isArray(unsavedFormsCallbacks)&&unsavedFormsCallbacks.length>0){function onYesHandler(){window.ignoreUnsavedChanges=false;commonModule.executeCallbacksAndAction(function(){preExecuteValidate(true)},onReject,unsavedFormsCallbacks,false,true)}function onNoHandler(){window.ignoreUnsavedChanges=true;preExecuteValidate(false)}if(options.showUnsavedDataConfirm&&options.unsavedDataConfirmText){commonModule.showConfirm(options.unsavedDataConfirmText,{triState:true}).then(onYesHandler,onNoHandler)}else{onResolve()}}else{preExecuteValidate(true)}}else{onResolve()}return deferred.promise()};commonModule.blockUi=function(delay,text){if(++blockCallCount>1){return}if($.type(delay)=="string"){text=delay;delay=null}var $body=$(document.body),timeout=$.type(delay)=="number"&&delay>=0?delay:1000,waitText=text||commonModule.messages.pleaseWait;if(!modalBackdrop){modalBackdrop=$('<div class="modal-backdrop fade" id="popupBlocked"></div>').css({"z-index":10000}).appendTo($body)}modalBackdrop.show();blockCallbackTimeout=setTimeout(function(){if(!modalBusy){modalBusy=$("<div class='modal ajax-busy' id='popupBlockedMessage' data-backdrop='static'>"+waitText+"</div>").appendTo(document.body)}modalBusy.show()},timeout)};commonModule.unblockUi=function(){if(--blockCallCount<=0){blockCallCount=0;clearTimeout(blockCallbackTimeout);if(modalBusy){modalBusy.hide()}if(modalBackdrop){modalBackdrop.removeClass("in").hide()}}};commonModule.formatBoolean=function(value,pattern){var tokens=(pattern||"").split("|");if(value===true){return tokens.length>0&&pattern?tokens[0]:commonModule.messages.yes}if(value===false){return tokens.length>1?tokens[1]:commonModule.messages.no}if(value===null){return tokens.length>2?tokens[2]:""}return value};commonModule.formatNumber=function(value,pattern,dataType){if(value!=null){if(pattern){}else{if(dataType=="Number"){pattern=(typeof ApplicationInfo==="undefined")?"#,##0.##":ApplicationInfo.NumberFormat||"#,##0.##"}else{if(dataType=="Money"){pattern="#,##0.00"}}}return $.formatNumber(value,{format:pattern||"",locale:FogSoft.Globalization.locale().locale})}return value};commonModule.htmlEncode=function(value){return $("<div/>").text(value).html()};commonModule.formatDateTime=function(value,pattern,dataType){if(value!=null){var date;if($.type(value)=="string"&&window.Globalize){date=window.Globalize.parseDate(value,"yyyy-MM-dd HH:mm:ss.fff");if(!date){date=window.Globalize.parseDate(value,"yyyy-MM-dd HH:mm:ss")}}else{date=value}if(!pattern){switch(dataType){case"Date":pattern="d";break;case"LongDate":pattern="D";break;case"Time":pattern="t";break;case"LongTime":pattern="T";break;case"DateTime":pattern="f";break;case"DateTimeWithSeconds":pattern="F";break;case"DateTimeWithMilliseconds":pattern="Î¼";break;case"LongDateTime":pattern="F";break;case"DateMonthYear":pattern="Y";break;case"DateYear":pattern="yyyy";break}}return pattern&&window.Globalize?window.Globalize.format(date,pattern):value.toString()}return value};commonModule.showMessage=showMessage;commonModule.showWarningMessage=function(message,header,parent,tags){showMessage(message,{header:header,parent:parent,tags:tags,cssClass:"alert-block",type:"warning"})};commonModule.showInfoMessage=function(message,header,parent,tags){showMessage(message,{header:header,parent:parent,tags:tags,cssClass:"alert-info",type:"info"})};commonModule.showSuccessMessage=function(message){var msgArr=!message?[]:!$.isArray(message)?[message]:message;if(msgArr.length==0){return}var content=$("<ul></ul>");$.each(msgArr,function(i,el){$("<li></li>").append(el.Text||el).appendTo(content)});toastr.options={positionClass:"toast-top-center"};toastr.success(content)};commonModule.showErrorMessage=function(message,header,parent,tags){showMessage(message,{header:header,parent:parent,tags:tags,cssClass:"alert-danger",type:"error"})};commonModule.closeMessages=closeMessages;commonModule.closeSuccessMessages=function(parent){closeMessages("alert-success",parent)};commonModule.closeErrorMessages=function(parent){closeMessages("alert-danger",parent)};commonModule.cacheUrl=function(url,useCache){if($.browser.msie&&parseInt($.browser.version,0)<9){useCache&=false}if(useCache==false){var ts=(new Date).getTime();var ret=url.replace(rts,"$1_="+ts+"$2");url=ret+((ret===url)?(rquery.test(url)?"&":"?")+"_="+ts:"")}return url};commonModule.modalLock=function(){var locked=false;return{getLock:function(){var v=locked;if(!locked){locked=true}return !v},releaseLock:function(){locked=false}}}();commonModule.getCommandExecuteChain=function(options){return getCommandExecuteChain(options)};var buildModal=function(options){var $modal=$('<div class="modal fade"></div>').attr({role:"dialog",tabIndex:"-1"}).appendTo(document.body);var isIe=(("Microsoft Internet Explorer"==navigator.appName)||navigator.userAgent.match(/Trident\/./i));if(isIe){$modal.removeClass("fade")}var $modalContent=$('<div class="modal-content"></div>');var width=parseInt(options.width)||0,height=parseInt(options.maxBodyHeight)||0;options.id&&$modal.prop("id",options.id);options.loadUrl&&$modal.data("submitUrl",options.loadUrl);if(options.title){$("<div></div").addClass("modal-header").append('<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>').append("<h3>"+options.title+"</h3>").appendTo($modalContent)}var $dlgBody=$("<div></div>").addClass("modal-body").appendTo($modalContent);$("<div></div>").addClass("notification-container").appendTo($dlgBody);var $dlgFooter=$("<div></div>").addClass("modal-footer").appendTo($modalContent);if(width>0){width=Math.min($(window).width(),width);$modal.css({width:width+"px"})}if(height>0){var headAndFootHeight=140,availHeight=$(window).height();height=Math.min(availHeight-headAndFootHeight,height);var remaining=availHeight-height-headAndFootHeight;$modal.css({top:Math.round(remaining/availHeight/2*1000)/10+"%"});$dlgBody.css("max-height",height+"px");$modal.on("hide",function(e){if($(e.target).is($modal)){$modal.css("top","-25%")}})}$modal.on("hidden.bs.modal",function(e){var nonChildrenElementHiding=$modal[0]===e.target;if(nonChildrenElementHiding){setTimeout(function(){$modal.remove()},0)}});var btns=document.documentElement.dir==="rtl"?options.buttons.reverse():options.buttons;$.each(btns||[],function(index,button){var $btn=$("<button>"+button.title+"</button>").addClass("btn"),btnType=button.type?button.type.toLowerCase():"custom",primaryBtn=null;if(btnType=="submit"&&primaryBtn==null){primaryBtn=$btn;$btn.addClass("btn-primary");$modal.on("keyup.defaultAction.modal",function(e){e.which==13&&document.activeElement.tagName.toLowerCase()!="textarea"&&primaryBtn.click()})}$btn.attr("data-button-type",btnType);button.id&&$btn.attr("id",button.id);button.cssClass&&$btn.addClass(button.cssClass);button.url&&$btn.attr("data-action",button.url);btnType=="cancel"&&$btn.attr({"data-dismiss":"modal","aria-hidden":"true"});button.click&&$btn.click(button.click);$btn.appendTo($dlgFooter)});return $modal.append($('<div class="modal-dialog'+(options.size?" "+options.size:"")+'" role="document"></div>').append($modalContent))};commonModule.modal=function(options,e){var action=function(){options=options||{};var executeEventArgs=options.executeEventArgs||[];if(options.eventNamespace){var $body=$(document.body);var execEvent=new $.Event("execute."+options.eventNamespace);$body.trigger(execEvent,[executeEventArgs,e]);if(execEvent.isDefaultPrevented()||execEvent.result===false){return}$body.one("success."+options.eventNamespace,function(){$modal.modal("hide")})}var $modal=buildModal(options),$dlgBody=$modal.find(".modal-body");$modal.on("shown.bs.modal",function(){var $form=$dlgBody.find("form");$form.trigger($.Event("modal-shown.dataForm.data-api"))});var showModal=function(contents,appendMode){appendMode?$dlgBody.append(contents):$dlgBody.html(contents);$modal.modal({keyboard:false,backdrop:"static"});commonModule.init($dlgBody);$modal.find(".modal-footer button").click(function(){var $self=$(this);if($self.data("button-type")!=="submit"){return}var $form=$dlgBody.find("form");var actionUrl=$self.data("action");if($form.length>0){actionUrl&&$form.prop("action",actionUrl);$form.submit()}else{actionUrl=actionUrl||$modal.data("submitUrl");if(actionUrl){post(actionUrl,{data:executeEventArgs,processResult:$.noop,dataType:"json"})}}options.confirmText&&$modal.modal("hide")});if(options.success){options.success($modal)}};var post=function(url,opts){var opt=$.extend({type:"POST",headers:{"X-Content-Requested-For":"Modal"},withBlockUi:true},opts||{});var e=$.Event("loading.modal.data-api");$modal.trigger(e,[opt]);if(e.isDefaultPrevented()||e.result===false){return}$.ajax(commonModule.cacheUrl(url),opt)};if(!options.data&&options.confirmText){options.data="<p>"+options.confirmText+"</p>"}if(options.data){showModal(options.data,true)}else{post(options.loadUrl,{data:executeEventArgs,processUnsuccessfulResult:commonModule.unblockUi,processResult:function(data){commonModule.unblockUi();showModal(data,true)}})}return $modal};var promise=getCommandExecuteChain(options);return promise.then(action)};commonModule.layer=function(options){if(!commonModule.modalLock.getLock()){return false}var executeEventArgs=options.executeEventArgs||[];var $layer=$("<div></div>").addClass("layer").attr({role:"layer",tabIndex:"-1"}).appendTo(document.body);var $layerContainer=$('<div class="container"></div>').appendTo($layer);if(options.eventNamespace){var $body=$(document.body);$body.one("success."+options.eventNamespace,function(){hideLayer()});$body.trigger("execute."+options.eventNamespace,[executeEventArgs])}options.id&&$layer.prop("id",options.id);options.loadUrl&&$layer.data("submitUrl",options.loadUrl);var $layerHeader=$("<div></div").addClass("layer-header").append('<button type="button" class="close" data-dismiss="layer" aria-hidden="true">&times;</button>').append("<h3>"+options.title+"</h3>").appendTo($layerContainer);var $layerBody=$("<div></div>").addClass("layer-body").appendTo($layerContainer);var showLayer=function(data,appendMode){appendMode?$layerBody.append(data):$layerBody.html(data);commonModule.init($layerBody);$layer.animate({height:$(window).height()-260,top:$(document).scrollTop()+250}).focus();if(options.success){options.success($layer)}};var hideLayer=function(){$layer.animate({height:0});$layer.remove();commonModule.modalLock.releaseLock()};$layerHeader.find(".close").click(hideLayer);$layer.keydown(function(e){if(e.keyCode==27){hideLayer()}});var post=function(url,opts){var opt=$.extend({type:"POST",headers:{"X-Content-Requested-For":"Modal"},processUnsuccessfulResult:commonModule.modalLock.releaseLock,error:commonModule.modalLock.releaseLock},opts||{});$.ajax(commonModule.cacheUrl(url),opt)};post(options.loadUrl,{data:executeEventArgs,processResult:showLayer});return false};commonModule.showConfirm=function(message,options){var dfrd=$.Deferred();if(!commonModule.modalLock.getLock()){return dfrd.promise()}var firstArgIsText=$.type(message)==="string",opt=firstArgIsText?(options||{}):message,text=firstArgIsText?message:opt.confirmText;var $cfm=$('<div class="modal fade"></div>').attr({role:"dialog",tabIndex:"-1"}).appendTo(document.body);var $modalContent=$('<div class="modal-content"></div>'),$cfmBody=$("<div></div>").addClass("modal-body").appendTo($modalContent),$cfmFoot=$("<div></div>").addClass("modal-footer").appendTo($modalContent);$cfm.on("hidden.bs.modal",function(e){if($(e.target).is($cfm)){commonModule.modalLock.releaseLock();var cback=$cfm.data("run");if(cback&&cback.handler){cback.handler($cfm,cback.button);$cfm.data("run",null)}else{dfrd.notify($cfm)}$cfm.remove()}});if(opt.confirmTitle){$("<div></div").addClass("modal-header").append("<h3>"+opt.confirmTitle+"</h3>").prependTo($modalContent)}$("<p></p>").append(text).appendTo($cfmBody);var btnColl=opt.buttons,primBtn=null;if(!btnColl){btnColl=[{title:commonModule.messages.yes,type:"yes"},{title:commonModule.messages.no,type:"no"}];if(opt.triState){btnColl.push({title:commonModule.messages.cancel,type:"noaction"})}}$.each(btnColl,function(index,button){var $btn=$("<button>"+button.title+"</button>"),type=button.type.toLowerCase(),handler;$btn.addClass("btn").attr({"data-dismiss":"modal","data-button-type":button.type});button.id&&$btn.attr("id",button.id);button.cssClass&&$btn.addClass(button.cssClass);if(type=="submit"||type=="yes"){if(!primBtn&&!opt.triState){$btn.addClass("btn-primary");primBtn=$btn}handler=dfrd.resolve}else{if(type=="cancel"||type=="no"){handler=dfrd.reject}else{if(!primBtn&&type=="noaction"){$btn.addClass("btn-primary");primBtn=$btn}handler=dfrd.notify}}$btn.click(function(){$cfm.data("run",{handler:handler,button:$btn})});$btn.appendTo($cfmFoot)});if(primBtn){$cfm.on("keyup.defaultAction.modal",function(e){e.which==13&&primBtn.click()})}var $modalDialog=$('<div class="modal-dialog" role="document"></div>');$modalDialog.append($modalContent);$cfm.append($modalDialog);$cfm.modal({keyboard:true,backdrop:true});return dfrd.promise()};commonModule.alert=function(message){var cback=function(cfmDialog,button){return $.Deferred().resolve(cfmDialog,button)};return commonModule.showConfirm(message,{buttons:[{type:"yes",title:commonModule.messages.ok}]}).then(cback,cback,cback)};commonModule.authenticate=function(data){var deferred=$.Deferred(),$body=$(document.body);var modalLoadHandler=function(e,opt){if(opt){opt.type="GET"}};$body.on("loading.modal.data-api",modalLoadHandler);var result=commonModule.modal({loadUrl:data.RedirectUrl,title:data.Title||commonModule.messages.loginDialogTitle,buttons:[{title:commonModule.messages.enter,type:"submit"},{title:commonModule.messages.cancel,type:"cancel"}]});$body.off("loading.modal.data-api",modalLoadHandler);if(result&&result.modal){var authenticated=false;var onHideHandler=function(){var method=authenticated?"resolve":"reject";deferred[method]()};result.one("hidden.bs.modal",onHideHandler);$body.off("UserLogged").one("UserLogged",function(e,args){authenticated=true;$('body > form input[name="'+args.Data.FormName+'"]').prop("value",args.Data.Token);result.modal("hide")})}if(result==false){deferred.reject()}return deferred.promise()};commonModule.processResult=function(resp){if(!resp){return}commonModule.processEvents(resp);if(resp.RedirectUrl){commonModule.goTo(resp.RedirectUrl);return}commonModule.processMessages(resp,this)};commonModule.processMessages=function(resp,options){if(!resp||!resp.Messages){return}var msgs=resp.Messages,msgArr=$.isArray(msgs)?msgs:[msgs];var scsMsgCol=[],errMsgCol=[],wrnMsgCol=[],otherMsgCol=[],opt=options||{};$.each(msgArr,function(i,el){if(el){if(el.Text){var msg={Key:el.Key,Text:el.Text,Type:el.Type.toLowerCase()};switch(msg.Type){case"error":errMsgCol.push(msg);break;case"warning":wrnMsgCol.push(msg);break;case"success":scsMsgCol.push(msg);break;default:otherMsgCol.push(msg)}}else{otherMsgCol=el}}});var visibleModal=$(".modal.fade.in");if(opt.showInfo){opt.showInfo(otherMsgCol,opt)}else{commonModule.showInfoMessage(otherMsgCol,null,visibleModal,opt.tags||opt.url)}if(opt.showSuccess){opt.showSuccess(scsMsgCol,opt)}else{commonModule.showSuccessMessage(scsMsgCol)}if(opt.showWarning){opt.showWarning(wrnMsgCol,opt)}else{commonModule.showWarningMessage(wrnMsgCol,null,visibleModal,opt.tags||opt.url)}if(opt.showError){opt.showError(errMsgCol,opt)}else{commonModule.showErrorMessage(errMsgCol,null,visibleModal,opt.tags||opt.url)}};commonModule.processEvents=function(resp,fromBatch){var isRunningInBatch=fromBatch===true;resp&&resp.Events&&$.each(resp.Events,function(i,event){$(document.body).trigger(event,[resp,isRunningInBatch])})};commonModule.postJson=function(url,data,postOptions){var opts=$.extend({type:"POST",data:JSON.stringify(data||{}),contentType:"application/json",processResult:$.noop},postOptions);return $.ajax(commonModule.cacheUrl(url),opts)};commonModule.refreshContainer=function($descendants,url){if(!$descendants||$descendants.length==0){return}$descendants.each(function(){var $block=$(this).closest("[data-remote-content]");if($block.length>0){var gridLoader=$block.find(".table").data("loader");gridLoader&&gridLoader.destroy();$block.dataBlock("load",url,true)}else{location.reload();return false}})};commonModule.goTo=function(url){if(url&&$.type(url)=="string"){try{window.location.href=url}catch(e){}}return false};var currentlyExecutingCallKeys={};var lastExecutingCallEventName=null;var getCallKey=function(options){var eventName=options.eventName?options.eventName:"";var executeUrl=options.executeUrl?options.executeUrl:"";return eventName+"_"+executeUrl};var startCallExecution=function(callKey,callEventName){if(!callKey){return}currentlyExecutingCallKeys[callKey]=true;lastExecutingCallEventName=callEventName};var finishCallExecution=function(callKey){if(!callKey){return}currentlyExecutingCallKeys[callKey]=false};var isCallBeingExecuted=function(callKey){return callKey?currentlyExecutingCallKeys[callKey]===true:false};var resetFormsChangeStateOnRedirect=function(e,resp){if(resp&&resp.RedirectUrl){commonModule.resetFormsChangeState()}};commonModule.getLastExecutingCallEventName=function(){return lastExecutingCallEventName};commonModule.resetFormsChangeState=function(){$("form").each(function(){$(this).dataForm("setChanged",false)})};commonModule.execute=function(options,e){var validateEvent=new $.Event("validate."+options.eventNamespace);var validateEventArgs=options.executeEventArgs||[];$(document.body).trigger(validateEvent,[validateEventArgs]);if(validateEvent.isDefaultPrevented()||validateEvent.result===false){return}var opt=options||{};var action=function(){var callKey=getCallKey(options);var eventArgs=opt.eventArgs?opt.eventArgs:[];if(opt.debounce===true&&isCallBeingExecuted(callKey)){return}$.when((function(){startCallExecution(callKey,opt.eventName);opt.eventName&&$(document.body).trigger(opt.eventName,[eventArgs,e])}())).then(function(){if(opt.executeUrl){return $.ajax(commonModule.cacheUrl(opt.executeUrl),{type:"POST",dataType:"json",data:eventArgs,withBlockUi:true,processResult:function(){commonModule.unblockUi()},processUnsuccessfulResult:function(){commonModule.unblockUi()}})}}).always(function(){finishCallExecution(callKey)})};var exec=function(){getCommandExecuteChain(opt).then(action)};return opt.showConfirmDialog?commonModule.showConfirm(opt).then(exec):exec()};commonModule.executeAction=function(url,confirmMessage){if(!confirmMessage||confirm(confirmMessage)){commonModule.postJson(url)}};commonModule.collectCallbacks=function(target,eventName){var callbacks=[];if(target&&eventName){$(target).trigger(eventName,[callbacks])}return callbacks};commonModule.executeCallbacksAndAction=function(succHandler,failHandler,callbacks,runInSync,fromBatch){if(!$.isFunction(succHandler)&&!$.isFunction(failHandler)){return}var cb=callbacks||commonModule.collectCallbacks(window,"collectUnsavedFormsCallbacks"),syncMode=runInSync===true,isRunningInBatch=fromBatch===true,failDefault=function(skipDefaultErrorMessage){if(skipDefaultErrorMessage===true){return}commonModule.showErrorMessage(commonModule.messages.failureMessage)};if($.isArray(cb)){var pipe;if(syncMode){var d=pipe=$.Deferred();$.each(cb,function(i,callback){pipe=pipe.then(callback)});d.resolve(isRunningInBatch)}else{var res=[];$.each(cb,function(i,callback){res.push(callback(isRunningInBatch))});pipe=$.when.apply($,res)}return pipe.fail(failDefault).then(succHandler,failHandler)}};commonModule.savePageForms=function(){var succHandler=function(){commonModule.closeMessages("savePageForms");commonModule.showSuccessMessage(commonModule.messages.successMessage)};commonModule.executeCallbacksAndAction(succHandler,null,null,false,true)};commonModule.quickSortObj=function(arr,fieldName){var a=arr,f_compare=function(a,b){return(a[fieldName]===b[fieldName]?0:(a[fieldName]>b[fieldName]?1:-1))},f_change=function(a,i,j){var c=a[i];a[i]=a[j];a[j]=c},qs=function(l,r){var i=l,j=r,x=a[l+r>>1];while(i<=j){while(f_compare(a[i],x)==-1){i++}while(f_compare(a[j],x)==1){j--}if(i<=j){f_change(a,i++,j--)}}if(l<j){qs(l,j)}if(i<r){qs(i,r)}};qs(0,a.length-1)};commonModule.getQueryParameters=function(){var query=window.location.search.substring(1);if(!query){return{}}return _.chain(query.split("&")).map(function(params){var p=params.split("=");return[p[0],decodeURIComponent(p[1]).replace(/\+/g," ")]}).object().value()};commonModule.generateGuid=function(){var s4=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)};return s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4()};commonModule.saveFormData=function($blockContentContainer,restoringData,forceSave){var $previousFieldsContainer=restoringData.$previousFieldsContainer;var fieldsData=restoringData.fieldsData;if($previousFieldsContainer===undefined&&$blockContentContainer.data("loaded")){$previousFieldsContainer=$blockContentContainer}var hasChanges=false;if($previousFieldsContainer){if($previousFieldsContainer.is("form")){hasChanges=$previousFieldsContainer.dataForm("hasChanges");$previousFieldsContainer.dataForm("setChanged",false)}else{var $previousFieldsContainerForm=$previousFieldsContainer.find("form");if($previousFieldsContainerForm.length){hasChanges=$previousFieldsContainerForm.dataForm("hasChanges");$previousFieldsContainerForm.dataForm("setChanged",false)}}var fieldDataFromCurrentForm=$previousFieldsContainer.dataForm("getValuesForStateSaving",forceSave===true);if(fieldsData.length){var fieldNamesCurrentForm=fieldDataFromCurrentForm.map(function(field){return field.name});var uniqueFieldsFromAnotherForms=$.grep(fieldsData,function(formField){return fieldNamesCurrentForm.indexOf(formField.name)===-1});fieldDataFromCurrentForm=fieldDataFromCurrentForm.concat(uniqueFieldsFromAnotherForms)}fieldsData=fieldDataFromCurrentForm}return{fieldsData:fieldsData,$previousFieldsContainer:$previousFieldsContainer,hasChanges:hasChanges}};commonModule.restoreFormData=function($fieldsContainer,restoringData){if($fieldsContainer.data("loaded")){var $targetFieldsContainer=$fieldsContainer;var fieldsData=restoringData.fieldsData;if(fieldsData.length){$targetFieldsContainer.dataForm("setValuesToFormFields",fieldsData);if($targetFieldsContainer.is("form")){$targetFieldsContainer.dataForm("setChanged",restoringData.hasChanges)}else{var $targetFieldsContainerForm=$targetFieldsContainer.find("form");if($targetFieldsContainerForm.length){$targetFieldsContainerForm.dataForm("setChanged",restoringData.hasChanges)}}}$targetFieldsContainer.dataForm("resetFormElementChangedStatus",fieldsData)}return{fieldsData:fieldsData,$previousFieldsContainer:$fieldsContainer,hasChanges:restoringData.hasChanges}};commonModule.recreateGrid=function(gridId,dataResult){var loader=getLoader();var newGrid=dataResult.Data;newGrid.eventHandlers=loader.eventHandlers;loader.destroy(true,true);renderGridHeader(newGrid);FogSoft.DataTable.init(loader.$tableEl,newGrid);initializeGridTooltips(loader.id);Fogsoft.Common.initPopovers(loader.$tableEl);function getLoader(){return $("#"+gridId).data("loader")}function initializeGridTooltips(gridId){$(document.body).on("initialized."+gridId,function(){FogSoft.Common.initTooltips($("#"+gridId))})}function renderGridHeader(newGrid){var gridTable=$("#"+newGrid.id);var $tHead=$("<thead>");$tHead.addClass("ui-state-default");var $tr=$("<tr>");$tHead.append($tr);var sortColumnIds=newGrid.columns.filter(function(c){return c.sortColumn}).map(function(c){return c.sortColumn});$.each(newGrid.columns,function(idx,column){if(column.visible!==false||(newGrid.groupColumn&&newGrid.groupColumn===column.id)||sortColumnIds.includes(column.id)){var $th=$("<th>");if(column.description){$th.attr("data-description",column.description)}$th.html(column.name);$tr.append($th)}});gridTable.append($tHead)}};return module}(FogSoft||{},jQuery,_));var FogSoft=(function(module,$,globalize,Cookies){var commonModule=module.Common=module.Common||{},utilsModule=module.Utils||{},isValidationConfigured=false;$.fn.modal.Constructor.prototype.enforceFocus=function(){var that=this;$(document).on("focusin.modal",function(e){if(that.$element[0]!==e.target&&!that.$element.has(e.target).length&&e.target.className!=="select2-search__field"){that.$element.focus()}})};var initSelect2=function($parent){$parent.find("select.select2").select2()};var initDatePickers=function($parent){var addonFunc=function(lE){lE.disablePicker=function(){$(lE).find("input").prop("disabled",true)};lE.enablePicker=function(){$(lE).find("input").prop("disabled",false)}};var enableAddonButton=function(el,prnt){(prnt||el.closest('[class*="date"]')).find(".input-group-addon").on("click",function(){if(!el.prop("disabled")){el.get(0).focus();el.datepicker("show")}})};var opt=$.extend({autoclose:true,todayBtn:true,todayHighlight:true},utilsModule.getValue(commonModule,"settings.datePickerParams",{language:"en"})),$modal=$parent.closest(".modal");var $datepickers=$();$parent.find(".datetime").each(function(){var $this=$(this);addonFunc(this);var $g=$this.find("input.datetime-input");var $d=$this.find(".date input");var $t=$this.find(".time input");var f=function(){var dVal=$d.val(),tVal=$t.val(),sep=dVal&&tVal?" ":"";$g.val(dVal?dVal+sep+tVal:"")};$d.on("input keyup change",f);$t.on("input keyup change",f);f();$d.attr("autocomplete","off").datepicker(opt);$datepickers=$datepickers.add($d);enableAddonButton($d);$d.on("changeDate",function(){$(this).blur()})});$parent.find(".date-only").each(function(){addonFunc(this);var $cntrl=$(this),$lE=$cntrl.find("input");$lE.attr("autocomplete","off").datepicker(opt);$datepickers=$datepickers.add($lE);enableAddonButton($lE,$cntrl);$lE.on("changeDate",function(){$(this).blur()})});$parent.find(".monthyear").each(function(){addonFunc(this);var $this=$(this),$lE=$this.find(".date input"),$g=$this.find("input.datetime-input");$lE.attr("autocomplete","off").datepicker($.extend({startView:"year"},opt));$datepickers=$datepickers.add($lE);enableAddonButton($lE);var f=function(){var v=$lE.val(),d=$lE.datepicker("getFormattedDate"),sv=v?v===d||("0"+v)===d?"01."+d:v:"";$g.val(sv)};$lE.on("changeMonth",function(evt){if(evt.type=="changeMonth"){var $self=$(this);$self.datepicker("setDate",evt.date).datepicker("hide");$self.blur();$self.change()}});$lE.on("change",f);f()});$parent.find(".year").each(function(){addonFunc(this);var $this=$(this),$lE=$this.find(".date input"),$g=$this.find("input.datetime-input");$lE.attr("autocomplete","off").datepicker($.extend({startView:"decade"},opt));$datepickers=$datepickers.add($lE);enableAddonButton($lE);var f=function(){var v=$lE.val(),d=$lE.datepicker("getFormattedDate"),sv=v?v===d?"01.01."+d:v:"";$g.val(sv)};$lE.on("changeYear change",function(evt){if(evt.type=="changeYear"){var $self=$(this);$self.datepicker("setDate",evt.date).datepicker("hide");$self.blur();$self.change()}f()});f()});var $timepickers=$parent.find(".time input");$timepickers.each(function(i,e){var $lE=$(e);$lE.closest(".input-group").find(".input-group-addon").on("click",function(evt){if($lE.prop("disabled")){evt.stopImmediatePropagation();evt.preventDefault()}return false});$lE.attr("autocomplete","off").timepicker({showMeridian:opt.showMeridian,minuteStep:5,defaultTime:"value"}).on("hidden",function(){$(this).blur()})});$parent.find(".dateinterval").each(function(){addonFunc(this)});var initDatePickerApi=function($datepickerElement){var toogleDatePicker=function(disabled){$datepickerElement.siblings("input.datetime-input").each(function(){$(this).prop("disabled",disabled)});$datepickerElement.find("input").each(function(){$(this).prop("disabled",disabled)});var $inputAddons=$datepickerElement.find(".input-group-addon");var $inputClearWidgets=$datepickerElement.find(".input-clear-widget");var setDisabledClass=function($elements,disabled){$elements.each(function(){if(disabled){$(this).addClass("disabled")}else{$(this).removeClass("disabled")}})};setDisabledClass($inputAddons,disabled);setDisabledClass($inputClearWidgets,disabled)};$datepickerElement.data("datepicker-api",{disableDatePicker:function(){toogleDatePicker(false)},enableDatePicker:function(){toogleDatePicker(true)},toogleDatePicker:function(disabled){toogleDatePicker(disabled)}})};$parent.find(".input-group.time").each(function(){var $timePicker=$(this);initDatePickerApi($timePicker)});$parent.find(".input-group.date").each(function(){var $datePicker=$(this);initDatePickerApi($datePicker)});$modal.on("hide",function(e){if($(e.target).is($modal)){$timepickers.length&&$timepickers.timepicker("destroy");$datepickers.length&&$datepickers.datepicker("destroy")}})};var initAutocomplete=function($parent){$parent.find(".autocomplete").each(function(){var $this=$(this);var $el=$this.find('input[type="text"]');var $hiddenEl=$this.find('input[type="hidden"]');if($hiddenEl.length==0){$hiddenEl=null}$el.on("change",function(event){if($(event.srcElement).val()===""){$hiddenEl.val("")}});var $clearButton=$this.find(".mtree-button-clear");$clearButton.on("click",function(){$el.val("");$hiddenEl.val("")});var sourceData=null;if($this.data("source-array")){sourceData=$this.data("source-array")}if($this.data("source-url")){sourceData=$this.data("source-url")}if($this.data("source-control")){sourceData=$($this.data("source-control"))}if($this.data("source-function")){sourceData=window[$this.data("source-function")]}var minLength=$this.data("item-minlength")?$this.data("item-minlength"):1;$el.typeaheadExt({source:sourceData,itemKeyField:$hiddenEl,itemValueProp:$this.data("item-value"),itemKeyProp:$this.data("item-key"),items:$this.data("item-count")?$this.data("item-count"):8,minLength:minLength});if(minLength==0){$el.on("focus",function(){$el.typeahead("lookup")})}})};function prepareClassifiersDataSource(dataSourceArray){return $.map(dataSourceArray||[],function(data){return{Code:data.Value,ItemId:data.Value,Text:data.Text,Selectable:!data.Disabled,HasChildren:false,ParentId:null}})}var initClassifiers=function($parent){$parent.find('.autocomplete.classifier-selector input[type="text"]').each(function(){var $textField=$(this);var name=$textField.attr("name");var id=$textField.prop("id");var $autocomplete=$textField.closest(".autocomplete");var $hiddenField=$autocomplete.find('input[type="hidden"]');$hiddenField.data("is-classifier-input",name);var $form=$autocomplete.closest("form");var $control=$textField.closest(".classifier-control");var $selection=$control.find(".classifier-selection");var miniTreeId=id+"_browseButton";var $button=$control.find(".mtree-button-collapse");$button.attr("id",id);var dataUrl=$control.data("url");var dataSourceArray=$autocomplete.data("source-array");var dataSource=null;if(Array.isArray(dataSourceArray)){dataSource=prepareClassifiersDataSource(dataSourceArray)}else{dataSource=dataUrl}var $classifierList=$('<div class="collapseTree" id="'+miniTreeId+'"></div>');var isMultipleClassifier=$autocomplete.data("multiple");var autohide=$autocomplete.data("autohide");if(isMultipleClassifier===false){autohide=true}$textField.after($classifierList);var values=[];$textField.val("");$textField.attr("id",id+"_autocomplete");$textField.attr("name",name+"_autocomplete");$textField.attr("do-not-post",true);$textField.removeClass("classifier-hidden-text");if(isMultipleClassifier){$hiddenField.attr("do-not-post",true);$hiddenField.val("")}$textField.data("orig-name",name);$form.on("formClearing.dataForm.data-api",function(){$selection.empty();values=[];var miniTreeApi=$control.find(".collapseTree").data("mini-tree-api");miniTreeApi.refreshSelection()});var setDirtyFlag=function($field){$field.change()};var updateItems=function(items,makeDirty){if(items.length){if(isMultipleClassifier){items.forEach(function(item){if(values.indexOf(item.Value)<0){var result=appendItem(item,makeDirty);values.push(item.Value);if(makeDirty){setDirtyFlag(result.$hiddenField);setDirtyFlag(result.$textField)}}})}else{var item=items[0];$hiddenField.data("text",item.Text);$hiddenField.val(item.Value);$textField.val(item.Text);if(makeDirty){setDirtyFlag($hiddenField)}}}};var selectItem=function(item){if(isMultipleClassifier){if(values.indexOf(item.Value)<0){updateItems([item],true)}}else{updateItems([item],true)}};var processState=$autocomplete.data("process-state")!=="False";$form.on("stateRestoring.dataForm.data-api",function(e,stateValues){if(!stateValues){return}var fieldStateValues=stateValues.filter(function(stateValue){return stateValue.name===name});if(!fieldStateValues.length){return}if(isMultipleClassifier){var fieldValueFromQuery=getFieldValueFromQuery();if(fieldValueFromQuery){var fieldValues=fieldValueFromQuery.split(",");var itemsToUpdate=dataSourceArray.filter(function(item){return fieldValues.some(function(fieldValue){return fieldValue===item.Value})}).map(function(item){return{Value:item.Value,Text:item.Text}});fieldStateValues.forEach(function(stateValue){stateValue.restored=false;stateValue.processed=true});updateItems(itemsToUpdate,true);return}var selectedValues=fieldStateValues.map(function(stateValue){return stateValue.value});var miniTreeApi=$control.find(".collapseTree").data("mini-tree-api");miniTreeApi.refreshSelection(selectedValues)}fieldStateValues.forEach(function(stateValue){if(!processState){stateValue.restored=false;stateValue.processed=true;return}var item={Value:stateValue.value,Text:stateValue.text};updateItems([item],true);stateValue.restored=true;stateValue.processed=true})});function getFieldValueFromQuery(){var result=null;var queryValues=FogSoft.Common.getQueryParameters();var lowerCaseName=name.toLowerCase();$.each(queryValues,function(queryKey,queryValue){if(queryKey.toLowerCase()===lowerCaseName){result=queryValue}});return result}var selectedItems=$autocomplete.data("selected-items");if(selectedItems&&selectedItems.length>0){updateItems(selectedItems)}var typeaheadSelectCallback=function(item){if(item){if(isMultipleClassifier){$hiddenField.val("")}selectItem(item)}};$textField.typeaheadExt({selectKey:typeaheadSelectCallback,updater:function(item){if(isMultipleClassifier){item=""}return item}});$textField.on("mouseup",function(){var $input=$(this);var oldValue=$input.val();if(!oldValue){return}setTimeout(function(){var newValue=$input.val();if(oldValue!==newValue){$input.trigger("keyup")}},1)});$selection.on("click","[data-item-remove]",function(e){e.preventDefault();var $el=$(e.currentTarget);var $container=$el.closest("[data-item-value]");var value=$container.data("item-value");var index=values.indexOf(value);values.splice(index,1);var $hiddenField=$container.find("[value='"+value+"']");setDirtyFlag($hiddenField);$container.remove();var miniTreeApi=$control.find(".collapseTree").data("mini-tree-api");miniTreeApi.refreshSelection()});var loaderFn=FogSoft.MiniTree($classifierList,dataSource,function(code,text,id){if(autohide===true){$classifierList.hide()}selectItem({Value:id,Text:text})},$textField);FogSoft.MiniTree.CollapsableButton($textField,$classifierList,loaderFn);function appendItem(item){var html='<p class="classifier-item" data-item-value="'+item.Value+'"><input type="hidden" name="'+name+'" value="'+item.Value+"\" data-text='"+item.Text+"' data-is-classifier-input='true' /><input type=\"hidden\" name=\""+name+'_Text" value="'+item.Text+'" do-not-post />'+item.Text+'<a data-item-remove href="#"><i class="icon-delete2"></i></a> </p>';$selection.append(html);var $appended=$selection.find("[data-item-value='"+item.Value+"']");return{$textField:$appended.find("[name='"+name+"_Text']"),$hiddenField:$appended.find("[name='"+name+"']")}}})};var initClassifiersDependencies=function($parent){$parent.find(".classifier-control[data-dependency-field-key]").each(function(){var $classifierControlWithDependency=$(this);var dependencyFieldKey=$classifierControlWithDependency.data("dependency-field-key");if(dependencyFieldKey){var dependentFieldKey=$classifierControlWithDependency.data("field-key");createClassifierDependence(dependencyFieldKey,dependentFieldKey)}});function createClassifierDependence(fieldKey,dependentFieldKey){$(document).ready(function(){resolveClassifierDependence(fieldKey,dependentFieldKey)});$('.classifier-control[data-field-key="'+fieldKey+'"]').on("change",function(){resolveClassifierDependence(fieldKey,dependentFieldKey);var dependentClassifier=$('.classifier-control[data-field-key="'+dependentFieldKey+'"]');reinitializeClassifierItem(dependentClassifier)})}function resolveClassifierDependence(fieldKey,dependentFieldKey){var classifierControl=$('.classifier-control[data-field-key="'+fieldKey+'"]');var selectedClassifierValues;if(classifierControl.length>0){var miniTreeRootControl=classifierControl.find(".collapseTree");var miniTreeApi=miniTreeRootControl.data("mini-tree-api");selectedClassifierValues=miniTreeApi.getSelectedValues()}else{selectedClassifierValues=$('[data-field-key="'+fieldKey+'"]').data("selected-values")}var selectedClassifierValue=selectedClassifierValues.length>0?selectedClassifierValues[0]:"";var paramPrefix="&entityUid=";var dependentClassifier=$('.classifier-control[data-field-key="'+dependentFieldKey+'"]');dependentClassifier.each(function(){changeUrlAdditionalQuery($(this),"items-url",paramPrefix,selectedClassifierValue);changeUrlAdditionalQuery($(this),"url",paramPrefix,selectedClassifierValue);changeUrlAdditionalQuery($(this).find(".classifier-selector"),"source-url",paramPrefix,selectedClassifierValue);$(this).attr("process-state","False")})}function reinitializeClassifierItem(classifierItem){var formControl=classifierItem.find(".form-control");var controlDefaultName=formControl.attr("name").replace("_autocomplete","");formControl.attr("name",controlDefaultName);var rootControl=classifierItem.find(".collapseTree");var miniTreeApi=rootControl.data("mini-tree-api");miniTreeApi.clearSelectedItems();miniTreeApi.clearMiniTree();var $buttonCollapse=classifierItem.find(".mtree-button-collapse");$buttonCollapse.off("click");initClassifiers(classifierItem)}function changeUrlAdditionalQuery($this,dataName,queryPrefix,queryValue){var currentUrl=$this.data(dataName);var additionalQuery=queryPrefix+queryValue;if(currentUrl.includes(additionalQuery)&&queryValue!==""){return}var prefixIndex=currentUrl.indexOf(queryPrefix);var originalUrl=prefixIndex>-1?currentUrl.substring(0,prefixIndex):currentUrl;var newValue=queryValue!==""?originalUrl+additionalQuery:originalUrl;$this.data(dataName,newValue);$this.attr("data-"+dataName,newValue)}};var initButtons=function($parent){$parent.find("input.btn, button.btn").filter("[type='submit'][data-action]").click(function(){var $button=$(this);$(this).closest("form").prop("action",$button.data("action"))});$parent.find("input.btn, button.btn").filter("[data-button-type='back']").click(function(){history.back();return false});$parent.find("input.btn, button.btn").filter("[data-button-type='cancel']").each(function(){var $this=$(this);$this.click(function(){var $form=$this.closest("form");if($form.length){$form.dataForm("setChanged",false)}if($this.data("back-on-click")===1){history.back()}})});$parent.find("input.btn, button.btn").filter("[data-button-type='clear']").click(function(e){var $form=$(this).closest("form");if($.fn.dataForm){e.preventDefault();$form.dataForm("reset")}});$parent.find("a.btn").click(function(e){if($(this).is("[disabled]")){e.preventDefault()}});$parent.find(".ui-block .btn-type-collapse").click(function(e){var $btn=$(this),trgSel=$btn.data("target"),$uiBlock=$btn.closest(".ui-block"),$contentBody=$uiBlock.find(trgSel),fPh=$btn.data("foldPhrase"),unfPh=$btn.data("unfoldPhrase"),$icon=$btn.find("i"),ifCl=$icon.data("foldClass"),iunfCl=$icon.data("unfoldClass"),evt;e.preventDefault();if($contentBody.length>0){var isHidden=$contentBody.is(":hidden");if(isHidden){evt=$.Event("show");$uiBlock.trigger(evt,[$contentBody]);if(evt.isDefaultPrevented()){return}$contentBody.removeClass("hidden").fadeIn({complete:function(){$uiBlock.trigger("shown",[$contentBody])}})}else{evt=$.Event("hide");$uiBlock.trigger(evt,[$contentBody]);if(evt.isDefaultPrevented()){return}$contentBody.fadeOut({complete:function(){$contentBody.toggleClass("hidden")}})}$icon.length>0&&$icon.toggleClass(ifCl).toggleClass(iunfCl);$btn.find("span").empty().text(isHidden?fPh:unfPh)}});var savePageFormsEventName="savePageForms";$(document.body).off(savePageFormsEventName).on(savePageFormsEventName,commonModule.savePageForms)};var initPopovers=function($parent){$parent.find("[data-description]").each(function(){var $this=$(this),descr=$this.data("description");if(!descr||descr.length===0){return}descr=descr.toString();var htmlDescr=descr.replace(/\n/g,"<br/>");var opt=generatePopoverOptions(htmlDescr);var targets=$this.find("label.control-label, .quick-help-target, .checkbox-with-quick-help").addBack("label, .quick-help-target").addClass("quick-help");targets.append('<span class="quick-help-icon" />');targets.children("span").popover(opt)});function generatePopoverOptions(description){return{content:description,html:true,trigger:"hover manual",container:$parent,placement:"top",getOffset:function(placement,popover,element){var offset,$pop=$(popover),$el=$(element),elPosition=this.getPosition();var $container=$el.closest("form");if($container.length){var maxWidth,contOffset=$container.offset(),decorWidth=$pop.outerWidth()-$pop.width();var curbPos=contOffset.left+(parseInt($container.css("border-left-width"))||0)+(parseInt($container.css("padding-left"))||0);if(placement!=="left"){curbPos+=$container.width();maxWidth=curbPos-elPosition.left-(placement==="right"?elPosition.width:0)-decorWidth}else{maxWidth=elPosition.left-curbPos-decorWidth}maxWidth>0&&$pop.css("max-width",Math.max(maxWidth,276)+"px")}var actualWidth=$pop.outerWidth(),actualHeight=$pop.outerHeight();if(placement==="top"||placement==="bottom"){var topSpaceAvail,bottomSpaceAvail,fullHeight,$w=$(window),wTopCurb=$w.scrollTop(),wBottomCurb=wTopCurb+$w.height();topSpaceAvail=elPosition.top-wTopCurb-($(".topbar").outerHeight()||0);bottomSpaceAvail=wBottomCurb-(elPosition.top+$el.outerHeight());$pop.addClass(placement);fullHeight=$pop.outerHeight()+Math.abs(parseInt($pop.css("margin-top"))||0);$pop.removeClass(placement);if(placement=="top"&&topSpaceAvail<fullHeight){placement="bottom"}else{if(placement=="bottom"&&bottomSpaceAvail<fullHeight&&topSpaceAvail>=fullHeight){placement="top"}}}switch(placement){case"left":offset={top:elPosition.top+elPosition.height/2-actualHeight/2,left:elPosition.left-actualWidth};break;case"right":offset={top:elPosition.top+elPosition.height/2-actualHeight/2,left:elPosition.left+elPosition.width};break;case"top":offset={top:elPosition.top-actualHeight,left:elPosition.left};break;default:offset={top:elPosition.top+$el.outerHeight(),left:elPosition.left};break}offset.placement=placement;return offset}}}var $currentPopover=null;$(document).off("shown.bs.popover").on("shown.bs.popover",function(ev){if($currentPopover&&($currentPopover.get(0)!==ev.target)){$currentPopover.popover("hide")}$currentPopover=$(ev.target)});$(document).off("hidden.bs.popover").on("hidden.bs.popover",function(ev){if($currentPopover&&($currentPopover.get(0)===ev.target)){$currentPopover=null}});$(".quick-help-icon",$parent).off("click").on("click",function(e){e.preventDefault();return false});$(document).off("mousedown.popover").on("mousedown.popover",function(e){var $target=$(e.target);if($target.data("bs.popover")){$target.popover("toggle");return}if($currentPopover){$currentPopover.popover("hide");$currentPopover=null}})};var initDataTableTabs=function($grid){var $block=$grid.closest(".tab-pane");$block.on("shown.tabPane.data-api",function(){var gridLoader=$grid.DataTable();gridLoader.responsive.recalc()})};var initRequiredAsteriskTooltips=function($parent){$parent.find(".required > label > i").attr({rel:"tooltip","data-original-title":module.Common.messages.requiredAsteriskMessage,"data-placement":"right"});$parent.find(".custom-required > label > i").attr({rel:"tooltip","data-original-title":module.Common.messages.customRequiredAsteriskMessage,"data-placement":"right"})};var initTooltips=function($parent){initRequiredAsteriskTooltips($parent);$parent.find("[rel=tooltip]").each(function(){$(this).tooltip({delay:{show:50,hide:50}})});$parent.find("[placeholder]").each(function(){var self=$(this),placeholder=self.attr("placeholder"),input=self.find('input[type="text"],input[type="password"],textarea');input.attr("placeholder",placeholder);if(self.placeholder){self.placeholder(placeholder)}})};var initClientConfirm=function($parent){$parent.find("[data-confirm-message]").each(function(i,e){var $e=$(e),message=$e.data("confirm-message"),title=$e.data("confirm-title");var opt={confirmText:message,confirmTitle:title};var clickFunc=function(){commonModule.showConfirm(message,opt).done(callbackFunc);return false};var callbackFunc;if(e.tagName.toUpperCase()=="A"){callbackFunc=function(){commonModule.goTo($(e).attr("href"))}}else{callbackFunc=function(){$(e).unbind("click",clickFunc).click().bind("click",clickFunc)}}$(e).click(clickFunc)})};var initBlocks=function($parent){$.fn.dataBlock&&$parent.find("[data-remote-content]").dataBlock()};var initTabs=function($parent){if(!$parent.is(document.body)){return}var $tabBlock=$parent.find(".tab-block"),$tabs=$tabBlock.find(".nav-tabs"),sel='a[data-toggle="tab"]';var updateTabs=function(e,$tabList){var state=($.bbq&&$.bbq.getState())||{};$tabList=$tabList||$(document.body).find(".nav-tabs");$tabList.each(function(){var $tabs=$(this),found=false;$.each(state,function(prop,val){var a=$tabs.find('a[href="#'+(val||prop)+'"]');found=a.length>0;if(found){a.tab("show");return false}});!found&&$tabs.find(".active").length==0&&$tabs.find("a:first").tab("show")})};$(window).on("hashchange.tabs",updateTabs);$tabs.find(sel).each(function(){var $tab=$(this),$tabPane=$tab.data("pane");if(!$tabPane){$tabPane=$tabBlock.find($tab.attr("href"));if($tabPane.length){$tab.data("pane",$tabPane);$tabPane.data("tab",$tab).on("loaded.dataBlock.data-api",function(e){if(e.namespace!="dataBlock.data-api"&&e.namespace!="data-api.dataBlock"){return}$(this).data("tab").trigger("loaded")})}}}).on("show.bs.tab",function(e){var $tab=$(e.target),$tabPane=$tab.data("pane");if($tabPane.length==0){return}$tabPane.dataBlock("load")}).on("shown.bs.tab",function(e){$(this).data("pane").trigger("shown.tabPane.data-api")}).on("click",function(e){e.preventDefault();var $this=$(this),stateKey=$this.data("stateKey"),stateVal=$this.attr("href"),stateObj={};if(stateKey){stateObj[stateKey]=stateVal.replace(/\#/g,"")}else{stateObj=stateVal}if($.bbq){var existingTabMarker=$.bbq.getState(stateVal.replace(/\#/g,""));if(typeof existingTabMarker==="undefined"){$.bbq.pushState(stateObj)}}else{$this.tab("show")}return false});updateTabs(null,$tabs);$tabBlock.on("validated submitted","form",function(e,isValid){var $form=$(e.currentTarget),$tab=$form.closest(".tab-pane").data("tab"),$block=$form.closest(".tab-block"),$invalidTab=$block.data("firstInvalidTab");if(!$tab||$tab.length==0||$block.data("highlightInvalidTab")===false){return}$tab.toggleClass("highlight-error",!isValid)})};var initBlockGrid=function($parent){if(typeof BlockGrid!=="undefined"&&BlockGrid.init){$parent.find("[data-blockgrid]").each(function(){var $this=$(this);var options=$this.data("blockgrid");var resources=$this.data("resources");var additionalResources=$this.data("additional-resources");BlockGrid.init(this,options,resources,additionalResources).render()})}};var initForms=function($parent){var $forms=$parent.find("form").not(".react-form");$.fn.dataForm&&$forms.dataForm();$forms.find("span.input-clear-widget").each(function(){var $w=$(this),$inpt=$w.children('input:text, input[type="password"]').first(),$icon=$w.children("i");var clickHandler=function(e){e.stopPropagation();$inpt.val("");$inpt.change();$inpt.get(0).focus();$(this).hide()};var keyupHandler=function(){var v=$(this).val(),isHidden=$icon.is(":hidden")||$icon.css("visibility")=="hidden";if(v!=""&&isHidden){$icon.css("visibility","visible").show()}else{if(v==""&&!isHidden){$icon.hide()}}};$icon.off("click",clickHandler).on("click",clickHandler);$inpt.off("keyup changeDate changeYear changeMonth change",keyupHandler).on("keyup changeDate changeYear changeMonth change",keyupHandler);if($inpt.length>0&&$inpt.not(":disabled").not("[readonly]").length>0&&$inpt.val()){$icon.css("visibility","visible").show()}});FogSoft.Suggestion.init($forms)};var initNumerics=function($parent){$parent.find(".numeric").numeric();$parent.find(".money").numeric({decimal:","}).blur(function(){if($(this).val()){$(this).parseNumber({format:"#0.00",locale:"ru"});$(this).formatNumber({format:"#0.00",locale:"ru"})}})};var initToolbar=function($parent){$parent.find(".toolbar a.action").click(function(e){e.preventDefault();return false});$parent.find(".mobile-toolbar-block").click(function(){$("body").toggleClass("js-no-scroll");$(".overlay").toggleClass("js-active")});$parent.find(".main-toolbar a.dropdown-toggle").click(function(){var $button=$(this.parentElement);var $dropdownMenu=$button.find("ul");var xOffset=$button.offset().left;var alignRight=($(document).width()-xOffset)<xOffset;$dropdownMenu.toggleClass("dropdown-menu-right",alignRight)})};var initHtmlEditors=function($parent){var ed=$parent.find("textarea.html-editor");if(ed[0]!=undefined){var opt=ed.data("editorOptions")||{},type=ed.data("editor-type"),fileManagerType=ed.attr("file-manager-type");if(typeof type==="undefined"){type="tinymce"}if(type=="wysihtml5"){if(!$.fn.wysihtml5){return}ed.wysihtml5($.extend(true,{"font-styles":false,link:false,image:false,lists:false,html:false,color:false,stylesheets:[],locale:FogSoft.Globalization.locale().culture,events:{change:function(){this.textareaElement&&$(this.textareaElement).change()}}},opt))}else{if(type=="tinymce"){var applicationUrl=(typeof ApplicationInfo==="undefined")?"/":ApplicationInfo.ApplicationUrl;$.getScript(applicationUrl+"Content/FogSoft.Common/lib/tinymce/tinymce.js",function(){tinymce.baseURL=applicationUrl+"Content/FogSoft.Common/lib/tinymce/";var fileBrowserCallbacks={RoxyFileBrowser:RoxyFileBrowser};var fileBrowserCallback=fileBrowserCallbacks[fileManagerType]!==undefined?fileBrowserCallbacks[fileManagerType]:false;tinymce.init({selector:"textarea.html-editor",theme:"modern",language:FogSoft.Globalization.locale().culture,plugins:["advlist autolink link image lists charmap preview hr anchor","searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime nonbreaking","table contextmenu directionality paste textcolor"],setup:function(editor){editor.on("change",function(){tinymce.triggerSave()});editor.on("SaveContent",function(e){e.content=e.content.replace(/(&nbsp;)(?!(&nbsp;)| )/ig," ")})},content_css:applicationUrl+"Content/FogSoft.Common/lib/tinymce/css/tinymce_content.css",menu:{edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall"},insert:{title:"Insert",items:"link image insertfile | insertdatetime charmap hr"},view:{title:"View",items:"visualaid visualblocks | preview"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript | formats fontselect fontsizeselect | removeformat"},table:{title:"Table",items:"inserttable tableprops deletetable | cell row column"},tools:{title:"Tools",items:"spellchecker code"}},toolbar:"undo redo | styleselect | fontsizeselect | bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | print preview media fullpage | forecolor backcolor | removeformat",file_browser_callback:fileBrowserCallback,fontsize_formats:"8pt 10pt 12pt 14pt 18pt 24pt 36pt",});function RoxyFileBrowser(field_name,url,type,win){var roxyFileman=applicationUrl+"Content/FogSoft.Common/lib/tinymce/plugins/fileman/index.cshtml";if(roxyFileman.indexOf("?")<0){roxyFileman+="?type="+type}else{roxyFileman+="&type="+type}roxyFileman+="&input="+field_name+"&value="+document.getElementById(field_name).value;tinyMCE.activeEditor.windowManager.open({file:roxyFileman,title:module.Common.messages.fileManager,width:850,height:650,resizable:"yes",inline:"yes",close_previous:"no"},{window:win,input:field_name});return false}})}}}};var processTemplates=function($parent){if($.fn.dataTemplate){$parent.find("[data-templates]").dataTemplate()}};var initNotificationArea=function($parent){if(!$parent.is(document.body)){return}if($.fn.notificationArea&&!module.NotificationArea){var options={messages:commonModule.messages.notificationArea};if(!options.messages){options=null}module.NotificationArea=$parent.find(".notification-area").first().notificationArea(options)}};var initDownloadLinks=function($parent){var uiBlocked=false;$parent.find('[data-file-download="true"]').click(function(e){var $this=$(this),url=$this.attr("href")||$this.data("action");if(!url){return}e.preventDefault();if(uiBlocked===false){$this.data("blockUi")===true&&commonModule.blockUi($this.data("blockUiText")||commonModule.messages.pleaseWait);uiBlocked=true}$.fileDownload(url,{successCallback:function(){commonModule.unblockUi();uiBlocked=false},failCallback:$.noop,clearCookieBeforeDownload:true})})};var initPageBlockNavigation=function($parent){if(!$parent.is(document.body)){return}var $nav=$parent.find(".page-block-navbar"),$navContainer=$parent.find(".page-block-navbar-container"),$navTop=$parent.find(".page-top-nav"),$contentDiv=$navTop.closest(".page-content"),offsetTop=$nav.length?$nav.parent().offset().top-$(".topbar").height():0,offsetBottom=$contentDiv.length?$(document).height()-$contentDiv.offset().top-$contentDiv.height():0,affixOpts={offset:{top:offsetTop}};$nav.affix(affixOpts);$navTop.affix($.extend(true,{},affixOpts,{offset:{bottom:offsetBottom}}));$nav.find('[data-toggle="nav-bar-tooltip"]').tooltip({placement:function(){return $navContainer.css("position")=="absolute"?"bottom":"left"},container:"body"})};var initScrollTopbar=function($parent){var $topbar=$parent.find(".public-layout .topbar");var $targetOffsetTop=$topbar.height();var $scrollPosition=$(window).scrollTop();$(window).scroll(function(){$scrollPosition=$(window).scrollTop();$topbar.toggleClass("topbar-scroll",$scrollPosition>=$targetOffsetTop)});if($scrollPosition>=$targetOffsetTop){$topbar.addClass("topbar-scroll")}};var initScrollSpy=function($parent){if(!$parent.is(document.body)){return}var $spy=$('[data-spy="scroll"]');$spy.each(function(){var $self=$(this);$self.scrollspy($self.data())});$(document.body).on("loaded.dataBlock.data-api",function(){$spy.scrollspy("refresh")})};var isRequiredAttributePresent=function($element){if($element.is("[data-val-required]")){return true}if($element.is("[data-val-requiredif]")){return true}return false};var initCustomValidationRequired=function($parent){$parent.find("[data-val-customvalidationrequired]").each(function(){var element=this;if(isRequiredAttributePresent($(element))){return}var $controlGroup=$(element).closest(".form-group");$controlGroup.addClass("custom-required");var $label=$controlGroup.find("label");if($label.find("i").length===0){$label.append($("<i></i>"))}})};var initCustomValidationRequiredIf=function($parent){$parent.find("[data-val-customvalidationrequiredif]").each(function(){var element=this;if(isRequiredAttributePresent($(element))){return}var $controlGroup=$(element).closest(".form-group");var $form=$(element).closest("form"),compElName=$(element).data("val-customvalidationrequiredif-otherproperty"),compOp=$(element).data("val-customvalidationrequiredif-comparsion"),compVal=$(element).data("val-customvalidationrequiredif-value"),$other=$form.find('[name="'+compElName+'"]');var $label=$controlGroup.find("label");if($label.find("i").length==0){$label.append($("<i></i>"))}var changeRequired=function(){if(!commonModule.isNotRequired("",element,{other:compElName,comp:compOp,value:compVal!=undefined?compVal.toString():compVal,init:1})){$controlGroup.addClass("custom-required");initTooltips($parent)}else{$controlGroup.removeClass("custom-required")}};$other.change(changeRequired);changeRequired()})};var initRequiredIfValidators=function($parent){$parent.find("[data-val-requiredif]").each(function(){var element=this;var $form=$(element).closest("form"),compElName=$(element).data("val-requiredif-other"),compOp=$(element).data("val-requiredif-comp"),compVal=$(element).data("val-requiredif-value"),$other=$form.find('[name="'+compElName+'"]'),$controlGroup=$(element).closest(".form-group");var $label=$controlGroup.find("label");if($label.find("i").length==0){$label.append($("<i></i>"))}var changeRequired=function(){if(!commonModule.isNotRequired("",element,{other:compElName,comp:compOp,value:compVal!=undefined?compVal.toString():compVal,init:1})){$controlGroup.addClass("required");initTooltips($parent)}else{$controlGroup.removeClass("required")}};$other.change(changeRequired);changeRequired()})};var initTrimingWhiteSpaces=function(){$("input.trim-white-spaces").on("input",function(){$(this).val($.trim($(this).val()))})};var configureValidation=function(globalizeObj){if($.validator){$.validator.methods.number=function(value){var type=$.type(value);if(value==undefined||value==null||type=="number"){return true}if(type=="string"){return value===""?true:!isNaN(globalizeObj?globalizeObj.parseFloat(value):parseFloat(value))}return false};$.validator.methods.date=function(value){var type=$.type(value);if(value==undefined||value==null||type=="date"){return true}if(type=="string"){return value===""?true:(globalizeObj?globalizeObj.parseDate(value):parseDate(value))!==null}return false};$.validator.methods.minlength=function(value,element,param){var length=$.isArray(value)?value.length:this.getLength(value,element);return this.optional(element)||length>=param},$.validator.methods.maxlength=function(value,element,param){var length=$.isArray(value)?value.length:this.getLength(value,element);return this.optional(element)||length<=param},$.validator.methods.rangelength=function(value,element,param){var length=$.isArray(value)?value.length:this.getLength(value,element);return this.optional(element)||(length>=param[0]&&length<=param[1])},$.extend($.validator.methods,{range:function(value,element,param){var val=globalizeObj?globalizeObj.parseFloat(value):parseFloat(value);return this.optional(element)||(val>=param[0]&&val<=param[1])}})}};var captchaScriptInitialized=false;function initFileFields($el){if(typeof FogSoft.FileField==="undefined"){return}$el.find(".file-field-container").each(function(){FogSoft.FileField.init($(this))})}function initCaptcha($el){var formsWithCaptcha=$el.find("form div[data-captchakey]").closest("form");if(formsWithCaptcha.size()===0){return}if(captchaScriptInitialized===true){initFormsCaptcha(formsWithCaptcha);return}var lang=$("html").attr("lang");var src="https://www.google.com/recaptcha/api.js?render=explicit&onload=onCaptchaScriptLoaded&hl="+lang;window.onCaptchaScriptLoaded=function(){captchaScriptInitialized=true;initFormsCaptcha(formsWithCaptcha)};var scriptEl=document.createElement("script");scriptEl.setAttribute("src",src);document.body.appendChild(scriptEl)}function initFormsCaptcha(formsWithCaptcha){formsWithCaptcha.each(function(){var $form=$(this);var targetDiv=$form.find("div[data-captchakey]");var publicKey=targetDiv.data("captchakey");if(publicKey){var grecaptcha=window.grecaptcha;var captchaForFormInitialized=$form.data("captcha-initialized");if(captchaForFormInitialized===true){return}if(!grecaptcha){throw new Error("grecaptcha is not initialized.")}var captchaChecked=false;var captchaWidgetId=grecaptcha.render(targetDiv[0],{size:"invisible",sitekey:publicKey,callback:function(){captchaChecked=true;$form.submit()}});$form.on("modal-shown.dataForm.data-api",function(e){grecaptcha.reset(captchaWidgetId)});$form.on("submitting.dataForm.data-api",function(e){if(captchaChecked===true){captchaChecked=false;return}e.preventDefault();grecaptcha.execute(captchaWidgetId)});$form.on("submitted",function(e){grecaptcha.reset(captchaWidgetId)});$form.data("captcha-initialized",true)}})}function cutDropdownOptionsText($parent){var selectBlock=$parent.find("select");if(selectBlock.length){$parent.find("select option").each(function(index,option){var optionText=$(option).text();var selectWidth=$(option).parent().outerWidth();if(optionText.length<100||selectWidth<1){return}var oneLetterPixelWidth=8;var letterCountAvailable=Math.floor(selectWidth/oneLetterPixelWidth);$(this).attr("title",optionText);optionText.length<letterCountAvailable?$(this).text(optionText):$(this).text(optionText.substring(0,letterCountAvailable)+"...")})}}var initCollapseBlock=function($parent){$parent.find(".block-collapse.auto-unfold").each(function(){var $currentCollapseBlock=$(this);var $extendedFilters=$currentCollapseBlock.find("input, select, textarea");if($extendedFilters.length===0){return true}var $collapseButton=$parent.find(".btn-type-collapse"),targetSelector=$collapseButton.data("target"),$uiBlock=$collapseButton.closest(".ui-block"),$contentBody=$uiBlock.find(targetSelector),buttonUnfoldPhrase=$collapseButton.data("unfoldPhrase"),$icon=$collapseButton.find("i"),iconFoldClass=$icon.data("foldClass"),iconUnfoldClass=$icon.data("unfoldClass"),showEvent=$.Event("show");$extendedFilters.each(function(){var isUnfoldNeeded,$element=$(this)[0],elementType=$element.type;if(elementType==="hidden"){return true}if(elementType==="checkbox"){isUnfoldNeeded=$element.checked}else{isUnfoldNeeded=$element.value.length>0}if(isUnfoldNeeded){$uiBlock.trigger(showEvent,[$contentBody]);if(showEvent.isDefaultPrevented()){return false}$contentBody.removeClass("hidden").fadeIn({complete:function(){$uiBlock.trigger("shown",[$contentBody])}});$icon.length>0&&$icon.toggleClass(iconFoldClass).toggleClass(iconUnfoldClass);$collapseButton.find("span").empty().text(buttonUnfoldPhrase);return false}})})};var initAffix=function($parent){var $affixToolBar=$parent.find(".main-toolbar.affixed-toolbar");var $affixNavBar=$affixToolBar.children(".navbar-inner");if($affixNavBar.length===1){var topNavbarsHeight=$parent.find(".navbar.navbar-fixed-top > .navbar-inner").height();var navbarDemoHeight=$parent.find(".demo-indicator").height();if(navbarDemoHeight){topNavbarsHeight+=navbarDemoHeight}$affixNavBar.css({top:topNavbarsHeight});var newOffset=$affixToolBar.height();$affixToolBar.css({height:newOffset+"px"});$affixNavBar.affix({offset:{top:newOffset}});var updateOffset=_.debounce(function(){$affixToolBar.css({height:newOffset+"px"});$affixNavBar.css({top:topNavbarsHeight})},300);$(window).off("resize",updateOffset).on("resize",updateOffset)}var item=$('a[data-toggle="popover"]');item.on("click",function(e){var sectionId=$(e.currentTarget).attr("href");var sectionTop=$(sectionId).offset().top;var affixTopHeight=$(".navbar-inner.affix-top").height();var affixHeight=$(".navbar-inner.affix").height();var navbarHeight=$(".navbar-fixed-top").height();var affixOffset=affixTopHeight?affixTopHeight*2:affixHeight;var scrollTo=sectionTop-affixOffset-navbarHeight+25;$("html, body").animate({scrollTop:scrollTo},0);e.preventDefault()})};var initResetButton=function($parent){$parent.find("button:reset").each(function(idx,btn){var $btn=$(btn);if($btn){var submitAfterReset=$btn.data("submitAfterReset");if(submitAfterReset){$btn.on("click",function(e){e.preventDefault();$(this.form).dataForm("reset")})}}})};var initTimeLeftIndicators=function($parent){$parent.find(".time-left-indicator").each(function(index,timeLeftIndicator){var $timeLeftIndicator=$(timeLeftIndicator);if($timeLeftIndicator.data("initialized")){return}var $timeLeftLabel=$timeLeftIndicator.find(".time-left-label");var $timeLeftValue=$timeLeftIndicator.find(".time-left-value");if($timeLeftValue.length){var targetDateUtc=window.Globalize.parseDate($timeLeftValue.data("target-date-utc"));var timezoneOffsetInMilliseconds=new Date().getTimezoneOffset()*60*1000;var targetLocalDateInMilliseconds=targetDateUtc.getTime()-timezoneOffsetInMilliseconds;var timeDiff=getTimeLeftInMilliseconds(targetLocalDateInMilliseconds);if(timeDiff>0){var totalDays=timeDiff/(1000*3600*24);if(totalDays>=1){totalDays=Math.ceil(totalDays);$timeLeftLabel.html($timeLeftLabel.data("days-mode-text"));$timeLeftValue.html(totalDays)}else{$timeLeftLabel.html($timeLeftLabel.data("time-mode-text"));$timeLeftValue.html(getTimeLeftText(timeDiff,timezoneOffsetInMilliseconds));var intervalId=setInterval(function(){var timeLeftInMilliseconds=getTimeLeftInMilliseconds(targetLocalDateInMilliseconds);var timeLeftText=getTimeLeftText(timeLeftInMilliseconds,timezoneOffsetInMilliseconds);$timeLeftValue.html(timeLeftText);if(timeLeftInMilliseconds<=0||!document.body.contains(timeLeftIndicator)){clearInterval(intervalId);return}},1000)}$timeLeftIndicator.toggleClass("hidden",false)}}$timeLeftIndicator.data("initialized",true)});function getTimeLeftInMilliseconds(targetLocalDateInMilliseconds){return targetLocalDateInMilliseconds-new Date().getTime()}function getTimeLeftText(timeLeftInMilliseconds,timezoneOffsetInMilliseconds){var diffDate=timeLeftInMilliseconds>0?new Date(timeLeftInMilliseconds+timezoneOffsetInMilliseconds):new Date(0,0,0,0,0,0,0);return FogSoft.Common.formatDateTime(diffDate,"HH:mm:ss")}};commonModule.initLoadOnChange=function($parent,$selectedValueFunc){var commonModule=FogSoft&&FogSoft.Common||{};$parent.find(".load-on-change").each(function(){var $contentContainerId=$(this).data("content-container");var $dataLoadUrl=$(this).data("load-url");var $contentContainer=$("#"+$contentContainerId);var restoringResult={"$previousFieldsContainer":undefined,fieldsData:[]};$contentContainer.on("loaded.dataBlock.data-api",function(){restoringResult=commonModule.restoreFormData($contentContainer,restoringResult)}).on("loading.dataBlock.data-api",function(){restoringResult=commonModule.saveFormData($contentContainer,restoringResult)});var loadContent=function(element){var selectedValue=$selectedValueFunc(element);$contentContainer.data({url:$dataLoadUrl.replace("_selectedValue_",selectedValue),contentTarget:$contentContainer});$contentContainer.dataBlock("load",true)};loadContent($(this));$(this).on("change",function(){loadContent($(this))})})};commonModule.isNotRequired=function(value,element,params){return commonModule.isFieldNotRequired(value,element,params,function(el){return $(el).val()})};commonModule.isFieldNotRequired=function(value,element,params,valueValidationFunc){if((!params||!params.init)&&(!element||valueValidationFunc(element)||!element.form)){return true}var $form=$(element).closest("form"),compElName=params.other,compOp=params.comp,compVal=params.value,$other=$form.find('[name="'+compElName+'"]'),otherType=($other.attr("type")||"").toLowerCase(),otherVal;if(otherType=="checkbox"){otherVal=$other.prop("checked")?"true":"false"}else{if(otherType=="radio"){otherVal=$form.find('[name="'+compElName+'"]:checked').val()}else{otherVal=$other.val()}}compVal=(compVal||"").toLowerCase();otherVal=(otherVal||"").toLowerCase();return(compOp=="isequalto"&&otherVal==compVal)||(compOp=="isnotequalto"&&otherVal!=compVal)?false:true};function initTableFields($parent){if(window.TableField&&window.TableField.initTableEditor){window.TableField.initTableEditor($parent)}}var initSidebarToggle=function($parent){var sidebarStateCookieName="sidebar-state";function getScreenWidth(){return window.innerWidth||document.clientWidth||document.documentElement.clientWidth}var lastWidth=getScreenWidth();$parent.find("[data-sidebar-toggle]").each(function(){var $this=$(this);var sidebarSelector=$this.data("sidebar-toggle");var $container=$(sidebarSelector);var $bodyElement=$("body");var $overlay=$(".overlay");var resizeValue=1199;var setState=function(value){var cookiesShouldHaveSecureAttribute=(typeof ApplicationInfo==="undefined")?"False":ApplicationInfo.CookiesSecureAttribute;if(cookiesShouldHaveSecureAttribute==="True"){Cookies.set(sidebarStateCookieName,value,{secure:true})}else{Cookies.set(sidebarStateCookieName,value)}};function update(collapse){if(collapse){$container.addClass("collapsed");$bodyElement.addClass("sidebar-collapsed");$overlay.removeClass("js-active")}else{$overlay.addClass("js-active");$container.removeClass("collapsed");$bodyElement.removeClass("sidebar-collapsed")}hideSubMenu()}function hideSubMenu(){if($container.hasClass("collapsed")){$container.find(".subnav.collapse.in").removeClass("in");$container.find(".trigger").addClass("collapsed")}}hideSubMenu();var resize=_.debounce(function(){var width=getScreenWidth();if(lastWidth!==width){lastWidth=width;var isCollapsed=width<=resizeValue;setState(isCollapsed);update(isCollapsed)}},50);$(window).on("resize.sidebar",resize);if(getScreenWidth()<=resizeValue){hideMenu()}function hideMenu(){setState(true);update(true)}$(document).click(function(e){e.stopPropagation();if($(e.target).closest(".sidebar-toggle").length===0&&$(e.target).closest(".sidebar").length===0){if($(e.target).closest(".overlay").length===1){hideMenu()}if($(e.target).closest(".overlay").length===0){hideSubMenu()}}});$(".collapse").on("shown.bs.collapse",function(e){if($container.hasClass("collapsed")){var $currentMenu=$(e.target);var $trigger=$currentMenu.prev();var $triggerPositionTop=$trigger.parent().position().top;var menuBottomPosition=$triggerPositionTop+$currentMenu.outerHeight();if(menuBottomPosition>document.documentElement.clientHeight){$currentMenu.addClass("scroll-submenu");$currentMenu.css({top:"auto",bottom:"4px"})}else{$currentMenu.css({top:$triggerPositionTop,bottom:"auto"})}}});$this.on("click.sidebar-toggle",function(){var collapsed=$container.hasClass("collapsed");update(!collapsed);setState(!collapsed)})})};function tryInitMultiLanguageSelector($parent){FogSoft.MultiLanguage&&FogSoft.MultiLanguage.init($parent)}function initInputMask($parent){$parent.find("[data-input-mask]").each(function(){var $this=$(this);var maskValue=$this.attr("data-input-mask");if(maskValue){$this.mask(maskValue)}})}function initDurationField($parent){var durationContainers=$parent.find("[data-duration-for]");function updateDuration(value,$target){var now=new Date();var date=window.Globalize.parseDate(value);date&&$target.html(humanizeDuration(now-date,{language:document.documentElement.getAttribute("lang"),largest:3,units:["y","mo","d"],round:true}))}durationContainers.each(function(){var $this=$(this);var target=$this.data("duration-for");var $input=$parent.find(':input[name="'+target+'"]');if($input.length){$input.off("change.duration").on("change.duration",function(){updateDuration($input.val(),$this)});updateDuration($input.val(),$this)}else{var valueContainer=$parent.find('[data-field-name="'+target+'"]');updateDuration(valueContainer.text(),$this)}})}function initDatesTogglingByRequiredIfAttribute($parent){initRequiredIfToggling("customvalidationrequiredif","otherproperty");initRequiredIfToggling("requiredif","other");function initRequiredIfToggling(requiredIfAttributeName,otherPropertyAttributeSuffix){$parent.find("[data-val-"+requiredIfAttributeName+'][data-type="date"]').each(function(){var $this=$(this),$form=$this.closest("form"),compElName=$this.data("val-"+requiredIfAttributeName+"-"+otherPropertyAttributeSuffix),enabledValue=$this.data("val-"+requiredIfAttributeName+"-value"),$other=$form.find('[name="'+compElName+'"]');function changeDatesState(element){var dateName=element.name.replace("Type","");var disabled=element.value.toUpperCase()!==enabledValue.toUpperCase();var $controlsDateDiv=$('input[name="'+dateName+'"]').closest(".controls");var $datePicker=$controlsDateDiv.find(".input-group.date");var $timePicker=$controlsDateDiv.find(".input-group.time");$datePicker.data("datepicker-api").toogleDatePicker(disabled);if($timePicker.length>0){$timePicker.data("datepicker-api").toogleDatePicker(disabled)}}$other.change(function(e){changeDatesState(e.target)});var selectedOption=$form.find('[name="'+compElName+'"][checked]');if(selectedOption.length){changeDatesState(selectedOption.get(0))}})}}commonModule.init=function($parent){if(!isValidationConfigured){configureValidation(globalize);isValidationConfigured=true}commonModule.initFormSearchParameters($parent);cutDropdownOptionsText($parent);initCaptcha($parent);initFileFields($parent);processTemplates($parent);initNotificationArea($parent);initDatePickers($parent);initAutocomplete($parent);initClassifiers($parent);initClassifiersDependencies($parent);initButtons($parent);initBlockGrid($parent);initForms($parent);initBlocks($parent);initTabs($parent);initToolbar($parent);initClientConfirm($parent);initHtmlEditors($parent);initDownloadLinks($parent);initPageBlockNavigation($parent);initScrollTopbar($parent);initScrollSpy($parent);initRequiredIfValidators($parent);initTrimingWhiteSpaces();initCustomValidationRequired($parent);initCustomValidationRequiredIf($parent);initTooltips($parent);initPopovers($parent);initSelect2($parent);initCollapseBlock($parent);initResetButton($parent);initSidebarToggle($parent);tryInitMultiLanguageSelector($parent);initAffix($parent);initTimeLeftIndicators($parent);initTableFields($parent);initInputMask($parent);initDurationField($parent);initDatesTogglingByRequiredIfAttribute($parent);var execEvent=new $.Event("initialized.common-init-api");$parent.trigger(execEvent)};commonModule.initClassifiers=function($parent){initClassifiers($parent)};commonModule.initClassifiersDependencies=function($parent){initClassifiersDependencies($parent)};commonModule.initTooltips=function($parent){initTooltips($parent)};commonModule.initPopovers=function($parent){initPopovers($parent)};commonModule.initDataTableTabs=function($grid){initDataTableTabs($grid)};commonModule.cutDropdownOptionsText=function($parent){cutDropdownOptionsText($parent)};commonModule.initTransposeGridForm=function(gridId){var $linkedForm=$("[data-linked-data-grid-id='"+gridId+"']");var gridSelector="#"+gridId;var getLoader=function(){return $(gridSelector).data("loader")};function checkTableScroll(){setTimeout(function(){var $grid=$(gridSelector);if(!$grid.hasClass("scroll-table-wrapper")&&$grid.parent().width()<$grid.width()){$grid.addClass("scroll-table-wrapper")}},0)}var resize=_.debounce(function(){checkTableScroll()},100);$(window).on("resize",resize);$linkedForm.on("submit",function(){checkTableScroll();var loader=getLoader();var data=[];var args={data:data};loader.model.onDataLoading.trigger(args)});$linkedForm.on("stateRestored.dataForm.data-api",function(){$(this).dataForm("submitData")});$linkedForm.on("submitted",function(e,isValid,dataResult){if(!isValid){return}var loader=getLoader();if(loader.isColumnMetadataDifferent(dataResult)){commonModule.recreateGrid(gridId,dataResult)}else{loader.setData(dataResult.Rows)}$(gridSelector).on("draw.dt",function(){FogSoft.Common.initTooltips($(gridSelector))});checkTableScroll()})};return module}(FogSoft||{},jQuery,Globalize||{},Cookies));!function($){var TypeaheadExt=function(element,options){this.$element=$(element);this.options=$.extend({},$.fn.typeaheadExt.defaults,options);this.matcher=this.options.matcher||this.matcher;this.sorter=this.options.sorter||this.sorter;this.highlighter=this.options.highlighter||this.highlighter;this.updater=this.options.updater||this.updater;this.$menu=$(this.options.menu).appendTo("body");this.source=this.options.source;this.$itemKeyField=this.options.itemKeyField;if(this.$itemKeyField&&!(this.$itemKeyField instanceof jQuery)){this.$itemKeyField=$(this.$itemKeyField)}this.parseSource();this.shown=false;this.listen()};TypeaheadExt.prototype={constructor:TypeaheadExt,parseSource:function(){if(this.source instanceof jQuery){if(this.source.length>0){if(this.source[0].tagName.toUpperCase()=="SELECT"){var arr=[];this.source.find("option").each(function(){arr.push({Id:$(this).attr("value"),Value:$(this).text()})});this.source=arr;this.itemKeyProp="Id";this.itemValueProp="Value"}else{arr=[];this.source.each(function(){arr.push({Id:$(this).attr(this.itemKeyProp),Value:$(this).text()})});this.itemKeyProp="Id";this.itemValueProp="Value"}}}if(typeof this.source=="string"){var path=this.source;var cachedData=[];var cachedQuery="\x9999";var hasAdditionalData=false;var timeOutId;var cachedQueryResults={};this.source=function(query,callback){if(cachedQuery==query||(cachedQueryResults[query]&&!hasAdditionalData)){var cachedResult=cachedQueryResults[query];callback(cachedResult);return}var pathLocal=path;clearTimeout(timeOutId);timeOutId=setTimeout(function(){var localQuery=query;$.post(pathLocal,{query:query},function(data){if(localQuery==query){cachedQuery=query;if(typeof data.HasAdditionalData!=="undefined"){hasAdditionalData=!!data.HasAdditionalData;cachedData=data.Content}else{cachedData=data;hasAdditionalData=false}cachedQueryResults[query]=cachedData;callback(cachedData)}})},300)}}},setKeyField:function(val){if(!this.$itemKeyField){return}var oldval=this.$itemKeyField.val();this.$itemKeyField.val(val);if(oldval!=val){this.$itemKeyField.change()}if(!val){if(!this.$element.hasClass("text-muted")){this.$element.addClass("text-muted")}}else{this.$element.removeClass("text-muted")}if(this.options.selectKey){var selectedItem;if(val&&this.options.itemKeyProp&&this.sourceItems){var that=this;$.each(this.sourceItems,function(i,e){if(e[that.options.itemKeyProp]==val){selectedItem=e}})}this.options.selectKey(selectedItem)}},select:function(){var val=this.$menu.find(".active").attr("data-value");this.$element.val(this.updater(val)).change();if(this.options.itemValueProp){var key=this.$menu.find(".active").attr("data-key");this.setKeyField(key)}return this.hide()},updater:function(item){return item},place:function(){var pos=$.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});this.$menu.css({top:pos.top+pos.height,left:pos.left})},show:function(){$(window).on("resize.typeahed.data-api",$.proxy(this.place,this));this.$element.closest(".modal-container").on("scroll.typeahed.data-api",$.proxy(this.place,this));this.place();this.$menu.show();this.shown=true;return this},hide:function(){$(window).off("resize.typeahed.data-api");this.$element.closest(".modal-container").off("scroll.typeahed.data-api");this.$menu.hide();this.shown=false;return this},lookup:function(event){var items;this.query=this.$element.val();if((typeof this.query==="string"&&this.query.length<this.options.minLength)||(typeof this.query!="string"&&!this.query)){this.setKeyField("");return this.shown?this.hide():this}items=$.isFunction(this.source)?this.source(this.query,$.proxy(this.process,this)):this.source;return items?this.process(items):this},process:function(items){var that=this;this.sourceItems=items;items=$.grep(items,function(item){return that.matcher(item)});items=this.sorter(items);if(!items.length){this.setKeyField("");return this.shown?this.hide():this}return this.render(items.slice(0,this.options.items)).show()},matcher:function(item){if(this.options.itemValueProp){return ~item[this.options.itemValueProp].toLowerCase().indexOf(this.query.toLowerCase())}return ~item.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(items){var beginswith=[],caseSensitive=[],caseInsensitive=[],item;while(item=items.shift()){if(this.options.itemValueProp){if(!item[this.options.itemValueProp].toLowerCase().indexOf(this.query.toLowerCase())){beginswith.push(item)}else{if(~item[this.options.itemValueProp].indexOf(this.query)){caseSensitive.push(item)}else{caseInsensitive.push(item)}}}else{if(!item.toLowerCase().indexOf(this.query.toLowerCase())){beginswith.push(item)}else{if(~item.indexOf(this.query)){caseSensitive.push(item)}else{caseInsensitive.push(item)}}}}return beginswith.concat(caseSensitive,caseInsensitive)},highlighter:function(item){var query=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");var it=item;if(this.options.itemValueProp){it=item[this.options.itemValueProp]}return it.replace(new RegExp("("+query+")","ig"),function($1,match){return"<strong>"+match+"</strong>"})},render:function(items){var that=this,addGroupItems=function(items){var ln=items.length,curGroupName;for(var i=0;i<ln;++i){if(!curGroupName||items[i].group!==curGroupName){curGroupName=items[i].group;items.splice(i,0,{name:curGroupName});++i;++ln}}};if(items&&items.length&&items[0].group){FogSoft.Common.quickSortObj(items,"group");addGroupItems(items)}items=$(items).map(function(i,item){if(item.name){i=$(that.options.item).addClass("group");i.html(item.name)}else{if(that.options.itemValueProp){i=$(that.options.item).attr("data-key",item[that.options.itemKeyProp]).attr("data-value",item[that.options.itemValueProp])}else{i=$(that.options.item).attr("data-value",item)}if(that.options.itemKeyProp){that.setKeyField(item[that.options.itemValueProp]==that.query?item[that.options.itemKeyProp]:"")}i.find("a").html(that.highlighter(item))}return i[0]});items.first().addClass("active");this.$menu.html(items);return this},next:function(event){var active=this.$menu.find(".active").removeClass("active"),next=active.next();if(!next.length){next=$(this.$menu.find("li")[0])}next.addClass("active")},prev:function(event){var active=this.$menu.find(".active").removeClass("active"),prev=active.prev();if(!prev.length){prev=this.$menu.find("li").last()}prev.addClass("active")},listen:function(){this.$element.on("focus",$.proxy(this.focus,this)).on("blur",$.proxy(this.blur,this)).on("keypress",$.proxy(this.keypress,this)).on("keyup",$.proxy(this.keyup,this));if($.browser.chrome||$.browser.webkit||$.browser.msie){this.$element.on("keydown",$.proxy(this.keydown,this))}this.$menu.on("click",$.proxy(this.click,this)).on("mouseenter","li",$.proxy(this.mouseenter,this)).on("mouseleave","li",$.proxy(this.mouseleave,this))},move:function(e){if(!this.shown){return}switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault();this.prev();break;case 40:e.preventDefault();this.next();break}e.stopPropagation()},keydown:function(e){this.suppressKeyPressRepeat=!~$.inArray(e.keyCode,[40,38,9,13,27]);this.move(e)},keypress:function(e){if(this.suppressKeyPressRepeat){return}this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown){return}this.select();break;case 27:if(!this.shown){return}this.hide();break;default:this.lookup()}e.stopPropagation();e.preventDefault()},focus:function(e){this.focused=true},blur:function(e){this.focused=false;if(!this.mousedover&&this.shown){this.hide()}},click:function(e){e.stopPropagation();e.preventDefault();this.select();this.$element.focus()},mouseenter:function(e){this.mousedover=true;this.$menu.find(".active").removeClass("active");$(e.currentTarget).addClass("active")},mouseleave:function(e){this.mousedover=false;if(!this.focused&&this.shown){this.hide()}}};$.fn.typeaheadExt=function(option){return this.each(function(){var $this=$(this),data=$this.data("typeahead"),options=typeof option=="object"&&option;if(!data){$this.data("typeahead",(data=new TypeaheadExt(this,options)))}else{$this.data("typeahead",(data=new TypeaheadExt(this,$.extend({},data.options,options))))}if(typeof option=="string"){data[option]()}})};$.fn.typeaheadExt.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1};$.fn.typeaheadExt.Constructor=TypeaheadExt;$(function(){$("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(e){var $this=$(this);if($this.data("typeahead")){return}e.preventDefault();$this.typeaheadExt($this.data())})})}(window.jQuery);(function($,localforage,sessionStorageWrapper){$.validator&&$.validator.setDefaults({onsubmit:false,ignore:""});function escapeAttributeValue(value){return value.replace(/([!"#$%&'\(\)\*\+,\.\/:;<=>?@\[\\\]^`{|}~])/g,"\\$1")}function getData(obj,name){obj[name]=obj[name]||{};return obj[name]}function getInputName($inputElement){var origName=$inputElement.data("origName");var name=escapeAttributeValue(origName?origName:$inputElement[0].name);return name}function inputHasError(form,$inputElement){var name=getInputName($inputElement);var data=getData(form,"inputHasErrors");return data[name]===true}function setInputError(form,$inputElement,hasError){var name=getInputName($inputElement);var data=getData(form,"inputHasErrors");data[name]=hasError}function onError(errorElement,$inputElement){var container=errorElement.data("unobtrusiveContainer");setInputError(this,$inputElement,true);var name=getInputName($inputElement);if(!container){container=$(this).find("[data-valmsg-for='"+name+"']");errorElement.data("unobtrusiveContainer",container)}var replaceAttrValue=container.data("valmsg-replace"),replace=replaceAttrValue?$.parseJSON(replaceAttrValue)!==false:null,$controlGroup=$inputElement.closest(".form-group");if(errorElement.text()){container.removeClass("field-validation-valid").addClass("field-validation-error");$controlGroup.addClass("error");if(replace){container.empty();errorElement.removeClass("input-validation-error").appendTo(container)}else{errorElement.hide()}}}function unhighlight(inputElement){var $inputElement=$(inputElement);var hasError=inputHasError(this,$inputElement);if(!hasError){return}setInputError(this,$inputElement,false);var name=getInputName($inputElement);var container=$(this).find("[data-valmsg-for='"+name+"']");if(container){var replaceAttrValue=container.data("valmsg-replace");var replace=replaceAttrValue?$.parseJSON(replaceAttrValue):null;if(replace){container.empty()}container.addClass("field-validation-valid").removeClass("field-validation-error");container.is(":hidden")&&container.css("display",null);var controlGroup=container.closest(".form-group");var $errorContainers=controlGroup.find(".field-validation-error");$errorContainers.first().css("display","");$errorContainers.slice(1).css("display","none");if($errorContainers.length===0){controlGroup.removeClass("error")}}}var ingoredFormFieldsForStateSaving=["__RequestVerificationToken"];var methods={setupValidation:function(reset){var $this=$(this);if($this.data("state-restore")==="none"){$this.trigger("additionalFiltersState.dataForm.data-api",[false])}if(reset===true){$this.removeData("unobtrusiveValidation").removeData("validator")}if(!$this.data("unobtrusiveValidation")){$.validator.unobtrusive.parse($this)}var validator=$this.validate();if(validator&&validator.settings){validator.settings.errorPlacement=$.proxy(onError,this);validator.settings.success=null;validator.settings.unhighlight=$.proxy(unhighlight,this);$this.unbind("invalid-form.validate",validator.invalidHandler)}},init:function(options){return this.each(function(){var $this=$(this),data=$this.data("dataForm"),opts=(data&&data.options)||{},runInitProcedure=!data;$this.methods=methods;if(runInitProcedure||options){opts=$.extend({},$.fn.dataForm.defaults,options);data={target:$this,options:opts};$this.data("dataForm",data)}if(runInitProcedure){methods.setupValidation.call($this);$this.submit(function(e){e.preventDefault();methods.submitData.call($this)});var gridId=$this.data("linkedDataGridId");if(gridId){var key=$this.data("full-storage-key");if(!key){key=$this.data("storageKey")+"_"+window.location.pathname+"_"+window.location.search}var storageInstance=localforage.createInstance({name:"DataForm"});var gridLoader=$("#"+gridId).data("loader");if(gridLoader&&gridLoader.model){if(gridLoader.model.onDataLoading){gridLoader.model.onDataLoading.subscribe(function(e,args){var valuesForStateSaving=methods.getValuesForStateSaving.call($this);storageInstance.setItem(key,valuesForStateSaving);$this.trigger($.Event("stateSaved.dataForm.data-api"),[valuesForStateSaving,key]);$.merge(args.data,methods.getValuesArray.call($this))})}if(gridLoader.model.onDataError){gridLoader.skipErrorHandling=true;gridLoader.model.onDataError.subscribe(function(e,args){args=args||{};if(args.xhr&&args.xhr.status!=200){opts.messageHandler&&opts.messageHandler.showErrorMessage(FogSoft.Common.messages.applicationError)}else{if(args.data){methods.processResult.call($this,args.data,args.textStatus)}}})}}var urlParameters=FogSoft.Common.getQueryParameters();var processFormState=!urlParameters.hasOwnProperty("process-form-state")||urlParameters["process-form-state"]===true;function refreshGrid(){if(gridLoader&&gridLoader.autoLoad!==false){gridLoader.refresh(false)}}if(processFormState){storageInstance.defineDriver(sessionStorageWrapper).then(function(){storageInstance.setDriver(sessionStorageWrapper._driver)}).then(function(){return storageInstance.getItem(key)}).then(function(values){$this.trigger($.Event("stateRestoring.dataForm.data-api"),[values]);if(values){methods.mergeValuesWithQueryString.call($this,values);methods.setValuesToFormFields.call($this,values)}$this.trigger($.Event("stateRestored.dataForm.data-api"),[values])}).then(function(values){$this.trigger($.Event("stateRestored.dataForm.data-api"),[values]);refreshGrid()})}else{refreshGrid()}}if($this.data("enableChangeTracking")===true){$this.on("change",':input[data-disable-change-tracking!="true"][do-not-post!="true"]',function(e){$(e.delegateTarget).data("hasChanges",true)});$(window).on("collectUnsavedFormsCallbacks",function(e,callbacks){if(methods.hasChanges.call($this)&&$.isArray(callbacks)){callbacks.push($.proxy(methods.submitData,$this))}})}$this.on("change",":input",function(e){$(e.currentTarget).data("changed",true)})}})},submitData:function(fromBatch){var $this=$(this),formId=$this.prop("id"),dataForm=$this.data("dataForm"),opts=(dataForm&&dataForm.options)||{},gridId=$this.data("linkedDataGridId"),dfd=$.Deferred(),isRunningInBatch=fromBatch===true,submittingFlagKey="submitting",promiseKey="promise";methods.clearErrors.call($this);if(!methods.validate.call($this)){dfd.reject(isRunningInBatch);return dfd}if(!$this.data("ajaxPost")){$this[0].submit();return true}opts.beforeSerialize&&opts.beforeSerialize.call($this);var gridLoader=$("#"+gridId).data("loader");if(gridId&&gridLoader.autoLoad!==false){var gl=$("#"+gridId).data("loader");gl&&gl.refresh(true,undefined);dfd.resolve(isRunningInBatch);return dfd}var submitFunc=function(frBatch){if($this.data("debounce")===true&&$this.data(submittingFlagKey)===true){return $this.data(promiseKey)}$this.data(submittingFlagKey,true);var df=$.Deferred(),ajaxOptions={type:$this.prop("method"),dataType:"json",data:methods.getValuesArray.call($this),withBlockUi:true,success:function(resp,status){methods.processResult.call($this,resp,status,this,df,frBatch)},processUnsuccessfulResult:function(resp,status){df.reject();methods.processResult.call($this,resp,status,this,df,frBatch)}};var url=$this.prop("action");if(url){ajaxOptions.url=url}$this.trigger($.Event("sending.dataForm.data-api"),[ajaxOptions]);$.ajax(ajaxOptions).fail($.proxy(df.reject,df,frBatch)).always(function(){$this.data(submittingFlagKey,false)});var promise=df.promise();$this.data(promiseKey,promise);return promise};var e=$.Event("submitting.dataForm.data-api");$this.trigger(e,[dfd]);if(e.isDefaultPrevented()||e.result===false){return dfd}if(opts.callbackHandler){var cbacks=opts.callbackHandler.collectCallbacks($this,"beforeSubmit"+(formId?"."+formId:""));dfd=opts.callbackHandler.executeCallbacksAndAction(function(){return submitFunc(isRunningInBatch)},null,cbacks,true,isRunningInBatch)}else{dfd=submitFunc(isRunningInBatch)}return dfd},processUnload:function(){if(methods.hasChanges.call($(this))){if(window.ignoreUnsavedChanges||confirm(FogSoft.Common.messages.unsavedChangesConfirmMessage)){return true}else{return false}}return true},hasChanges:function(){return $(this).data("hasChanges")===true},setChanged:function(flag){return this.each(function(){$(this).data("hasChanges",flag===true)})},clearErrors:function($container){$container=$container||$(this);var cg=$container.find(".form-group.has-error");cg.find(".help-block").empty().addClass("field-validation-valid").removeClass("field-validation-error");cg.removeClass("error");$container.find(".errors-container").hide()},showErrors:function(errors){var errCount=0;if(!errors){return errCount}var $this=$(this);var validatorErrors={};$.each(errors,function(){var key=this.Key;if(key){var ctrl=$this.find('[name="'+key+'"]').first();var accocCtrl=$this.find('[data-orig-name="'+key+'"]');var elementToShowErrorWasFind=false;if(ctrl.length==1){if(ctrl.is(":hidden")){if(accocCtrl.length==1){key=accocCtrl.attr("name")}}elementToShowErrorWasFind=true}else{if(accocCtrl.length==1){key=accocCtrl.attr("name");elementToShowErrorWasFind=true}else{this.Key=null}}if(elementToShowErrorWasFind){validatorErrors[key]=this.Text;errCount++}else{this.Key=null}}});var validator=$this.validate();validator.showErrors(validatorErrors);validator.focusInvalid();return errCount},showSummary:function(errors,options){var errCount=0;if(!errors){return errCount}if($.isArray(errors)&&errors.length>0){var $frm=$(this),dataForm=$frm.data("dataForm"),opts=(dataForm&&dataForm.options)||{},container=$frm.find(".validation-summary"),list=container.find("ul"),errList=$.grep(errors,function(el){return el&&!el.Key});errCount=errList.length;if(list.length>0){list.empty();var showSmry=false;$.each(errList,function(){$("<li />").html(this.Text).appendTo(list);showSmry=true});if(showSmry){container.addClass("validation-summary-errors").removeClass("validation-summary-valid")}}else{if(opts.messageHandler){opts.messageHandler.showErrorMessage(errList,null,$frm.closest(".modal-body"),options&&(options.tags||options.url))}}}return errCount},hideSummary:function(){$(this).find(".validation-summary.validation-summary-errors").addClass("validation-summary-valid").removeClass("validation-summary-errors")},validate:function(){var $this=$(this);var validator=$this.validate();var result=validator.form();if(result){methods.hideSummary.call($this)}else{validator.focusInvalid()}$this.trigger("validated",[result]);return result},processResult:function(resp,status,reqOpts,deferred,fromBatch){var $this=$(this),dataForm=$this.data("dataForm"),opts=(dataForm&&dataForm.options)||{},isRunningInBatch=fromBatch===true;if(resp.RedirectUrl&&!isRunningInBatch){methods.setChanged.call(this,false);FogSoft.Common.goTo(resp.RedirectUrl);return}if(resp.Data&&resp.Data.Timestamp){$this.find('input[name="Timestamp"]').val(resp.Data.Timestamp)}var errCount=0;var processMessageCfg={showError:$.proxy(function(msgColl,opt){errCount=methods.showErrors.call(this,msgColl,opt);errCount+=methods.showSummary.call(this,msgColl,opt)},this)};if(isRunningInBatch){processMessageCfg.showSuccess=$.noop}if(opts.messageHandler){opts.messageHandler.processEvents(resp,isRunningInBatch);opts.messageHandler.processMessages(resp,$.extend({},reqOpts,processMessageCfg))}if(status!="success"||!resp.Success){opts.error&&opts.error.call($this,resp);deferred&&deferred.reject&&deferred.reject(isRunningInBatch)}else{methods.setChanged.call(this,false);opts.success&&opts.success.call($this,resp);deferred&&deferred.resolve&&deferred.resolve(isRunningInBatch)}$this.trigger("submitted",[errCount==0,resp]);FogSoft.Common.unblockUi()},getValuesArray:function(){var $form=$(this);var toPost=$form.formToArray();var doNotPost=$.map($("[do-not-post]"),function(el){return{name:el.name,value:$.fieldValue(el,true)}});var values=toPost.filter(function(el){var ignored=false;for(var i=0;i<doNotPost.length;i++){if((doNotPost[i].name==el.name&&doNotPost[i].value==el.value)){ignored=true;break}}return !ignored});$form.trigger("getValuesArray",[values]);return values},getValuesForStateSaving:function(forceSave){var valuesForStateSaving=this.find(":input").filter(function(idx,el){return el.name&&!el.disabled&&$(el).closest("[data-process-state=False]").length===0&&$(el).is(':not([do-not-post="true"])')&&ingoredFormFieldsForStateSaving.indexOf(el.name)==-1&&($(el).data("changed")||forceSave)}).map(function(idx,el){var item={name:el.name,hidden:el.type==="hidden",id:el.id,text:$(el).data("text")};if(el.type==="checkbox"){item.value=$(el).is(":checked").toString()}else{if(el.type==="radio"){if($(el).is(":checked")){item.value=$(el).val()}else{return}}else{var dataSet=$(el).data();var fieldValue=$(el).val();if(dataSet.type==="date"&&dataSet.dateFormat&&fieldValue){item.value=window.Globalize.parseDate(fieldValue,dataSet.dateFormat).toISOString()}else{item.value=fieldValue}}}return item}).get();return valuesForStateSaving},reset:function(){var re=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;var result=this.each(function(){var $form=$(this);$form.trigger($.Event("formClearing.dataForm.data-api"));$form.find(".autocomplete").each(function(){var $self=$(this);var defaultValue=$self.data("defaultValue")||"";$self.find("input").each(function(){$(this).val(defaultValue)})});$form.find("input,select,textarea").not(":disabled,[readonly]").each(function(){var t=this.type,tag=this.tagName.toLowerCase(),$self=$(this),prevValue,defaultValue=$self.data("defaultValue")||"",$skipFormReset=$self.data("skipFormReset");if($skipFormReset){return true}if(re.test(t)||tag=="textarea"){prevValue=$self.val();this.value=defaultValue;prevValue!=this.value&&$self.change()}else{if(t=="checkbox"){prevValue=this.checked;this.checked=defaultValue;prevValue!=this.checked&&$self.change()}else{if(t=="radio"){var checked=$self.attr("checked")!==undefined;$self.prop("checked",checked).change()}else{if(tag=="select"){var $opt=$self.find('option[value="'+defaultValue+'"]');prevValue=this.selectedIndex;this.selectedIndex=$opt.length?$opt.prevAll().length:-1;prevValue!=this.selectedIndex&&$self.change()}}}}})});methods.submitData.call(this);return result},mergeValuesWithQueryString:function(values){var queryValues=FogSoft.Common.getQueryParameters();$.each(values,function(idx,valuesItem){if(!valuesItem.hidden){$.each(queryValues,function(queryKey,queryValue){if(queryKey.toLowerCase()===valuesItem.name.toLowerCase()){valuesItem.value=queryValue}})}})},setValuesToFormFields:function(values){var showAdditionalFilters=false;var form=this;for(var i=0;i<values.length;i++){var element=values[i];var selector;if(element.hidden){selector="[name='"+element.name+"'][type='hidden']"}else{selector="[name='"+element.name+"']:not([type='hidden'])"}var formElement=this.find(selector);if(!element.processed){if(formElement.length>0){var oldValue;var newValue;var formElementType=formElement.prop("type");if(formElementType==="checkbox"){oldValue=formElement.prop("checked");newValue=element.value.toLowerCase()==="true";var checkBox=jQuery.grep(formElement,function(item){var checkBoxId=$(item)[0].id;return checkBoxId===element.id});$(checkBox).prop("checked",newValue)}else{if(formElementType==="radio"){var radioButton=jQuery.grep(formElement,function(item){var radioButtonValue=$(item).val();return radioButtonValue===element.value});$(radioButton).prop("checked","checked")}else{if(formElementType==="select-one"){oldValue=formElement.val();newValue=element.value;var newValueExists=newValue&&formElement.find("option[value="+newValue+"]").length>0;if(newValueExists){formElement.val(newValue)}}else{oldValue=formElement.val();var dataSet=formElement.data();if(dataSet.type==="date"&&dataSet.dateFormat&&element.value){newValue=FogSoft.Common.formatDateTime(new Date(element.value),dataSet.dateFormat)}else{newValue=element.value}formElement.val(newValue)}}}if(newValue!==oldValue){formElement.trigger("change");element.restored=true;if(formElement.closest(".additional-fields.collapse").length){showAdditionalFilters=true}}}}else{var additionalFieldsBlock=formElement.closest(".additional-fields.collapse:not(.in)");if(additionalFieldsBlock.length){showAdditionalFilters=true}}}if(showAdditionalFilters){methods.toggleAdditionalFields.call(form,true)}},resetFormElementChangedStatus:function(storedFieldValues){var $form=$(this);$form.find(":input").each(function(idx,el){var fieldChangedStatus=false;$(storedFieldValues).each(function(index,field){if(field.name===el.name){fieldChangedStatus=true}});var $el=$(el);$el.data("changed",fieldChangedStatus)})},toggleAdditionalFields:function(flag){var $form=$(this);var stateRestoreBehavior=$form.data("state-restore");if(stateRestoreBehavior==="none"){return}var additionalFieldsBlock;if(flag){additionalFieldsBlock=$form.find(".additional-fields.collapse:not(.in)")}else{additionalFieldsBlock=$form.find(".additional-fields.collapse.in")}if(additionalFieldsBlock.length){var triggerSelector=additionalFieldsBlock.data("trigger");triggerSelector&&$(triggerSelector).trigger("click");$form.trigger("additionalFiltersState.dataForm.data-api",[flag])}},restoreFields:function(values){var $form=$(this);if(!values||!values.length){return}$form.dataForm("setValuesToFormFields",values);$form.trigger($.Event("stateRestoring.dataForm.data-api"),[values])}};$.fn.dataForm=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof method==="object"||!method){return methods.init.apply(this,arguments)}else{return $.error('Method "'+method+'" does not exist on jQuery.dataForm')}}};$.fn.dataForm.defaults={}})(jQuery,window.localforage,window.sessionStorageWrapper);var Fogsoft=(function(module,$){var gridModule=module.DataGrid=module.DataGrid||{},commonModule=module.Common||{};function getCompiledTemplate(tmplStr){var tmpl;if(tmplStr.indexOf("${")==0){tmpl=$("<span></span>").text(tmplStr).template()}else{tmpl=$.template(tmplStr.indexOf("#")==0?$(tmplStr):$("<div/>").append(tmplStr))}return tmpl}function dataGridLoader($container,columns,options){var self,model,grid,$grid,$gridStatus;var templateCache={};function init(){$grid=$("<div class='fs-datagrid-content'></div>").appendTo($container);if(options.showStatusRow){$gridStatus=$("<div class='fs-datagrid-status'></div>").appendTo($container)}if(options.buttons&&options.buttons.length){var $btnBar=$('<div class="fs-datagrid-toolbar clearfix"></div>').prependTo($container);var $toolBar=$('<div class="btn-toolbar pull-left"></div>').appendTo($btnBar);$.each(options.buttons,function(i,btn){var $btn=$('<button class="btn btn-xs" type="button"></button>').appendTo($toolBar);btn.cssClass&&$btn.addClass(btn.cssClass);btn.iconCssClass&&$btn.append('<i class="'+btn.iconCssClass+'"></i>');btn.text&&$btn.append(" "+btn.text);btn.attributes&&$btn.attr(btn.attributes);if(btn.beforeEvent||btn.event){$btn.on("click",function(){var $this=$(this);if(btn.beforeEvent){var e=$.Event(btn.beforeEvent,{relatedTarget:$this});$container.trigger(e);if(e.isDefaultPrevented()||e.result===false){return}}btn.event&&$container.trigger({type:btn.event,relatedTarget:$this,args:$this.data()})})}})}options.formatterFactory={getFormatter:function(){return function(row,cell,value,columnDef,dataContext){var renderTemplate=function(_tmpl,tmplOptions){var compiledTmpl=templateCache[columnDef.id||_tmpl];if(!compiledTmpl){compiledTmpl=getCompiledTemplate(_tmpl);if(compiledTmpl&&$.type(compiledTmpl)=="function"){templateCache[columnDef.id||_tmpl]=compiledTmpl}}return compiledTmpl?$.tmpl(compiledTmpl,dataContext,tmplOptions):$()};var templateOptions={row:row,cell:cell,value:value,columnDef:columnDef,common:commonModule};if(columnDef.template){value=$("<div/>").append(renderTemplate(columnDef.template,templateOptions)).html()}else{if(columnDef.dataType=="Bool"||columnDef.dataType=="Boolean"){value=commonModule.formatBoolean(value,columnDef.pattern)}else{if(columnDef.dataType=="Number"||columnDef.dataType=="Money"){value=commonModule.formatNumber(value,columnDef.pattern,columnDef.dataType)}else{if(columnDef.dataType&&(columnDef.dataType.indexOf("Date")!=-1||columnDef.dataType.indexOf("Time")!=-1)){value=commonModule.formatDateTime(value,columnDef.pattern,columnDef.dataType)}}}}templateOptions.value=value;if(columnDef.url||columnDef.action){var $a=$("<a></a>");var href="",onclick="";if(columnDef.url){href=columnDef.url}if(columnDef.action){if(!columnDef.url){href="#"}onclick=columnDef.action}href&&$a.attr("href",href);onclick&&$a.prop("onclick",onclick);$a.html("${$item.value}");var tmpl=$a.wrap("<div>").parent().html();var $link=renderTemplate(tmpl,templateOptions).first();if($link.attr("href")){return $link.wrap("<div>").parent().html()}}return value}}};model=options.loadDataUrl?new Slick.Data.RemoteModel(options):new Slick.Data.DataView(options);var checkboxSelector=null,isRowSelectionModel=options.selectionModel=="row";if(isRowSelectionModel&&options.selectionWidget){checkboxSelector=options.selectionWidget=="Checkbox"?new Slick.CheckboxSelectColumn({cssClass:"slick-cell-checkboxsel",toolTip:options.checkboxTooltip}):new Slick.RadioSelectColumn({cssClass:"slick-cell-checkboxsel"});columns.unshift(checkboxSelector.getColumnDefinition())}setDataMetadataProvider(resolveCssClassProvider(options.rowCssClassProvider));grid=new Slick.Grid($grid,model.getItems?model.getItems():model.data,columns,options);grid.setSelectionModel(isRowSelectionModel?new Slick.RowSelectionModel():new Slick.CellSelectionModel());if(checkboxSelector){grid.registerPlugin(checkboxSelector)}grid.registerPlugin(new Slick.AutoTooltips());grid.registerPlugin(new Slick.HighlightSortColumn());grid.onViewportChanged.subscribe(function(){if(model.ensureData){var vp=grid.getViewport();model.ensureData(vp.top,vp.bottom)}});grid.onSort.subscribe(function(e,args){if(model.ensureData){var vp=grid.getViewport();model.setSorting(args.sortCol,args.sortAsc);model.ensureData(vp.top,vp.bottom).fail(function(){grid.invalidateAllRows()})}else{if(model.fastSort){model.sort(function(a,b){var x=a[args.sortCol.field],y=b[args.sortCol.field];return(x==y?0:(x>y?1:-1))},args.sortAsc);grid.invalidateAllRows();grid.render()}}});if(model.onDataError){model.onDataError.subscribe(function(e,args){if(self.skipErrorHandling||!args){return}if(args.xhr&&args.xhr.status!=200){commonModule.showErrorMessage(FogSoft.Common.messages.applicationError)}else{if(args.data){commonModule.processResult(args.data)}}})}if(model.onDataLoaded){model.onDataLoaded.subscribe(function(e,args){grid.invalidateAllRows();if(args.data.Paging){grid.setSortColumn(args.data.Paging.SortColumn,args.data.Paging.SortAsc)}render();refreshGridStatus()})}else{if(model.onPagingInfoChanged){model.onPagingInfoChanged.subscribe(function(){refreshGridStatus()})}}grid.onSelectedRowsChanged.subscribe(function(){refreshGridStatus();$(document.body).trigger("selectedRowsChanged."+options.id)});grid.onCellChange.subscribe(function(e,args){if(args&&args.item){var node=grid.getCellNode(args.row,args.cell);if(node){$(node).addClass("selected")}args.item._changed=true}});if(grid.onSelectAll){grid.onSelectAll.subscribe(function(e,args){if(args.selected&&model.ensureData){var limit=Math.max(options.selectAllSizeLimit||0,options.pageSize||0),recCount=grid.getDataLength()||0;if(limit<=0){return}var result=model.ensureData(0,Math.min(recCount,limit)-1);if(result&&result.state){args.deferred=result}if(limit<recCount){args.limit=limit;var msg=$.tmpl(options.selectAllSizeLimitExceedMessage,args).text();msg&&commonModule.alert(msg)}}})}$container.on("refresh.datagrid.data-api",refresh);$container.on("export.datagrid.data-api",exportData)}function render(){grid.updateRowCount();grid.render();if(options.forceFitColumns){grid.autosizeColumns()}}function setDataMetadataProvider(provider){var data=model.getItems?model.getItems():model.data;if(!data||$.type(provider)!="function"){return}var getItemMetadataBase=data.getItemMetadataInternal;data.getItemMetadataInternal=function(row){var metadata=(getItemMetadataBase&&getItemMetadataBase(row))||{};var anotherMetadata=provider(row)||{};return $.extend(true,{},metadata,anotherMetadata)};if(!data.getItemMetadata){data.getItemMetadata=function(rowIndex){return data.length>rowIndex?data.getItemMetadataInternal(data[rowIndex]):null}}}function resolveCssClassProvider(prov){if(!prov){return null}if($.isFunction(prov)){return prov}var resolved=null;if(typeof(prov)=="string"){prov=$.trim(prov);if(!prov){return null}if(prov.lastIndexOf("function")==0){try{resolved=eval("("+prov+")")}catch(e){resolved=null}}else{var objParts=prov.split(".");var foundObj=window;for(var i=0;i<objParts.length;i++){if(foundObj[i]){foundObj=foundObj[i]}else{foundObj=null;break}}if(foundObj&&$.isFunction(foundObj)){resolved=foundObj}}if(!resolved){resolved=function(row){return row&&row[prov]}}}return resolved}function setRowCssClassProvider(prov){var provider=resolveCssClassProvider(prov);if(provider){setDataMetadataProvider(function(row){var cssCls=provider(row);return cssCls&&{cssClasses:cssCls}})}}function initHandlers(){if(options.eventHandlers){$.each(options.eventHandlers,function(index,eh){$(document.body).on(eh.eventName+"."+options.id,function(){var gridEl=$("#"+options.id);if(!gridEl.length){$(document.body).off(eh.eventName+"."+options.id)}else{return eh.handler.apply(self,Array.prototype.slice.call(arguments))}})})}}function refreshGridStatus(){if($gridStatus){var data={totalCount:grid.getDataLength()||0,selectedCount:(grid.getSelectedRows()||[]).length};$gridStatus.empty();$.tmpl(options.statusRowTemplate,data,{common:commonModule}).appendTo($gridStatus)}}function refresh(){model.clear&&model.clear();if(model.ensureData){var vp=grid.getViewport();model.ensureData(vp.top,vp.bottom)}}function validateSelectionExists(id,errorMessage,e){if(grid.getSelectedRows().length>0){return true}commonModule.showErrorMessage(errorMessage||FogSoft.Common.messages.dataGridNoSelectedRowsError);e.stopImmediatePropagation();return false}function getSelectedData(dataColumns){var idOnly=false,opt=grid.getOptions()||{},idProp=opt.objectIdProperty,selectedData=[],selectedIndexes=grid.getSelectedRows();if(dataColumns===true){dataColumns=idProp?[idProp]:[];idOnly=true}else{dataColumns=$.map(arguments,function(el){if($.type(el)==="string"&&el){return el}})}var shouldFilter=dataColumns.length>0;$.each(selectedIndexes,function(index,selectedIndex){var dataRow=model.getData?model.getData(selectedIndex):model.getItemByIdx(selectedIndex),filteredData={};if(shouldFilter){if(dataRow!=null){if(idOnly){filteredData=dataRow[dataColumns[0]]}else{$.each(dataColumns,function(i,v){filteredData[v]=dataRow[v]})}}}else{filteredData=dataRow}selectedData.push(filteredData)});return selectedData}function setData(data,forceUpdate){model.setItems&&model.setItems(data,null,forceUpdate);forceUpdate&&grid.invalidateAllRows()}function selectAllRows(){var rows=[];for(var i=0;i<grid.getDataLength();i++){rows.push(i)}grid.setSelectedRows(rows)}function selectRowByIndex(indexes){if(!$.isArray(indexes)){indexes=[indexes]}grid.setSelectedRows(indexes)}function clearSelection(){grid.setSelectedRows([]);grid.resetActiveCell()}function getChangedData(){var changedData=[];if(model.getItems){$.each(model.getItems(),function(index,item){if(item._changed){changedData.push(item)}})}return changedData}function getRowData(row){return model.getData?model.getData(row):model.getItemByIdx(row)}function executeAction(opts,mode){opts.mode=opts.mode||"selection";var selectedItems=(opts.mode=="changes")?getChangedData():getSelectedData();if(selectedItems.length>0){if(!opts.confirmMessage||confirm(opts.confirmMessage)){commonModule.postJson(opts.url,selectedItems);if(mode=="selection"){grid.setSelectedRows([])}}}else{alert(opts.rowsNotSelectedError)}}function addVerificationToken(postData){var tokenName="__RequestVerificationToken";if(_.some(postData,(function(x){return x.name==tokenName}))){return}var tokenValue=$('form input[name="'+tokenName+'"]').val();postData.push({name:tokenName,value:tokenValue})}function exportData(exportType){if(model.onDataLoading){var cType=$.type(exportType)=="string"?exportType:(exportType&&exportType.args&&exportType.args.exportType)||"text/csv",sorting=$.map(model.getSorting(),function(v,k){return{name:k,value:v}}),postData=[{name:"offset",value:0},{name:"limit",value:65536},{name:"X-HTTP-Accept-Override",value:cType}].concat(sorting);model.onDataLoading.notify({from:0,to:0,data:postData});addVerificationToken(postData);commonModule.blockUi();$.fileDownload(options.loadDataUrl,{httpMethod:"POST",data:postData,successCallback:commonModule.unblockUi,failCallback:commonModule.unblockUi,clearCookieBeforeDownload:true})}}init();self={model:model,grid:grid,skipErrorHandling:false,render:render,refresh:refresh,getSelectedData:getSelectedData,validateSelectionExists:validateSelectionExists,setData:setData,getChangedData:getChangedData,getRowData:getRowData,selectAllRows:selectAllRows,selectRowByIndex:selectRowByIndex,clearSelection:clearSelection,executeAction:executeAction,setRowCssClassProvider:setRowCssClassProvider,setDataMetadataProvider:setDataMetadataProvider};$(document.body).trigger("initializing."+options.id,[self]);initHandlers();$(document.body).trigger("initialized."+options.id,[self]);grid.init();if(options.data){refreshGridStatus();var sorting=options.data.Paging||{};if(sorting.SortColumn){grid.setSortColumn(sorting.SortColumn,sorting.SortAsc)}}if(options.autoLoad&&!options.data){var linkedForm=$("[data-linked-data-grid-id='"+options.id+"']");if(linkedForm.length){}else{refresh()}}return self}gridModule.Loader=dataGridLoader;gridModule.Loader.defaults={autoLoad:false,pageSize:500,selectAllSizeLimit:5000,selectAllSizeLimitExceedMessage:$("#fs-datagrid-select-limit-exceeded-message").template(),forceFitColumns:!$.browser.msie||parseInt($.browser.version)>7,enableColumnReorder:false,showStatusRow:true,statusRowTemplate:"#fs-datagrid-status"};gridModule.Loader.set=function($container,options){var defaults=$.extend({checkboxTooltip:commonModule.messages.dataGridSelectDeselectAll,loadingIndicatorLabel:commonModule.messages.dataGridLoadingIndicatorLabel},gridModule.Loader.defaults,options);defaults.explicitInitialization=true;if(defaults.multiSelect&&defaults.selectionModel=="row"){defaults.statusRowTemplate="#fs-datagrid-status-and-select"}if($.type(defaults.statusRowTemplate)=="string"){defaults.statusRowTemplate=getCompiledTemplate(defaults.statusRowTemplate)}$.each(defaults.columns,function(){this.field=this.id;if(this.dataType){this.cssClass=[this.cssClass," dataType-"+this.dataType].join(" ");String.prototype.trim&&this.cssClass.trim()}if(!defaults.selectionModel){this.selectable=false}if(this.formatter&&$.type(this.formatter)=="string"){if($.isFunction(gridModule[this.formatter])){this.formatter=gridModule[this.formatter]}else{if($.isFunction(commonModule[this.formatter])){this.formatter=commonModule[this.formatter]}else{if($.isFunction(window[this.formatter])){this.formatter=window[this.formatter]}else{this.formatter=null}}}}});var loader=new gridModule.Loader($container,$.grep(defaults.columns,function(el){return el.visible}),defaults);$container.data("loader",loader);if(!defaults.forceFitColumns){loader.grid.autosizeColumns()}return loader};gridModule.Loader.get=function($container){return $container.data("loader")};return module}(FogSoft||{},jQuery));(function($){var rowSelector=".data-list-row";var subscribe=function(dataList,eventName,handler,css){css&&dataList.find(rowSelector).css(css);dataList.on(eventName,rowSelector,function(e){handler.call(this,e,$(this).data("model"))})};var methods={init:function(options){var defaults=$.extend({},options);this.each(function(){var $dataList=$(this);$.isFunction(defaults.click)&&subscribe($dataList,"click",defaults.click,{cursor:"pointer"});$.isFunction(defaults.mouseover)&&subscribe($dataList,"mouseenter",defaults.mouseover)});return this},getSelectedData:function(){var selectedData=[];this.each(function(){$(this).find(rowSelector).each(function(){var row=$(this);if(row.find("input:checkbox").first().is(":checked")){selectedData.push(row.data("model"))}})});return selectedData}};$.fn.dataList=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof method==="object"||!method){return methods.init.apply(this,arguments)}else{return $.error('Method "'+method+'" does not exist on jQuery.dataList')}}}})(jQuery);(function($){function init(options){return this.each(function(){var $block=$(this),cfg=$.extend(true,options||{},$block.data()),targetSelector=cfg.target,$target=targetSelector?$block.find(targetSelector):$();cfg.contentTarget=$target.length?$target:null;$block.data(cfg);var isInitiallyCollapsed=$block.data("initiallyCollapsed");if(isInitiallyCollapsed){loadCollapsedContent($block)}$block.data("autoLoad")&&!$block.data("loaded")&&!isInitiallyCollapsed&&loadContent($block);var refreshEventName=$block.data("refresh-event");if(refreshEventName){$(document).on(refreshEventName,function(){FogSoft.Common.refreshContainer($block)})}})}function load(url,forceReload){if($.type(url)=="boolean"){forceReload=url;url=null}return this.each(function(){var $block=$(this);url&&$block.data("url",url);if(forceReload===true||url||!$block.data("loaded")){loadContent($block)}else{$block.trigger("activated")}})}function loadContent($block){var url=$block.data("url");var $target=$block.data("contentTarget")||$block;var loadParams=$block.data("loadParams");var renderType=$block.data("renderType");if(!url){return}var opt={type:"POST",data:loadParams,headers:{"X-Content-Requested-For":renderType},processResult:function(data,status,jqXhr){$block.trigger("content-loaded.dataBlock.data-api",[data,jqXhr,$block,$target]);if($.type(this.dataHandler)=="function"){this.dataHandler(data,jqXhr,$block,$target)}else{$target.html(data);setTimeout(function(){FogSoft.Common.init($target);$(document.body).trigger("initialized.dataBlock.data-api",$target)},0)}$block.data("loaded",true).trigger("loaded.dataBlock.data-api",[data,jqXhr,$block,$target])}};if($target.hasClass("tab-pane")){opt.headers={"X-Content-Requested-For":"Tab"}}var e=$.Event("loading.dataBlock.data-api");$block.trigger(e,[opt]);if(e.isDefaultPrevented()||e.result===false){return}$.ajax(FogSoft.Common.cacheUrl(url),opt)}function loadCollapsedContent($block){$block.on("shown",function(){if(!$block.data("loaded")){loadContent($block)}})}var methods={init:init,load:load};$.fn.dataBlock=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof method==="object"||!method){return methods.init.apply(this,arguments)}else{return $.error('Method "'+method+'" does not exist on jQuery.dataBlock')}}}})(jQuery);(function($){var templPropName="dataTemplates";function init(options){if(!$.tmpl){return this}return this.each(function(){var $this=$(this),defaults={templates:$this.data("templates"),applyTemplatesOnInit:true},dataTemplObj=$this.data(templPropName),opts=$.extend(true,defaults,options||{});if(!dataTemplObj){dataTemplObj={options:opts,compiledTemplates:{}};if(opts.templates){$.each(opts.templates,function(key,val){var templ=val&&val.substr(0,1)=="#"?$(val):val;if(templ){dataTemplObj.compiledTemplates[key]=$.template(null,templ)}})}if(!opts.modelSource){dataTemplObj.modelSource=$this.data("model")?$this:$this.find("[data-model]")}else{if($.type(opts.modelSource)=="string"){dataTemplObj.modelSource=$this.find(opts.modelSource)}else{if($.isFunction(opts.modelSource)){dataTemplObj.modelSource=opts.modelSource.call(this)}else{dataTemplObj.modelSource=opts.modelSource}}}$this.data(templPropName,dataTemplObj)}if(opts.applyTemplatesOnInit){applyTemplatesInternal(dataTemplObj.compiledTemplates,dataTemplObj.modelSource,opts.model)}})}function applyTemplates(){return this.each(function(){var $this=$(this),dataTemplObj=$this.data(templPropName),$modelSrc=dataTemplObj&&dataTemplObj.modelSource,model=dataTemplObj&&dataTemplObj.options&&dataTemplObj.options.model,templates=dataTemplObj&&dataTemplObj.compiledTemplates;applyTemplatesInternal(templates,$modelSrc,model)})}function applyTemplatesInternal(templates,$modelSrc,model){if($modelSrc&&templates){$modelSrc.each(function(){var $src=$(this),mdl=model||$src.data("model");if(mdl){$.each(templates,function(key,val){$src.find('[data-apply-template="'+key+'"]').empty().append($.tmpl(val,mdl))})}})}}var methods={init:init,applyTemplates:applyTemplates};$.fn.dataTemplate=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof method==="object"||!method){return methods.init.apply(this,arguments)}else{return $.error('Method "'+method+'" does not exist on jQuery.dataTemplate')}}}})(jQuery);(function($){var openClassName="open",dataCacheName="notificationArea",totalCountCacheName="notificationCount",latestCountCacheName="latestNotificationCount",stackCountCacheName="stackNotificationCount",appendedEventName="appended.notificationArea",removedEventName="removed.notificationArea",appendInternalEventName="appendInternal",removeInternalEventName="removeInternal";function init(options){options=$.extend(true,{},$.fn.notificationArea.defaults,options);return this.each(function(){var $this=$(this),data=$this.data(dataCacheName);if(!data){var template=options.areaTemplate,$areaInnards=template?$($.isFunction(template)?template(options):template):$this,triggerOpts=options.areaTrigger||{},controlArea=$areaInnards.find("[data-notification-control]"),inlineMsgs=$this.children().detach(options.notificationSelector);options.areaTemplate&&$this.append($areaInnards);data={options:options,trigger:$(triggerOpts.trigger),latestArea:$areaInnards.find("[data-notification-latest]"),stackArea:$areaInnards.find("[data-notification-stack]"),controlArea:controlArea,controls:{showStack:controlArea.find('[data-toggle-stack="show"]'),hideStack:controlArea.find('[data-toggle-stack="hide"]'),emptyListBlock:controlArea.find("[data-empty-list-text]"),alertCount:$(triggerOpts.trigger).find("span")}};$this.data(dataCacheName,data);bindEvents($this,data);addNotificationInternal($this,inlineMsgs);addNotificationInternal($this,$this.data("notifications"))}})}function bindEvents($area,data){var $controlArea=data.controlArea,$areaTrigger=data.trigger,options=data.options;$areaTrigger.on("click.notificationArea",function(e){e.preventDefault();toggleAreaInternal($area,$(this))});$area.on(appendInternalEventName,data,appendEventHandler).on(removeInternalEventName,data,removeEventHandler).on("close.bs.alert",options.notificationSelector,function(e){removeNotificationInternal($(e.delegateTarget),$(this))});$controlArea.on("click.notificationArea","[data-clear-trigger]",function(){removeNotificationInternal($area,$area.find(options.notificationSelector))}).on("click.notificationArea","[data-toggle-trigger]",function(e){var $parent=$(e.target).closest("[data-toggle-stack]").first(),controls=data.controls;if($parent.is(controls.showStack)){data.stackArea.addClass("open");controls.showStack.hide();controls.hideStack.show()}else{if($parent.is(data.controls.hideStack)){data.stackArea.removeClass("open");controls.hideStack.hide();controls.showStack.show()}}})}function appendEventHandler(e){e.stopImmediatePropagation();var $area=$(this),data=e.data||{},options=data.options||{},latestCnt=getNotificationCountInternal($area,true),maxCnt=data.options.latestNotificationMaxCount||1;if(maxCnt-latestCnt<=0){moveNotifications(data.latestArea,data.stackArea,function(src){return src.find(options.notificationSelector).last()})}}function removeEventHandler(e,$msg){e.stopImmediatePropagation();var $area=$(this),data=e.data||{},options=data.options||{};if($msg&&$msg.length==1&&$msg.parentsUntil($area).is(data.latestArea)){moveNotifications(data.stackArea,data.latestArea,function(src){return src.find(options.notificationSelector).first()},true)}}function toggleControlsInternal($area,controls){var stackCnt=getNotificationCountInternal($area,false),count=getNotificationCountInternal($area),cntrl=controls||{},showStack=cntrl.showStack,hideStack=cntrl.hideStack,alertCount=cntrl.alertCount;if(stackCnt>0){showStack.find("[data-notification-count]").text(stackCnt);hideStack.is(":hidden")&&showStack.show()}else{showStack.hide();hideStack.hide()}count?alertCount.text(count):alertCount.text("");cntrl.emptyListBlock.toggle(count==0)}function toggleAreaInternal($area,trigger,toggle,autoTriggered){if($.type(trigger)=="boolean"){autoTriggered=toggle;toggle=trigger;trigger=null}var opened=$area.hasClass(openClassName),dur=300,shouldShow=toggle===true?true:toggle===false?false:!opened;var data=$area.data(dataCacheName)||{},options=data.options||{},handler=options.areaTrigger&&options.areaTrigger.handler,preEvent=(shouldShow?"open":"close")+".notificationArea",postEvent=(shouldShow?"opened":"closed")+".notificationArea";var res=$area.triggerHandler(preEvent);if(res!==false){trigger=trigger||data.trigger;var f=$.isFunction(handler)?$.proxy(handler,trigger,$area,shouldShow):$.noop;var closeOnClick=function(e){var target=e.target,dataObj=e.data,$ar=dataObj&&dataObj.area,$trig=dataObj&&dataObj.trigger,auto=dataObj&&dataObj.autoOpened;if(!$ar|!$trig||$ar.is(target)||$trig.is(target)||$.contains($ar[0],target)||$.contains($trig[0],target)||auto){return}toggleAreaInternal($area,false)};if(shouldShow){if(!opened){f();$area.addClass(openClassName).slideDown(dur,$.proxy($area.triggerHandler,$area,postEvent));data.autoOpened=autoTriggered;$(document.body).on("click.notificationArea.data-api",{area:$area,trigger:trigger,autoOpened:data.autoOpened},closeOnClick)}}else{if(opened&&!options.alwaysOpen&&(!autoTriggered||data.autoOpened)){data.autoOpened=false;$(document.body).off("click.notificationArea.data-api");$area.slideUp(dur,function(){f();$area.removeClass(openClassName).triggerHandler(postEvent)})}}}}function openArea(){return this.each(function(){toggleAreaInternal($(this),true)})}function closeArea(){return this.each(function(){toggleAreaInternal($(this),false)})}function appendNotification(notification){if(!notification){return this}var msgArr=$.type(notification)=="string"||$.isPlainObject(notification)?[notification]:notification;if(!$.isArray(msgArr)||msgArr.length==0){return this}return this.each(function(){addNotificationInternal($(this),msgArr)})}function addNotificationInternal($area,messageArr){if(!$area||!messageArr||!messageArr.length){return}var data=$area.data(dataCacheName)||{},$msgContainer=data.latestArea,buildMessage=data.options&&data.options.buildNotification,appended=[];var func=function(msg){if(msg){$area.triggerHandler(appendInternalEventName);var $msg=msg.prevObject?msg:$(msg);$msg.css("display","none").prependTo($msgContainer).fadeIn();appended.push($msg);invalidateNotificationCount($area)}};var res=$area.triggerHandler("append.notificationArea",[messageArr,$msgContainer]);if(res!==false&&$msgContainer.length>0){if(messageArr.prevObject){messageArr.each(function(){func($(this))})}else{if(buildMessage){$.each(messageArr,function(i,msg){func(buildMessage(msg))})}}toggleControlsInternal($area,data.controls);autoOpenArea($area,data);updateTriggerView($area,data);$area.triggerHandler(appendedEventName,[$msgContainer,appended])}}function removeNotificationInternal($area,$msg){var data=$area.data(dataCacheName)||{};var res=$area.triggerHandler("remove.notificationArea",[$msg]);if(res!==false){$area.triggerHandler(removeInternalEventName,[$msg]);$msg.remove();if(getNotificationCountInternal($area,true)==0){toggleAreaInternal($area,false)}invalidateNotificationCount($area);getNotificationCountInternal($area,false)==0&&data.stackArea.removeClass("open");toggleControlsInternal($area,data.controls);updateTriggerView($area,data);$area.triggerHandler(removedEventName,[$msg])}}function clearNotifications(filter){return this.each(function(){var $area=$(this),data=$area.data(dataCacheName)||{},options=data.options||{},$msg=$area.find(options.notificationSelector);removeNotificationInternal($area,filter?$msg.filter(filter):$msg)})}function moveNotifications($src,$dest,ntfcSelector,append){if(!$src||!$src.length||!$dest||!$dest.length||!ntfcSelector){return}var $ntfcColl=$.isFunction(ntfcSelector)?ntfcSelector($src):$src.find(ntfcSelector);$ntfcColl.detach();append===true?$ntfcColl.appendTo($dest):$ntfcColl.prependTo($dest)}function getNotificationCount(){return getNotificationCountInternal(this.first())}function getNotificationCountInternal($area,latest){var data=$area.data(dataCacheName),msgSelector=data&&data.options.notificationSelector,cacheName=totalCountCacheName,$root=$area;if(latest===true){cacheName=latestCountCacheName;$root=data&&data.latestArea}else{if(latest===false){cacheName=stackCountCacheName;$root=data&&data.stackArea}}var count=$area.data(cacheName),countValid=count>=0;if(!countValid){count=$root.find(msgSelector).length;$area.data(cacheName,count)}return count}function invalidateNotificationCount($area){$area.data(totalCountCacheName,-1);$area.data(latestCountCacheName,-1);$area.data(stackCountCacheName,-1)}function autoOpenArea($area,data){var options=data.options||{};toggleAreaInternal($area,true,true);if(options.autoCloseAfter>0){if(data.timerId){clearTimeout(data.timerId)}data.timerId=setTimeout($.proxy(toggleAreaInternal,this,$area,false,true),options.autoCloseAfter);$area.on("mouseenter",function(){clearTimeout(data.timerId);data.timerId=null});$area.on("mouseleave",function(){data.timerId=setTimeout($.proxy(toggleAreaInternal,this,$area,false,true),options.autoCloseAfter)})}}function updateTriggerView($area,data){var $trigger=data.trigger,$latestMsg=data.latestArea.find(data.options.notificationSelector).first(),prevMsgType=$trigger.data("lastMsgType");prevMsgType&&$trigger.removeClass(prevMsgType).data("lastMsgType",null);if($latestMsg.length){var lastMsgType=$latestMsg.data("type");lastMsgType&&$trigger.addClass(lastMsgType).data("lastMsgType",lastMsgType)}}var methods={init:init,open:openArea,close:closeArea,append:appendNotification,getCount:getNotificationCount,clear:clearNotifications};$.fn.notificationArea=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof method==="object"||!method){return methods.init.apply(this,arguments)}else{return $.error('Method "'+method+'" does not exist on jQuery.notificationArea')}}};$.fn.notificationArea.defaults={areaTemplate:function(options){var opts=options||{},msg=opts.messages||{};return'<div class="notification-area-inner"><div class="notification-wrapper"><div class="notification-latest" data-notification-latest="true"></div><div class="notification-stack" data-notification-stack="true"></div></div><div class="notification-control" data-notification-control="true"><div class="control-stack" data-toggle-stack="show"><button class="btn" data-clear-trigger="true"><i class="icon-delete icon-white"></i> '+msg.remove+'</button> <button class="btn" data-toggle-trigger="true">'+msg.show+' (<span data-notification-count="true"></span>)</button></div><div class="control-stack" data-toggle-stack="hide"><button class="btn" data-clear-trigger="true"><i class="icon-delete icon-white"></i> '+msg.remove+'</button> <button class="btn" data-toggle-trigger="true">'+msg.hide+'</button></div><div class="empty-list" data-empty-list-text="true">'+msg.empty+"</div></div></div>"},messages:{remove:"Delete all",show:"Show all",hide:"Hide",empty:"There are no messages"},areaTrigger:{trigger:".notification-area-trigger",handler:function($area,show){var $self=$(this),$icon=$self.find("i"),showClass=$icon.data("iconShow"),hideClass=$icon.data("iconHide");if(getNotificationCountInternal($area)){$self.find("span").text(getNotificationCountInternal($area))}$self.toggleClass("open",show);if(show){$icon.removeClass(showClass).addClass(hideClass)}else{$icon.removeClass(hideClass).addClass(showClass)}}},buildNotification:function(msg){if(!msg){return null}if($.type(msg)=="string"){msg={text:msg}}var text=msg.text||msg.Text,type=msg.type||msg.Type;if(!text){return null}var $msg=$("<div></div>").addClass("alert").data("type",type).append('<button type="button" class="close" data-dismiss="alert">Ã</button>'),header=msg.header||msg.Header;header&&$.type(header)=="string"&&$msg.append('<span class="alert-heading">'+header+"</span>");$msg.append(text);msg.cssClass&&$msg.addClass(msg.cssClass);msg.tags&&$msg.data("tags",msg.tags);return $msg},notificationSelector:".alert",latestNotificationMaxCount:1,alwaysOpen:false,autoCloseAfter:4000}})(jQuery);var FogSoft=(function(module,$){var multiLanguageModule=module.MultiLanguage=module.MultiLanguage||{};function getHiddenInput($form,prefix,locale){var id="#"+prefix+"_Translations_"+locale+"_";return $form.find(id)}multiLanguageModule.init=function($parent){var $localeContainer=$parent.find("[data-form-selector]");if($localeContainer.length>0){var formSelector=$localeContainer.data("form-selector");var $form=$(formSelector);var $languageSelector=$localeContainer.find(".language-selector-item > input");var $multiLanguageInputList=$form.find(".multi-language-field");$languageSelector.off("change.languageSelector").on("change.languageSelector",function(){var locale=$(this).val();$.each($multiLanguageInputList,function(index,el){var $el=$(el);$el.data("language",locale);$el.val(getHiddenInput($form,$el.prop("id"),locale).val());$form.find(".multi-language-field-wrapper .input-group-addon").text(locale)})});$multiLanguageInputList.change(function(){var locale=$(this).data("language");var id=$(this).prop("id");var $hiddenField=getHiddenInput($form,id,locale);$hiddenField.val($(this).val())})}};return module}(FogSoft||{},jQuery));(function(commonModule,$){var errorTreshold=0;var maxErrorTreshold=10;window.onerror=function(errorMsg,url,lineNumber,columnNumber,errorObject){if(typeof errorMsg==="object"&&errorMsg.target){return}if(errorTreshold++>maxErrorTreshold){return}var arg={message:errorMsg,url:url,line:lineNumber,column:columnNumber};if(errorObject){arg.stack=errorObject.stack}var applicationUrl=(typeof ApplicationInfo==="undefined")?"/":ApplicationInfo.ApplicationUrl;$.ajax({method:"POST",url:applicationUrl+"Errors/Log",contentType:"application/json",data:JSON.stringify(arg)})};if($.validator){var multiLangRequiredInvalidLocalesDataKey="invalid-locales";var validateMultiLangRequired=function(element){var $element=$(element);var id=$element.prop("id");var inputTranslationIdPrefix=id+"_Translations_";var $wrapper=$element.closest(".multi-language-field-wrapper").parent();var $inputs=$wrapper.find("[id^='"+inputTranslationIdPrefix+"']");var invalidLocaleCodes=$inputs.filter(function(index,input){return !$(input).val().length}).map(function(index,input){return input.id.replace(inputTranslationIdPrefix,"").replace("_","")}).toArray();$element.data(multiLangRequiredInvalidLocalesDataKey,invalidLocaleCodes);return !invalidLocaleCodes.length};var getMultiLangRequiredInvalidLocaleNames=function($element){var invalidLocales=$element.data(multiLangRequiredInvalidLocalesDataKey);var $languageSelector=$element.closest("form").parent().find(".locale-name");var $selectorItems=$languageSelector.find(".language-selector-item input");return invalidLocales.map(function(locale){var $items=$selectorItems.filter(function(index,el){return $(el).val()===locale});if($items.length){return $($items[0]).closest(".language-selector-item")[0].innerText}return locale})};var getMultiLangRequiredValidationMessage=function(element,messageFromOptions){var invalidLocaleNames=getMultiLangRequiredInvalidLocaleNames($(element));return messageFromOptions+invalidLocaleNames.join(", ")};var validatorNameMultiLangRequired="multilangrequired";$.validator.addMethod(validatorNameMultiLangRequired,function(value,element){return validateMultiLangRequired(element)});jQuery.extend(jQuery.validator.messages,{email:commonModule.messages.emailValidationMessage});$.validator.unobtrusive.adapters.add(validatorNameMultiLangRequired,function(options){options.rules[validatorNameMultiLangRequired]={};options.messages[validatorNameMultiLangRequired]=function(params,element){return getMultiLangRequiredValidationMessage(element,options.message)}});var validatorNameRequiredIf="requiredif";$.validator.addMethod(validatorNameRequiredIf,commonModule.isNotRequired);$.validator.unobtrusive.adapters.add(validatorNameRequiredIf,["other","comp","value"],function(options){options.rules[validatorNameRequiredIf]={other:options.params.other,comp:options.params.comp,value:options.params.value};options.messages[validatorNameRequiredIf]=options.message});var validatorNameMultilangRequiredIf="multilangrequiredif";$.validator.addMethod(validatorNameMultilangRequiredIf,function(value,element,params){return commonModule.isFieldNotRequired(value,element,params,function(el){return validateMultiLangRequired(el)})});$.validator.unobtrusive.adapters.add(validatorNameMultilangRequiredIf,["other","comp","value"],function(options){options.rules[validatorNameMultilangRequiredIf]={other:options.params.other,comp:options.params.comp,value:options.params.value};options.messages[validatorNameMultilangRequiredIf]=function(params,element){return getMultiLangRequiredValidationMessage(element,options.message)}});var validatorNameScaleLimit="scalelimit";$.validator.addMethod(validatorNameScaleLimit,function(value,element,scale){if(this.optional(element)){return true}var globalObj=window.Globalize;var number=globalObj?globalObj.parseFloat(value):parseFloat(value);if(isNaN(number)){return true}var numberString=number.toString();var match=new RegExp("-?\\d*(\\.\\d{0,"+scale+"})?").exec(numberString);return(match&&(match.index===0)&&(match[0].length===numberString.length))});$.validator.unobtrusive.adapters.add(validatorNameScaleLimit,["scale"],function(options){options.rules[validatorNameScaleLimit]=options.params.scale;options.messages[validatorNameScaleLimit]=options.message});var validatorNameInteger="integer";$.validator.addMethod(validatorNameInteger,function(value,element){if(this.optional(element)){return true}var globalObj=window.Globalize;var number=globalObj?globalObj.parseFloat(value):parseFloat(value);return isNaN(number)?true:number%1==0});$.validator.unobtrusive.adapters.addBool(validatorNameInteger)}jQuery.extend(jQuery.validator.messages,{email:commonModule.messages.emailValidationMessage});$.fn.wysihtml5&&$.extend(true,$.fn.wysihtml5.defaultOptions,{parserRules:{tags:{p:{},hr:{}}}});var ajaxRequestQueue=[],promiseMethods=["always","done","fail","pipe","progress","promise","state","then"];var deferredResolver=function(df,resolve){return function(){df[resolve===true?"resolveWith":"rejectWith"](this,arguments)}};var authRequired=function(data){return data&&data.Code===401};var authSuccessHandler=function(){$.each(ajaxRequestQueue,function(i,optObj){var req=$.ajax(optObj);if(optObj._dfrd){var df=optObj._dfrd;optObj._dfrd=null;req.then(deferredResolver(df,true),deferredResolver(df))}});ajaxRequestQueue=[]};var authFailHandler=function(data,status,jqXHR){$.each(ajaxRequestQueue,function(i,optObj){var func=optObj.processUnsuccessfulResult;$.isFunction(func)&&func.call(optObj,data,status,jqXHR);if(optObj._dfrd){var df=optObj._dfrd;optObj._dfrd=null;df.rejectWith(optObj,[jqXHR,"error","Unauthorized"])}});ajaxRequestQueue=[]};$._origAjax=$.ajax;$.ajax=function(){var def=$.Deferred();var req=$._origAjax.apply(null,arguments);req.then(function(data){var opts=this;if(authRequired(data)){opts._dfrd=def}else{def.resolveWith(opts,arguments)}},function(){def.rejectWith(this,arguments)});$.each(promiseMethods,function(i,key){var method=def[key];req[key]=function(){return method.apply(def,arguments)}});return req};$.ajaxSetup({cache:false,beforeSend:function(xhr,options){if(options.withBlockUi){commonModule.blockUi()}if(options.type=="POST"){xhr.setRequestHeader("Content-Type",options.contentType);var xCsrfToken=$('body > form input[name="__RequestVerificationToken"]').val();if(xCsrfToken){xhr.setRequestHeader("X-CSRF-Token",xCsrfToken)}}var procResHandler=options.processResult,procFailResHandler=options.processUnsuccessfulResult;var successHandler=options.success||function(data,status,jqXHR){commonModule.processResult.call(this,data);if(status=="success"&&(!data||data.Success==undefined||data.Success)){$.isFunction(procResHandler)&&procResHandler.call(this,data,status,jqXHR)}else{$.isFunction(procFailResHandler)&&procFailResHandler.call(this,data,status,jqXHR)}};options.success=function(data,status,jqXHR){if(!authRequired(data)){successHandler.call(this,data,status,jqXHR);return}ajaxRequestQueue.push(this);if(ajaxRequestQueue.length>1){return}commonModule.authenticate(data).then(authSuccessHandler,$.proxy(authFailHandler,this,data,status,jqXHR))};if(options.closeMessages!==false){commonModule.closeMessages(options.tags||options.url)}}});$.fn.dataForm&&$.extend(true,$.fn.dataForm.defaults,{messageHandler:commonModule,callbackHandler:commonModule})}((FogSoft&&FogSoft.Common)||{},jQuery));$(function($){$(window).on("beforeunload",function(e){if(FogSoft.Common.collectCallbacks(window,"collectUnsavedFormsCallbacks").length>0){if(window.ignoreUnsavedChanges){window.ignoreUnsavedChanges=undefined}else{return(e.originalEvent.returnValue=FogSoft.Common.messages.unsavedChangesConfirmMessage)}}});var errorTreshold=0;var maxErrorTreshold=10;FogSoft.Common.init($(document.body))});(function(){var greek={y:function(c){return c===1?"ÏÏÏÎ½Î¿Ï":"ÏÏÏÎ½Î¹Î±"},mo:function(c){return c===1?"Î¼Î®Î½Î±Ï":"Î¼Î®Î½ÎµÏ"},w:function(c){return c===1?"ÎµÎ²Î´Î¿Î¼Î¬Î´Î±":"ÎµÎ²Î´Î¿Î¼Î¬Î´ÎµÏ"},d:function(c){return c===1?"Î¼Î­ÏÎ±":"Î¼Î­ÏÎµÏ"},h:function(c){return c===1?"ÏÏÎ±":"ÏÏÎµÏ"},m:function(c){return c===1?"Î»ÎµÏÏÏ":"Î»ÎµÏÏÎ¬"},s:function(c){return c===1?"Î´ÎµÏÏÎµÏÏÎ»ÎµÏÏÎ¿":"Î´ÎµÏÏÎµÏÏÎ»ÎµÏÏÎ±"},ms:function(c){return c===1?"ÏÎ¹Î»Î¹Î¿ÏÏÏ ÏÎ¿Ï Î´ÎµÏÏÎµÏÎ¿Î»Î­ÏÏÎ¿Ï":"ÏÎ¹Î»Î¹Î¿ÏÏÎ¬ ÏÎ¿Ï Î´ÎµÏÏÎµÏÎ¿Î»Î­ÏÏÎ¿Ï"},decimal:","};var languages={ar:{y:function(c){return c===1?"Ø³ÙØ©":"Ø³ÙÙØ§Øª"},mo:function(c){return c===1?"Ø´ÙØ±":"Ø£Ø´ÙØ±"},w:function(c){return c===1?"Ø£Ø³Ø¨ÙØ¹":"Ø£Ø³Ø§Ø¨ÙØ¹"},d:function(c){return c===1?"ÙÙÙ":"Ø£ÙØ§Ù"},h:function(c){return c===1?"Ø³Ø§Ø¹Ø©":"Ø³Ø§Ø¹Ø§Øª"},m:function(c){return["Ø¯ÙÙÙØ©","Ø¯ÙØ§Ø¦Ù"][getArabicForm(c)]},s:function(c){return c===1?"Ø«Ø§ÙÙØ©":"Ø«ÙØ§ÙÙ"},ms:function(c){return c===1?"Ø¬Ø²Ø¡ ÙÙ Ø§ÙØ«Ø§ÙÙØ©":"Ø£Ø¬Ø²Ø§Ø¡ ÙÙ Ø§ÙØ«Ø§ÙÙØ©"},decimal:","},bg:{y:function(c){return["Ð³Ð¾Ð´Ð¸Ð½Ð¸","Ð³Ð¾Ð´Ð¸Ð½Ð°","Ð³Ð¾Ð´Ð¸Ð½Ð¸"][getSlavicForm(c)]},mo:function(c){return["Ð¼ÐµÑÐµÑÐ°","Ð¼ÐµÑÐµÑ","Ð¼ÐµÑÐµÑÐ°"][getSlavicForm(c)]},w:function(c){return["ÑÐµÐ´Ð¼Ð¸ÑÐ¸","ÑÐµÐ´Ð¼Ð¸ÑÐ°","ÑÐµÐ´Ð¼Ð¸ÑÐ¸"][getSlavicForm(c)]},d:function(c){return["Ð´Ð½Ð¸","Ð´ÐµÐ½","Ð´Ð½Ð¸"][getSlavicForm(c)]},h:function(c){return["ÑÐ°ÑÐ°","ÑÐ°Ñ","ÑÐ°ÑÐ°"][getSlavicForm(c)]},m:function(c){return["Ð¼Ð¸Ð½ÑÑÐ¸","Ð¼Ð¸Ð½ÑÑÐ°","Ð¼Ð¸Ð½ÑÑÐ¸"][getSlavicForm(c)]},s:function(c){return["ÑÐµÐºÑÐ½Ð´Ð¸","ÑÐµÐºÑÐ½Ð´Ð°","ÑÐµÐºÑÐ½Ð´Ð¸"][getSlavicForm(c)]},ms:function(c){return["Ð¼Ð¸Ð»Ð¸ÑÐµÐºÑÐ½Ð´Ð¸","Ð¼Ð¸Ð»Ð¸ÑÐµÐºÑÐ½Ð´Ð°","Ð¼Ð¸Ð»Ð¸ÑÐµÐºÑÐ½Ð´Ð¸"][getSlavicForm(c)]},decimal:","},ca:{y:function(c){return"any"+(c===1?"":"s")},mo:function(c){return"mes"+(c===1?"":"os")},w:function(c){return"setman"+(c===1?"a":"es")},d:function(c){return"di"+(c===1?"a":"es")},h:function(c){return"hor"+(c===1?"a":"es")},m:function(c){return"minut"+(c===1?"":"s")},s:function(c){return"segon"+(c===1?"":"s")},ms:function(c){return"milisegon"+(c===1?"":"s")},decimal:","},cs:{y:function(c){return["rok","roku","roky","let"][getCzechOrSlovakForm(c)]},mo:function(c){return["mÄsÃ­c","mÄsÃ­ce","mÄsÃ­ce","mÄsÃ­cÅ¯"][getCzechOrSlovakForm(c)]},w:function(c){return["tÃ½den","tÃ½dne","tÃ½dny","tÃ½dnÅ¯"][getCzechOrSlovakForm(c)]},d:function(c){return["den","dne","dny","dnÃ­"][getCzechOrSlovakForm(c)]},h:function(c){return["hodina","hodiny","hodiny","hodin"][getCzechOrSlovakForm(c)]},m:function(c){return["minuta","minuty","minuty","minut"][getCzechOrSlovakForm(c)]},s:function(c){return["sekunda","sekundy","sekundy","sekund"][getCzechOrSlovakForm(c)]},ms:function(c){return["milisekunda","milisekundy","milisekundy","milisekund"][getCzechOrSlovakForm(c)]},decimal:","},da:{y:"Ã¥r",mo:function(c){return"mÃ¥ned"+(c===1?"":"er")},w:function(c){return"uge"+(c===1?"":"r")},d:function(c){return"dag"+(c===1?"":"e")},h:function(c){return"time"+(c===1?"":"r")},m:function(c){return"minut"+(c===1?"":"ter")},s:function(c){return"sekund"+(c===1?"":"er")},ms:function(c){return"millisekund"+(c===1?"":"er")},decimal:","},de:{y:function(c){return"Jahr"+(c===1?"":"e")},mo:function(c){return"Monat"+(c===1?"":"e")},w:function(c){return"Woche"+(c===1?"":"n")},d:function(c){return"Tag"+(c===1?"":"e")},h:function(c){return"Stunde"+(c===1?"":"n")},m:function(c){return"Minute"+(c===1?"":"n")},s:function(c){return"Sekunde"+(c===1?"":"n")},ms:function(c){return"Millisekunde"+(c===1?"":"n")},decimal:","},el:greek,en:{y:function(c){return"year"+(c===1?"":"s")},mo:function(c){return"month"+(c===1?"":"s")},w:function(c){return"week"+(c===1?"":"s")},d:function(c){return"day"+(c===1?"":"s")},h:function(c){return"hour"+(c===1?"":"s")},m:function(c){return"minute"+(c===1?"":"s")},s:function(c){return"second"+(c===1?"":"s")},ms:function(c){return"millisecond"+(c===1?"":"s")},decimal:"."},es:{y:function(c){return"aÃ±o"+(c===1?"":"s")},mo:function(c){return"mes"+(c===1?"":"es")},w:function(c){return"semana"+(c===1?"":"s")},d:function(c){return"dÃ­a"+(c===1?"":"s")},h:function(c){return"hora"+(c===1?"":"s")},m:function(c){return"minuto"+(c===1?"":"s")},s:function(c){return"segundo"+(c===1?"":"s")},ms:function(c){return"milisegundo"+(c===1?"":"s")},decimal:","},fa:{y:"Ø³Ø§Ù",mo:"ÙØ§Ù",w:"ÙÙØªÙ",d:"Ø±ÙØ²",h:"Ø³Ø§Ø¹Øª",m:"Ø¯ÙÛÙÙ",s:"Ø«Ø§ÙÛÙ",ms:"ÙÛÙÛ Ø«Ø§ÙÛÙ",decimal:"."},fi:{y:function(c){return c===1?"vuosi":"vuotta"},mo:function(c){return c===1?"kuukausi":"kuukautta"},w:function(c){return"viikko"+(c===1?"":"a")},d:function(c){return"pÃ¤ivÃ¤"+(c===1?"":"Ã¤")},h:function(c){return"tunti"+(c===1?"":"a")},m:function(c){return"minuutti"+(c===1?"":"a")},s:function(c){return"sekunti"+(c===1?"":"a")},ms:function(c){return"millisekunti"+(c===1?"":"a")},decimal:","},fr:{y:function(c){return"an"+(c>=2?"s":"")},mo:"mois",w:function(c){return"semaine"+(c>=2?"s":"")},d:function(c){return"jour"+(c>=2?"s":"")},h:function(c){return"heure"+(c>=2?"s":"")},m:function(c){return"minute"+(c>=2?"s":"")},s:function(c){return"seconde"+(c>=2?"s":"")},ms:function(c){return"milliseconde"+(c>=2?"s":"")},decimal:","},gr:greek,hr:{y:function(c){if(c%10===2||c%10===3||c%10===4){return"godine"}return"godina"},mo:function(c){if(c===1){return"mjesec"}else{if(c===2||c===3||c===4){return"mjeseca"}}return"mjeseci"},w:function(c){if(c%10===1&&c!==11){return"tjedan"}return"tjedna"},d:function(c){return c===1?"dan":"dana"},h:function(c){if(c===1){return"sat"}else{if(c===2||c===3||c===4){return"sata"}}return"sati"},m:function(c){var mod10=c%10;if((mod10===2||mod10===3||mod10===4)&&(c<10||c>14)){return"minute"}return"minuta"},s:function(c){if((c===10||c===11||c===12||c===13||c===14||c===16||c===17||c===18||c===19)||(c%10===5)){return"sekundi"}else{if(c%10===1){return"sekunda"}else{if(c%10===2||c%10===3||c%10===4){return"sekunde"}}}return"sekundi"},ms:function(c){if(c===1){return"milisekunda"}else{if(c%10===2||c%10===3||c%10===4){return"milisekunde"}}return"milisekundi"},decimal:","},hu:{y:"Ã©v",mo:"hÃ³nap",w:"hÃ©t",d:"nap",h:"Ã³ra",m:"perc",s:"mÃ¡sodperc",ms:"ezredmÃ¡sodperc",decimal:","},id:{y:"tahun",mo:"bulan",w:"minggu",d:"hari",h:"jam",m:"menit",s:"detik",ms:"milidetik",decimal:"."},is:{y:"Ã¡r",mo:function(c){return"mÃ¡nuÃ°"+(c===1?"ur":"ir")},w:function(c){return"vik"+(c===1?"a":"ur")},d:function(c){return"dag"+(c===1?"ur":"ar")},h:function(c){return"klukkutÃ­m"+(c===1?"i":"ar")},m:function(c){return"mÃ­nÃºt"+(c===1?"a":"ur")},s:function(c){return"sekÃºnd"+(c===1?"a":"ur")},ms:function(c){return"millisekÃºnd"+(c===1?"a":"ur")},decimal:"."},it:{y:function(c){return"ann"+(c===1?"o":"i")},mo:function(c){return"mes"+(c===1?"e":"i")},w:function(c){return"settiman"+(c===1?"a":"e")},d:function(c){return"giorn"+(c===1?"o":"i")},h:function(c){return"or"+(c===1?"a":"e")},m:function(c){return"minut"+(c===1?"o":"i")},s:function(c){return"second"+(c===1?"o":"i")},ms:function(c){return"millisecond"+(c===1?"o":"i")},decimal:","},ja:{y:"å¹´",mo:"æ",w:"é±",d:"æ¥",h:"æé",m:"å",s:"ç§",ms:"ããªç§",decimal:"."},ko:{y:"ë",mo:"ê°ì",w:"ì£¼ì¼",d:"ì¼",h:"ìê°",m:"ë¶",s:"ì´",ms:"ë°ë¦¬ ì´",decimal:"."},lo:{y:"àºàºµ",mo:"à»àºàº·àº­àº",w:"àº­àº²àºàº´àº",d:"àº¡àº·à»",h:"àºàº»à»àº§à»àº¡àº",m:"àºàº²àºàºµ",s:"àº§àº´àºàº²àºàºµ",ms:"àº¡àº´àºàº¥àº´àº§àº´àºàº²àºàºµ",decimal:","},lt:{y:function(c){return((c%10===0)||(c%100>=10&&c%100<=20))?"metÅ³":"metai"},mo:function(c){return["mÄnuo","mÄnesiai","mÄnesiÅ³"][getLithuanianForm(c)]},w:function(c){return["savaitÄ","savaitÄs","savaiÄiÅ³"][getLithuanianForm(c)]},d:function(c){return["diena","dienos","dienÅ³"][getLithuanianForm(c)]},h:function(c){return["valanda","valandos","valandÅ³"][getLithuanianForm(c)]},m:function(c){return["minutÄ","minutÄs","minuÄiÅ³"][getLithuanianForm(c)]},s:function(c){return["sekundÄ","sekundÄs","sekundÅ¾iÅ³"][getLithuanianForm(c)]},ms:function(c){return["milisekundÄ","milisekundÄs","milisekundÅ¾iÅ³"][getLithuanianForm(c)]},decimal:","},ms:{y:"tahun",mo:"bulan",w:"minggu",d:"hari",h:"jam",m:"minit",s:"saat",ms:"milisaat",decimal:"."},nl:{y:"jaar",mo:function(c){return c===1?"maand":"maanden"},w:function(c){return c===1?"week":"weken"},d:function(c){return c===1?"dag":"dagen"},h:"uur",m:function(c){return c===1?"minuut":"minuten"},s:function(c){return c===1?"seconde":"seconden"},ms:function(c){return c===1?"milliseconde":"milliseconden"},decimal:","},no:{y:"Ã¥r",mo:function(c){return"mÃ¥ned"+(c===1?"":"er")},w:function(c){return"uke"+(c===1?"":"r")},d:function(c){return"dag"+(c===1?"":"er")},h:function(c){return"time"+(c===1?"":"r")},m:function(c){return"minutt"+(c===1?"":"er")},s:function(c){return"sekund"+(c===1?"":"er")},ms:function(c){return"millisekund"+(c===1?"":"er")},decimal:","},pl:{y:function(c){return["rok","roku","lata","lat"][getPolishForm(c)]},mo:function(c){return["miesiÄc","miesiÄca","miesiÄce","miesiÄcy"][getPolishForm(c)]},w:function(c){return["tydzieÅ","tygodnia","tygodnie","tygodni"][getPolishForm(c)]},d:function(c){return["dzieÅ","dnia","dni","dni"][getPolishForm(c)]},h:function(c){return["godzina","godziny","godziny","godzin"][getPolishForm(c)]},m:function(c){return["minuta","minuty","minuty","minut"][getPolishForm(c)]},s:function(c){return["sekunda","sekundy","sekundy","sekund"][getPolishForm(c)]},ms:function(c){return["milisekunda","milisekundy","milisekundy","milisekund"][getPolishForm(c)]},decimal:","},pt:{y:function(c){return"ano"+(c===1?"":"s")},mo:function(c){return c===1?"mÃªs":"meses"},w:function(c){return"semana"+(c===1?"":"s")},d:function(c){return"dia"+(c===1?"":"s")},h:function(c){return"hora"+(c===1?"":"s")},m:function(c){return"minuto"+(c===1?"":"s")},s:function(c){return"segundo"+(c===1?"":"s")},ms:function(c){return"milissegundo"+(c===1?"":"s")},decimal:","},ro:{y:function(c){return c===1?"an":"ani"},mo:function(c){return c===1?"lunÄ":"luni"},w:function(c){return c===1?"sÄptÄmÃ¢nÄ":"sÄptÄmÃ¢ni"},d:function(c){return c===1?"zi":"zile"},h:function(c){return c===1?"orÄ":"ore"},m:function(c){return c===1?"minut":"minute"},s:function(c){return c===1?"secundÄ":"secunde"},ms:function(c){return c===1?"milisecundÄ":"milisecunde"},decimal:","},ru:{y:function(c){return["Ð»ÐµÑ","Ð³Ð¾Ð´","Ð³Ð¾Ð´Ð°"][getSlavicForm(c)]},mo:function(c){return["Ð¼ÐµÑÑÑÐµÐ²","Ð¼ÐµÑÑÑ","Ð¼ÐµÑÑÑÐ°"][getSlavicForm(c)]},w:function(c){return["Ð½ÐµÐ´ÐµÐ»Ñ","Ð½ÐµÐ´ÐµÐ»Ñ","Ð½ÐµÐ´ÐµÐ»Ð¸"][getSlavicForm(c)]},d:function(c){return["Ð´Ð½ÐµÐ¹","Ð´ÐµÐ½Ñ","Ð´Ð½Ñ"][getSlavicForm(c)]},h:function(c){return["ÑÐ°ÑÐ¾Ð²","ÑÐ°Ñ","ÑÐ°ÑÐ°"][getSlavicForm(c)]},m:function(c){return["Ð¼Ð¸Ð½ÑÑ","Ð¼Ð¸Ð½ÑÑÐ°","Ð¼Ð¸Ð½ÑÑÑ"][getSlavicForm(c)]},s:function(c){return["ÑÐµÐºÑÐ½Ð´","ÑÐµÐºÑÐ½Ð´Ð°","ÑÐµÐºÑÐ½Ð´Ñ"][getSlavicForm(c)]},ms:function(c){return["Ð¼Ð¸Ð»Ð»Ð¸ÑÐµÐºÑÐ½Ð´","Ð¼Ð¸Ð»Ð»Ð¸ÑÐµÐºÑÐ½Ð´Ð°","Ð¼Ð¸Ð»Ð»Ð¸ÑÐµÐºÑÐ½Ð´Ñ"][getSlavicForm(c)]},decimal:","},uk:{y:function(c){return["ÑÐ¾ÐºÑÐ²","ÑÑÐº","ÑÐ¾ÐºÐ¸"][getSlavicForm(c)]},mo:function(c){return["Ð¼ÑÑÑÑÑÐ²","Ð¼ÑÑÑÑÑ","Ð¼ÑÑÑÑÑ"][getSlavicForm(c)]},w:function(c){return["ÑÐ¸Ð¶Ð½ÑÐ²","ÑÐ¸Ð¶Ð´ÐµÐ½Ñ","ÑÐ¸Ð¶Ð½Ñ"][getSlavicForm(c)]},d:function(c){return["Ð´Ð½ÑÐ²","Ð´ÐµÐ½Ñ","Ð´Ð½Ñ"][getSlavicForm(c)]},h:function(c){return["Ð³Ð¾Ð´Ð¸Ð½","Ð³Ð¾Ð´Ð¸Ð½Ð°","Ð³Ð¾Ð´Ð¸Ð½Ð¸"][getSlavicForm(c)]},m:function(c){return["ÑÐ²Ð¸Ð»Ð¸Ð½","ÑÐ²Ð¸Ð»Ð¸Ð½Ð°","ÑÐ²Ð¸Ð»Ð¸Ð½Ð¸"][getSlavicForm(c)]},s:function(c){return["ÑÐµÐºÑÐ½Ð´","ÑÐµÐºÑÐ½Ð´Ð°","ÑÐµÐºÑÐ½Ð´Ð¸"][getSlavicForm(c)]},ms:function(c){return["Ð¼ÑÐ»ÑÑÐµÐºÑÐ½Ð´","Ð¼ÑÐ»ÑÑÐµÐºÑÐ½Ð´Ð°","Ð¼ÑÐ»ÑÑÐµÐºÑÐ½Ð´Ð¸"][getSlavicForm(c)]},decimal:","},ur:{y:"Ø³Ø§Ù",mo:function(c){return c===1?"ÙÛÛÙÛ":"ÙÛÛÙÛ"},w:function(c){return c===1?"ÛÙØªÛ":"ÛÙØªÛ"},d:"Ø¯Ù",h:function(c){return c===1?"Ú¯Ú¾ÙÙ¹Û":"Ú¯Ú¾ÙÙ¹Û"},m:"ÙÙÙ¹",s:"Ø³ÛÚ©ÙÚ",ms:"ÙÙÛ Ø³ÛÚ©ÙÚ",decimal:"."},sk:{y:function(c){return["rok","roky","roky","rokov"][getCzechOrSlovakForm(c)]},mo:function(c){return["mesiac","mesiace","mesiace","mesiacov"][getCzechOrSlovakForm(c)]},w:function(c){return["tÃ½Å¾deÅ","tÃ½Å¾dne","tÃ½Å¾dne","tÃ½Å¾dÅov"][getCzechOrSlovakForm(c)]},d:function(c){return["deÅ","dni","dni","dnÃ­"][getCzechOrSlovakForm(c)]},h:function(c){return["hodina","hodiny","hodiny","hodÃ­n"][getCzechOrSlovakForm(c)]},m:function(c){return["minÃºta","minÃºty","minÃºty","minÃºt"][getCzechOrSlovakForm(c)]},s:function(c){return["sekunda","sekundy","sekundy","sekÃºnd"][getCzechOrSlovakForm(c)]},ms:function(c){return["milisekunda","milisekundy","milisekundy","milisekÃºnd"][getCzechOrSlovakForm(c)]},decimal:","},sv:{y:"Ã¥r",mo:function(c){return"mÃ¥nad"+(c===1?"":"er")},w:function(c){return"veck"+(c===1?"a":"or")},d:function(c){return"dag"+(c===1?"":"ar")},h:function(c){return"timm"+(c===1?"e":"ar")},m:function(c){return"minut"+(c===1?"":"er")},s:function(c){return"sekund"+(c===1?"":"er")},ms:function(c){return"millisekund"+(c===1?"":"er")},decimal:","},tr:{y:"yÄ±l",mo:"ay",w:"hafta",d:"gÃ¼n",h:"saat",m:"dakika",s:"saniye",ms:"milisaniye",decimal:","},th:{y:"à¸à¸µ",mo:"à¹à¸à¸·à¸­à¸",w:"à¸­à¸²à¸à¸´à¸à¸¢à¹",d:"à¸§à¸±à¸",h:"à¸à¸±à¹à¸§à¹à¸¡à¸",m:"à¸à¸²à¸à¸µ",s:"à¸§à¸´à¸à¸²à¸à¸µ",ms:"à¸¡à¸´à¸¥à¸¥à¸´à¸§à¸´à¸à¸²à¸à¸µ",decimal:"."},vi:{y:"nÄm",mo:"thÃ¡ng",w:"tuáº§n",d:"ngÃ y",h:"giá»",m:"phÃºt",s:"giÃ¢y",ms:"mili giÃ¢y",decimal:","},zh_CN:{y:"å¹´",mo:"ä¸ªæ",w:"å¨",d:"å¤©",h:"å°æ¶",m:"åé",s:"ç§",ms:"æ¯«ç§",decimal:"."},zh_TW:{y:"å¹´",mo:"åæ",w:"å¨",d:"å¤©",h:"å°æ",m:"åé",s:"ç§",ms:"æ¯«ç§",decimal:"."}};function humanizer(passedOptions){var result=function humanizer(ms,humanizerOptions){var options=extend({},result,humanizerOptions||{});return doHumanization(ms,options)};return extend(result,{language:"en",delimiter:", ",spacer:" ",conjunction:"",serialComma:true,units:["y","mo","w","d","h","m","s"],languages:{},round:false,unitMeasures:{y:31557600000,mo:2629800000,w:604800000,d:86400000,h:3600000,m:60000,s:1000,ms:1}},passedOptions)}var humanizeDuration=humanizer({});function getDictionary(options){var languagesFromOptions=[options.language];if(options.hasOwnProperty("fallbacks")){if(isArray(options.fallbacks)&&options.fallbacks.length){languagesFromOptions=languagesFromOptions.concat(options.fallbacks)}else{throw new Error("fallbacks must be an array with at least one element")}}for(var i=0;i<languagesFromOptions.length;i++){var languageToTry=languagesFromOptions[i];if(options.languages.hasOwnProperty(languageToTry)){return options.languages[languageToTry]}else{if(languages.hasOwnProperty(languageToTry)){return languages[languageToTry]}}}throw new Error("No language found.")}function doHumanization(ms,options){var i,len,piece;ms=Math.abs(ms);var dictionary=getDictionary(options);var pieces=[];var unitName,unitMS,unitCount;for(i=0,len=options.units.length;i<len;i++){unitName=options.units[i];unitMS=options.unitMeasures[unitName];if(i+1===len){unitCount=ms/unitMS}else{unitCount=Math.floor(ms/unitMS)}pieces.push({unitCount:unitCount,unitName:unitName});ms-=unitCount*unitMS}var firstOccupiedUnitIndex=0;for(i=0;i<pieces.length;i++){if(pieces[i].unitCount){firstOccupiedUnitIndex=i;break}}if(options.round){var ratioToLargerUnit,previousPiece;for(i=pieces.length-1;i>=0;i--){piece=pieces[i];piece.unitCount=Math.round(piece.unitCount);if(i===0){break}previousPiece=pieces[i-1];ratioToLargerUnit=options.unitMeasures[previousPiece.unitName]/options.unitMeasures[piece.unitName];if((piece.unitCount%ratioToLargerUnit)===0||(options.largest&&((options.largest-1)<(i-firstOccupiedUnitIndex)))){previousPiece.unitCount+=piece.unitCount/ratioToLargerUnit;piece.unitCount=0}}}var result=[];for(i=0,pieces.length;i<len;i++){piece=pieces[i];if(piece.unitCount){result.push(render(piece.unitCount,piece.unitName,dictionary,options))}if(result.length===options.largest){break}}if(result.length){if(!options.conjunction||result.length===1){return result.join(options.delimiter)}else{if(result.length===2){return result.join(options.conjunction)}else{if(result.length>2){return result.slice(0,-1).join(options.delimiter)+(options.serialComma?",":"")+options.conjunction+result.slice(-1)}}}}else{return render(0,options.units[options.units.length-1],dictionary,options)}}function render(count,type,dictionary,options){var decimal;if(options.decimal===void 0){decimal=dictionary.decimal}else{decimal=options.decimal}var countStr=count.toString().replace(".",decimal);var dictionaryValue=dictionary[type];var word;if(typeof dictionaryValue==="function"){word=dictionaryValue(count)}else{word=dictionaryValue}return countStr+options.spacer+word}function extend(destination){var source;for(var i=1;i<arguments.length;i++){source=arguments[i];for(var prop in source){if(source.hasOwnProperty(prop)){destination[prop]=source[prop]}}}return destination}function getPolishForm(c){if(c===1){return 0}else{if(Math.floor(c)!==c){return 1}else{if(c%10>=2&&c%10<=4&&!(c%100>10&&c%100<20)){return 2}else{return 3}}}}function getSlavicForm(c){if(Math.floor(c)!==c){return 2}else{if((c%100>=5&&c%100<=20)||(c%10>=5&&c%10<=9)||c%10===0){return 0}else{if(c%10===1){return 1}else{if(c>1){return 2}else{return 0}}}}}function getCzechOrSlovakForm(c){if(c===1){return 0}else{if(Math.floor(c)!==c){return 1}else{if(c%10>=2&&c%10<=4&&c%100<10){return 2}else{return 3}}}}function getLithuanianForm(c){if(c===1||(c%10===1&&c%100>20)){return 0}else{if(Math.floor(c)!==c||(c%10>=2&&c%100>20)||(c%10>=2&&c%100<10)){return 1}else{return 2}}}function getArabicForm(c){if(c<=2){return 0}if(c>2&&c<11){return 1}return 0}var isArray=Array.isArray||function(arg){return Object.prototype.toString.call(arg)==="[object Array]"};humanizeDuration.getSupportedLanguages=function getSupportedLanguages(){var result=[];for(var language in languages){if(languages.hasOwnProperty(language)&&language!=="gr"){result.push(language)}}return result};humanizeDuration.humanizer=humanizer;if(typeof define==="function"&&define.amd){define(function(){return humanizeDuration})}else{if(typeof module!=="undefined"&&module.exports){module.exports=humanizeDuration}else{this.humanizeDuration=humanizeDuration}}})();(function(module,$){var suggestionModule=module.Suggestion=module.Suggestion||{};var FieldParsingHelper=(function(){var customFieldTypeParsers={};customFieldTypeParsers.CompanyFullName=function(searchType){if(searchType==="PARTY"){return function(suggestion){return suggestion.data.name.full_with_opf}}return null};customFieldTypeParsers.CompanyShortName=function(searchType){if(searchType==="PARTY"){return function(suggestion){return suggestion.data.name.short_with_opf}}return null};customFieldTypeParsers.Vatin=function(searchType){if(searchType==="PARTY"){return function(suggestion){return suggestion.data.inn}}return null};customFieldTypeParsers.Kpp=function(searchType){if(searchType==="PARTY"){return function(suggestion){return suggestion.data.kpp}}return null};customFieldTypeParsers.Ogrn=function(searchType){if(searchType==="PARTY"){return function(suggestion){return suggestion.data.ogrn}}return null};customFieldTypeParsers.LegalAddress=function(searchType){if(searchType==="PARTY"){return function(suggestion){return suggestion.data.address.value}}return null};customFieldTypeParsers.ChiefName=function(searchType){if(searchType==="PARTY"){return function(suggestion){return suggestion.data.management.name}}return null};return{getCustomParser:function(suggestionFieldType,searchType){var customFieldTypeParser=customFieldTypeParsers[suggestionFieldType];return !customFieldTypeParser?null:customFieldTypeParser(searchType)}}});var fieldParsingHelper=new FieldParsingHelper();suggestionModule.init=function($forms){var suggestionsOptions=document.SuggestionsOptions;if(!suggestionsOptions){return}$forms.each(function(index,form){initializeFormSuggestions($(form),suggestionsOptions)})};suggestionModule.toggleForInput=function($input,isEnabled){var suggestionsPlugin=$input.suggestions();if(suggestionsPlugin){if(isEnabled){suggestionsPlugin.enable()}else{suggestionsPlugin.disable()}}};return suggestionModule;function initializeFormSuggestions($form,suggestionsOptions){var $formSuggestionFields=$form.find("[data-suggestion-type]");if($formSuggestionFields.length===0){return}var hint=suggestionsOptions.hint;var token=suggestionsOptions.publicKey;var overwriteNonEmptyFields=suggestionsOptions.overwriteNonEmptyFields;var $selectedCompanyType=$form.find("[data-suggestion-company-type]");var selectedCompanyType=$selectedCompanyType.val();var companyOptions=getCompanyOptions(selectedCompanyType);var fields=[];$formSuggestionFields.each(function(index,input){var $input=$(input);var suggestionFieldType=$input.attr("data-suggestion-type");var searchType=getSuggestionSearchType(suggestionFieldType);var options=null;if(searchType==="PARTY"){options=companyOptions}fields.push({$input:$input,fieldId:input.id,searchType:searchType,suggestionFieldType:suggestionFieldType,options:options})});fields.forEach(function(fieldData){var $input=fieldData.$input;var otherSuggestionFields=fields.filter(function(data){return data.$input!==$input});var valueParser=fieldParsingHelper.getCustomParser(fieldData.suggestionFieldType,fieldData.searchType);$input.suggestions({token:token,type:fieldData.searchType,params:fieldData.options,hint:hint,formatSelected:valueParser,onSelect:function(suggestion){var validator=$form.validate();validator.element($input);otherSuggestionFields.forEach(function(data){var $otherSuggestionInput=data.$input;if(overwriteNonEmptyFields||!$otherSuggestionInput.val()){var relatedFieldValue=getRelatedFieldValue(data,suggestion,fieldData.searchType);if(relatedFieldValue!==null){$otherSuggestionInput.val(relatedFieldValue);validator.element($otherSuggestionInput)}}})}});if($input.prop("readonly")){module.Suggestion.toggleForInput($input,false)}})}function getRelatedFieldValue(relatedFieldData,suggestion,searchType){var relatedFieldCustomParser=fieldParsingHelper.getCustomParser(relatedFieldData.suggestionFieldType,searchType);if(relatedFieldCustomParser){try{return relatedFieldCustomParser(suggestion)}catch(e){return null}}return null}function getSuggestionSearchType(suggestionFieldType){switch(suggestionFieldType){case"LegalAddress":case"PostalAddress":return"ADDRESS";case"Email":return"EMAIL";case"ChiefName":return"NAME";default:return"PARTY"}}function getCompanyOptions(selectedCompanyType){var companyOptions={status:["ACTIVE"]};switch(selectedCompanyType){case"SoleProprietorCompany":case"NaturalPerson":companyOptions.type="INDIVIDUAL";break;case"LegalCompany":companyOptions.type="LEGAL";break}return companyOptions}})(FogSoft||{},jQuery);var qq=qq||{};var qq=function(element){return{hide:function(){element.style.display="none";return this},attach:function(type,fn){if(element.addEventListener){element.addEventListener(type,fn,false)}else{if(element.attachEvent){element.attachEvent("on"+type,fn)}}return function(){qq(element).detach(type,fn)}},detach:function(type,fn){if(element.removeEventListener){element.removeEventListener(type,fn,false)}else{if(element.attachEvent){element.detachEvent("on"+type,fn)}}return this},contains:function(descendant){if(element==descendant){return true}if(element.contains){return element.contains(descendant)}else{return !!(descendant.compareDocumentPosition(element)&8)}},insertBefore:function(elementB){elementB.parentNode.insertBefore(element,elementB);return this},remove:function(){element.parentNode.removeChild(element);return this},css:function(styles){if(styles.opacity!=null){if(typeof element.style.opacity!="string"&&typeof(element.filters)!="undefined"){styles.filter="alpha(opacity="+Math.round(100*styles.opacity)+")"}}qq.extend(element.style,styles);return this},hasClass:function(name){var re=new RegExp("(^| )"+name+"( |$)");return re.test(element.className)},addClass:function(name){if(!qq(element).hasClass(name)){element.className+=" "+name}return this},removeClass:function(name){var re=new RegExp("(^| )"+name+"( |$)");element.className=element.className.replace(re," ").replace(/^\s+|\s+$/g,"");return this},getByClass:function(className){if(element.querySelectorAll){return element.querySelectorAll("."+className)}var result=[];var candidates=element.getElementsByTagName("*");var len=candidates.length;for(var i=0;i<len;i++){if(qq(candidates[i]).hasClass(className)){result.push(candidates[i])}}return result},children:function(){var children=[],child=element.firstChild;while(child){if(child.nodeType==1){children.push(child)}child=child.nextSibling}return children},setText:function(text){element.innerText=text;element.textContent=text;return this},clearText:function(){return qq(element).setText("")}}};qq.log=function(message,level){if(window.console){if(!level||level==="info"){window.console.log(message)}else{if(window.console[level]){window.console[level](message)}else{window.console.log("<"+level+"> "+message)}}}};qq.isObject=function(variable){return variable!==null&&variable&&typeof(variable)==="object"&&variable.constructor===Object};qq.extend=function(first,second,extendNested){var prop;for(prop in second){if(second.hasOwnProperty(prop)){if(extendNested&&qq.isObject(second[prop])){if(first[prop]===undefined){first[prop]={}}qq.extend(first[prop],second[prop],true)}else{first[prop]=second[prop]}}}};qq.indexOf=function(arr,elt,from){if(arr.indexOf){return arr.indexOf(elt,from)}from=from||0;var len=arr.length;if(from<0){from+=len}for(;from<len;from++){if(from in arr&&arr[from]===elt){return from}}return -1};qq.getUniqueId=(function(){var id=0;return function(){return id++}})();qq.ie=function(){return navigator.userAgent.indexOf("MSIE")!=-1};qq.ie10=function(){return navigator.userAgent.indexOf("MSIE 10")!=-1};qq.safari=function(){return navigator.vendor!=undefined&&navigator.vendor.indexOf("Apple")!=-1};qq.chrome=function(){return navigator.vendor!=undefined&&navigator.vendor.indexOf("Google")!=-1};qq.firefox=function(){return(navigator.userAgent.indexOf("Mozilla")!=-1&&navigator.vendor!=undefined&&navigator.vendor=="")};qq.windows=function(){return navigator.platform=="Win32"};qq.preventDefault=function(e){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}};qq.toElement=(function(){var div=document.createElement("div");return function(html){div.innerHTML=html;var element=div.firstChild;div.removeChild(element);return element}})();qq.obj2url=function(obj,temp,prefixDone){var uristrings=[],prefix="&",add=function(nextObj,i){var nextTemp=temp?(/\[\]$/.test(temp))?temp:temp+"["+i+"]":i;if((nextTemp!="undefined")&&(i!="undefined")){uristrings.push((typeof nextObj==="object")?qq.obj2url(nextObj,nextTemp,true):(Object.prototype.toString.call(nextObj)==="[object Function]")?encodeURIComponent(nextTemp)+"="+encodeURIComponent(nextObj()):encodeURIComponent(nextTemp)+"="+encodeURIComponent(nextObj))}};if(!prefixDone&&temp){prefix=(/\?/.test(temp))?(/\?$/.test(temp))?"":"&":"?";uristrings.push(temp);uristrings.push(qq.obj2url(obj))}else{if((Object.prototype.toString.call(obj)==="[object Array]")&&(typeof obj!="undefined")){for(var i=0,len=obj.length;i<len;++i){add(obj[i],i)}}else{if((typeof obj!="undefined")&&(obj!==null)&&(typeof obj==="object")){for(var i in obj){add(obj[i],i)}}else{uristrings.push(encodeURIComponent(temp)+"="+encodeURIComponent(obj))}}}if(temp){return uristrings.join(prefix)}else{return uristrings.join(prefix).replace(/^&/,"").replace(/%20/g,"+")}};qq.DisposeSupport={_disposers:[],dispose:function(){var disposer;while(disposer=this._disposers.shift()){disposer()}},addDisposer:function(disposeFunction){this._disposers.push(disposeFunction)},_attach:function(){this.addDisposer(qq(arguments[0]).attach.apply(this,Array.prototype.slice.call(arguments,1)))}};qq.FineUploaderBasic=function(o){var that=this;this._options={debug:false,button:null,multiple:true,multipleInputs:true,maxConnections:3,disableCancelForFormUploads:false,autoUpload:true,request:{endpoint:"/server/upload",params:{},customHeaders:{},forceMultipart:false,inputName:"qqfile"},validation:{allowedExtensions:[],sizeLimit:0,minSizeLimit:0,stopOnFirstInvalidFile:true},callbacks:{onSubmit:function(id,fileName){},onComplete:function(id,fileName,responseJSON){},onCompleteAll:function(){},onCancel:function(id,fileName){},onUpload:function(id,fileName,xhr){},onProgress:function(id,fileName,loaded,total){},onError:function(id,fileName,reason){},onAutoRetry:function(id,fileName,attemptNumber){},onManualRetry:function(id,fileName){},onValidate:function(fileData){},onBeforeSubmitFiles:function(){}},messages:{typeError:"{file} has an invalid extension. Valid extension(s): {extensions}.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",noFilesError:"No files to upload.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},retry:{enableAuto:false,maxAutoAttempts:3,autoAttemptDelay:5,preventRetryResponseProperty:"preventRetry"}};qq.extend(this._options,o,true);this._wrapCallbacks();qq.extend(this,qq.DisposeSupport);this._filesInProgress=0;this._storedFileIds=[];this._autoRetries=[];this._retryTimeouts=[];this._preventRetries=[];this._handler=this._createUploadHandler();if(this._options.button){this._button=this._createUploadButton(this._options.button)}this._preventLeaveInProgress()};qq.FineUploaderBasic.prototype={log:function(str,level){if(this._options.debug&&(!level||level==="info")){qq.log("[FineUploader] "+str)}else{if(level&&level!=="info"){qq.log("[FineUploader] "+str,level)}}},setParams:function(params){this._options.request.params=params},getInProgress:function(){return this._filesInProgress},uploadStoredFiles:function(){this._options.callbacks.onBeforeSubmitFiles();while(this._storedFileIds.length){this._filesInProgress++;this._handler.upload(this._storedFileIds.shift(),this._options.request.params)}},clearStoredFiles:function(){this._storedFileIds=[]},retry:function(id){if(this._onBeforeManualRetry(id)){this._handler.retry(id);return true}else{return false}},cancel:function(fileId){this._handler.cancel(fileId)},reset:function(){this.log("Resetting uploader...");this._handler.reset();this._filesInProgress=0;this._storedFileIds=[];this._autoRetries=[];this._retryTimeouts=[];this._preventRetries=[];this._button.reset()},_createUploadButton:function(element){var self=this;var button=new qq.UploadButton({element:element,multiple:this._options.multiple&&qq.UploadHandlerXhr.isSupported(),multipleInputs:this._options.multipleInputs,acceptFiles:this._options.validation.acceptFiles,onChange:function(input){self._onInputChange(input)}});this.addDisposer(function(){button.dispose()});return button},_createUploadHandler:function(){var self=this,handlerClass=this._options.handlerClass;if(!handlerClass){if(qq.UploadHandlerXhr.isSupported()){handlerClass="UploadHandlerXhr"}else{handlerClass="UploadHandlerForm"}}var handler=new qq[handlerClass]({debug:this._options.debug,endpoint:this._options.request.endpoint,forceMultipart:this._options.request.forceMultipart,maxConnections:this._options.maxConnections,customHeaders:this._options.request.customHeaders,inputName:this._options.request.inputName,demoMode:this._options.demoMode,log:this.log,onProgress:function(id,fileName,loaded,total){self._onProgress(id,fileName,loaded,total);self._options.callbacks.onProgress(id,fileName,loaded,total)},onComplete:function(id,fileName,result,xhr){self._onComplete(id,fileName,result,xhr);self._options.callbacks.onComplete(id,fileName,result)},onCompleteAll:function(){},onBeforeSubmitFiles:function(){},onCancel:function(id,fileName){self._onCancel(id,fileName);self._options.callbacks.onCancel(id,fileName)},onUpload:function(id,fileName,xhr){self._onUpload(id,fileName,xhr);self._options.callbacks.onUpload(id,fileName,xhr)},onAutoRetry:function(id,fileName,responseJSON,xhr){self._preventRetries[id]=responseJSON[self._options.retry.preventRetryResponseProperty];if(self._shouldAutoRetry(id,fileName,responseJSON)){self._maybeParseAndSendUploadError(id,fileName,responseJSON,xhr);self._options.callbacks.onAutoRetry(id,fileName,self._autoRetries[id]+1);self._onBeforeAutoRetry(id,fileName);self._retryTimeouts[id]=setTimeout(function(){self._onAutoRetry(id,fileName,responseJSON)},self._options.retry.autoAttemptDelay*1000);return true}else{return false}}});return handler},_preventLeaveInProgress:function(){var self=this;this._attach(window,"beforeunload",function(e){if(!self._filesInProgress){return}var e=e||window.event;e.returnValue=self._options.messages.onLeave;return self._options.messages.onLeave})},_onSubmit:function(id,fileName){if(this._options.autoUpload){this._filesInProgress++}},_onProgress:function(id,fileName,loaded,total){},_onCompleteAll:function(){this._options.callbacks.onCompleteAll()},_onBeforeSubmitFiles:function(){this._options.callbacks.onBeforeSubmitFiles()},_onComplete:function(id,fileName,result,xhr){this._filesInProgress--;this._maybeParseAndSendUploadError(id,fileName,result,xhr);if(this._filesInProgress==0){this._onCompleteAll()}},_onCancel:function(id,fileName){clearTimeout(this._retryTimeouts[id]);var storedFileIndex=qq.indexOf(this._storedFileIds,id);if(this._options.autoUpload||storedFileIndex<0){this._filesInProgress--}else{if(!this._options.autoUpload){this._storedFileIds.splice(storedFileIndex,1)}}},_onUpload:function(id,fileName,xhr){},_onInputChange:function(input){if(Modernizr&&Modernizr.filereader){if(this._handler instanceof qq.UploadHandlerXhr){this._uploadFileList(input.files)}else{if(this._validateFile(input.files[0])){this._uploadFile(input)}}}else{this._uploadFile(input)}this._button.reset()},_onBeforeAutoRetry:function(id,fileName){this.log("Waiting "+this._options.retry.autoAttemptDelay+" seconds before retrying "+fileName+"...")},_onAutoRetry:function(id,fileName,responseJSON){this.log("Retrying "+fileName+"...");this._autoRetries[id]++;this._handler.retry(id)},_shouldAutoRetry:function(id,fileName,responseJSON){if(!this._preventRetries[id]&&this._options.retry.enableAuto){if(this._autoRetries[id]===undefined){this._autoRetries[id]=0}return this._autoRetries[id]<this._options.retry.maxAutoAttempts}return false},_onBeforeManualRetry:function(id){if(this._preventRetries[id]){this.log("Retries are forbidden for id "+id,"warn");return false}else{if(this._handler.isValid(id)){var fileName=this._handler.getName(id);if(this._options.callbacks.onManualRetry(id,fileName)===false){return false}this.log("Retrying upload for '"+fileName+"' (id: "+id+")...");this._filesInProgress++;return true}else{this.log("'"+id+"' is not a valid file ID","error");return false}}},_maybeParseAndSendUploadError:function(id,fileName,response,xhr){if(!response.success){if(xhr&&xhr.status!==200&&!response.error){this._options.callbacks.onError(id,fileName,"XHR returned response code "+xhr.status,false)}else{var errorReason="Upload failure reason unknown";if(typeof response.error!=="undefined"){errorReason=response.error}if(typeof response.message!=="undefined"){errorReason=response.message}this._options.callbacks.onError(id,fileName,errorReason,false)}}},_uploadFileList:function(files){var validationDescriptors,index,batchInvalid=false;validationDescriptors=this._getValidationDescriptors(files);if(validationDescriptors.length>1){batchInvalid=this._options.callbacks.onValidate(validationDescriptors)===false}if(!batchInvalid){if(files.length>0){for(index=0;index<files.length;index++){if(this._validateFile(files[index])){this._uploadFile(files[index])}else{if(this._options.validation.stopOnFirstInvalidFile){return}}}}else{this._error("noFilesError","")}}},_uploadFile:function(fileContainer){var id=this._handler.add(fileContainer);var fileName=this._handler.getName(id);if(this._options.callbacks.onSubmit(id,fileName)!==false){this._onSubmit(id,fileName);if(this._options.autoUpload){this._handler.upload(id,this._options.request.params)}else{this._storeFileForLater(id)}}},_storeFileForLater:function(id){this._storedFileIds.push(id)},_validateFile:function(file){var validationDescriptor,name,size;validationDescriptor=this._getValidationDescriptor(file);name=validationDescriptor.name;size=validationDescriptor.size;if(this._options.callbacks.onValidate([validationDescriptor])===false){return false}if(!this._isAllowedExtension(name)){this._error("typeError",name);return false}else{if(size===0){this._error("emptyError",name);return false}else{if(size&&this._options.validation.sizeLimit&&size>this._options.validation.sizeLimit){this._error("sizeError",name);return false}else{if(size&&size<this._options.validation.minSizeLimit){this._error("minSizeError",name);return false}}}}return true},_error:function(code,fileName){var message=this._options.messages[code];function r(name,replacement){message=message.replace(name,replacement)}var extensions=this._options.validation.allowedExtensions.join(", ");r("{file}",this._formatFileName(fileName));r("{extensions}",extensions);r("{sizeLimit}",this._formatSize(this._options.validation.sizeLimit));r("{minSizeLimit}",this._formatSize(this._options.validation.minSizeLimit));this._options.callbacks.onError(null,fileName,message,true);return message},_formatFileName:function(name){if(name.length>33){name=name.slice(0,19)+"..."+name.slice(-13)}return name},_isAllowedExtension:function(fileName){var ext=(-1!==fileName.indexOf("."))?fileName.replace(/.*[.]/,"").toLowerCase():"";var allowed=this._options.validation.allowedExtensions;if(!allowed.length){return true}for(var i=0;i<allowed.length;i++){if(allowed[i].toLowerCase()==ext){return true}}return false},_formatSize:function(bytes){var i=-1;do{bytes=bytes/1024;i++}while(bytes>99);return Number(Math.max(bytes,0.1).toFixed(1))+" "+["kB","MB","GB","TB","PB","EB"][i]},_wrapCallbacks:function(){var self,safeCallback;self=this;safeCallback=function(name,callback,args){try{return callback.apply(self,args)}catch(exception){self.log("Caught exception in '"+name+"' callback - "+exception,"error")}};for(var prop in this._options.callbacks){(function(){var oldCallback=self._options.callbacks[prop];self._options.callbacks[prop]=function(){return safeCallback(prop,oldCallback,arguments)}}())}},_parseFileName:function(file){var name;if(file.value){name=file.value.replace(/.*(\/|\\)/,"")}else{name=(file.fileName!==null&&file.fileName!==undefined)?file.fileName:file.name}return name},_parseFileSize:function(file){var size;if(!file.value){size=(file.fileSize!==null&&file.fileSize!==undefined)?file.fileSize:file.size}return size},_getValidationDescriptor:function(file){var name,size,fileDescriptor;fileDescriptor={};name=this._parseFileName(file);size=this._parseFileSize(file);fileDescriptor.name=name;if(typeof size!=="undefined"){fileDescriptor.size=size}return fileDescriptor},_getValidationDescriptors:function(files){var index,fileDescriptors;fileDescriptors=[];for(index=0;index<files.length;index++){fileDescriptors.push(files[index])}return fileDescriptors}};qq.FineUploader=function(o){qq.FineUploaderBasic.apply(this,arguments);qq.extend(this._options,{element:null,listElement:null,dragAndDrop:{enabled:true,extraDropzones:[],hideDropzones:true,disableDefaultDropzone:false},text:{uploadButton:"Upload a file",cancelButton:"Cancel",retryButton:"Retry",failUpload:"Upload failed",dragZone:"Drop files here to upload",formatProgress:"{percent}% of {total_size}",waitingForResponse:"Processing..."},template:'<div class="qq-uploader">'+((!this._options.dragAndDrop||!this._options.dragAndDrop.disableDefaultDropzone)?'<div class="qq-upload-drop-area"><span>{dragZoneText}</span></div>':"")+(!this._options.button?'<div class="qq-upload-button"><div>{uploadButtonText}</div></div>':"")+(!this._options.listElement?'<ul class="qq-upload-list"></ul>':"")+"</div>",fileTemplate:'<li><div class="qq-progress-bar"></div> <span class="qq-upload-spinner"></span> <span class="qq-upload-finished"></span> <span class="qq-upload-file"></span> <span class="qq-upload-size"></span> <a class="qq-upload-cancel" href="#">{cancelButtonText}</a> <a class="qq-upload-retry" href="#">{retryButtonText}</a> <span class="qq-upload-status-text">{statusText}</span></li>',classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",dropDisabled:"qq-upload-drop-area-disabled",list:"qq-upload-list",progressBar:"qq-progress-bar",file:"qq-upload-file",spinner:"qq-upload-spinner",finished:"qq-upload-finished",retrying:"qq-upload-retrying",retryable:"qq-upload-retryable",size:"qq-upload-size",cancel:"qq-upload-cancel",retry:"qq-upload-retry",statusText:"qq-upload-status-text",success:"qq-upload-success",fail:"qq-upload-fail",successIcon:null,failIcon:null},failedUploadTextDisplay:{mode:"default",maxChars:50,responseProperty:"error",enableTooltip:true},messages:{tooManyFilesError:"You may only drop one file"},retry:{showAutoRetryNote:true,autoRetryNote:"Retrying {retryNum}/{maxAuto}...",showButton:false},showMessage:function(message){alert(message)}},true);qq.extend(this._options,o,true);this._wrapCallbacks();this._options.template=this._options.template.replace(/\{dragZoneText\}/g,this._options.text.dragZone);this._options.template=this._options.template.replace(/\{uploadButtonText\}/g,this._options.text.uploadButton);this._options.fileTemplate=this._options.fileTemplate.replace(/\{cancelButtonText\}/g,this._options.text.cancelButton);this._options.fileTemplate=this._options.fileTemplate.replace(/\{retryButtonText\}/g,this._options.text.retryButton);this._options.fileTemplate=this._options.fileTemplate.replace(/\{statusText\}/g,"");this._element=this._options.element;this._element.innerHTML=this._options.template;this._listElement=this._options.listElement||this._find(this._element,"list");this._classes=this._options.classes;if(!this._button){this._button=this._createUploadButton(this._find(this._element,"button"))}this._bindCancelAndRetryEvents();this._setupDragDrop()};qq.extend(qq.FineUploader.prototype,qq.FineUploaderBasic.prototype);qq.extend(qq.FineUploader.prototype,{clearStoredFiles:function(){qq.FineUploaderBasic.prototype.clearStoredFiles.apply(this,arguments);this._listElement.innerHTML=""},addExtraDropzone:function(element){this._setupExtraDropzone(element)},removeExtraDropzone:function(element){var dzs=this._options.dragAndDrop.extraDropzones;for(var i in dzs){if(dzs[i]===element){return this._options.dragAndDrop.extraDropzones.splice(i,1)}}},getItemByFileId:function(id){var item=this._listElement.firstChild;while(item){if(item.qqFileId==id){return item}item=item.nextSibling}},reset:function(){qq.FineUploaderBasic.prototype.reset.apply(this,arguments);this._element.innerHTML=this._options.template;this._listElement=this._options.listElement||this._find(this._element,"list");if(!this._options.button){this._button=this._createUploadButton(this._find(this._element,"button"))}this._bindCancelAndRetryEvents();this._setupDragDrop()},_leaving_document_out:function(e){return((qq.chrome()||(qq.safari()&&qq.windows()))&&e.clientX==0&&e.clientY==0)||(qq.firefox()&&!e.relatedTarget)},_storeFileForLater:function(id){qq.FineUploaderBasic.prototype._storeFileForLater.apply(this,arguments);var item=this.getItemByFileId(id);qq(this._find(item,"spinner")).hide()},_find:function(parent,type){var element=qq(parent).getByClass(this._options.classes[type])[0];if(!element){throw new Error("element not found "+type)}return element},_setupExtraDropzone:function(element){this._options.dragAndDrop.extraDropzones.push(element);this._setupDropzone(element)},_setupDropzone:function(dropArea){var self=this;var dz=new qq.UploadDropZone({element:dropArea,onEnter:function(e){qq(dropArea).addClass(self._classes.dropActive);e.stopPropagation()},onLeave:function(e){},onLeaveNotDescendants:function(e){qq(dropArea).removeClass(self._classes.dropActive)},onDrop:function(e){if(self._options.dragAndDrop.hideDropzones){qq(dropArea).hide()}qq(dropArea).removeClass(self._classes.dropActive);if(e.dataTransfer.files.length>1&&!self._options.multiple){self._error("tooManyFilesError","")}else{self._uploadFileList(e.dataTransfer.files)}}});this.addDisposer(function(){dz.dispose()});if(this._options.dragAndDrop.hideDropzones){qq(dropArea).hide()}},_setupDragDrop:function(){if(this._options.dragAndDrop.enabled!==true){return}var self,dropArea;self=this;if(!this._options.dragAndDrop.disableDefaultDropzone){dropArea=this._find(this._element,"drop");this._options.dragAndDrop.extraDropzones.push(dropArea)}var dropzones=this._options.dragAndDrop.extraDropzones;var i;for(i=0;i<dropzones.length;i++){this._setupDropzone(dropzones[i])}if(!this._options.dragAndDrop.disableDefaultDropzone&&(!qq.ie()||qq.ie10())){this._attach(document,"dragenter",function(e){if(qq(dropArea).hasClass(self._classes.dropDisabled)){return}dropArea.style.display="block";for(i=0;i<dropzones.length;i++){dropzones[i].style.display="block"}})}this._attach(document,"dragleave",function(e){if(self._options.dragAndDrop.hideDropzones&&qq.FineUploader.prototype._leaving_document_out(e)){for(i=0;i<dropzones.length;i++){qq(dropzones[i]).hide()}}});qq(document).attach("drop",function(e){if(self._options.dragAndDrop.hideDropzones){for(i=0;i<dropzones.length;i++){qq(dropzones[i]).hide()}}e.preventDefault()})},_onSubmit:function(id,fileName){qq.FineUploaderBasic.prototype._onSubmit.apply(this,arguments);this._addToList(id,fileName)},_onProgress:function(id,fileName,loaded,total){qq.FineUploaderBasic.prototype._onProgress.apply(this,arguments);var item,progressBar,text,percent,cancelLink,size;item=this.getItemByFileId(id);progressBar=this._find(item,"progressBar");percent=Math.round(loaded/total*100);if(loaded===total){cancelLink=this._find(item,"cancel");qq(cancelLink).hide();qq(progressBar).hide();qq(this._find(item,"statusText")).setText(this._options.text.waitingForResponse);text=this._formatSize(total)}else{text=this._formatProgress(loaded,total);qq(progressBar).css({display:"block"})}qq(progressBar).css({width:percent+"%"});size=this._find(item,"size");qq(size).css({display:"inline"});qq(size).setText(text)},_onCompleteAll:function(){this._options.callbacks.onCompleteAll()},_onBeforeSubmitFiles:function(){this._options.callbacks.onBeforeSubmitFiles()},_onComplete:function(id,fileName,result,xhr){qq.FineUploaderBasic.prototype._onComplete.apply(this,arguments);var item=this.getItemByFileId(id);qq(this._find(item,"statusText")).clearText();qq(item).removeClass(this._classes.retrying);qq(this._find(item,"progressBar")).hide();if(!this._options.disableCancelForFormUploads||qq.UploadHandlerXhr.isSupported()){qq(this._find(item,"cancel")).hide()}qq(this._find(item,"spinner")).hide();if(result.success){qq(item).addClass(this._classes.success);if(this._classes.successIcon){this._find(item,"finished").style.display="inline-block";qq(item).addClass(this._classes.successIcon)}}else{qq(item).addClass(this._classes.fail);if(this._classes.failIcon){this._find(item,"finished").style.display="inline-block";qq(item).addClass(this._classes.failIcon)}if(this._options.retry.showButton&&!this._preventRetries[id]){qq(item).addClass(this._classes.retryable)}this._controlFailureTextDisplay(item,result)}},_onUpload:function(id,fileName,xhr){qq.FineUploaderBasic.prototype._onUpload.apply(this,arguments);var item=this.getItemByFileId(id);this._showSpinner(item)},_onBeforeAutoRetry:function(id){var item,progressBar,cancelLink,failTextEl,retryNumForDisplay,maxAuto,retryNote;qq.FineUploaderBasic.prototype._onBeforeAutoRetry.apply(this,arguments);item=this.getItemByFileId(id);progressBar=this._find(item,"progressBar");this._showCancelLink(item);progressBar.style.width=0;qq(progressBar).hide();if(this._options.retry.showAutoRetryNote){failTextEl=this._find(item,"statusText");retryNumForDisplay=this._autoRetries[id]+1;maxAuto=this._options.retry.maxAutoAttempts;retryNote=this._options.retry.autoRetryNote.replace(/\{retryNum\}/g,retryNumForDisplay);retryNote=retryNote.replace(/\{maxAuto\}/g,maxAuto);qq(failTextEl).setText(retryNote);if(retryNumForDisplay===1){qq(item).addClass(this._classes.retrying)}}},_onBeforeManualRetry:function(id){if(qq.FineUploaderBasic.prototype._onBeforeManualRetry.apply(this,arguments)){var item=this.getItemByFileId(id);this._find(item,"progressBar").style.width=0;qq(item).removeClass(this._classes.fail);this._showSpinner(item);this._showCancelLink(item);return true}return false},_addToList:function(id,fileName){var item=qq.toElement(this._options.fileTemplate);if(this._options.disableCancelForFormUploads&&!qq.UploadHandlerXhr.isSupported()){var cancelLink=this._find(item,"cancel");qq(cancelLink).remove()}item.qqFileId=id;var fileElement=this._find(item,"file");qq(fileElement).setText(this._formatFileName(fileName));qq(this._find(item,"size")).hide();if(!this._options.multiple){this._clearList()}this._listElement.appendChild(item)},_clearList:function(){this._listElement.innerHTML="";this.clearStoredFiles()},_bindCancelAndRetryEvents:function(){var self=this,list=this._listElement;this._attach(list,"click",function(e){e=e||window.event;var target=e.target||e.srcElement;if(qq(target).hasClass(self._classes.cancel)||qq(target).hasClass(self._classes.retry)){qq.preventDefault(e);var item=target.parentNode;while(item.qqFileId==undefined){item=target=target.parentNode}if(qq(target).hasClass(self._classes.cancel)){self.cancel(item.qqFileId);qq(item).remove()}else{qq(item).removeClass(self._classes.retryable);self.retry(item.qqFileId)}}})},_formatProgress:function(uploadedSize,totalSize){var message=this._options.text.formatProgress;function r(name,replacement){message=message.replace(name,replacement)}r("{percent}",Math.round(uploadedSize/totalSize*100));r("{total_size}",this._formatSize(totalSize));return message},_controlFailureTextDisplay:function(item,response){var mode,maxChars,responseProperty,failureReason,shortFailureReason;mode=this._options.failedUploadTextDisplay.mode;maxChars=this._options.failedUploadTextDisplay.maxChars;responseProperty=this._options.failedUploadTextDisplay.responseProperty;if(mode==="custom"){failureReason=response[responseProperty];if(failureReason){if(failureReason.length>maxChars){shortFailureReason=failureReason.substring(0,maxChars)+"..."}}else{failureReason=this._options.text.failUpload;this.log("'"+responseProperty+"' is not a valid property on the server response.","warn")}qq(this._find(item,"statusText")).setText(shortFailureReason||failureReason);if(this._options.failedUploadTextDisplay.enableTooltip){this._showTooltip(item,failureReason)}}else{if(mode==="default"){qq(this._find(item,"statusText")).setText(this._options.text.failUpload)}else{if(mode!=="none"){this.log("failedUploadTextDisplay.mode value of '"+mode+"' is not valid","warn")}}}},_showTooltip:function(item,text){item.title=text},_showSpinner:function(item){var spinnerEl=this._find(item,"spinner");spinnerEl.style.display="inline-block"},_showCancelLink:function(item){if(!this._options.disableCancelForFormUploads||qq.UploadHandlerXhr.isSupported()){var cancelLink=this._find(item,"cancel");cancelLink.style.display="inline"}},_error:function(code,fileName){var message=qq.FineUploaderBasic.prototype._error.apply(this,arguments);this._options.showMessage(message)}});qq.UploadDropZone=function(o){this._options={element:null,onEnter:function(e){},onLeave:function(e){},onLeaveNotDescendants:function(e){},onDrop:function(e){}};qq.extend(this._options,o);qq.extend(this,qq.DisposeSupport);this._element=this._options.element;this._disableDropOutside();this._attachEvents()};qq.UploadDropZone.prototype={_dragover_should_be_canceled:function(){return qq.safari()||(qq.firefox()&&qq.windows())},_disableDropOutside:function(e){if(!qq.UploadDropZone.dropOutsideDisabled){if(this._dragover_should_be_canceled){qq(document).attach("dragover",function(e){e.preventDefault()})}else{qq(document).attach("dragover",function(e){if(e.dataTransfer){e.dataTransfer.dropEffect="none";e.preventDefault()}})}qq.UploadDropZone.dropOutsideDisabled=true}},_attachEvents:function(){var self=this;self._attach(self._element,"dragover",function(e){if(!self._isValidFileDrag(e)){return}var effect=qq.ie()?null:e.dataTransfer.effectAllowed;if(effect=="move"||effect=="linkMove"){e.dataTransfer.dropEffect="move"}else{e.dataTransfer.dropEffect="copy"}e.stopPropagation();e.preventDefault()});self._attach(self._element,"dragenter",function(e){if(!self._isValidFileDrag(e)){return}self._options.onEnter(e)});self._attach(self._element,"dragleave",function(e){if(!self._isValidFileDrag(e)){return}self._options.onLeave(e);var relatedTarget=document.elementFromPoint(e.clientX,e.clientY);if(qq(this).contains(relatedTarget)){return}self._options.onLeaveNotDescendants(e)});self._attach(self._element,"drop",function(e){if(!self._isValidFileDrag(e)){return}e.preventDefault();self._options.onDrop(e)})},_isValidFileDrag:function(e){if(qq.ie()&&!qq.ie10()){return false}var dt=e.dataTransfer,isSafari=qq.safari();var effectTest=qq.ie10()?true:dt.effectAllowed!="none";return dt&&effectTest&&(dt.files||(!isSafari&&dt.types.contains&&dt.types.contains("Files")))}};qq.UploadButton=function(o){this._options={element:null,multiple:false,multipleInputs:false,acceptFiles:null,name:"file",onChange:function(input){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"};qq.extend(this._options,o);qq.extend(this,qq.DisposeSupport);this._element=this._options.element;qq(this._element).css({position:"relative",overflow:"hidden",direction:"ltr"});this._input=this._createInput()};qq.UploadButton.prototype={getInput:function(){return this._input},reset:function(){if(this._input.parentNode){qq(this._input).remove()}qq(this._element).removeClass(this._options.focusClass);this._input=this._createInput()},_createInput:function(){var input=document.createElement("input");if(this._options.multipleInputs&&this._options.multiple){input.setAttribute("multiple","multiple")}if(this._options.acceptFiles){input.setAttribute("accept",this._options.acceptFiles)}input.setAttribute("type","file");input.setAttribute("name",this._options.name);qq(input).css({position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0});this._element.appendChild(input);var self=this;this._attach(input,"change",function(){self._options.onChange(input)});this._attach(input,"mouseover",function(){qq(self._element).addClass(self._options.hoverClass)});this._attach(input,"mouseout",function(){qq(self._element).removeClass(self._options.hoverClass)});this._attach(input,"focus",function(){qq(self._element).addClass(self._options.focusClass)});this._attach(input,"blur",function(){qq(self._element).removeClass(self._options.focusClass)});if(window.attachEvent){input.setAttribute("tabIndex","-1")}return input}};qq.UploadHandlerAbstract=function(o){this._options={debug:false,endpoint:"/upload.php",maxConnections:999,log:function(str,level){},onProgress:function(id,fileName,loaded,total){},onComplete:function(id,fileName,response,xhr){},onCompleteAll:function(response){},onCancel:function(id,fileName){},onUpload:function(id,fileName,xhr){},onAutoRetry:function(id,fileName,response,xhr){}};qq.extend(this._options,o);this._queue=[];this._params=[];this.log=this._options.log};qq.UploadHandlerAbstract.prototype={add:function(file){},upload:function(id,params){var len=this._queue.push(id);var copy={};qq.extend(copy,params);this._params[id]=copy;if(len<=this._options.maxConnections){this._upload(id,this._params[id])}},retry:function(id){var i=qq.indexOf(this._queue,id);if(i>=0){this._upload(id,this._params[id])}else{this.upload(id,this._params[id])}},cancel:function(id){this.log("Cancelling "+id);this._cancel(id);this._dequeue(id)},cancelAll:function(){for(var i=0;i<this._queue.length;i++){this._cancel(this._queue[i])}this._queue=[]},getName:function(id){},getSize:function(id){},getQueue:function(){return this._queue},reset:function(){this.log("Resetting upload handler");this._queue=[];this._params=[]},_upload:function(id){},_cancel:function(id){},_dequeue:function(id){var i=qq.indexOf(this._queue,id);this._queue.splice(i,1);var max=this._options.maxConnections;if(this._queue.length>=max&&i<max){var nextId=this._queue[max-1];this._upload(nextId,this._params[nextId])}},isValid:function(id){}};qq.UploadHandlerForm=function(o){qq.UploadHandlerAbstract.apply(this,arguments);this._inputs={};this._detach_load_events={}};qq.extend(qq.UploadHandlerForm.prototype,qq.UploadHandlerAbstract.prototype);qq.extend(qq.UploadHandlerForm.prototype,{add:function(fileInput){fileInput.setAttribute("name",this._options.inputName);var id="qq-upload-handler-iframe"+qq.getUniqueId();this._inputs[id]=fileInput;if(fileInput.parentNode){qq(fileInput).remove()}return id},getName:function(id){return this._inputs[id].value.replace(/.*(\/|\\)/,"")},isValid:function(id){return this._inputs[id]!==undefined},reset:function(){qq.UploadHandlerAbstract.prototype.reset.apply(this,arguments);this._inputs={};this._detach_load_events={}},_cancel:function(id){this._options.onCancel(id,this.getName(id));delete this._inputs[id];delete this._detach_load_events[id];var iframe=document.getElementById(id);if(iframe){iframe.setAttribute("src","javascript:false;");qq(iframe).remove()}},_upload:function(id,params){this._options.onUpload(id,this.getName(id),false);var input=this._inputs[id];if(!input){throw new Error("file with passed id was not added, or already uploaded or cancelled")}var fileName=this.getName(id);params[this._options.inputName]=fileName;var iframe=this._createIframe(id);var form=this._createForm(iframe,params);form.appendChild(input);var self=this;this._attachLoadEvent(iframe,function(){self.log("iframe loaded");var response=self._getIframeContentJSON(iframe);setTimeout(function(){self._detach_load_events[id]();delete self._detach_load_events[id];qq(iframe).remove()},1);if(!response.success){if(self._options.onAutoRetry(id,fileName,response)){return}}self._options.onComplete(id,fileName,response);self._dequeue(id)});this.log("Sending upload request for "+id);form.submit();qq(form).remove();return id},_attachLoadEvent:function(iframe,callback){var self=this;this._detach_load_events[iframe.id]=qq(iframe).attach("load",function(){self.log("Received response for "+iframe.id);if(!iframe.parentNode){return}try{if(iframe.contentDocument&&iframe.contentDocument.body&&iframe.contentDocument.body.innerHTML=="false"){return}}catch(error){self.log("Error when attempting to access iframe during handling of upload response ("+error+")","error")}callback()})},_getIframeContentJSON:function(iframe){try{var doc=iframe.contentDocument?iframe.contentDocument:iframe.contentWindow.document,response;var innerHTML=doc.body.innerHTML;this.log("converting iframe's innerHTML to JSON");this.log("innerHTML = "+innerHTML);if(innerHTML&&innerHTML.match(/^<pre/i)){innerHTML=doc.body.firstChild.firstChild.nodeValue}response=eval("("+innerHTML+")")}catch(error){this.log("Error when attempting to parse form upload response ("+error+")","error");response={success:false}}return response},_createIframe:function(id){var iframe=qq.toElement('<iframe src="javascript:false;" name="'+id+'" />');iframe.setAttribute("id",id);iframe.style.display="none";document.body.appendChild(iframe);return iframe},_createForm:function(iframe,params){var protocol=this._options.demoMode?"GET":"POST";var form=qq.toElement('<form method="'+protocol+'" enctype="multipart/form-data"></form>');var queryString=qq.obj2url(params,this._options.endpoint);form.setAttribute("action",queryString);form.setAttribute("target",iframe.name);form.style.display="none";document.body.appendChild(form);return form}});qq.UploadHandlerXhr=function(o){qq.UploadHandlerAbstract.apply(this,arguments);this._files=[];this._xhrs=[];this._loaded=[]};qq.UploadHandlerXhr.isSupported=function(){var input=document.createElement("input");input.type="file";return("multiple" in input&&typeof File!="undefined"&&typeof FormData!="undefined"&&typeof(new XMLHttpRequest()).upload!="undefined")};qq.extend(qq.UploadHandlerXhr.prototype,qq.UploadHandlerAbstract.prototype);qq.extend(qq.UploadHandlerXhr.prototype,{add:function(file){if(!(file instanceof File)){throw new Error("Passed obj in not a File (in qq.UploadHandlerXhr)")}return this._files.push(file)-1},getName:function(id){var file=this._files[id];return(file.fileName!==null&&file.fileName!==undefined)?file.fileName:file.name},getSize:function(id){var file=this._files[id];return file.fileSize!=null?file.fileSize:file.size},getLoaded:function(id){return this._loaded[id]||0},isValid:function(id){return this._files[id]!==undefined},reset:function(){qq.UploadHandlerAbstract.prototype.reset.apply(this,arguments);this._files=[];this._xhrs=[];this._loaded=[]},_upload:function(id,params){this._options.onUpload(id,this.getName(id),true);var file=this._files[id],name=this.getName(id),size=this.getSize(id);this._loaded[id]=0;var xhr=this._xhrs[id]=new XMLHttpRequest();var self=this;xhr.upload.onprogress=function(e){if(e.lengthComputable){self._loaded[id]=e.loaded;self._options.onProgress(id,name,e.loaded,e.total)}};xhr.onreadystatechange=function(){if(xhr.readyState==4){self._onComplete(id,xhr)}};params=params||{};params[this._options.inputName]=name;var queryString=qq.obj2url(params,this._options.endpoint);var protocol=this._options.demoMode?"GET":"POST";xhr.open(protocol,queryString,true);xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");xhr.setRequestHeader("X-File-Name",encodeURIComponent(name));xhr.setRequestHeader("Cache-Control","no-cache");if(this._options.forceMultipart){var formData=new FormData();formData.append(this._options.inputName,file);file=formData}else{xhr.setRequestHeader("Content-Type","application/octet-stream");xhr.setRequestHeader("X-Mime-Type",file.type)}for(key in this._options.customHeaders){xhr.setRequestHeader(key,this._options.customHeaders[key])}this.log("Sending upload request for "+id);xhr.send(file)},_onCompleteAll:function(){this._options.onCompleteAll()},_onComplete:function(id,xhr){if(!this._files[id]){return}var name=this.getName(id);var size=this.getSize(id);var response;this._options.onProgress(id,name,size,size);this.log("xhr - server response received for "+id);this.log("responseText = "+xhr.responseText);try{if(typeof JSON.parse==="function"){response=JSON.parse(xhr.responseText)}else{response=eval("("+xhr.responseText+")")}}catch(error){this.log("Error when attempting to parse xhr response text ("+error+")","error");response={}}if(xhr.status!==200||!response.success){if(this._options.onAutoRetry(id,name,response,xhr)){return}}this._options.onComplete(id,name,response,xhr);this._xhrs[id]=null;this._dequeue(id)},_cancel:function(id){this._options.onCancel(id,this.getName(id));this._files[id]=null;if(this._xhrs[id]){this._xhrs[id].abort();this._xhrs[id]=null}}});(function($){var uploader,$el,init,dataStore,pluginOption,pluginOptions,addCallbacks,transformOptions,isValidCommand,delegateCommand;pluginOptions=["uploaderType"];init=function(options){if(options){var xformedOpts=transformOptions(options);addCallbacks(xformedOpts);if(pluginOption("uploaderType")==="basic"){uploader(new qq.FineUploaderBasic(xformedOpts))}else{uploader(new qq.FineUploader(xformedOpts))}}return $el};dataStore=function(key,val){var data=$el.data("fineuploader");if(val){if(data===undefined){data={}}data[key]=val;$el.data("fineuploader",data)}else{if(data===undefined){return null}return data[key]}};uploader=function(instanceToStore){return dataStore("uploader",instanceToStore)};pluginOption=function(option,optionVal){return dataStore(option,optionVal)};addCallbacks=function(transformedOpts){var callbacks=transformedOpts.callbacks={};$.each(new qq.FineUploaderBasic()._options.callbacks,function(prop,func){var name,$callbackEl;name=/^on(\w+)/.exec(prop)[1];name=name.substring(0,1).toLowerCase()+name.substring(1);$callbackEl=$el;callbacks[prop]=function(){var args=Array.prototype.slice.call(arguments);return $callbackEl.triggerHandler(name,args)}})};transformOptions=function(source,dest){var xformed,arrayVals;if(dest===undefined){if(source.uploaderType!=="basic"){xformed={element:$el[0]}}else{xformed={}}}else{xformed=dest}$.each(source,function(prop,val){if($.inArray(prop,pluginOptions)>=0){pluginOption(prop,val)}else{if(val instanceof $){xformed[prop]=val[0]}else{if($.isPlainObject(val)){xformed[prop]={};transformOptions(val,xformed[prop])}else{if($.isArray(val)){arrayVals=[];$.each(val,function(idx,arrayVal){if(arrayVal instanceof $){$.merge(arrayVals,arrayVal)}else{arrayVals.push(arrayVal)}});xformed[prop]=arrayVals}else{xformed[prop]=val}}}}});if(dest===undefined){return xformed}};isValidCommand=function(command){return $.type(command)==="string"&&!command.match(/^_/)&&uploader()[command]!==undefined};delegateCommand=function(command){return uploader()[command].apply(uploader(),Array.prototype.slice.call(arguments,1))};$.fn.fineUploader=function(optionsOrCommand){$el=this;if(uploader()&&isValidCommand(optionsOrCommand)){return delegateCommand.apply(this,arguments)}else{if(typeof optionsOrCommand==="object"||!optionsOrCommand){return init.apply(this,arguments)}else{$.error("Method "+optionsOrCommand+" does not exist on jQuery.fineUploader")}}return this}}(jQuery));var FogSoft=(function(module,$){var docModule=module.Documents=module.Documents||{},commonModule=module.Common||{};docModule.uploadSignature=function(uploadSignatureOptions){if(uploadSignatureOptions.url&&uploadSignatureOptions.entityUid&&uploadSignatureOptions.signature){return $.ajax(uploadSignatureOptions.url,{type:"POST",data:{entityUid:uploadSignatureOptions.entityUid,signatureModel:JSON.stringify({Value:uploadSignatureOptions.signature})}})}return $.Deferred().reject().promise()};docModule.createUploader=function(options){options=options||{};if(!options.extensions||!options.extensions.length){options.extensions=[]}if(options.autoUpload==null){options.autoUpload=false}if(options.selectButtonText==null){options.selectButtonText=options.model.resources.selectButtonTitle}if(options.showNotificationsImmediately==null){options.showNotificationsImmediately=true}var liteTemplate='<div class="qq-uploader" style="display:inline;">'+(options.useUploadHandlerForm?"":'<div class="qq-upload-drop-area" style="display:none;"><span>{dragZoneText}</span></div>')+'<span type="button" class="btn btn-sm qq-upload-button" style="display:inline-block;"><i class="icon-add"></i>{uploadButtonText}</span><ul class="qq-upload-list" style="display:none;"></ul></div>';var template='<div class="qq-uploader">'+(options.useUploadHandlerForm?"":'<div class="qq-upload-drop-area"><span>{dragZoneText}</span></div>')+'<div class="qq-upload-button btn" style="width: auto;">{uploadButtonText}</div><ul class="qq-upload-list" style="margin-top: 10px;"></ul></div>';var uploader=new qq.FineUploader({element:options.element,listElement:options.listElement,request:{endpoint:options.model.uploadFileUrl+"&ShowNotificationsImmediately="+options.showNotificationsImmediately+"&UrnType="+options.urnType+"&DocumentUid="+(options.documentUid!=null?options.documentUid:""),inputName:"Name"},handlerClass:options.useUploadHandlerForm?"UploadHandlerForm":null,multipleInputs:!options.useUploadHandlerForm,autoUpload:options.autoUpload,text:{uploadButton:options.selectButtonText,cancelButton:options.model.resources.cancelButtonTitle,retryButton:options.model.resources.retryButtonTitle,failUpload:options.model.resources.failUploadMessageText,dragZone:options.model.resources.dragButtonTitle,formatProgress:options.model.resources.formatProgressText,waitingForResponse:options.model.resources.waitingForResponse},template:options.listElement!=null?liteTemplate:template,dragAndDrop:{enabled:!options.useUploadHandlerForm,extraDropzones:[],hideDropzones:false,disableDefaultDropzone:false},callbacks:{onCompleteAll:function(){$(document.body).trigger("Document.FilesUploaded")},onValidate:function(fileData){options.parentElement&&commonModule.closeErrorMessages&&commonModule.closeErrorMessages(options.parentElement);if(!this._maxFileCount){return true}if(this._storedFileIds.length>=this._maxFileCount){commonModule.showErrorMessage(options.model.resources.maxFileCountExceededErrorMessage,null,options.parentElement);return false}return true},onUpload:function(id){this.rawUploadUrl=this.rawUploadUrl||this._handler._options.endpoint;this._handler._options.endpoint=this.rawUploadUrl+(this._fileUids?"&uid="+this._fileUids[id]:"");if((options.documentUid==null||options.documentUid===undefined)&&this._storedFileIds.length===0){this._handler._options.endpoint+="&deleteDocumentIfNoFiles=True"}},onError:function(id,fileName,errorReason,beforeUpload){if(options.showNotificationsImmediately){commonModule.showErrorMessage(errorReason,options.model.cannotUploadFileTitle+" "+fileName,beforeUpload?options.parentElement:null)}},onBeforeSubmitFiles:function(){if(!this._storedFileIds||!$.isArray(this._storedFileIds)||this._storedFileIds.length===0){return}this._fileIds=this._fileIds||[];this._fileUids=this._fileUids||{};this._filePaths=this._filePaths||{};this._fileBlobs=this._fileBlobs||{};for(var i=0;i<this._storedFileIds.length;i++){var fileId=this._storedFileIds[i];this._fileIds.push(fileId);this._fileUids[fileId]=commonModule.generateGuid();if(this._handler._inputs){this._filePaths[fileId]=this._handler._inputs[fileId].value}if(this._handler._files){this._fileBlobs[fileId]=this._handler._files[fileId]}}}},classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",dropDisabled:"qq-upload-drop-area-disabled",list:"qq-upload-list",progressBar:"qq-progress-bar",file:"qq-upload-file",spinner:"qq-upload-spinner",finished:"qq-upload-finished",size:"qq-upload-size",cancel:"qq-upload-cancel",failText:"qq-upload-failed-text",success:null,fail:null,successIcon:null,failIcon:null},validation:{allowedExtensions:options.extensions,sizeLimit:options.sizeLimit},messages:options.model.uploaderMessages,showMessage:function(message){},debug:false});if(options.maxFileCount>0){uploader._maxFileCount=options.maxFileCount}var $element=$(options.element);uploader.enableSelectButton=function(mode){var $button=$element.find("."+uploader._classes.button);$input=$button.find("input");$button.prop("disabled",!mode);$input.prop("disabled",!mode);if(mode){$input.css("cursor","pointer")}else{$input.css("cursor","not-allowed")}};return uploader};docModule.deleteEntity=function($documentsRoot,entityUid,confirmMessage,confirmTitle,submitUrl){var deleteHandler=function(){var $form=$documentsRoot.find("form[name=documentActionForm]");$form.find("input[name=uid]").val(entityUid);$form.prop("action",submitUrl).submit()};if(commonModule.showConfirm){var opt={confirmTitle:confirmTitle};commonModule.showConfirm(confirmMessage,opt).done(deleteHandler)}else{confirm(confirmMessage)&&deleteHandler()}};docModule.signRemoteFile=function(options){var resultDeferred=$.Deferred();if(options.embeddedSignature===true){function showError(messages){var modalContainer=$(".modal-content");FogSoft.Common.closeMessages("signer",modalContainer);FogSoft.Common.showErrorMessage(messages,null,modalContainer,"signer")}var embeddedSigner=FogSoftEmbeddedSigner.get();if(!embeddedSigner.AddPlugin()){showError(options.embeddedSignErrorMessage);resultDeferred.reject();return resultDeferred}if(!embeddedSigner.IsCertificateExportable(options.cert.thumbprint)){showError(options.certificateNotExportableErrorMessage);resultDeferred.reject();return resultDeferred}$.ajax(options.getEmbeddedHashUrl,{type:"POST",success:function(){}}).then(function(data){if(data.Success===true){return embeddedSigner.SignHash(data.Data,options.cert.thumbprint)}else{return $.Deferred().reject(data.Messages).promise()}}).then(function(signatureBytes){return $.ajax(options.saveEmbeddedSignatureUrl,{type:"POST",data:{signature:signatureBytes},success:function(){}})}).then(function(data){if(data.Success===true){resultDeferred.resolve()}else{return $.Deferred().reject(data.Messages).promise()}}).fail(function(messages){showError(messages);resultDeferred.reject()})}else{options.signer.DownloadFile(options.remoteFileUrl,function(progressResult){if(progressResult.IsCompleted){options.signer.SignDownloadedFileAsync(options.cert,progressResult.FileId).then(function(signature){if(options.onlyGenerateSignature===true){return $.Deferred().resolve(signature).promise()}return docModule.uploadSignature({url:options.uploadSignatureUrl,entityUid:options.fileUid,signature:signature})}).then(function(data){resultDeferred.resolve(data)}).fail(function(){resultDeferred.reject()}).always(function(){progressResult.Delete()})}if(progressResult.IsError){resultDeferred.reject()}},options.cert)}return resultDeferred.promise()};docModule.startUploadFilesToDocument=function(uploader,documentUid){uploader._options.request.endpoint+=documentUid;uploader._handler._options.endpoint+=documentUid;uploader.uploadStoredFiles()};docModule.splitAllowedExtensions=function(allowedExtensions){if(allowedExtensions==null){return[]}var arrayExtensions=allowedExtensions.split(",");for(var i=0;i<arrayExtensions.length;i++){arrayExtensions[i]=$.trim(arrayExtensions[i]).replace(".","")}return arrayExtensions};docModule.signDocuments=function(files,thumbprint,signUrl,onlyGenerateSignature,embeddedSignaturePluginErrorMessage,certificateNotExportableErrorMessage){return FogSoftSigner.getAsync().then(function(signer){return signer.FindCertificateByThumbprintAsync(thumbprint).then(function(cert){var deferreds=[];files.forEach(function(file){var fileTokenUrl=file.TokenUrl;var fileUid=file.Uid;var embeddedSignature=file.EmbeddedSignature;var saveEmbeddedSignatureUrl=file.SaveEmbeddedSignatureUrl;var getEmbeddedHashUrl=file.GetEmbeddedHashUrl;var uploadSignatureUrl=signUrl;deferreds.push($.ajax(fileTokenUrl,{type:"POST",success:function(){}}).then(function(data){var d=$.Deferred();if(data.Success){docModule.signRemoteFile({signer:signer,cert:cert,remoteFileUrl:data.Data,uploadSignatureUrl:uploadSignatureUrl,embeddedSignErrorMessage:embeddedSignaturePluginErrorMessage,certificateNotExportableErrorMessage:certificateNotExportableErrorMessage,fileUid:fileUid,embeddedSignature:embeddedSignature,getEmbeddedHashUrl:getEmbeddedHashUrl,saveEmbeddedSignatureUrl:saveEmbeddedSignatureUrl,onlyGenerateSignature:onlyGenerateSignature}).then(function(data){d.resolve({signature:data,fileUid:fileUid,entityTypeCode:"DocumentFile"})},function(e){d.reject(e)})}else{d.reject(data.Messages)}return d.promise()}))});return $.when.apply($,deferreds)})})};return module}(FogSoft||{},jQuery));var FogSoft=(function(module,$,PhotoSwipe,PhotoSwipeUI_Default){var docModule=module.DocumentsPreview=module.DocumentsPreview||{};docModule.initPhotoSwipeFromDOM=function(gallerySelector){var parseThumbnailElements=function(el){var thumbElements=el.childNodes,numNodes=thumbElements.length,items=[],el,childElements,item;for(var i=0;i<numNodes;i++){el=thumbElements[i];if(el.nodeType!==1){continue}childElements=el.children;item={src:el.getAttribute("href"),w:-1,h:-1,title:$(childElements[0]).data("title")};item.el=el;if(childElements.length>0){item.msrc=childElements[0].getAttribute("src")}item.o={src:item.src,w:item.w,h:item.h};items.push(item)}return items};var closest=function closest(el,fn){return el&&(fn(el)?el:closest(el.parentNode,fn))};var onThumbnailsClick=function(e){e=e||window.event;e.preventDefault?e.preventDefault():e.returnValue=false;var eTarget=e.target||e.srcElement;var clickedListItem=closest(eTarget,function(el){return el.tagName==="A"});if(!clickedListItem){return}var clickedGallery=clickedListItem.parentNode;var childNodes=clickedListItem.parentNode.childNodes,numChildNodes=childNodes.length,nodeIndex=0,index;for(var i=0;i<numChildNodes;i++){if(childNodes[i].nodeType!==1){continue}if(childNodes[i]===clickedListItem){index=nodeIndex;break}nodeIndex++}if(index>=0){openPhotoSwipe(index,clickedGallery)}return false};var photoswipeParseHash=function(){var hash=window.location.hash.substring(1),params={};if(hash.length<5){return params}var vars=hash.split("&");for(var i=0;i<vars.length;i++){if(!vars[i]){continue}var pair=vars[i].split("=");if(pair.length<2){continue}params[pair[0]]=pair[1]}if(params.gid){params.gid=parseInt(params.gid,10)}return params};var openPhotoSwipe=function(index,galleryElement,disableAnimation,fromURL){var pswpElement=document.querySelectorAll(".pswp")[0],gallery,options,items;items=parseThumbnailElements(galleryElement);options={bgOpacity:0.7,showHideOpacity:true,hideAnimationDuration:0,showAnimationDuration:0,addCaptionHTMLFn:function(item,captionEl){captionEl.children[0].innerHTML="<b>ÐÐ¼Ñ ÑÐ°Ð¹Ð»Ð°: "+item.title+"</b>";return true}};if(fromURL){if(options.galleryPIDs){for(var j=0;j<items.length;j++){if(items[j].pid==index){options.index=j;break}}}else{options.index=parseInt(index,10)-1}}else{options.index=parseInt(index,10)}if(isNaN(options.index)){return}gallery=new PhotoSwipe(pswpElement,PhotoSwipeUI_Default,items,options);var realViewportWidth,useLargeImages=false,firstResize=true,imageSrcWillChange;gallery.listen("beforeResize",function(){var dpiRatio=window.devicePixelRatio?window.devicePixelRatio:1;dpiRatio=Math.min(dpiRatio,2.5);realViewportWidth=gallery.viewportSize.x*dpiRatio;if(realViewportWidth>=1200||(!gallery.likelyTouchDevice&&realViewportWidth>800)||screen.width>1200){if(!useLargeImages){useLargeImages=true;imageSrcWillChange=true}}else{if(useLargeImages){useLargeImages=false;imageSrcWillChange=true}}if(imageSrcWillChange&&!firstResize){gallery.invalidateCurrItems()}if(firstResize){firstResize=false}imageSrcWillChange=false});gallery.listen("gettingData",function(index,item){if(item.w<1||item.h<1){var img=new Image();img.onload=function(){item.w=this.width;item.h=this.height;gallery.updateSize(true)};img.src=item.src}});gallery.init()};var galleryElements=document.querySelectorAll(gallerySelector);for(var i=0,l=galleryElements.length;i<l;i++){galleryElements[i].setAttribute("data-pswp-uid",i+1);galleryElements[i].onclick=onThumbnailsClick}var hashData=photoswipeParseHash();if(hashData.pid&&hashData.gid){openPhotoSwipe(hashData.pid,galleryElements[hashData.gid-1],true,true)}};return module}(FogSoft||{},jQuery,window.PhotoSwipe,window.PhotoSwipeUI_Default));var FogSoft=(function(module,$,_){var messagesModule=module.Messages=module.Messages||{};messagesModule.init=init;function init(initOptions){var options={inbox:"Inbox",outbox:"Outbox",drafts:"Drafts",defaultBox:"Inbox",boxHashId:"mailbox",messageHashId:"id",onSuccess:function(){},gridSelector:"",btnBackSelector:"#btn-back",btnRefreshSelector:"#btn-refresh",readSelector:"#message-wrapper #mark-as-read",notReadSelector:"#message-wrapper #mark-as-not-read",sendSelector:"#message-wrapper #send-message",deleteSelector:"#message-wrapper #delete-message",detailsUrl:"",deleteUrl:"",sendUrl:"",readUrl:"",notReadUrl:"",loadErrorText:"",markedAsReadText:"",markedAsNotReadText:"",deletedText:"",sentText:""};$.extend(options,initOptions);$(".messages #SelectedMessages").val(JSON.stringify([]));var currentEnvelopeId;var clearSuccessMessages=true;var readTimerId;var gridLoader=$(options.gridSelector).data("loader");gridLoader.grid.onActiveCellChanged.subscribe(function(e,args){if(args.row>=0){setHashForMessage(gridLoader.getRowData(args.row)["EnvelopeId"])}});gridLoader.model.onDataLoading.subscribe(function(e,args){args.data.push({name:"MailBoxCode",value:currentActiveBox()});$(".messages #SelectedMessages").val(JSON.stringify([]))});gridLoader.grid.onSelectedRowsChanged.subscribe(function(){$(".messages #SelectedMessages").val(JSON.stringify(gridLoader.getSelectedData(true)))});gridLoader.setRowCssClassProvider(function(row){return(row&&currentActiveBox()===options.inbox&&!row.IsRead)?"new-message":null});var stateMailbox=$.bbq.getState(options.boxHashId);var stateEnvelopeId=$.bbq.getState(options.messageHashId);if(!stateMailbox){setHashForMailbox(options.defaultBox);stateMailbox=options.defaultBox}var isShowToolbars=isNaN(stateEnvelopeId);selectTab(stateMailbox,true,isShowToolbars);if(stateEnvelopeId){currentEnvelopeId=stateEnvelopeId;loadDetails()}$(window).bind("hashchange",function(e){setTimeout(function(){var stateMailbox=$.bbq.getState(options.boxHashId);var stateEnvelopeId=$.bbq.getState(options.messageHashId);if(!stateMailbox){removeHashForMessage();setHashForMailbox(options.defaultBox);selectTab(options.defaultBox,true,false);return}if(stateMailbox!=currentActiveBox()){removeHashForMessage();selectTab(stateMailbox,true,true);return}stopReadTimer();if(stateEnvelopeId&&currentEnvelopeId!=stateEnvelopeId){currentEnvelopeId=stateEnvelopeId;loadDetails();return}if(!stateEnvelopeId&&currentEnvelopeId){currentEnvelopeId=null;selectTab(stateMailbox,true,true)}},0)});$(document).on("click",options.btnRefreshSelector,function(e,args){gridLoader.refresh();e.preventDefault()});$(document).on("click",options.btnBackSelector,function(e,args){removeHashForMessage();e.preventDefault()});$('.message-menu a[data-toggle="tab"]').on("shown",function(e){$(".messages #MailBoxCode").val(currentActiveBox())});$(".message-menu li.nav-header-message").click(function(){setHashForMailbox($(this).prop("id"))});function selectTab(tabId,withLoad,isShowToolbar){var $tab=$("#"+tabId),$dropdown=$(".message-menu .dropdown-toggle");if(!$tab.length){return}$tab.find("a").tab("show");$dropdown.html($tab.find("a").html()).append('<span class="caret"></span>');gridLoader.grid.setSelectedRows([]);showTable(isShowToolbar);if(withLoad){gridLoader.refresh(false)}$(".message-menu .dropdown-menu a").on("click",function(){$(".message-menu > .dropdown").removeClass("open")})}function showMessage(data){var $messageWrapper=$(".message-info");var $table=$(".messages");$messageWrapper.html(data);FogSoft.Common.init($messageWrapper);$table.hide();var notEnvelopeDetailsButtons=$(".message-menu > li > button").not("details-btns");notEnvelopeDetailsButtons.hide();FogSoft.Common.closeSuccessMessages();$(".details-btns").show();$messageWrapper.show()}function showTable(isShowToolbarButtons){var $messageWrapper=$(".message-info");$messageWrapper.html("");$messageWrapper.hide();$(".message-menu > li > button").hide();if(isShowToolbarButtons){$(".list-btns").show();var $inboxToolbar=$(".inbox-btns");var $outboxToolbar=$(".outbox-btns");var $draftToolbar=$(".draft-btns");if(currentActiveBox()==options.inbox){$inboxToolbar.show()}if(currentActiveBox()==options.outbox){$outboxToolbar.show()}if(currentActiveBox()==options.drafts){$draftToolbar.show()}}$(".messages").show();gridLoader.grid.resetActiveCell()}function loadDetails(){$.ajax({type:"POST",url:options.detailsUrl,data:{envelopeId:currentEnvelopeId,mailBox:currentActiveBox()},processResult:function(result){if(result){showMessage(result);readWithDelay(500)}else{FogSoft.Common.showErrorMessage(options.loadErrorText);removeHashForMessage()}}})}$(document.body).on("Messages.Read Messages.NotRead",function(evt,data){var table=gridLoader.table;if(table==null){gridLoader.refresh()}else{gridLoader.refresh(false);gridLoader.clearSelection()}});$(document.body).on("Messages.Deleted Messages.Sent",function(evt,data){var table=gridLoader.table;if(table==null){gridLoader.refresh();gridLoader.clearSelection();return}var pageInfo=table.page.info();var selectedRowsCount=gridLoader.grid.getSelectedRows().length;var currentPageRows=gridLoader.Sorting.Total-gridLoader.Sorting.Offset;if(pageInfo.page===pageInfo.pages-1&&selectedRowsCount===currentPageRows){gridLoader.refresh(true)}else{gridLoader.refresh(false)}gridLoader.clearSelection()});$(document.body).on("Message.Sent",function(evt,data){FogSoft.Common.showSuccessMessage(options.sentText);removeHashForMessage();options.onSuccess("sent")});$(document.body).on("Messages.Deleted",function(evt,data){currentEnvelopeId=$.bbq.getState(options.messageHashId);if(currentEnvelopeId){removeHashForMessage()}});function readWithDelay(ms){readTimerId=setTimeout(function(){markAsRead()},ms)}function stopReadTimer(){if(readTimerId){clearTimeout(readTimerId);readTimerId=0}}$(document).on("click",options.readSelector,function(e){stopReadTimer();markAsRead(true);e.preventDefault()});$(document).on("click",options.notReadSelector,function(e){markAsNotRead();e.preventDefault()});$(document).on("click",options.deleteSelector,function(e){deleteMessage();e.preventDefault()});function deleteMessage(){$.ajax({type:"POST",url:options.deleteUrl,data:{envelopeId:currentEnvelopeId,mailBoxCode:currentActiveBox()},processResult:function(){FogSoft.Common.showSuccessMessage(options.deletedText);removeHashForMessage();options.onSuccess("deleted")},dataType:"json"})}function markAsRead(fromClick){$.ajax({type:"POST",url:options.readUrl,data:{envelopeId:currentEnvelopeId},success:function(data){if(data&&data.Success){readToggle();if(fromClick){FogSoft.Common.showSuccessMessage(options.markedAsReadText)}}else{FogSoft.Common.processMessages(data)}FogSoft.Common.processEvents(data)},dataType:"json"})}function markAsNotRead(){$.ajax({type:"POST",url:options.notReadUrl,data:{envelopeId:currentEnvelopeId},success:function(data){if(data&&data.Success){readToggle();FogSoft.Common.showSuccessMessage(options.markedAsNotReadText)}else{FogSoft.Common.processMessages(data)}FogSoft.Common.processEvents(data)},dataType:"json"})}function readToggle(){var $readBtn=$(options.readSelector);var $notReadBtn=$(options.notReadSelector);$readBtn.toggle();$notReadBtn.toggle()}function currentActiveBox(){var active=$(".message-menu li.nav-header-message.active");return active.prop("id")}function setHashForMailbox(mailbox){var state={};state[options.boxHashId]=mailbox;$.bbq.pushState(state)}function setHashForMessage(envelopeId){var state={};state[options.messageHashId]=envelopeId;$.bbq.pushState(state)}function removeHashForMessage(){$.bbq.removeState(options.messageHashId)}return gridLoader}return module})(FogSoft||{},jQuery,_);var ITenderSignature=(function(){var xmlData;function changeSigningCollapsibleTitle(obj){if($(obj).hasClass("collapsed")){$(obj).text(FogSoft.SignatureMessages.collapseSigningXmlDocument)}else{$(obj).text(FogSoft.SignatureMessages.expandSigningXmlDocument)}}function changeSignedCollapsibleTitle(obj){if($(obj).hasClass("collapsed")){$(obj).text(FogSoft.SignatureMessages.collapseXmlDocument)}else{$(obj).text(FogSoft.SignatureMessages.expandXmlDocument)}}function getXml(url,f){$.ajax({type:"POST",url:url,success:function(data){f(data.Data.Xml)},dataType:"json"})}function signPublicData(data,thumbprint,signUrl,onlyGenerateSignature){var $dfd=$.Deferred();FogSoftSigner.getAsync().then(function(signer){return signer.FindCertificateByThumbprintAsync(thumbprint).then(function(cert){return signer.SignAsync(cert,data)}).then(function(signature){if(onlyGenerateSignature){return $dfd.resolve({signature:signature}).promise()}return $.ajax(signUrl,{type:"POST",dataType:"json",data:{signatureModel:JSON.stringify({Value:signature})}})}).then(function(data){if(onlyGenerateSignature){$dfd.resolve(data)}else{if(data.Success===true){$dfd.resolve()}else{$dfd.reject(data.Messages)}}})}).fail(function(){$dfd.reject()});return $dfd.promise()}function initTenderSignature($parent,getXmlUrl,signPublicDataUrl,thumbprint){var $title=$parent.find(".collapse-title");$title.text(FogSoft.SignatureMessages.expandSigningXmlDocument);getXml(getXmlUrl,fillXml);$title.click(function(){ITenderSignature.changeTitle(false,this)});$parent.find(".action").click(function(){signPublicData(xmlData,thumbprint,signPublicDataUrl)});function fillXml(data){xmlData=data;$parent.find("pre").text(xmlData)}}function getPriceFromEncryptedData(encryptedData){return FogSoftSigner.getAsync().then(function(signer){return signer.DecryptAsync(encryptedData).then(function(decryptedData){var $xml=$(decryptedData);return $xml.find("PriceOffer").text()})})}return{loadXml:getXml,changeTitle:function(isDataSigned,obj){if(isDataSigned){changeSignedCollapsibleTitle(obj)}else{changeSigningCollapsibleTitle(obj)}},signPublicData:signPublicData,initTenderSignature:initTenderSignature,getPriceFromEncryptedData:getPriceFromEncryptedData}})();var template=$.template(null,'{{each data}}<div class="mtree-item-block"><div class="mtree-item-item ${selected ? "mtree-item-selected" : ""}" data-code="${Code || ItemId}" data-id="${ItemId}" data-text="${Text}" data-selectable="${Selectable}" data-has-children="${HasChildren}"><span class="mtree-item-arrow ${HasChildren ? "plusBlock" : ""}"></span><span class="mtree-item-text ${Selectable ? "mtree-item-text-selectable" : ""} ${ParentId == null ? "mtree-item-first" : ""}">${Text}</span></div></div>{{/each}}');(function(window,$){function toggleArrow($arrow){if($arrow.hasClass("plusBlock")){$arrow.removeClass("plusBlock").addClass("minusBlock")}else{$arrow.removeClass("minusBlock").addClass("plusBlock")}}var create=function($root,dataSource,itemSelectCallback,$trackItem){var loader=function(){var df=$.Deferred();df.resolve();return df.promise()};var getClassifierControl=function(){return $root.closest(".classifier-control")};var getClassifierType=function(){return getClassifierControl().data("classifier-type")};var isMultple=function(){return getClassifierControl().data("multiple")};var getClassifierSelector=function(){return $root.closest(".autocomplete.classifier-selector.input-group")};var getClassifierHiddenFields=function(){if(isMultple()){return getClassifierControl().find('.classifier-selection input[type="hidden"]:not([do-not-post])')}else{return getClassifierControl().find('input[type="hidden"]')}};var getAutocompleteFields=function(){return getClassifierSelector().find('input[name$="_autocomplete"]')};var getMiniTreeButton=function(){return getClassifierSelector().find(".mtree-button-collapse")};var getSelectedValues=function(){var selectedValues=[];var classifierHiddenFields=getClassifierHiddenFields();$.map(classifierHiddenFields,function(val,i){if(val.value){selectedValues.push(val.value)}});return selectedValues};var toogleMiniTree=function(disabled){var $classifierHiddenFields=getClassifierHiddenFields();$classifierHiddenFields.prop("disabled",disabled);var $autocompleteFields=getAutocompleteFields();$autocompleteFields.prop("disabled",disabled);var miniTreeButton=getMiniTreeButton();var $classifierSelection=getClassifierControl().find(".classifier-item");miniTreeButton.prop("disabled",disabled);if(disabled){miniTreeButton.addClass("disabled");$classifierSelection.addClass("disabled")}else{miniTreeButton.removeClass("disabled");$classifierSelection.removeClass("disabled")}};var getMiniTreeÐ¡ollapseTree=function(){return getClassifierControl().find(".collapseTree")};var refreshDataSource=function(){var dataSourceUrl=getClassifierControl().data("url");if(dataSourceUrl!==null){dataSource=dataSourceUrl}};var clearMiniTree=function(){getMiniTreeÐ¡ollapseTree().remove()};var clearSelectedItems=function(){var selector=getClassifierSelector();selector.attr("data-selected-items",[]);selector.data("selected-items",[]);selector.find('input[type="hidden"]').attr("value","");getClassifierControl().trigger("change")};$root.data("mini-tree-api",{getClassifierType:getClassifierType,isMultple:isMultple,getClassifierControl:getClassifierControl,getClassifierSelector:getClassifierSelector,getClassifierHiddenFields:getClassifierHiddenFields,getAutocompleteFields:getAutocompleteFields,getSelectedValues:getSelectedValues,getMiniTreeÐ¡ollapseTree:getMiniTreeÐ¡ollapseTree,refreshDataSource:refreshDataSource,refreshSelection:refreshSelection,clearMiniTree:clearMiniTree,clearSelectedItems:clearSelectedItems,disableMiniTree:function(){toogleMiniTree(false)},enableMiniTree:function(){toogleMiniTree(true)},toogleMiniTree:function(disabled){toogleMiniTree(disabled)}});if(Array.isArray(dataSource)){renderDataSource(dataSource)}else{loader=function(){var selector=getClassifierSelector();var expandingChain=selector.data("expanding-chain");var parentIds=expandingChain?expandingChain:[];if(parentIds.length){parentIds.push(null)}return loadChildren($root,parentIds)}}function renderDataSource(data){var $subRoot=$('<div class="mtree-item-container" />');$root.append($subRoot);var selectedValues=getSelectedValues();data.forEach(function(item){item.selected=selectedValues.indexOf(item.ItemId)!==-1});renderChildren($subRoot,data)}function renderChildren($target,data){var items=$.tmpl(template,{data:data});$target.append(items);return items}$root.on("click",".mtree-item-item",function(e){var $this=$(this);var $target=$(e.target);var data=$this.data();if($target.hasClass("mtree-item-arrow")){if(data.hasChildren){var $next=$this.next();if($next.hasClass("mtree-item-container")){$next.toggle();$next.removeClass("mtree-item-first");toggleArrow($target)}else{loadChildren($this.parent(),[data.id])}}}else{if(itemSelectCallback&&data.selectable){itemSelectCallback(data.code,data.text,data.id)}if($trackItem){var name=$trackItem.data("origName");var $control=$trackItem.closest("div.controls");var container=$control.find("[data-valmsg-for='"+name+"']");if(container){container.addClass("field-validation-valid").removeClass("field-validation-error")}$trackItem.change()}}var execEvent=new $.Event("click.mtree-item-arrow.mini-tree-api");$(document.body).trigger(execEvent)});function loadChildren($rootItem,parentIds){if($rootItem.data("treeLoading")){return}$rootItem.data("treeLoading",1);var df=$.Deferred();refreshDataSource();$.post(dataSource,{parentIds:parentIds},function(data){$rootItem.data("treeLoading",0);if(typeof data==="string"){if(window.console){console.log("Load error. Data = "+data)}return}createSubTree($rootItem,data,true);df.resolve()});return df.promise()}function createSubTree($rootItem,data,alwaysToggleArrow){var targetItemId=$rootItem.find(".mtree-item-item").data("id");if(!targetItemId){targetItemId=null}var selectedValues=getSelectedValues();var childItemsData=[];var otherItemsData=[];data.forEach(function(item){item.selected=selectedValues.indexOf(item.ItemId)!==-1;var itemDataArray=item.ParentId===targetItemId?childItemsData:otherItemsData;itemDataArray.push(item)});if(alwaysToggleArrow||childItemsData.length){toggleArrow($rootItem.find(".mtree-item-arrow"));var $subRoot=$('<div class="mtree-item-container" />');$rootItem.append($subRoot);var elements=renderChildren($subRoot,childItemsData);elements.each(function(index,el){otherItemsData=createSubTree($(el),otherItemsData,false)})}return otherItemsData}if($trackItem){$trackItem.change(function(){refreshSelection()})}function refreshSelection(selectedValues){selectedValues=selectedValues||getSelectedValues();$root.find(".mtree-item-item").each(function(){var $treeItem=$(this);var itemId=$treeItem.data("id");var itemSelected=selectedValues.indexOf(itemId)!==-1;$treeItem.toggleClass("mtree-item-selected",itemSelected)})}return loader};var createCollapsable=function($addAfter,$collapseControl,loaderFn){var $buttonCollapse=$addAfter.parent().find(".mtree-button-collapse");var $modalWindow=$buttonCollapse.closest(".modal-dialog");var changeCollapseControlOffset=_.debounce(function(){if(!$buttonCollapse.length){return}var inputPosition=$buttonCollapse.parent().find('input[type!="hidden"]')[0].getBoundingClientRect();$($collapseControl).width(inputPosition.width);var inputHeight=35;if($modalWindow.length){$collapseControl.css("top",inputHeight+"px");return}var windowHeight=$(window).height();var clientContainerHeight=$collapseControl.find(".mtree-item-container").height();var affixToolbarHeight=($(".navbar-inner.affix").height()||0)+($(".navbar.navbar-fixed-top.topbar").height()||0);var windowHeightWithoutAffix=windowHeight-affixToolbarHeight;var maxDefaultHeightControl=parseInt($collapseControl.css("max-height").replace("px",""));var bottomOffset=10;var recalculatePosition=function(windowHeight,inputPositionTop,minContainerHeight){minContainerHeight=Math.min(maxDefaultHeightControl,minContainerHeight);var controlFitInWindow=windowHeightWithoutAffix-inputPositionTop>minContainerHeight;var inputIsVisible=inputPositionTop>0&&windowHeight>inputPositionTop;var recalculatedCollapseControlTopPosition,recalculateCollapseTreeHeight;if(controlFitInWindow||inputIsVisible===false){recalculatedCollapseControlTopPosition=inputHeight}else{if(minContainerHeight>0){recalculatedCollapseControlTopPosition=-(minContainerHeight-(windowHeight-inputPositionTop))-bottomOffset;recalculateCollapseTreeHeight=(minContainerHeight-(windowHeight-inputPositionTop))+inputPosition.height}else{recalculateCollapseTreeHeight=(maxDefaultHeightControl-(windowHeight-inputPositionTop))+inputPosition.height}}if(!$(".collapseTree").hasClass("js-in-table")){$collapseControl.css("top",recalculatedCollapseControlTopPosition+"px")}else{$collapseControl.height(maxDefaultHeightControl-recalculateCollapseTreeHeight)}};var debouncedRecalc=_.debounce(function(){var containerHeight=$collapseControl.find(".mtree-item-container").height();$collapseControl.height(containerHeight);recalculatePosition(windowHeight,inputPosition.top,containerHeight)},100);if(clientContainerHeight!==0&&windowHeightWithoutAffix<clientContainerHeight){var recalculatedHeight=windowHeightWithoutAffix-inputHeight;$collapseControl.height(recalculatedHeight);recalculatePosition(windowHeight,inputPosition.top,recalculatedHeight)}else{if(clientContainerHeight>0){$collapseControl.height(clientContainerHeight);recalculatePosition(windowHeight,inputPosition.top,clientContainerHeight)}else{debouncedRecalc()}}if(document.documentElement.dir==="rtl"){$collapseControl.css("right",($(window).width()-inputPosition.right)+"px")}},10);function dropDownFixPosition(button,dropdownMenu){var dropDownTop=button.offset().top+button.outerHeight()-window.pageYOffset;dropdownMenu.css("position","fixed");dropdownMenu.css("top",dropDownTop);dropdownMenu.css("left",button.offset().left)}var loaded=false;$buttonCollapse.on("click",function(e){if($buttonCollapse.prop("disabled")){return}else{if($collapseControl.is(":visible")){$(".collapseTree").hide()}else{if(loaded===false){loaderFn().then(function(){$collapseControl.show()});loaded=true}else{$collapseControl.show()}changeCollapseControlOffset()}}if($(e.currentTarget).closest("table.dataTable").length===1){var collapseTree=$(e.currentTarget).parent().find(".collapseTree");collapseTree.addClass("js-in-table");dropDownFixPosition($(e.currentTarget).parent(),collapseTree)}});$(window).scroll(function(){var collapseTree=$("table.dataTable .collapseTree:visible");if(collapseTree.length>0){var collapseTreeButton=collapseTree.parent();dropDownFixPosition(collapseTreeButton,collapseTree)}});$(window).resize(function(){changeCollapseControlOffset()});$(document.body).on("click.mtree-item-arrow.mini-tree-api",function(){_.debounce(function(){changeCollapseControlOffset()},100)()});$(document).click(function(e){var isVisibleCollapseControl=$collapseControl.is(":visible");var currentControlButtonId=$collapseControl.parent().find(".mtree-button-collapse").attr("id");var eventTarget=$(e.target);var isClickedInCollapseControl=eventTarget.parents(".collapseTree").length>0;var isClickedByButtonCollapse=eventTarget.hasClass("mtree-button-collapse")&&eventTarget.attr("id")===currentControlButtonId||eventTarget.parent().hasClass("mtree-button-collapse")&&eventTarget.parent().attr("id")===currentControlButtonId;if(isVisibleCollapseControl&&!isClickedInCollapseControl&&!isClickedByButtonCollapse){$collapseControl.hide()}})};if(!window.FogSoft){window.FogSoft={}}if(!window.FogSoft.MiniTree){window.FogSoft.MiniTree=create}if(!window.FogSoft.MiniTree.CollapsableButton){window.FogSoft.MiniTree.CollapsableButton=createCollapsable}}(window,window.jQuery));var FogSoft=(function(module,$){var webModule=module.iTenderWeb=module.iTenderWeb||{};var constants={SignableObjectTypeKey:{ExternalXml:"ExternalXml",Documents:"Documents"}};function showBlockWhenChecked($block,$input,$checkbox){if(!$checkbox.is(":checked")){$block.fadeOut(100);$input.val("")}else{$block.fadeIn(100)}}function disableInputWhenChecked($input,$checkbox){if($checkbox.is(":checked")){$input.prop("disabled",true)}else{$input.prop("disabled",false)}}webModule.initShowBlockWhenChecked=function($block,$input,$checkBox){$checkBox.click(function(){showBlockWhenChecked($block,$input,$checkBox)});showBlockWhenChecked($block,$input,$checkBox)};webModule.initDisableInputWhenChecked=function($input,$checkBox){$checkBox.click(function(){disableInputWhenChecked($input,$checkBox)});disableInputWhenChecked($input,$checkBox)};webModule.initEvaluationMetadataOptionsHandlers=function($parent){$parent.find("[data-evaluation-metadata-key]").each(function(){var $element=$(this);var evaluationMetadataOption=$element.data("evaluation-metadata-option");$element.on("change",function(){var metadataKey=$element.data("evaluation-metadata-key");var $evaluationInput=$(document).find('[data-evaluation-for-metadata-key="'+metadataKey+'"]');if(evaluationMetadataOption.metadataType==="Choice"){var selectedValues=[];if(evaluationMetadataOption.multiple){var $checkboxes=$(document).find('[data-evaluation-metadata-key="'+metadataKey+'"] input');$checkboxes.each(function(index,item){var $item=$(item);if($item.is(":checked")){selectedValues.push($item.val())}})}else{selectedValues.push($element.find("option:selected").val())}var evaluationValue=0;evaluationMetadataOption.values.forEach(function(item){if(selectedValues.includes(item.value)){evaluationValue+=item.score}});$evaluationInput.val(evaluationValue)}else{if(evaluationMetadataOption.metadataType==="Boolean"){var evaluationValue;if($element.is(":checked")){evaluationValue=evaluationMetadataOption.trueValueScore}else{evaluationValue=evaluationMetadataOption.falseValueScore}$evaluationInput.val(evaluationValue)}else{if(evaluationMetadataOption.metadataType==="Number"){var selectedValue=$element.val();var evaluationValue;if(evaluationMetadataOption.estimationValues){evaluationMetadataOption.estimationValues.forEach(function(item){if(item.minValue<=selectedValue&&selectedValue<=item.maxValue){evaluationValue=item.score}});$evaluationInput.val(evaluationValue)}}}}})})};webModule.updateEvaluationModificationData=function(modificationData){modificationData.forEach(function(item){var formattedModificationData=item.ModifiedByFullName+", "+FogSoft.Common.formatDateTime(item.ModifiedDate,null,"DateTimeWithSeconds");$('[data-evaluation-modification-data-key="'+item.FieldKey+'"]').text(formattedModificationData)})};webModule.collapseOptionalFields=function(containerSelector){$(containerSelector).each(function(){var $this=$(this),trigger=$this.data("trigger");if(trigger){var $trigger=$this.find(trigger);$trigger.data("toggle","collapse");$trigger.data("target",$this.data("target"))}}).on("hidden show",function(e){var $el=$(e.target),toggleFields=$el.data("toggleFields");if(toggleFields==null){var $container=$(e.currentTarget),toggleFieldState=$container.data("toggleFieldState");if(toggleFieldState){var selector=toggleFieldState===true?":input":toggleFieldState;toggleFields=$el.find(selector);$el.data("toggleFields",toggleFields)}else{$el.data("toggleFields",false);return}}toggleFields&&toggleFields.prop("disabled",e.type==="hidden")})};webModule.updateTimestampOnClientEvent=function(eventName){$(document.body).on(eventName,function(e,args){$("#Timestamp").val(args.ClientEventArguments[eventName])})};webModule.processForm=function(data,thumbprint,embeddedSignaturePluginErrorMessage,certificateNotExportableErrorMessage){var $df=$.Deferred();if(!data){$df.resolve();return $df.promise()}var $dfs=[];var onlyGenerateSignature=true;data.forEach(function(el){if(el.Type===constants.SignableObjectTypeKey.Documents){if(el.Data){$dfs.push(FogSoft.Documents.signDocuments(el.Data.Data,thumbprint,el.Data.SignUrl,onlyGenerateSignature,embeddedSignaturePluginErrorMessage,certificateNotExportableErrorMessage))}}if(el.Type===constants.SignableObjectTypeKey.ExternalXml){if(el.Data){$dfs.push(window.ITenderSignature.signPublicData(el.Data.Data,thumbprint,el.Data.SignUrl,onlyGenerateSignature))}}});$.when.apply($,$dfs).then(function(docs,xml){var result=Array(xml);if(docs!==undefined){result=result.concat(docs)}$df.resolve(result)},function(e){$df.reject(e)});return $df.promise()};webModule.loadXml=function(url,$preformattedXml,callback){$.ajax({type:"GET",dataType:"json",url:url,success:function(result){if(result.Success){if(!result.Data){return}result.Data.forEach(function(el){if(el.Type===constants.SignableObjectTypeKey.ExternalXml){if(el.Data){$preformattedXml.text(el.Data.Data)}}});callback(result.Data)}}})};webModule.checkAndNotifyCurrentUserCertificateAvailability=function(currentCertificateThumbprint){return FogSoftSigner.getAsync().then(function(signer){return signer.FindCertificateByThumbprintAsync(currentCertificateThumbprint).then(function(){return true})})};webModule.setFieldSectionHeader=function(sectionTitle,fromSectionTitle){var sectionHeader=$(".fields-container > .section-field-info-header");var countSectionHeader=sectionHeader.length;sectionHeader.each(function(indx,elem){var indexElem=sectionHeader.index(elem)+1;$(elem).text(sectionTitle+" "+indexElem+" "+fromSectionTitle+" "+countSectionHeader)})};webModule.affixRatingScale=function(){var $topbarHeight=$(".topbar").height();var $fieldBlock=$(".questionnaire-form");$(document).on("scroll",function(e){var $toolbarBlock=$(".rating-scale-wrapper");var $affixToolbarHeight=$(".main-toolbar.affixed-toolbar > .affix").outerHeight();var $documentScroll=$(document).scrollTop();var value=$fieldBlock.offset().top-($topbarHeight+$affixToolbarHeight);var value2=$fieldBlock.outerHeight()+$toolbarBlock.children().outerHeight()-16;if($documentScroll>value){$toolbarBlock.addClass("js-fixed")}else{$toolbarBlock.removeClass("js-fixed")}if($documentScroll>value2){$toolbarBlock.children().addClass("js-no-fixed");$toolbarBlock.removeClass("js-fixed")}else{$toolbarBlock.children().removeClass("js-no-fixed")}})};return module})(FogSoft||{},jQuery);(function($){$.extend(true,window,{FogSoft:{Settings:function(){}}});var defaultButtonOptions={Name:null,ContainerName:null,TrueIconClass:null,TrueTitle:null,FalseIconClass:null,FalseTitle:null,FieldValueName:null,};var setStyleOnButton=function(options){var settings=$.extend({},defaultButtonOptions,options);var value=settings.FieldValueName.val().toLowerCase()=="true";var icon=settings.Name.find("i");icon.removeClass(settings.TrueIconClass);icon.removeClass(settings.FalseIconClass);icon.addClass(value?settings.TrueIconClass:settings.FalseIconClass);var newTitle=value?settings.TrueTitle:settings.FalseTitle;icon.attr("title",newTitle)};var updateShownTooltip=function(options){var settings=$.extend({},defaultButtonOptions,options);var icon=settings.Name;icon.tooltip("destroy");icon.tooltip();icon.tooltip("show")};var clickOnButton=function(options){options.FieldValueName.val(!(options.FieldValueName.val().toLowerCase()=="true"));setStyleOnButton(options);updateShownTooltip(options);options.ContainerName.dataForm("setChanged",true)};var innerInitialization=function(options){setStyleOnButton(options);options.Name.click(function(){clickOnButton(options)})};var initializeActivitySettingsButton=function(activityButtonCssSelector,hiddenFieldNameSelector,trueTitle,falseTitle,trueIconClass,falseIconClass){var $activitySettingButtons=$("form "+activityButtonCssSelector);$activitySettingButtons.each(function(){var $activitySettingButton=$(this);var buttonId=$activitySettingButton[0].id;var containerId=$activitySettingButton.closest("form")[0].id;var parent=$activitySettingButton.parent();var lockedHiddenField=parent.find(hiddenFieldNameSelector);var fieldValueName=lockedHiddenField[0].name;var settings=$.extend({},defaultButtonOptions,{Name:$("#"+containerId+" #"+buttonId),ContainerName:$("#"+containerId),TrueIconClass:trueIconClass,TrueTitle:trueTitle,FalseIconClass:falseIconClass,FalseTitle:falseTitle,FieldValueName:$("#"+containerId+" [name='"+fieldValueName+"']"),});innerInitialization(settings)})};FogSoft.Settings.HideButtonInitialize=function(trueTitle,falseTitle){initializeActivitySettingsButton(".settings-activity-btn.settings-btn-hidding",'input[name$="Value.IsHidden"]',trueTitle,falseTitle,"icon-hide","icon-display")};FogSoft.Settings.LockButtonInitialize=function(trueTitle,falseTitle){initializeActivitySettingsButton(".settings-activity-btn.settings-btn-locking",'input[name$="Value.IsLocked"]',trueTitle,falseTitle,"icon-lock","icon-unlock")}})(jQuery);function EditTable(wrapperId,addButtonId,collectorId){var ln=arguments.length;for(var i=0;i<ln;++i){arguments[i]="#"+arguments[i]}var $wrapper=$(wrapperId),$table=$wrapper.find("table"),$collector=$wrapper.find(collectorId),cols=$table.find("th"),colsCount=cols.length;for(var k=0;k<colsCount;++k){var $header=$(cols[k]);cols[k]={name:$header.data("fieldName"),cssClass:$header.data("fieldClass")}}var defVal=$table.data("default"),addButtonClick=function(){var td='<td><input type="text" value=""></td>',tr="<tr>";for(var i=0;i<colsCount;++i){tr+=td}tr=$(tr+"</tr>");td=tr.find("td");for(var i=0;i<colsCount;++i){$(td[i]).addClass(cols[i].cssClass);$(td[i]).find("input").prop({value:defVal[cols[i].name]})}var deleteButton=getDelButton();deleteButton.tooltip();tr.find("td:last-child").append(deleteButton);$table.find("tbody").append(tr);collectChangedData()},getDelButton=function(){var deleteDiv=$('<div class="del-tr-button icon-delete" rel="tooltip"></div>');deleteDiv.prop("title",$table.data("deleteButtonTitle"));return deleteDiv.bind("click",function(){$(this).tooltip("destroy");$(this).parents("tr").remove();collectChangedData()})},getJsonStr=function(){var inputs=$table.find("input"),inputsLn=inputs.length,res=[],tmpObj={};for(var i=0;i<inputsLn;++i){var j=i%colsCount;tmpObj[cols[j].name]=$(inputs[i]).prop("value");if(j===colsCount-1){if(cols[j].name!==""){res.push(tmpObj)}else{res.push($(inputs[i]).prop("value"))}tmpObj={}}}return JSON.stringify(res)},collectData=function(){$collector.prop({value:getJsonStr()})},collectChangedData=function(){collectData();$collector.change()};collectData();$table.find("tr td:last-child").append(getDelButton());$wrapper.find(addButtonId).bind("click",function(e){e.preventDefault();addButtonClick();$(this).blur();return false});$table.on("change","input",collectChangedData)};;
var FogSoftSignerCades2 = (function ($, cadesplugin) {
	if (!window.FogSoftSignerOptions || window.FogSoftSignerOptions.UseDigitalSignature === 'False')
		return;

	cadesplugin.set_log_level(cadesplugin.LOG_LEVEL_ERROR);

	var CADESCOM_BASE64_TO_BINARY = cadesplugin.CADESCOM_BASE64_TO_BINARY;
	var CADES_BES = cadesplugin.CADESCOM_CADES_BES;

	var showErrorMessage = function (text, exception) {
		console.log(text, exception);
	};

	var getHashAlgorithmAsync = function(certificate) {
		return getPublicKeyAlgorithmAsync(certificate).then(function (publicKeyAlgorithm) {
			var deferred = $.Deferred();

			switch(publicKeyAlgorithm) {
				case "1.2.643.2.2.19":
					return deferred.resolve(cadesplugin.CADESCOM_HASH_ALGORITHM_CP_GOST_3411);
				case "1.2.643.7.1.1.1.1":
					return deferred.resolve(cadesplugin.CADESCOM_HASH_ALGORITHM_CP_GOST_3411_2012_256);
				case "1.2.643.7.1.1.1.2":
					return deferred.resolve(cadesplugin.CADESCOM_HASH_ALGORITHM_CP_GOST_3411_2012_512);
				default:
					return deferred.reject();
			}
		});
	}

	var getHashedDataObjectAsync = function (certificate) {
		return getHashAlgorithmAsync(certificate).then(function (hashAlgorithm) {
			var deferred = $.Deferred();

			if (cadesplugin.CreateObjectAsync) {
				cadesplugin.CreateObjectAsync("CAdESCOM.HashedData")
					.then(function (hashedData) {
						return Promise.all([
							hashedData.propset_DataEncoding(CADESCOM_BASE64_TO_BINARY),
							hashedData.propset_Algorithm(hashAlgorithm)
						]).then(function() {
							deferred.resolve(hashedData);
						});
					})
					.catch(function (ex) {
						deferred.reject(ex);
					});
			} else {
				try {
					var hashedData = cadesplugin.CreateObject("CAdESCOM.HashedData");
					hashedData.DataEncoding = CADESCOM_BASE64_TO_BINARY;
					hashedData.Algorithm = hashAlgorithm;
					deferred.resolve(hashedData);
				} catch (ex) {
					deferred.reject(ex);
				}
			}

			return deferred.promise();
		});
	}

	var signHashedDataAsync = function (certificate, hashedData) {
		if (!certificate || !certificate.Cades2CertObj || !hashedData)
			return $.Deferred().reject().promise();

		var resultDeferred = $.Deferred();

		if (cadesplugin.CreateObjectAsync) {
			Promise.all([
				cadesplugin.CreateObjectAsync("CAdESCOM.CPSigner"),
				cadesplugin.CreateObjectAsync("CAdESCOM.CadesSignedData")
			])
			.then(function (objects) {
				var signer = objects[0];
				var signedData = objects[1];
				return signer.propset_Certificate(certificate.Cades2CertObj)
					.then(function () {
						return signedData.SignHash(hashedData, signer, CADES_BES);
					})
					.then(function (signature) {
						resultDeferred.resolve(signature);
					});
			})
			.catch(function(ex) {
				resultDeferred.reject(ex);
			});
		} else {
			try {
				var signer = cadesplugin.CreateObject("CAdESCOM.CPSigner");
				signer.Certificate = certificate.Cades2CertObj;

				var signedData = cadesplugin.CreateObject("CAdESCOM.CadesSignedData");

				var signature = signedData.SignHash(hashedData, signer, CADES_BES);
				resultDeferred.resolve(signature);
			} catch (ex) {
				resultDeferred.reject(ex);
			}
		}

		return resultDeferred.promise();
	}

	var getChunkSize = function() {
		var isIe = (("Microsoft Internet Explorer" == navigator.appName) || navigator.userAgent.match(/Trident\/./i));
		if (isIe)
			return 20 * 1024 * 1024; // 20MB

		return 40 * 1024 * 1024; // 40MB
	}

	var messages;
	function getMessages() {
		if (!messages) {
			messages = FogSoft.SignatureMessages || {};
		}

		return messages;
	}

	function getInfoFunc(type) {
		if (type >= 0 && type <= 7) {
			return this.Info[type];
		}

		throw new Error("The parameter is incorrect.");
	};

	function addPluginAsync() {
		var resultDeferred = $.Deferred();

		if (!!window.Promise) {
			window.cadesplugin.then(
				function() { resultDeferred.resolve(true); },
				function() { resultDeferred.resolve(false); }
			);
		} else {
			window.addEventListener("message", function (event) {
				if (event.data == "cadesplugin_loaded") {
					resultDeferred.resolve(true);
				} else if (event.data == "cadesplugin_load_error") {
					resultDeferred.resolve(false);
				}
			}, false);

			window.postMessage("cadesplugin_echo_request", "*");
		}

		return resultDeferred.promise();
	}

	function getCertListAsync() {
		var result = [];

		if (cadesplugin.CreateObjectAsync) {
			var resultDeferred = $.Deferred();
			cadesplugin.CreateObjectAsync("CAdESCOM.Store")
				.then(function (store) {
					return store.Open().then(function() {
						store.Certificates
							.then(function (certs) {
								return certs.Count.then(function (certCount) {
									var certificatesPromises = [];
									for (var i = 1; i <= certCount; i++) {
										var certificatePromise = certs.Item(i);
										certificatesPromises.push(certificatePromise);
									}
									return Promise.all(certificatesPromises);
								})
								.then(function (certs) {
									var propertyPromises = [];
									certs.forEach(function(cert) {
										propertyPromises.push(Promise.all([
											cert.IssuerName, cert.SerialNumber, cert.SubjectName, cert.Thumbprint,
											cert.ValidFromDate, cert.ValidToDate, cert.Version, cert.HasPrivateKey(),
											cert.GetInfo(0), cert.GetInfo(1), cert.GetInfo(2), cert.GetInfo(3),
											cert.GetInfo(4), cert.GetInfo(5), cert.GetInfo(6), cert.GetInfo(7), cert
										]));
									});
									return Promise.all(propertyPromises);
								})
								.then(function (certs) {
									certs.forEach(function(props) {
										result.push({
											IssuerName: props[0],
											SerialNumber: props[1],
											SubjectName: props[2],
											Thumbprint: props[3],
											ValidFromDate: props[4],
											ValidToDate: props[5],
											Version: props[6],
											HasPrivateKey: props[7],
											Info: [
												props[8], props[9], props[10],
												props[11], props[12], props[13],
												props[14], props[15]
											],
											GetInfo: getInfoFunc,
											Cades2CertObj: props[16]
										});
									});

									store.Close().catch(function (ex) {
										showErrorMessage(getMessages().errorStoreClose, ex);
									});

									resultDeferred.resolve(result);
								});
						})
						.catch(function (ex) {
							var msg = getMessages().errorCertificateEnum;
							showErrorMessage(msg, ex);
							resultDeferred.reject([msg]);
						});
					});
				})
				.catch(function (ex) {
					var msg = getMessages().errorStoreOpen;
					showErrorMessage(msg, ex);
					resultDeferred.reject([msg]);
				});

			return resultDeferred.promise();
		} else {
			var store;
			try {
				store = cadesplugin.CreateObject("CAdESCOM.Store");
				store.Open();
			} catch (ex) {
				var msg = getMessages().errorStoreOpen;
				showErrorMessage(msg, ex);
				return $.Deferred().reject([msg]).promise();
			}

			try {
				for (var i = 1; i <= store.Certificates.Count; i++) {
					var cert = store.Certificates.Item(i);
					result.push({
						IssuerName: cert.IssuerName,
						SerialNumber: cert.SerialNumber,
						SubjectName: cert.SubjectName,
						Thumbprint: cert.Thumbprint,
						ValidFromDate: cert.ValidFromDate,
						ValidToDate: cert.ValidToDate,
						Version: cert.Version,
						HasPrivateKey: cert.HasPrivateKey(),
						Info: [
							cert.GetInfo(0), cert.GetInfo(1), cert.GetInfo(2),
							cert.GetInfo(3), cert.GetInfo(4), cert.GetInfo(5),
							cert.GetInfo(6), cert.GetInfo(7)
						],
						GetInfo: getInfoFunc,
						Cades2CertObj: cert
					});
				}
			} catch (ex) {
				var msg = getMessages().errorCertificateEnum;
				showErrorMessage(msg, ex);
				return $.Deferred().reject([msg]).promise();
			}

			try {
				store.Close();
			} catch (ex){
				showErrorMessage(getMessages().errorStoreClose, ex);
			}

			return $.when(result);
		}
	}

	function signAsync(certificate, dataToSign) {
		if (!certificate || !certificate.Cades2CertObj || !dataToSign)
			return $.Deferred().reject().promise();

		if (cadesplugin.CreateObjectAsync) {
			var resultDeferred = $.Deferred();

			Promise.all([
				cadesplugin.CreateObjectAsync("CAdESCOM.CPSigner"),
				cadesplugin.CreateObjectAsync("CAdESCOM.CadesSignedData")
			])
			.then(function (objects) {
				var signer = objects[0];
				var signedData = objects[1];

				return Promise.all([
					signer.propset_Certificate(certificate.Cades2CertObj),
					signedData.propset_Content(dataToSign)
				])
				.then(function () {
					return signedData.SignCades(signer, CADES_BES, true);
				})
				.then(function(result) {
					resultDeferred.resolve(result);
				});
			})
			.catch(function (ex) {
				var msg = getMessages().errorSignatureCreate;
				showErrorMessage(msg, ex);
				resultDeferred.reject([msg]);
			});

			return resultDeferred.promise();
		} else {
			try {
				var signer = cadesplugin.CreateObject("CAdESCOM.CPSigner");
				signer.Certificate = certificate.Cades2CertObj;

				var signedData = cadesplugin.CreateObject("CAdESCOM.CadesSignedData");
				signedData.Content = dataToSign;

				var signature = signedData.SignCades(signer, CADES_BES, true);
				return $.when(signature);
			} catch (ex) {
				var msg = getMessages().errorSignatureCreate;
				showErrorMessage(msg, ex);
				return $.Deferred().reject([msg]).promise();
			}
		}
	}

	function encryptAsync(certificates, dataToEncrypt) {
		if (!certificates || !dataToEncrypt) {
			return $.Deferred().reject().promise();
		}

		if (!$.isArray(certificates)) {
			certificates = [certificates];
		}

		if (cadesplugin.CreateObjectAsync) {
			var resultDeferred = $.Deferred();

			cadesplugin.CreateObjectAsync("CAdESCOM.CPEnvelopedData")
				.then(function (envelopedData) {
					return envelopedData.propset_Content(dataToEncrypt)
						.then(function () {
							return envelopedData.Recipients;
						})
						.then(function (recipients) {
							var addPromises = [];
							certificates.forEach(function (c) {
								addPromises.push(recipients.Add(c.Cades2CertObj));
							});
							return Promise.all(addPromises);
						})
						.then(function () {
							return envelopedData.Encrypt();
						})
						.then(function (result) {
							resultDeferred.resolve(result);
						});
				})
				.catch(function(ex) {
					var msg = getMessages().errorEncryption;
					showErrorMessage(msg, ex);
					resultDeferred.reject([msg]);
				});

			return resultDeferred.promise();
		} else {
			try {
				var envelopedData = cadesplugin.CreateObject("CAdESCOM.CPEnvelopedData");
				envelopedData.Content = dataToEncrypt;

				certificates.forEach(function (c) {
					envelopedData.Recipients.Add(c.Cades2CertObj);
				});

				var encryptedData = envelopedData.Encrypt();
				return $.when(encryptedData);
			} catch (ex) {
				var msg = getMessages().errorEncryption;
				showErrorMessage(msg, ex);
				return $.Deferred().reject([msg]).promise();
			}
		}
	}

	function decryptAsync(encryptedData) {
		if (!encryptedData)
			return $.Deferred().reject().promise();

		if (cadesplugin.CreateObjectAsync) {
			var resultDeferred = $.Deferred();

			cadesplugin.CreateObjectAsync("CAdESCOM.CPEnvelopedData")
				.then(function(envelopedData) {
					return envelopedData.Decrypt(encryptedData)
						.then(function () {
							return envelopedData.Content;
						})
						.then(function (result) {
							resultDeferred.resolve(result);
						});
				})
				.catch(function(ex) {
					var msg = getMessages().errorDecryption;
					showErrorMessage(msg, ex);
					resultDeferred.reject([msg]);
				});

			return resultDeferred.promise();
		} else {
			try {
				var envelopedData = cadesplugin.CreateObject("CAdESCOM.CPEnvelopedData");
				envelopedData.Decrypt(encryptedData);
				var decryptedData = envelopedData.Content;
				return $.when(decryptedData);
			} catch (ex) {
				var msg = getMessages().errorDecryption;
				showErrorMessage(msg, ex);
				return $.Deferred().reject([msg]).promise();
			}
		}
	}

	function verifyAsync(dataToSign, signature) {
		if (!dataToSign || !signature)
			return $.Deferred().reject().promise();

		if (cadesplugin.CreateObjectAsync) {
			var resultDeferred = $.Deferred();

			cadesplugin.CreateObjectAsync("CAdESCOM.CadesSignedData")
				.then(function (signedData) {
					return signedData.propset_Content(dataToSign)
						.then(function () {
							return signedData.VerifyCades(signature, CADES_BES, true);
						})
						.then(function () {
							resultDeferred.resolve(true);
						});
				})
				.catch(function(ex) {
					var msg = getMessages().errorSignValidate;
					showErrorMessage(msg, ex);
					resultDeferred.reject([msg]);
				});

			return resultDeferred.promise();
		} else {
			try {
				var signedData = cadesplugin.CreateObject("CAdESCOM.CadesSignedData");
				signedData.Content = dataToSign;
				signedData.VerifyCades(signature, CADES_BES, true);
			} catch (ex) {
				var msg = getMessages().errorSignValidate;
				showErrorMessage(msg, ex);
				return $.Deferred().reject([msg]).promise();
			}

			return $.when(true);
		}
	}

	function convertCertificateToStringAsync(cert) {
		if (!cert || !cert.Cades2CertObj)
			return $.Deferred().reject().promise();

		if (cadesplugin.CreateObjectAsync) {
			var resultDeferred = $.Deferred();

			cert.Cades2CertObj.Export(0)
				.then(function (result) {
					resultDeferred.resolve(result);
				})
				.catch(function (ex) {
					var msg = getMessages().errorCertificateExport;
					showErrorMessage(msg, ex);
					resultDeferred.reject([msg]);
				});

			return resultDeferred.promise();
		} else {
			try {
				var certificateString = cert.Cades2CertObj.Export(0);
				return $.when(certificateString);
			} catch (ex) {
				var msg = getMessages().errorCertificateExport;
				showErrorMessage(msg, ex);
				return $.Deferred().reject([msg]).promise();
			}
		}
	}

	function convertCertificateFromStringAsync(stringData) {
		if (!stringData)
			return $.Deferred().reject().promise();

		if (cadesplugin.CreateObjectAsync) {
			var resultDeferred = $.Deferred();

			cadesplugin.CreateObjectAsync("CAPICOM.Certificate")
				.then(function(cert) {
					return cert.Import(stringData)
						.then(function () {
							return Promise.all([
								cert.IssuerName, cert.SerialNumber, cert.SubjectName, cert.Thumbprint,
								cert.ValidFromDate, cert.ValidToDate, cert.Version, cert.HasPrivateKey(),
								cert.GetInfo(0), cert.GetInfo(1), cert.GetInfo(2), cert.GetInfo(3),
								cert.GetInfo(4), cert.GetInfo(5), cert.GetInfo(6), cert.GetInfo(7)
							]);
						})
						.then(function(props) {
							resultDeferred.resolve({
								IssuerName: props[0],
								SerialNumber: props[1],
								SubjectName: props[2],
								Thumbprint: props[3],
								ValidFromDate: props[4],
								ValidToDate: props[5],
								Version: props[6],
								HasPrivateKey: props[7],
								Info: [
									props[8], props[9], props[10],
									props[11], props[12], props[13],
									props[14], props[15]
								],
								GetInfo: getInfoFunc,
								Cades2CertObj: cert
							});
						});
				})
				.catch(function(ex) {
					var msg = getMessages().errorCertificateImport;
					showErrorMessage(msg, ex);
					resultDeferred.reject([msg]);
				});

			return resultDeferred.promise();
		} else {
			try {
				var cert = cadesplugin.CreateObject("CAPICOM.Certificate");
				cert.Import(stringData);
				var resultCert = {
					IssuerName: cert.IssuerName,
					SerialNumber: cert.SerialNumber,
					SubjectName: cert.SubjectName,
					Thumbprint: cert.Thumbprint,
					ValidFromDate: cert.ValidFromDate,
					ValidToDate: cert.ValidToDate,
					Version: cert.Version,
					HasPrivateKey: cert.HasPrivateKey(),
					Info: [
						cert.GetInfo(0), cert.GetInfo(1), cert.GetInfo(2),
						cert.GetInfo(3), cert.GetInfo(4), cert.GetInfo(5),
						cert.GetInfo(6), cert.GetInfo(7)
					],
					GetInfo: getInfoFunc,
					Cades2CertObj: cert
				}
				return $.when(resultCert);
			}
			catch (ex) {
				var msg = getMessages().errorCertificateImport;
				showErrorMessage(msg, ex);
				return $.Deferred().reject([msg]).promise();
			}
		}
	}

	var downloadedFiles = {}
	function downloadFile(url, progressCallback, certificate) {
		var progressResult = {
			IsCompleted: false,
			IsError: false,
			FileId: FogSoft.Common.generateGuid(),
			Delete: function () {
				if (downloadedFiles[this.FileId]) {
					delete downloadedFiles[this.FileId];
				}
			}
		}

		var totalBytes;
		var chunkSize = getChunkSize();
		var loadedBytes = 0;

		$.ajax({
			type: "HEAD",
			url: url,
			headers: { Accept: "application/x-base64-encoded-file" }
		}).then(function (data, status, response) {
			totalBytes = parseInt(response.getResponseHeader('x-base64-content-length'));
			progressResult.TotalBytes = totalBytes;
		}).then(function () {
			return getHashedDataObjectAsync(certificate);
		}).then(function (hashedData) {
			downloadedFiles[progressResult.FileId] = hashedData;

			function loadNextChunk(begin, end) {
				return $.ajax({
					headers: {
						Accept: "application/x-base64-encoded-file",
						Range: "bytes=" + begin + "-" + end
					},
					url: url
				}).then(function (data, status, response) {
					loadedBytes += parseInt(response.getResponseHeader('x-base64-content-length'));
					progressResult.BytesReceived = loadedBytes;

					return $.when(hashedData.Hash(data));
				}).then(function () {
					if (loadedBytes < totalBytes) {
						progressCallback(progressResult);

						begin = end + 1;
						end = begin + chunkSize - 1;
						if (end > totalBytes - 1)
							end = totalBytes - 1;

						return loadNextChunk(begin, end);
					} else {
						progressResult.IsCompleted = true;
						progressCallback(progressResult);
					}
				});
			}

			return loadNextChunk(0, chunkSize < totalBytes ? chunkSize - 1 : totalBytes - 1);
		}).fail(function() {
			progressResult.IsError = true;
			progressCallback(progressResult);
		});
	}

	function signDownloadedFileAsync(certificate, fileId) {
		var resultDeferred = $.Deferred();

		signHashedDataAsync(certificate, downloadedFiles[fileId])
			.then(function(signature) {
				resultDeferred.resolve(signature);
			})
			.fail(function (ex) {
				var msg = getMessages().errorSignatureCreate;
				showErrorMessage(msg, ex);
				resultDeferred.reject([msg]);
			});

		return resultDeferred.promise();
	}

	function signLocalFileBlobAsync(certificate, fileBlob) {
		if (!certificate || !certificate.Cades2CertObj || !fileBlob)
			return $.Deferred().reject().promise();

		var resultDeferred = $.Deferred();

		function onErrorCallback(ex) {
			var msg = getMessages().errorSignatureCreate;
			showErrorMessage(msg, ex);
			resultDeferred.reject([msg]);
		}

		getHashedDataObjectAsync(certificate)
			.then(function(hashedData) {
				var blobSlice = File.prototype.slice || File.prototype.mozSlice || File.prototype.webkitSlice;
				var chunkSize = getChunkSize();
				var chunks = Math.ceil(fileBlob.size / chunkSize);
				var currentChunk = 0;

				function loadNext() {
					var fileReader = new FileReader();
					fileReader.onload = onLoadCallback;
					fileReader.onerror = onErrorCallback;

					var start = currentChunk * chunkSize;
					var end = ((start + chunkSize) >= fileBlob.size) ? fileBlob.size : start + chunkSize;

					fileReader.readAsDataURL(blobSlice.call(fileBlob, start, end));
				};

				function onLoadCallback(e) {
					var header = ";base64,";
					var fileData = e.target.result;
					var base64Data = fileData.substr(fileData.indexOf(header) + header.length);
					$.when(hashedData.Hash(base64Data))
						.then(function() {
							currentChunk++;
							currentChunk < chunks
								? loadNext()
								: signHashedDataAsync(certificate, hashedData)
									.then(function(signature) {
										resultDeferred.resolve(signature);
									}, onErrorCallback);
						},
						onErrorCallback);
				}

				loadNext();
			})
			.fail(onErrorCallback);

		return resultDeferred.promise();
	}

	function isValidBrowser() {
		var isChrome = navigator.userAgent.match(/Chrome/i);
		var isOpera = navigator.userAgent.match(/opr/i);
		var isYaBrowser = navigator.userAgent.match(/YaBrowser/i);
		var isFirefox = typeof InstallTrigger !== 'undefined';
		var isSafari = /constructor/i.test(window.HTMLElement) || (function (p) { return p.toString() === "[object SafariRemoteNotification]"; })(!window['safari'] || safari.pushNotification);;

		var isIe = (("Microsoft Internet Explorer" == navigator.appName) || navigator.userAgent.match(/Trident\/./i));
		var div = document.createElement("div");
		div.innerHTML = "<!--[if lt IE 9]><iecheck></iecheck><![endif]-->";
		var isIeLessThan9 = (div.getElementsByTagName("iecheck").length == 1);

		return isChrome || isOpera || isYaBrowser || isFirefox || isSafari || (isIe && !isIeLessThan9);
	}

	function checkCertificateIsValid(cert, callback) {
		if (!cert || !cert.Cades2CertObj) {
			callback("error", getMessages().errorValidateIntergiry);
		}

		if (cadesplugin.CreateObjectAsync) {
			cert.Cades2CertObj.IsValid()
				.then(function(x) {
					return x.Result;
				})
				.then(function(isValid) {
					if (isValid)
						callback("success");
					else {
						callback("error", getMessages().errorValidateIntergiry);
					}
				})
				.catch(function() {
					callback("error", getMessages().errorValidateIntergiry);
				});
		} else {
			try {
				if (cert.Cades2CertObj.IsValid().Result === true) {
					callback("success");
				} else {
					callback("error", getMessages().errorValidateIntergiry);
				}
			} catch (ex) {
				callback("error", getMessages().errorValidateIntergiry);
			}
		}
	}

	function getPublicKeyAlgorithmAsync(cert) {
		if (!cert || !cert.Cades2CertObj)
			return $.Deferred().reject().promise();

		if (cadesplugin.CreateObjectAsync) {
			var resultDeferred = $.Deferred();

			cert.Cades2CertObj.PublicKey()
				.then(function(publicKey) {
					return publicKey.Algorithm;
				})
				.then(function(algorithm) {
					return algorithm.Value;
				})
				.then(function(value) {
					resultDeferred.resolve(value);
				})
				.catch(function() {
					resultDeferred.reject();
				});

			return resultDeferred.promise();
		} else {
			try {
				var algorithm = cert.Cades2CertObj.PublicKey().Algorithm.Value;
				return $.when(algorithm);
			} catch (ex) {
				return $.Deferred().reject().promise();
			}
		}
	}

	function setErrorMessageFunction(func) {
		showErrorMessage = func;
	}

	function getSupportedBrowsersMessage() {
		return getMessages().Cades2SuportedBrowsersMessage;
	}

	var downloadPluginUrl = "https://www.cryptopro.ru/products/cades/plugin";
	function getAddPluginMessage() {
		return getMessages().Cades2AddPluginMessage(downloadPluginUrl);
	}

	function init() {
		var plugin = {
			AddPluginAsync: addPluginAsync,
			GetCertListAsync: getCertListAsync,
			SignAsync: signAsync,
			EncryptAsync: encryptAsync,
			DecryptAsync: decryptAsync,
			VerifyAsync: verifyAsync,
			ConvertCertificateToStringAsync: convertCertificateToStringAsync,
			ConvertCertificateFromStringAsync: convertCertificateFromStringAsync,
			DownloadFile: downloadFile,
			SignDownloadedFileAsync: signDownloadedFileAsync,
			IsValidBrowser: isValidBrowser,
			CheckCertificateIsValid: checkCertificateIsValid,
			GetPublicKeyAlgorithmAsync: getPublicKeyAlgorithmAsync,
			SetErrorMessageFunction: setErrorMessageFunction,
			GetSupportedBrowsersMessage: getSupportedBrowsersMessage,
			GetAddPluginMessage: getAddPluginMessage
		};

		if (Modernizr.filereader) {
			plugin.SignLocalFileBlobAsync = signLocalFileBlobAsync;
		}

		return plugin;
	}

	var instance;
	return {
		get: function () {
			if (!instance) {
				instance = init();
			}
			return instance;
		}
	};
})(jQuery, window.cadesplugin);
;
var FogSoftSignerCapidec=(function(){var showErrorMessage=function(text,exception){console.log(text,exception)};function isActiveXSupported(){try{return(typeof window.ActiveXObject!="undefined"||"ActiveXObject" in window)}catch(e){return false}}function isValidBrowser(){return isActiveXSupported()}var messages;function getMessages(){if(!messages){messages=FogSoft.SignatureMessages||{}}return messages}var reopenTabNeededKey="FogSoft.Capidec.ReopenTabNeeded";var reopenTabNeeded=window.sessionStorage?window.sessionStorage.getItem(reopenTabNeededKey):false;var askedForReopenTab=false;var askedForUninstall=false;function checkVersion(v){var s=v.split(".");var mulVer=s[0]*1000*1000+s[1]*1000+s[2]*1;if(mulVer<1001004){if(!askedForUninstall&&!reopenTabNeeded){askedForUninstall=true;if(confirm(getMessages().CapidecErrorOldVersion)){var s2="uninstall";var s3="Capidec";var s1="please";getManager().Uninstall(s1+", "+s2+" "+s3);reopenTabNeeded=true;if(window.sessionStorage){window.sessionStorage.setItem(reopenTabNeededKey,reopenTabNeeded)}window.close()}}if(!askedForReopenTab&&reopenTabNeeded){askedForReopenTab=true;FogSoft.Common.showErrorMessage(getMessages().CapidecErrorReopenTabToUninstall)}return false}return true}var storageAskedKey="FogSoft.Capidec.AskedToInstall";function setPluginAsked(){if(window.sessionStorage){window.sessionStorage.setItem(storageAskedKey,window.location)}}function addPluginOnPageIfAsked(){if(window.sessionStorage){var v=window.sessionStorage.getItem(storageAskedKey);if(v){window.sessionStorage.removeItem(storageAskedKey)}if(v==window.location){addPlugin()}}}var isInited;function addPlugin(){if(isActiveXSupported()){if(!isInited){isInited=true;var div=document.createElement("div");div.style.position="absolute";div.style.display="";div.style.zIndex=0;div.style.top="0px";div.style.left="0px";var o='<object classid="clsid:1AC1A2A5-9A19-49B9-8A47-8B964275D85F"';o+=' codebase="http://apps.fogsoft.ru/capidec/1.1/FogSoft.Capidec.exe"';o+=' width="0" height="0" id="capidec_obj"></object>';div.innerHTML=o;document.body.appendChild(div)}try{var version=document.getElementById("capidec_obj").GetVersion();return $.when(checkVersion(version))}catch(e){}setPluginAsked()}return $.when(false)}var manager;function getManager(){if(manager){return manager}try{return manager=new ActiveXObject("FogSoft.Capidec.Manager")}catch(e){showErrorMessage(getMessages().CapidecErrorActiveXObjectCreation,e);throw e}}function getCertList(){try{var certList=getManager().GetSelector().GetCertificateList(true,"");var certCnt=certList.Length;var certInfos=[];for(var i=0;i<certCnt;i++){var cert=certList.Get(i);certInfos.push(cert)}return $.when(certInfos)}catch(ex){var msg=getMessages().errorCertificateEnum;showErrorMessage(msg,ex);return $.Deferred().reject([msg]).promise()}}function sign(certificate,dataToSign){if(!certificate||!dataToSign){return $.Deferred().reject().promise()}try{var signer=getManager().GetSigner();var signature=signer.SignDetached(dataToSign,certificate);return $.when(signature)}catch(ex){var msg=getMessages().errorSignatureCreate;showErrorMessage(msg,ex);return $.Deferred().reject([msg]).promise()}}function signFile(certificate,fileName){if(!certificate||!fileName){return $.Deferred().reject().promise()}try{var signer=getManager().GetSigner();var signature=signer.SignLocalFileDetached(fileName,certificate);return $.when(signature)}catch(ex){var msg=getMessages().errorSignatureCreate;showErrorMessage(msg,ex);return $.Deferred().reject([msg]).promise()}}function encrypt(certificates,dataToEncrypt){if(!certificates||!dataToEncrypt){return $.Deferred().reject().promise()}if(!$.isArray(certificates)){certificates=[certificates]}try{var encryptor=getManager().GetEncrypter();var selector=getManager().GetSelector();var list=selector.CreateEmptyCertificateList();for(var i=0;i<certificates.length;i++){var c=certificates[i];if(c!=null){list.Add(c)}}var encryptedData=encryptor.EncryptWithManyCertificates(dataToEncrypt,list);return $.when(encryptedData)}catch(ex){var msg=getMessages().errorEncryption;showErrorMessage(msg,ex);return $.Deferred().reject([msg]).promise()}}function decrypt(encryptedData){if(!encryptedData){return $.Deferred().reject().promise()}try{var encryptor=getManager().GetEncrypter();var decryptedData=encryptor.DecryptAutoSelectCertificate(encryptedData);return $.when(decryptedData)}catch(ex){var msg=getMessages().errorDecryption;showErrorMessage(msg,ex);return $.Deferred().reject([msg]).promise()}}function verify(dataToSign,signature){if(!dataToSign||!signature){return $.Deferred().reject().promise()}try{var signer=getManager().GetSigner();signer.VerifyDetached(dataToSign,signature,true)}catch(ex){var msg=getMessages().errorSignValidate;showErrorMessage(msg,ex);return $.Deferred().reject([msg]).promise()}return $.when(true)}function convertCertificateToString(cert){if(!cert){return $.Deferred().reject().promise()}try{var selector=getManager().GetSelector();var certificateString=selector.ExportCertificate(cert);return $.when(certificateString)}catch(ex){var msg=getMessages().errorCertificateExport;showErrorMessage(msg,ex);return $.Deferred().reject([msg]).promise()}}function convertCertificateFromString(stringData){if(!stringData){return $.Deferred().reject().promise()}try{var selector=getManager().GetSelector();var resultCert=selector.ImportCertificate(stringData);return $.when(resultCert)}catch(ex){var msg=getMessages().errorCertificateImport;showErrorMessage(msg,ex);return $.Deferred().reject([msg]).promise()}}function getErrorMatchArray(){return{NoError:{isCritical:false,message:"NoError"},NotTimeValid:{isCritical:true,message:function(cert){var now=new Date(),fromDate=typeof cert.ValidFromDate=="number"?new Date(cert.ValidFromDateSeconds*1000):cert.ValidFromDate,toDate=typeof cert.ValidToDate=="number"?new Date(cert.ValidToDateSeconds*1000):cert.ValidToDate;return now<fromDate?getMessages().errorValidateDateNotStarted:now>toDate?getMessages().errorValidateDateExpired:null}},NotTimeNested:{isCritical:true,message:getMessages().errorValidateChainDateNested},Revoked:{isCritical:true,message:getMessages().errorValidateRevoked},NotSignatureValid:{isCritical:true,message:getMessages().errorValidateSign},NotValidForUsage:{isCritical:true,message:getMessages().errorValidateInvalidUsage},UntrustedRoot:{isCritical:false,message:getMessages().errorValidateChain},RevocationStatusUnknown:{isCritical:false,message:getMessages().errorValidateStatus},Cyclic:{isCritical:false,message:getMessages().errorValidateCyclic},InvalidExtension:{isCritical:true,message:getMessages().errorInvalidConstraints},InvalidPolicyConstraints:{isCritical:true,message:getMessages().errorInvalidConstraints},InvalidBasicConstraints:{isCritical:true,message:getMessages().errorInvalidConstraints},InvalidNameConstraints:{isCritical:true,message:getMessages().errorInvalidConstraints},HasNotSupportedNameConstraint:{isCritical:true,message:getMessages().errorInvalidConstraints},HasNotDefinedNameConstraint:{isCritical:true,message:getMessages().errorInvalidConstraints},HasNotPermittedNameConstraint:{isCritical:true,message:getMessages().errorInvalidConstraints},HasExcludedNameConstraint:{isCritical:true,message:getMessages().errorInvalidConstraints},PartialChain:{isCritical:false,message:getMessages().errorValidateChain},CtlNotTimeValid:{isCritical:true,message:getMessages().errorValidateChainDate},CtlNotSignatureValid:{isCritical:true,message:getMessages().errorValidateInvalidChainSign},CtlNotValidForUsage:{isCritical:true,message:getMessages().errorValidateInvalidRootUsage},OfflineRevocation:{isCritical:false,message:getMessages().errorOfflineRevocation},NoIssuanceChainPolicy:{isCritical:true,message:getMessages().errorNoInsuranceChainPolicy}}}function checkCertificateIsValid(cert,callback){if(!cert){callback("error",getMessages().errorValidateIntergiry)}try{var errors=getManager().GetValidator().ValidateFull(cert);if(!errors){callback("success")}else{var r=/\[([^\]]+)\]/g;var match;var errorMatchArray=getErrorMatchArray();var anyCallbackProcessed=false;var warningMessages="";var errorMessages="";while(match=r.exec(errors)){var v=errorMatchArray[match[1]];if(v==undefined){continue}var vm=v.message;var msg=typeof vm=="function"?vm(cert):vm;if(v.isCritical){if(errorMessages.indexOf(msg)<0){errorMessages+=msg+"<br/>"}}else{if(warningMessages.indexOf(msg)<0){warningMessages+=msg+"<br/>"}}}if(errorMessages!=""){callback("error",errorMessages);anyCallbackProcessed=true}if(warningMessages!=""){callback("warning",warningMessages);anyCallbackProcessed=true}if(!anyCallbackProcessed){callback("error",getMessages().errorValidateStatus)}}}catch(ex){callback("error",getMessages().errorValidateIntergiry)}}function getAddPluginMessage(){if(isActiveXSupported()){var url=(typeof ApplicationInfo==="undefined"?"/":ApplicationInfo.ApplicationUrl)+"Documents/List?entityTypeCode=Application&hint=LearningMaterials";return getMessages().CapidecAddPluginMessageIE(url)}else{return getMessages().CapidecAddPluginMessageUnsupportedBrowser}}function downloadFile(url,progressCallback){var handler=getManager().GetFileHandler();var fileInfo=handler.BeginDownloadFile(url);var iterateFunction=function(){var d={IsCompleted:fileInfo.IsCompleted,IsError:fileInfo.IsError,BytesReceived:fileInfo.BytesReceived||fileInfo.BytesReceivedString,TotalBytes:fileInfo.TotalBytes||fileInfo.TotalBytesString,FileId:fileInfo.FileName,Delete:function(){fileInfo.Delete()}};progressCallback(d);if(!d.IsCompleted&&!d.IsError){setTimeout(iterateFunction,1000)}};iterateFunction()}function getPublicKeyAlgorithm(cert){if(!cert){return $.Deferred().reject().promise()}try{var algorithm=cert.Algorithm;return $.when(algorithm)}catch(ex){return $.Deferred().reject().promise()}}function setErrorMessageFunction(func){showErrorMessage=func}function getSupportedBrowsersMessage(){return getMessages().CapidecSuportedBrowsersMessage}var asyncWrapper=function(callback,context){return function(){var args=arguments;var deferred=$.Deferred();setTimeout(function(){$.when(callback.apply(context,args)).then(function(){deferred.resolve.apply(deferred,arguments)},function(){deferred.reject.apply(deferred,arguments)})},0);return deferred.promise()}};function init(){var plugin={AddPluginAsync:asyncWrapper(addPlugin),GetCertListAsync:asyncWrapper(getCertList),SignAsync:asyncWrapper(sign),EncryptAsync:asyncWrapper(encrypt),DecryptAsync:asyncWrapper(decrypt),VerifyAsync:asyncWrapper(verify),ConvertCertificateToStringAsync:asyncWrapper(convertCertificateToString),ConvertCertificateFromStringAsync:asyncWrapper(convertCertificateFromString),DownloadFile:downloadFile,SignDownloadedFileAsync:asyncWrapper(signFile),IsValidBrowser:isValidBrowser,CheckCertificateIsValid:checkCertificateIsValid,GetPublicKeyAlgorithmAsync:asyncWrapper(getPublicKeyAlgorithm),SetErrorMessageFunction:setErrorMessageFunction,GetSupportedBrowsersMessage:getSupportedBrowsersMessage,GetAddPluginMessage:getAddPluginMessage};if(isValidBrowser()){plugin.SignLocalFilePathAsync=asyncWrapper(signFile)}return plugin}addPluginOnPageIfAsked();var instance;return{get:function(){if(!instance){instance=init()}return instance}}})();var FogSoft=(function(module,$){var signerModule=module.Signature=module.Signature||{},validatorOptions=signerModule.ValidatorOptions||{};signerModule.getValidator=function(){var errorStepIndex=-1;var errorMessage;var processCallback;var selectedCert;var selectedCertString;var signerModule;var testData="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus leo felis, pretium sed pellentesque at, suscipit eu nibh. Phasellus gravida odio elit, vitae lacinia nisi. Etiam volutpat, nisl et vulputate vulputate, ipsum erat consectetur ante, a ultricies nunc elit semper neque.";var uiSelector;var tags;var validationItems=[{name:"validationStepIsValidBrowserName",method:checkIsValidBrowser,},{name:"validationStepPluginName",method:checkPlugin,},{name:"validationCertificatesExistsName",method:checkCertificatesExists,errorMessage:"validationStepCertificatesExistsMessage"},{name:"validationStepCertificateName",method:checkCertificateSelect,errorMessage:"validationStepCertificateMessage"},{name:"validationStepLocalCertificateCheckName",method:checkIsValidLocally,errorMessage:"validationStepLocalCertificateCheckMessage"},{name:"validationStepLocalCertificateGostName",method:checkComplianceWithGovernmentStandart,errorMessage:"validationStepLocalCertificateGostMessage"},{name:"validationStepLocalCertificateSignName",method:checkSign,errorMessage:"validationStepLocalCertificateSignMessage"},{name:"validationStepLocalCertificateEncryptName",method:checkEncryptDecrypt,errorMessage:"validationStepLocalCertificateEncryptMessage"},{name:"validationStepLocalCertificateServerName",method:checkServer,errorMessage:"validationStepLocalCertificateServerMessage"}];if(!validatorOptions.signatureAlgorithms){validationItems=$.grep(validationItems,function(item){return item.name!=="validationStepLocalCertificateGostName"})}function checkIsValidBrowser(continuation){if(signerModule.IsValidBrowser){continuation("success")}else{continuation("error",signerModule.GetSupportedBrowsersMessage())}}function checkPlugin(continuation){if(signerModule.IsPluginAddedSuccess){continuation("success")}else{continuation("error",signerModule.GetAddPluginMessage())}}function checkCertificatesExists(continuation){signerModule.GetAllCertificates(function(certList){continuation(certList&&certList.length>0?"success":"error")})}function checkCertificateSelect(continuation){signerModule.SelectCertificate(function(cert){selectedCert=cert;continuation(cert!=null?"success":"error")})}function checkIsValidLocally(continuation){signerModule.IsCertificateValid(selectedCert,function(result,validMessage){continuation(result,validMessage)})}function checkComplianceWithGovernmentStandart(continuation){signerModule.GetPublicKeyAlgorithmAsync(selectedCert).then(function(algorithm){continuation(validatorOptions.signatureAlgorithms.indexOf(algorithm)>-1?"success":"error")}).fail(function(){continuation("error")})}function checkSign(continuation){signerModule.SignAsync(selectedCert,testData).then(function(signature){return signerModule.VerifyAsync(testData,signature)}).then(function(){continuation("success")}).fail(function(){continuation("error")})}function checkEncryptDecrypt(continuation){signerModule.EncryptAsync(selectedCert,testData).then(function(encryptedData){return signerModule.DecryptAsync(encryptedData)}).then(function(decryptResult){continuation(testData==decryptResult?"success":"error")}).fail(function(){continuation("error")})}function checkServer(continuation){signerModule.ExportCertificateAsync(selectedCert).then(function(certString){selectedCertString=certString;$.ajax({url:validatorOptions.validateUrl,contentType:"application/json",type:"POST",dataType:"JSON",data:JSON.stringify({CertData:certString}),success:function(data){if(data.IsSuccess){continuation("success")}else{var res="";$.each(data.Errors,function(i,e){res+=e+"<br/>"});continuation("error",res)}},error:function(xhr){continuation("error",xhr.statusText)}})}).fail(function(){continuation("error")})}function validate(messageTags,finalCallback,stepCallback){FogSoftSigner.getAsync().then(function(signer){signerModule=signer;processCallback=stepCallback;tags=messageTags;signerModule.SetDisplayErrors(false);FogSoft.Common.closeMessages(tags);if(hasUi()){$.each(validationItems,function(i,e){setStepResult(i)})}var processFunc=function(stepIndex){validationItems[stepIndex].method(function(result,customMessage){if(result=="error"){var error=customMessage?customMessage:FogSoft.SignatureMessages[validationItems[stepIndex].errorMessage];setError(stepIndex,error)}else{if(result=="warning"){var warning=customMessage?customMessage:FogSoft.SignatureMessages[validationItems[stepIndex].errorMessage];setWarning(stepIndex,warning);if(stepIndex===validationItems.length-1){setWarning(-1)}else{if(stepIndex!==errorStepIndex){processFunc(stepIndex+1)}}}else{setSuccess(stepIndex,customMessage);if(stepIndex===validationItems.length-1){finalCallback&&finalCallback({cert:selectedCert,certStr:selectedCertString});setSuccess(-1)}else{processFunc(stepIndex+1)}}}})};processFunc(0)})}function setError(stepIndex,message){errorStepIndex=stepIndex;errorMessage=message;if(hasUi()){setStepResult(stepIndex,"failed")}FogSoft.Common.showErrorMessage(message,FogSoft.SignatureMessages[validationItems[stepIndex].name],null,tags);processCallback&&processCallback("error",errorStepIndex,errorMessage)}function setWarning(stepIndex,message){if(hasUi()){setStepResult(stepIndex,"warning","icon-caution")}FogSoft.Common.showWarningMessage(message,FogSoft.SignatureMessages[validationItems[stepIndex].name],null,tags);processCallback&&processCallback("warning",stepIndex,message)}function setSuccess(stepIndex,message){if(hasUi()){setStepResult(stepIndex,"passed","icon-sign-eds").next().addClass("active")}processCallback&&processCallback("success",stepIndex,message)}function setStepResult(stepIndex,stepClass,iClass){var $step=$("#checkStep"+stepIndex),$step_i=$step.find("i");$step.removeClass("active passed warning failed").addClass(stepClass);$step_i.removeClass();if(!!iClass){$step_i.addClass(iClass)}return $step}function hasUi(){return !!uiSelector}function getSteps(){var resArr=[];$.each(validationItems,function(i,e){resArr.push(FogSoft.SignatureMessages[e.name])});return resArr}function getSelectedCertificate(){return selectedCert}function initUi(selector){uiSelector=selector;var $checkList=$(uiSelector);$checkList.empty();$.each(getSteps(),function(i,e){$("<div></div>").addClass("check-point").attr("id","checkStep"+i).data("stepName",e).append('<i class="icon-fake"></i>').append(" "+e).appendTo($checkList)})}return{validate:validate,getSteps:getSteps,getSelectedCertificate:getSelectedCertificate,initUi:initUi}};return module}(FogSoft||{},jQuery));FogSoftSigner=(function(){var instance;var internalInstance;var displayErrors=true;var signMessages;var commonModule=(FogSoft&&FogSoft.Common)||null;function getMessages(){if(!signMessages){signMessages=FogSoft.SignatureMessages||{}}return signMessages}function FindCertificateByThumbprintAsync(thumbprint){return internalInstance.GetCertListAsync().then(function(certList){if(thumbprint){if(!certList){var msg=getMessages().errorUserCertificateIsNotFound;ShowErrorMessage(msg);return $.Deferred().reject([msg]).promise()}var cert=null;$.each(certList,function(i,e){if(e.Thumbprint==thumbprint){cert=e;return false}});if(cert==null){var msg=getMessages().errorUserCertificateIsNotFound;ShowErrorMessage(msg);return $.Deferred().reject([msg]).promise()}var certValidToDate=new Date(cert.ValidToDate);var now=new Date();if(certValidToDate.getTime()<now.getTime()){var msg=getMessages().errorValidateDateExpired;ShowErrorMessage(msg);return $.Deferred().reject([msg]).promise()}return cert}var applicationUrl=typeof ApplicationInfo==="undefined"?"/":ApplicationInfo.ApplicationUrl+"AccountCertificates";var msg=getMessages().NoCertificateSelected(applicationUrl);ShowErrorMessage(msg);return $.Deferred().reject([msg]).promise()})}function GetAllCertificates(callback){return internalInstance.GetCertListAsync().then(function(certList){callback(certList)}).fail(function(){callback(null)})}function ShowCertificateSelector(callback){internalInstance.GetCertListAsync().then(function(certList){if(!certList||certList.length===0){callback(null);return}var $sertList=$("<div></div>");var selectedCert=null;$.each(certList,function(i,e){var d1=new Date();var d2=new Date();if(typeof e.ValidFromDate==="number"){d1.setTime((e.ValidFromDate-25569)*1000*60*60*24)}else{d1=new Date(e.ValidFromDate)}if(typeof e.ValidToDate==="number"){d2.setTime((e.ValidToDate-25569)*1000*60*60*24)}else{d2=new Date(e.ValidToDate)}$('<div style="padding:5px;cursor:pointer"><strong>'+e.GetInfo(0)+"</strong><br/>"+getMessages().issuer+": "+e.GetInfo(1)+"<br/>"+getMessages().validFrom+": "+commonModule.formatDateTime(d1,null,"LongDate")+" "+getMessages().validTo+": "+commonModule.formatDateTime(d2,null,"LongDate")+"<br/></div>").appendTo($sertList).click(function(){selectedCert=e;$(this).closest(".modal").modal("hide")})});var selectCertOptions={id:"certList",title:getMessages().selectCertificate};var promise=commonModule.getCommandExecuteChain(selectCertOptions);promise.then(function(){selectCertOptions.data=$sertList;commonModule.modal(selectCertOptions)}).then(function(){var $modal=$("#certList").closest(".modal");$modal.on("hidden.bs.modal",function(){if(callback){setTimeout(function(){callback(selectedCert)},300)}})})}).fail(function(){callback(null)})}function decimalToHexString(number){if(number<0){number=4294967295+number+1}return number.toString(16).toUpperCase()}function ShowErrorMessage(mess,ex){var err=mess;if(ex){if(ex.message){err+=" : "+ex.message}if(ex.number){err+=" : (0x"+decimalToHexString(ex.number)+")"}if(err===mess){err+=" : "+ex}}if(displayErrors){var modalContainer=$(".modal-content");commonModule.closeMessages("signer",modalContainer);commonModule.showErrorMessage(mess,getMessages().errorSignerTitle,modalContainer,"signer")}console.log(err)}function CheckCertAlgorithm(cert){var signatureAlgorithms=FogSoft.Signature.ValidatorOptions.signatureAlgorithms;if(signatureAlgorithms){var dfr=$.Deferred();internalInstance.GetPublicKeyAlgorithmAsync(cert).then(function(algorithm){if(signatureAlgorithms.indexOf(algorithm)>-1){dfr.resolve()}else{dfr.reject()}},function(){dfr.reject()});return dfr.promise()}else{return $.Deferred().resolve().promise()}}function initAsync(){internalInstance=window["FogSoftSigner"+FogSoftSignerOptions.InternalSigner].get();internalInstance.SetErrorMessageFunction(ShowErrorMessage);return internalInstance.AddPluginAsync().then(function(addResult){var wrapper=function(c){return function(){if(!addResult){var msg=internalInstance.GetAddPluginMessage();ShowErrorMessage(msg);return $.Deferred().reject([msg]).promise()}return c.apply(internalInstance,arguments)}};var checkCertAlgorithmWrapper=function(c){return function(){var args=arguments;return CheckCertAlgorithm(arguments[0]).then(function(){return c.apply(internalInstance,args)},function(){var msg=getMessages().activeCertNotGostError;ShowErrorMessage(msg)})}};instance={IsValidBrowser:internalInstance.IsValidBrowser(),IsPluginAddedSuccess:addResult,SelectCertificate:wrapper(ShowCertificateSelector),FindCertificateByThumbprintAsync:wrapper(FindCertificateByThumbprintAsync),SignAsync:wrapper(checkCertAlgorithmWrapper(internalInstance.SignAsync)),VerifyAsync:wrapper(internalInstance.VerifyAsync),ExportCertificateAsync:wrapper(internalInstance.ConvertCertificateToStringAsync),ImportCertificateAsync:wrapper(internalInstance.ConvertCertificateFromStringAsync),EncryptAsync:wrapper(internalInstance.EncryptAsync),DecryptAsync:wrapper(internalInstance.DecryptAsync),IsCertificateValid:wrapper(internalInstance.CheckCertificateIsValid),DownloadFile:wrapper(internalInstance.DownloadFile),SignDownloadedFileAsync:wrapper(checkCertAlgorithmWrapper(internalInstance.SignDownloadedFileAsync)),GetPublicKeyAlgorithmAsync:wrapper(internalInstance.GetPublicKeyAlgorithmAsync),SetDisplayErrors:function(isDisplay){displayErrors=!!isDisplay},GetAddPluginMessage:internalInstance.GetAddPluginMessage,GetSupportedBrowsersMessage:internalInstance.GetSupportedBrowsersMessage,GetAllCertificates:wrapper(GetAllCertificates)};if(internalInstance.SignLocalFileBlobAsync){instance.LocalFileBlobSigningSupport=true;instance.SignLocalFileBlobAsync=wrapper(checkCertAlgorithmWrapper(internalInstance.SignLocalFileBlobAsync))}if(internalInstance.SignLocalFilePathAsync){instance.LocalFilePathSigningSupport=true;instance.SignLocalFilePathAsync=wrapper(checkCertAlgorithmWrapper(internalInstance.SignLocalFilePathAsync))}return instance})}return{getAsync:function(){if(!instance){return initAsync()}return $.when(instance)}}})();var FogSoft=(function(module,$){var commonModule=module.Common=module.Common||{};var hubModule=module.AuctionHub=module.AuctionHub||{};var initialized=false,hub,clients=[],messagesProvider,reconnectCount=0,reconnectAttemptLimit=3,shouldRestart=true,lostConnectionMsgTag="lostConnection",isDisconnected=true,logging=false;function ensureInitialized(options){if(initialized||!$.connection){return}log("Initializing AuctionHub");messagesProvider=$.isFunction(options.messagesProvider)?options.messagesProvider:$.noop;$(window).on("unload",dispose);$.connection.hub.starting(function(){log("AuctionHub - starting")}).received(function(){log("AuctionHub - received")}).connectionSlow(function(){log("AuctionHub - connection is slow");for(var i=0;i<clients.length;i++){var client=clients[i];if(client&&client.onConnectionSlow){client.onConnectionSlow()}}}).reconnecting(function(){log("AuctionHub - reconnecting")}).reconnected(function(){log("AuctionHub - reconnected")}).stateChanged(function(){log("AuctionHub - stateChanged")}).disconnected(function(){log("AuctionHub - disconnected");isDisconnected=true;if(reconnectCount>0){return}setTimeout(restart,1000)});hub=$.connection[options.hub];hub.client.addMessage=function(messageCode){log("AuctionHub - addMessage "+messageCode);for(var i=0;i<clients.length;i++){var client=clients[i];if(client&&client.addMessage){client.addMessage(messageCode)}}};hub.client.onBidCreated=function(data){log("AuctionHub - onBidCreated");for(var i=0;i<clients.length;i++){var client=clients[i];if(client&&client.onBidCreated){client.onBidCreated(data)}}};hub.client.onBidIntervalCreated=function(data){log("AuctionHub - onBidIntervalCreated");for(var i=0;i<clients.length;i++){var client=clients[i];if(client&&client.onBidIntervalCreated){client.onBidIntervalCreated(data)}}};hub.client.onBiddingStop=function(data){log("AuctionHub - onBiddingStop");for(var i=0;i<clients.length;i++){var client=clients[i];if(client&&client.onBiddingStop){client.onBiddingStop(data)}}};hub.client.onPriceStepChanged=function(data){log("AuctionHub - onPriceStepChanged");for(var i=0;i<clients.length;i++){var client=clients[i];if(client&&client.onPriceStepChanged){client.onPriceStepChanged(data)}}};initialized=true}hubModule.connect=function(options){log("Connecting client "+options.clientId);ensureInitialized(options);clients.push(options);if(isDisconnected){start()}else{if(options.onStart){options.onStart()}}};hubModule.disconnect=function(clientId){log("Disconnecting client "+clientId);for(var i=0;i<clients.length;i++){var client=clients[i];if(client.clientId===clientId){return clients.splice(i,1)}}return null};hubModule.subscribeToGroup=function(groupName){hub.server.register(groupName)};hubModule.isDisconnected=function(){return isDisconnected};function start(){log("Starting connection to server");return $.connection.hub.start().done(function(){isDisconnected=false;for(var i=0;i<clients.length;i++){var client=clients[i];if(client&&client.onStart){client.onStart()}}})}function restart(){if(!shouldRestart){return}reconnectCount++;try{log("Re-establishing connection... Attempts made: "+reconnectCount+" out of "+reconnectAttemptLimit);start().done(function(){isDisconnected=false;reconnectCount=0;log("Connection successfully established")}).fail(function(){retry()})}catch(e){retry()}}function retry(){if(reconnectCount>=reconnectAttemptLimit){commonModule.closeMessages(lostConnectionMsgTag);commonModule.showWarningMessage(messagesProvider("DisconnectedMessage"),null,null,lostConnectionMsgTag);return}setTimeout(restart,5000)}function dispose(){log("Disposing hub");for(var i=0;i<clients.length;i++){var client=clients[i];if(client&&client.onDispose){client.onDispose()}}shouldRestart=false;$.connection.hub.stop(false,false)}function log(message){logging&&window.console&&window.console.log(message)}return module}(FogSoft||{},jQuery));
/*
 * jQuery Spliter Plugin version 0.28.5
 * Copyright (C) 2010-2020 Jakub T. Jankiewicz <https://jcubic.pl/me>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
(function(factory,undefined){var root=typeof window!=="undefined"?window:global;if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{if(typeof module==="object"&&module.exports){module.exports=function(root,jQuery){if(jQuery===undefined){if(window!==undefined){jQuery=require("jquery")}else{jQuery=require("jquery")(root)}}factory(jQuery);return jQuery}}else{factory(root.jQuery)}}})(function($,undefined){if(typeof String.prototype.trim==="undefined"){var sp_re=/(^\s+)|(\s+)$/g;String.prototype.trim=function(){return this.replace(sp_re,"")}}var count=0;var splitter_id=null;var splitters=[];var current_splitter=null;var current_splitter_index=null;$.fn.split=function(options){var data=this.data("splitter");if(data){return data}var panels=[];var $splitters=[];var panel_1;var panel_2;var settings=$.extend({limit:100,orientation:"horizontal",position:"50%",invisible:false,onDragStart:$.noop,onDragEnd:$.noop,onDrag:$.noop,percent:false},options||{});this.settings=settings;function unset(prop){return options&&typeof options[prop]==="undefined"||!options}var len=this.children().length;if(len>2){if(unset("position")){var w=100/len;settings.position=new Array(len-1).fill(0).map(function(){return w+"%"})}if(unset("percent")){settings.percent=true}}var cls;var children=this.children();if(children.length===2){if(settings.orientation=="vertical"){panel_1=children.first().addClass("left_panel");panel_2=panel_1.next().addClass("right_panel");cls="vsplitter"}else{if(settings.orientation=="horizontal"){panel_1=children.first().addClass("top_panel");panel_2=panel_1.next().addClass("bottom_panel");cls="hsplitter"}}panels=[panel_1,panel_2]}else{children.each(function(){var panel=$(this);if(settings.orientation=="vertical"){panel.addClass("vertical_panel");cls="vsplitter"}else{panel.addClass("horizontal_panel");cls="hsplitter"}panels.push(panel)})}if(settings.invisible){cls+=" splitter-invisible"}var width=this.width();var height=this.height();this.addClass("splitter_panel");var id=count++;panels.slice(0,-1).forEach(function(panel,i){var splitter=$("<div/>").addClass(cls).on("mouseenter touchstart",function(){splitter_id=id;current_splitter_index=splitter.index()-i-1}).on("mouseleave touchend",function(){splitter_id=null;current_splitter_index=null}).insertAfter(panel);$splitters.push(splitter)});var position;function get_position(position){if(position instanceof Array){return position.map(get_position)}if(typeof position==="number"){return position}if(typeof position==="string"){var match=position.match(/^([0-9\.]+)(px|%)$/);if(match){if(match[2]=="px"){return +match[1]}else{if(settings.orientation=="vertical"){return(width*+match[1])/100}else{if(settings.orientation=="horizontal"){return(height*+match[1])/100}}}}else{}}else{}}function set_limit(limit){if(!isNaN(parseFloat(limit))&&isFinite(limit)){return{leftUpper:limit,rightBottom:limit}}return limit}var self=$.extend(this,{refresh:function(){var new_width=this.width();var new_height=this.height();if(width!=new_width||height!=new_height){width=this.width();height=this.height();self.position(position)}},option:function(name,value){if(name==="position"){return self.position(value)}else{if(typeof value==="undefined"){return settings[name]}else{settings[name]=value}}return self},position:(function(){function make_sizer(dim_name,pos_name){return function(n,silent){if(n===undefined){return position}else{position=get_position(n);if(!(position instanceof Array)){position=[position]}if(position.length!==panels.length-1){throw new Error("position array need to equal splitters length")}var outer_name="outer";outer_name+=dim_name[0].toUpperCase()+dim_name.substring(1);var dim_px=self.css("visiblity","hidden")[dim_name]();var pw=0;var sw_sum=0;for(var i=0;i<position.length;++i){var splitter=$splitters[i];var panel=panels[i];var pos=position[i];var splitter_dim=splitter[dim_name]();var sw2=splitter_dim/2;if(settings.invisible){pw+=panel[dim_name](pos)[outer_name]();splitter.css(pos_name,pw-(sw2*(i+1)))}else{if(settings.percent){var w1=(pos-sw2)/dim_px*100;var l1=(pw+sw_sum)/dim_px*100;panel.css(pos_name,l1+"%");pw+=panel.css(dim_name,w1+"%")[outer_name]();splitter.css(pos_name,(pw+sw_sum)/dim_px*100+"%")}else{panel.css(pos_name,pw+sw_sum);pw+=panel.css(dim_name,pos-sw2)[outer_name]();splitter.css(pos_name,pw+sw_sum)}}sw_sum+=splitter_dim}var panel_last=panels[i];if(settings.invisible){panel_last.height(height-pw)}else{var s_sum=splitter_dim*i;var props={};if(settings.percent){props[dim_name]=(dim_px-pw-sw_sum)/dim_px*100+"%";props[pos_name]=(pw+sw_sum)/dim_px*100+"%"}else{props[dim_name]=dim_px-pw-sw_sum;props[pos_name]=pw+sw_sum}panel_last.css(props)}self.css("visiblity","")}if(!silent){self.trigger("splitter.resize");self.find(".splitter_panel").trigger("splitter.resize")}return self}}if(settings.orientation=="vertical"){return make_sizer("width","left")}else{if(settings.orientation=="horizontal"){return make_sizer("height","top")}else{return $.noop}}})(),_splitters:$splitters,_panels:panels,orientation:settings.orientation,limit:set_limit(settings.limit),isActive:function(){return splitter_id===id},destroy:function(){self.removeClass("splitter_panel");clear_attr(self,"class");function clear_attr(item,attr){var val=item.attr(attr);if(typeof val==="string"&&!val.trim()){item.removeAttr(attr)}}panels.forEach(function($panel){$panel.css({height:"",width:"",left:"",top:""});var cls=$panel.attr("class").replace(/\w+_panel/g,"").trim();$panel.attr("class",cls);clear_attr($panel,"class");clear_attr($panel,"style")});self.off("splitter.resize");self.trigger("splitter.resize");self.find(".splitter_panel").trigger("splitter.resize");splitters[id]=null;count--;$splitters.forEach(function($splitter){var splitter=$(this);$splitter.off("mouseenter");$splitter.off("mouseleave");$splitter.off("touchstart");$splitter.off("touchmove");$splitter.off("touchend");$splitter.off("touchleave");$splitter.off("touchcancel");$splitter.remove()});self.removeData("splitter");var not_null=false;for(var i=splitters.length;i--;){if(splitters[i]!==null){not_null=true;break}}if(!not_null){$(document.documentElement).off(".splitter");$(window).off("resize.splitter");splitters=[];count=0}}});self.on("splitter.resize",function(e){var pos=self.position();if(self.orientation=="vertical"&&pos>self.width()){pos=self.width()-self.limit.rightBottom-1}else{if(self.orientation=="horizontal"&&pos>self.height()){pos=self.height()-self.limit.rightBottom-1}}if(pos<self.limit.leftUpper){pos=self.limit.leftUpper+1}e.stopPropagation();self.position(pos,true)});var pos;if(settings.orientation=="vertical"){if(pos>width-settings.limit.rightBottom){pos=width-settings.limit.rightBottom}else{pos=get_position(settings.position)}}else{if(settings.orientation=="horizontal"){if(pos>height-settings.limit.rightBottom){pos=height-settings.limit.rightBottom}else{pos=get_position(settings.position)}}}if(pos<settings.limit.leftUpper){pos=settings.limit.leftUpper}if(panels.length>2&&!(pos instanceof Array&&pos.length==$splitters.length)){throw new Error("position need to be array equal to $splitters length")}self.position(pos,true);function calc_pos(pos,x){var new_pos=pos.slice(0,current_splitter.index);var p;if(new_pos.length){p=x-new_pos.reduce(function(a,b){return a+b})}else{p=x}var diff=pos[current_splitter.index]-p;new_pos.push(p);if(current_splitter.index<pos.length-1){var rest=pos.slice(current_splitter.index+1);rest[0]+=diff;new_pos=new_pos.concat(rest)}return new_pos}if(splitters.filter(Boolean).length===0){$(window).on("resize.splitter",function(){$.each(splitters,function(i,splitter){if(splitter){splitter.refresh()}})});$(document.documentElement).on("mousedown.splitter touchstart.splitter",function(e){if(splitter_id!==null){e.preventDefault();current_splitter={node:splitters[splitter_id],index:current_splitter_index};if(e.originalEvent.button!==2){setTimeout(function(){if(!current_splitter){return}$('<div class="splitterMask"></div>').css("cursor",current_splitter.node.children().eq(1).css("cursor")).insertAfter(current_splitter.node)})}current_splitter.node.settings.onDragStart(e)}}).on("mouseup.splitter touchend.splitter touchleave.splitter touchcancel.splitter",function(e){if(current_splitter){setTimeout(function(){$(".splitterMask").remove()});current_splitter.node.settings.onDragEnd(e);current_splitter=null}}).on("mousemove.splitter touchmove.splitter",function(e){var pos;if(current_splitter!==null){var node=current_splitter.node;var leftUpperLimit=node.limit.leftUpper;var rightBottomLimit=node.limit.rightBottom;var offset=node.offset();if(node.orientation=="vertical"){var pageX=e.pageX;if(e.originalEvent&&e.originalEvent.changedTouches){pageX=e.originalEvent.changedTouches[0].pageX}var x=pageX-offset.left;if(x<=node.limit.leftUpper){x=node.limit.leftUpper+1}else{if(x>=node.width()-rightBottomLimit){x=node.width()-rightBottomLimit-1}}pos=node.position();if(pos.length>1){node.position(calc_pos(pos,x),true)}else{if(x>node.limit.leftUpper&&x<node.width()-rightBottomLimit){node.position(x,true);node.trigger("splitter.resize");node.find(".splitter_panel").trigger("splitter.resize")}}}else{if(node.orientation=="horizontal"){var pageY=e.pageY;if(e.originalEvent&&e.originalEvent.changedTouches){pageY=e.originalEvent.changedTouches[0].pageY}var y=pageY-offset.top;if(y<=node.limit.leftUpper){y=node.limit.leftUpper+1}else{if(y>=node.height()-rightBottomLimit){y=node.height()-rightBottomLimit-1}}pos=node.position();if(pos.length>1){node.position(calc_pos(pos,y),true)}else{if(y>node.limit.leftUpper&&y<node.height()-rightBottomLimit){node.position(y,true);node.trigger("splitter.resize");node.find(".splitter_panel").trigger("splitter.resize")}}}}node.settings.onDrag(e)}})}splitters[id]=self;self.data("splitter",self);return self}});;
var FogSoft = (function (module, $) {
	var commonModule = module.Common = module.Common || {};
	var auctionHubModule = module.AuctionHub = module.AuctionHub || {};
	var auctionRoomModule = module.AuctionRoom = module.AuctionRoom || {};
	
	var initialized = false,
		options,
		$form,
		$grid,
		$details,
		selectedTenderLot,
		logging = false,
		sessions = [];
	
	auctionRoomModule.init = function (opts) {

		options = opts,

		$(window).on("unload", disposeSessions);

		$form = $("#" + opts.formId);
		$grid = $("#" + opts.gridId);
		$details = $("#" + opts.detailsId);

		connectToHub();
		subscribeOnGridEvents();
		initSplitter();

		initialized = true;
	}

	auctionRoomModule.isInitialized = function() {
		return initialized;
	}

	auctionRoomModule.registerSession = function(session) {
		sessions.push(session);
	}

	auctionRoomModule.reloadCurrentSession = function() {
		displayBidding(selectedTenderLot);
	}

	function disposeSessions() {
		log("Disposing sessions");

		for (var i = 0; i < sessions.length; i++) {
			var session = sessions[i];

			if (session && session.dispose) session.dispose();
		}

		sessions = [];
	}

	function log(message) {
		logging && window.console && window.console.log(message);
	}

	function connectToHub() {
		log("auctionRoom.initHub");

		auctionHubModule.connect({
			hub: options.hub,
			clientId: "AuctionRoom",
			messageProvider: options.messagesProvider,
			onStart: refreshGrid,
			onBidCreated: refreshSelectedGridRow,
			onBidIntervalCreated: refreshSelectedGridRow,
			onBiddingStop: refreshSelectedGridRow
		});
	}

	function subscribeToHubGroups(data) {
		for (var i = 0; i < data.length; i++) {
			var item = data[i];

			auctionHubModule.subscribeToGroup(item.TenderLotUid);
		}
	}

	function subscribeOnGridEvents() {
		var gridLoader = $grid.data("loader");
		
		// todo: subscribe on clear selection

		gridLoader.model.onDataLoaded.subscribe(function(e, args) {
			subscribeToHubGroups(args.data.Rows);
		});

		gridLoader.grid.onSelectedRowsChanged.subscribe(function () {

			var selectedData = gridLoader.getSelectedData();

			if (selectedData && selectedData.length > 0) {
				var tenderLot = selectedData[0];
				if (!selectedTenderLot || tenderLot.TenderLotUid != selectedTenderLot.TenderLotUid) {
					displayBidding(tenderLot);
				}
			}
    	});	
	}
	
	function displayBidding(tenderLot) {

		if (selectedTenderLot) {
			disposeSessions();

			// always clear details - because new session can be inaccessible 
			$details.html("");
		}

		selectedTenderLot = tenderLot;

		// todo: check why lots without StartDate and not in BidReceiving returns 405 error
		if (tenderLot && tenderLot.StartDate /*&& tenderLot.TenderLotStatusCode === "BidReceiving"*/) {

			log("Display session: " + tenderLot.DetailsUrl);

			$.ajax({
				type: "POST",
				url: tenderLot.DetailsUrl,
				headers: { "X-Content-Requested-For": "Page" },
				processResult: function (data) {
					$details.html(data);
					commonModule.init($details);
				}
			});
		}
	}
	
	function refreshGrid() {
		var gridLoader = $grid.data("loader");
		gridLoader.refresh();

		displayBidding(null);
	}

	function refreshSelectedGridRow(biddingInfo) {
		var gridLoader = $grid.data("loader");
		var gridData = gridLoader.getData();
		
		var gridItem, gridItemIndex;

		// find grid item to update
		for (var i = 0; i < gridData.length; i++) {
			if (gridData[i].TenderLotUid === biddingInfo.productItemUid) {

				gridItem = gridData[i];
				gridItemIndex = i;
				break;
			}
		}

		// update grid item from server
		if (gridItem) {
			$.ajax({
				type: "POST",
				url: $form.attr("action"),
				data: { tenderLotUid: gridItem.TenderLotUid },
				processResult: function (data) {
					if (data.Rows.length === 1) {
						var row = data.Rows[0];

						for (var prop in row) {
							if (row.hasOwnProperty(prop)) {
								gridItem[prop] = row[prop];
							}
						}

						gridLoader.table.row(gridItemIndex).invalidate();

						// ÑÑÑÐ°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð½Ð¾Ð²Ð¾ Ð²ÑÐ´ÐµÐ»ÐµÐ½Ð½Ð¾Ð¹ ÑÑÑÐ¾ÐºÐ¸, ÑÐ°Ðº ÐºÐ°Ðº Ð½Ð°Ñ Ð²Ð¸Ð´Ð¶ÐµÑ Ð²ÑÐ´ÐµÐ»ÐµÐ½Ð¸Ñ (ÑÐµÐºÐ±Ð¾ÐºÑ Ð¸Ð»Ð¸ ÑÐ°Ð´Ð¸Ð¾)
						// Ð¿Ð¾ÑÐ»Ðµ invalidate Ð½Ðµ Ð¿ÐµÑÐµÑÐ¸ÑÐ¾Ð²ÑÐ²Ð°ÐµÑÑÑ Ð² ÑÐ¾Ð¾ÑÐ²ÐµÑÑÑÐ²Ð¸Ð¸ Ñ Ð²ÑÐ´ÐµÐ»ÐµÐ½Ð½ÑÐ¼Ð¸ Ð´Ð°Ð½Ð½ÑÐ¼Ð¸
						if (selectedTenderLot) gridLoader.setSelectedDataByIds([selectedTenderLot.TenderLotUid]);
					}
				}
			});
		}
	}

	function initSplitter() {
		$("#" + options.containerId).split({
			orientation: "horizontal",
			position: "40%"
		});
	}
	
	return module;
	
}(FogSoft || {}, jQuery));
;
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.moment=t()}(this,function(){"use strict";var e,i;function c(){return e.apply(null,arguments)}function o(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function u(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function l(e){return void 0===e}function d(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function h(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function f(e,t){var n,s=[];for(n=0;n<e.length;++n)s.push(t(e[n],n));return s}function m(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function _(e,t){for(var n in t)m(t,n)&&(e[n]=t[n]);return m(t,"toString")&&(e.toString=t.toString),m(t,"valueOf")&&(e.valueOf=t.valueOf),e}function y(e,t,n,s){return Ot(e,t,n,s,!0).utc()}function g(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function p(e){if(null==e._isValid){var t=g(e),n=i.call(t.parsedDateParts,function(e){return null!=e}),s=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(s=s&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return s;e._isValid=s}return e._isValid}function v(e){var t=y(NaN);return null!=e?_(g(t),e):g(t).userInvalidated=!0,t}i=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,s=0;s<n;s++)if(s in t&&e.call(this,t[s],s,t))return!0;return!1};var r=c.momentProperties=[];function w(e,t){var n,s,i;if(l(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),l(t._i)||(e._i=t._i),l(t._f)||(e._f=t._f),l(t._l)||(e._l=t._l),l(t._strict)||(e._strict=t._strict),l(t._tzm)||(e._tzm=t._tzm),l(t._isUTC)||(e._isUTC=t._isUTC),l(t._offset)||(e._offset=t._offset),l(t._pf)||(e._pf=g(t)),l(t._locale)||(e._locale=t._locale),0<r.length)for(n=0;n<r.length;n++)l(i=t[s=r[n]])||(e[s]=i);return e}var t=!1;function M(e){w(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===t&&(t=!0,c.updateOffset(this),t=!1)}function S(e){return e instanceof M||null!=e&&null!=e._isAMomentObject}function D(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function k(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=D(t)),n}function a(e,t,n){var s,i=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),a=0;for(s=0;s<i;s++)(n&&e[s]!==t[s]||!n&&k(e[s])!==k(t[s]))&&a++;return a+r}function Y(e){!1===c.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function n(i,r){var a=!0;return _(function(){if(null!=c.deprecationHandler&&c.deprecationHandler(null,i),a){for(var e,t=[],n=0;n<arguments.length;n++){if(e="","object"==typeof arguments[n]){for(var s in e+="\n["+n+"] ",arguments[0])e+=s+": "+arguments[0][s]+", ";e=e.slice(0,-2)}else e=arguments[n];t.push(e)}Y(i+"\nArguments: "+Array.prototype.slice.call(t).join("")+"\n"+(new Error).stack),a=!1}return r.apply(this,arguments)},r)}var s,O={};function T(e,t){null!=c.deprecationHandler&&c.deprecationHandler(e,t),O[e]||(Y(t),O[e]=!0)}function x(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function b(e,t){var n,s=_({},e);for(n in t)m(t,n)&&(u(e[n])&&u(t[n])?(s[n]={},_(s[n],e[n]),_(s[n],t[n])):null!=t[n]?s[n]=t[n]:delete s[n]);for(n in e)m(e,n)&&!m(t,n)&&u(e[n])&&(s[n]=_({},s[n]));return s}function P(e){null!=e&&this.set(e)}c.suppressDeprecationWarnings=!1,c.deprecationHandler=null,s=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)m(e,t)&&n.push(t);return n};var W={};function H(e,t){var n=e.toLowerCase();W[n]=W[n+"s"]=W[t]=e}function R(e){return"string"==typeof e?W[e]||W[e.toLowerCase()]:void 0}function C(e){var t,n,s={};for(n in e)m(e,n)&&(t=R(n))&&(s[t]=e[n]);return s}var F={};function L(e,t){F[e]=t}function U(e,t,n){var s=""+Math.abs(e),i=t-s.length;return(0<=e?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+s}var N=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,G=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,V={},E={};function I(e,t,n,s){var i=s;"string"==typeof s&&(i=function(){return this[s]()}),e&&(E[e]=i),t&&(E[t[0]]=function(){return U(i.apply(this,arguments),t[1],t[2])}),n&&(E[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function A(e,t){return e.isValid()?(t=j(t,e.localeData()),V[t]=V[t]||function(s){var e,i,t,r=s.match(N);for(e=0,i=r.length;e<i;e++)E[r[e]]?r[e]=E[r[e]]:r[e]=(t=r[e]).match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"");return function(e){var t,n="";for(t=0;t<i;t++)n+=x(r[t])?r[t].call(e,s):r[t];return n}}(t),V[t](e)):e.localeData().invalidDate()}function j(e,t){var n=5;function s(e){return t.longDateFormat(e)||e}for(G.lastIndex=0;0<=n&&G.test(e);)e=e.replace(G,s),G.lastIndex=0,n-=1;return e}var Z=/\d/,z=/\d\d/,$=/\d{3}/,q=/\d{4}/,J=/[+-]?\d{6}/,B=/\d\d?/,Q=/\d\d\d\d?/,X=/\d\d\d\d\d\d?/,K=/\d{1,3}/,ee=/\d{1,4}/,te=/[+-]?\d{1,6}/,ne=/\d+/,se=/[+-]?\d+/,ie=/Z|[+-]\d\d:?\d\d/gi,re=/Z|[+-]\d\d(?::?\d\d)?/gi,ae=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,oe={};function ue(e,n,s){oe[e]=x(n)?n:function(e,t){return e&&s?s:n}}function le(e,t){return m(oe,e)?oe[e](t._strict,t._locale):new RegExp(de(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,s,i){return t||n||s||i})))}function de(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var he={};function ce(e,n){var t,s=n;for("string"==typeof e&&(e=[e]),d(n)&&(s=function(e,t){t[n]=k(e)}),t=0;t<e.length;t++)he[e[t]]=s}function fe(e,i){ce(e,function(e,t,n,s){n._w=n._w||{},i(e,n._w,n,s)})}var me=0,_e=1,ye=2,ge=3,pe=4,ve=5,we=6,Me=7,Se=8;function De(e){return ke(e)?366:365}function ke(e){return e%4==0&&e%100!=0||e%400==0}I("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),I(0,["YY",2],0,function(){return this.year()%100}),I(0,["YYYY",4],0,"year"),I(0,["YYYYY",5],0,"year"),I(0,["YYYYYY",6,!0],0,"year"),H("year","y"),L("year",1),ue("Y",se),ue("YY",B,z),ue("YYYY",ee,q),ue("YYYYY",te,J),ue("YYYYYY",te,J),ce(["YYYYY","YYYYYY"],me),ce("YYYY",function(e,t){t[me]=2===e.length?c.parseTwoDigitYear(e):k(e)}),ce("YY",function(e,t){t[me]=c.parseTwoDigitYear(e)}),ce("Y",function(e,t){t[me]=parseInt(e,10)}),c.parseTwoDigitYear=function(e){return k(e)+(68<k(e)?1900:2e3)};var Ye,Oe=Te("FullYear",!0);function Te(t,n){return function(e){return null!=e?(be(this,t,e),c.updateOffset(this,n),this):xe(this,t)}}function xe(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function be(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&ke(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),Pe(n,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function Pe(e,t){if(isNaN(e)||isNaN(t))return NaN;var n,s=(t%(n=12)+n)%n;return e+=(t-s)/12,1===s?ke(e)?29:28:31-s%7%2}Ye=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},I("M",["MM",2],"Mo",function(){return this.month()+1}),I("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),I("MMMM",0,0,function(e){return this.localeData().months(this,e)}),H("month","M"),L("month",8),ue("M",B),ue("MM",B,z),ue("MMM",function(e,t){return t.monthsShortRegex(e)}),ue("MMMM",function(e,t){return t.monthsRegex(e)}),ce(["M","MM"],function(e,t){t[_e]=k(e)-1}),ce(["MMM","MMMM"],function(e,t,n,s){var i=n._locale.monthsParse(e,s,n._strict);null!=i?t[_e]=i:g(n).invalidMonth=e});var We=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,He="January_February_March_April_May_June_July_August_September_October_November_December".split("_");var Re="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function Ce(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=k(t);else if(!d(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),Pe(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function Fe(e){return null!=e?(Ce(this,e),c.updateOffset(this,!0),this):xe(this,"Month")}var Le=ae;var Ue=ae;function Ne(){function e(e,t){return t.length-e.length}var t,n,s=[],i=[],r=[];for(t=0;t<12;t++)n=y([2e3,t]),s.push(this.monthsShort(n,"")),i.push(this.months(n,"")),r.push(this.months(n,"")),r.push(this.monthsShort(n,""));for(s.sort(e),i.sort(e),r.sort(e),t=0;t<12;t++)s[t]=de(s[t]),i[t]=de(i[t]);for(t=0;t<24;t++)r[t]=de(r[t]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+s.join("|")+")","i")}function Ge(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&0<=e&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function Ve(e,t,n){var s=7+t-n;return-((7+Ge(e,0,s).getUTCDay()-t)%7)+s-1}function Ee(e,t,n,s,i){var r,a,o=1+7*(t-1)+(7+n-s)%7+Ve(e,s,i);return a=o<=0?De(r=e-1)+o:o>De(e)?(r=e+1,o-De(e)):(r=e,o),{year:r,dayOfYear:a}}function Ie(e,t,n){var s,i,r=Ve(e.year(),t,n),a=Math.floor((e.dayOfYear()-r-1)/7)+1;return a<1?s=a+Ae(i=e.year()-1,t,n):a>Ae(e.year(),t,n)?(s=a-Ae(e.year(),t,n),i=e.year()+1):(i=e.year(),s=a),{week:s,year:i}}function Ae(e,t,n){var s=Ve(e,t,n),i=Ve(e+1,t,n);return(De(e)-s+i)/7}I("w",["ww",2],"wo","week"),I("W",["WW",2],"Wo","isoWeek"),H("week","w"),H("isoWeek","W"),L("week",5),L("isoWeek",5),ue("w",B),ue("ww",B,z),ue("W",B),ue("WW",B,z),fe(["w","ww","W","WW"],function(e,t,n,s){t[s.substr(0,1)]=k(e)});I("d",0,"do","day"),I("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),I("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),I("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),I("e",0,0,"weekday"),I("E",0,0,"isoWeekday"),H("day","d"),H("weekday","e"),H("isoWeekday","E"),L("day",11),L("weekday",11),L("isoWeekday",11),ue("d",B),ue("e",B),ue("E",B),ue("dd",function(e,t){return t.weekdaysMinRegex(e)}),ue("ddd",function(e,t){return t.weekdaysShortRegex(e)}),ue("dddd",function(e,t){return t.weekdaysRegex(e)}),fe(["dd","ddd","dddd"],function(e,t,n,s){var i=n._locale.weekdaysParse(e,s,n._strict);null!=i?t.d=i:g(n).invalidWeekday=e}),fe(["d","e","E"],function(e,t,n,s){t[s]=k(e)});var je="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");var Ze="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");var ze="Su_Mo_Tu_We_Th_Fr_Sa".split("_");var $e=ae;var qe=ae;var Je=ae;function Be(){function e(e,t){return t.length-e.length}var t,n,s,i,r,a=[],o=[],u=[],l=[];for(t=0;t<7;t++)n=y([2e3,1]).day(t),s=this.weekdaysMin(n,""),i=this.weekdaysShort(n,""),r=this.weekdays(n,""),a.push(s),o.push(i),u.push(r),l.push(s),l.push(i),l.push(r);for(a.sort(e),o.sort(e),u.sort(e),l.sort(e),t=0;t<7;t++)o[t]=de(o[t]),u[t]=de(u[t]),l[t]=de(l[t]);this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Qe(){return this.hours()%12||12}function Xe(e,t){I(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function Ke(e,t){return t._meridiemParse}I("H",["HH",2],0,"hour"),I("h",["hh",2],0,Qe),I("k",["kk",2],0,function(){return this.hours()||24}),I("hmm",0,0,function(){return""+Qe.apply(this)+U(this.minutes(),2)}),I("hmmss",0,0,function(){return""+Qe.apply(this)+U(this.minutes(),2)+U(this.seconds(),2)}),I("Hmm",0,0,function(){return""+this.hours()+U(this.minutes(),2)}),I("Hmmss",0,0,function(){return""+this.hours()+U(this.minutes(),2)+U(this.seconds(),2)}),Xe("a",!0),Xe("A",!1),H("hour","h"),L("hour",13),ue("a",Ke),ue("A",Ke),ue("H",B),ue("h",B),ue("k",B),ue("HH",B,z),ue("hh",B,z),ue("kk",B,z),ue("hmm",Q),ue("hmmss",X),ue("Hmm",Q),ue("Hmmss",X),ce(["H","HH"],ge),ce(["k","kk"],function(e,t,n){var s=k(e);t[ge]=24===s?0:s}),ce(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),ce(["h","hh"],function(e,t,n){t[ge]=k(e),g(n).bigHour=!0}),ce("hmm",function(e,t,n){var s=e.length-2;t[ge]=k(e.substr(0,s)),t[pe]=k(e.substr(s)),g(n).bigHour=!0}),ce("hmmss",function(e,t,n){var s=e.length-4,i=e.length-2;t[ge]=k(e.substr(0,s)),t[pe]=k(e.substr(s,2)),t[ve]=k(e.substr(i)),g(n).bigHour=!0}),ce("Hmm",function(e,t,n){var s=e.length-2;t[ge]=k(e.substr(0,s)),t[pe]=k(e.substr(s))}),ce("Hmmss",function(e,t,n){var s=e.length-4,i=e.length-2;t[ge]=k(e.substr(0,s)),t[pe]=k(e.substr(s,2)),t[ve]=k(e.substr(i))});var et,tt=Te("Hours",!0),nt={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:He,monthsShort:Re,week:{dow:0,doy:6},weekdays:je,weekdaysMin:ze,weekdaysShort:Ze,meridiemParse:/[ap]\.?m?\.?/i},st={},it={};function rt(e){return e?e.toLowerCase().replace("_","-"):e}function at(e){var t=null;if(!st[e]&&"undefined"!=typeof module&&module&&module.exports)try{t=et._abbr,require("./locale/"+e),ot(t)}catch(e){}return st[e]}function ot(e,t){var n;return e&&((n=l(t)?lt(e):ut(e,t))?et=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),et._abbr}function ut(e,t){if(null===t)return delete st[e],null;var n,s=nt;if(t.abbr=e,null!=st[e])T("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),s=st[e]._config;else if(null!=t.parentLocale)if(null!=st[t.parentLocale])s=st[t.parentLocale]._config;else{if(null==(n=at(t.parentLocale)))return it[t.parentLocale]||(it[t.parentLocale]=[]),it[t.parentLocale].push({name:e,config:t}),null;s=n._config}return st[e]=new P(b(s,t)),it[e]&&it[e].forEach(function(e){ut(e.name,e.config)}),ot(e),st[e]}function lt(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return et;if(!o(e)){if(t=at(e))return t;e=[e]}return function(e){for(var t,n,s,i,r=0;r<e.length;){for(t=(i=rt(e[r]).split("-")).length,n=(n=rt(e[r+1]))?n.split("-"):null;0<t;){if(s=at(i.slice(0,t).join("-")))return s;if(n&&n.length>=t&&a(i,n,!0)>=t-1)break;t--}r++}return et}(e)}function dt(e){var t,n=e._a;return n&&-2===g(e).overflow&&(t=n[_e]<0||11<n[_e]?_e:n[ye]<1||n[ye]>Pe(n[me],n[_e])?ye:n[ge]<0||24<n[ge]||24===n[ge]&&(0!==n[pe]||0!==n[ve]||0!==n[we])?ge:n[pe]<0||59<n[pe]?pe:n[ve]<0||59<n[ve]?ve:n[we]<0||999<n[we]?we:-1,g(e)._overflowDayOfYear&&(t<me||ye<t)&&(t=ye),g(e)._overflowWeeks&&-1===t&&(t=Me),g(e)._overflowWeekday&&-1===t&&(t=Se),g(e).overflow=t),e}function ht(e,t,n){return null!=e?e:null!=t?t:n}function ct(e){var t,n,s,i,r,a=[];if(!e._d){var o,u;for(o=e,u=new Date(c.now()),s=o._useUTC?[u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()]:[u.getFullYear(),u.getMonth(),u.getDate()],e._w&&null==e._a[ye]&&null==e._a[_e]&&function(e){var t,n,s,i,r,a,o,u;if(null!=(t=e._w).GG||null!=t.W||null!=t.E)r=1,a=4,n=ht(t.GG,e._a[me],Ie(Tt(),1,4).year),s=ht(t.W,1),((i=ht(t.E,1))<1||7<i)&&(u=!0);else{r=e._locale._week.dow,a=e._locale._week.doy;var l=Ie(Tt(),r,a);n=ht(t.gg,e._a[me],l.year),s=ht(t.w,l.week),null!=t.d?((i=t.d)<0||6<i)&&(u=!0):null!=t.e?(i=t.e+r,(t.e<0||6<t.e)&&(u=!0)):i=r}s<1||s>Ae(n,r,a)?g(e)._overflowWeeks=!0:null!=u?g(e)._overflowWeekday=!0:(o=Ee(n,s,i,r,a),e._a[me]=o.year,e._dayOfYear=o.dayOfYear)}(e),null!=e._dayOfYear&&(r=ht(e._a[me],s[me]),(e._dayOfYear>De(r)||0===e._dayOfYear)&&(g(e)._overflowDayOfYear=!0),n=Ge(r,0,e._dayOfYear),e._a[_e]=n.getUTCMonth(),e._a[ye]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=a[t]=s[t];for(;t<7;t++)e._a[t]=a[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[ge]&&0===e._a[pe]&&0===e._a[ve]&&0===e._a[we]&&(e._nextDay=!0,e._a[ge]=0),e._d=(e._useUTC?Ge:function(e,t,n,s,i,r,a){var o=new Date(e,t,n,s,i,r,a);return e<100&&0<=e&&isFinite(o.getFullYear())&&o.setFullYear(e),o}).apply(null,a),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ge]=24),e._w&&void 0!==e._w.d&&e._w.d!==i&&(g(e).weekdayMismatch=!0)}}var ft=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,mt=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,_t=/Z|[+-]\d\d(?::?\d\d)?/,yt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],gt=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],pt=/^\/?Date\((\-?\d+)/i;function vt(e){var t,n,s,i,r,a,o=e._i,u=ft.exec(o)||mt.exec(o);if(u){for(g(e).iso=!0,t=0,n=yt.length;t<n;t++)if(yt[t][1].exec(u[1])){i=yt[t][0],s=!1!==yt[t][2];break}if(null==i)return void(e._isValid=!1);if(u[3]){for(t=0,n=gt.length;t<n;t++)if(gt[t][1].exec(u[3])){r=(u[2]||" ")+gt[t][0];break}if(null==r)return void(e._isValid=!1)}if(!s&&null!=r)return void(e._isValid=!1);if(u[4]){if(!_t.exec(u[4]))return void(e._isValid=!1);a="Z"}e._f=i+(r||"")+(a||""),kt(e)}else e._isValid=!1}var wt=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function Mt(e,t,n,s,i,r){var a=[function(e){var t=parseInt(e,10);{if(t<=49)return 2e3+t;if(t<=999)return 1900+t}return t}(e),Re.indexOf(t),parseInt(n,10),parseInt(s,10),parseInt(i,10)];return r&&a.push(parseInt(r,10)),a}var St={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Dt(e){var t,n,s,i=wt.exec(e._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(i){var r=Mt(i[4],i[3],i[2],i[5],i[6],i[7]);if(t=i[1],n=r,s=e,t&&Ze.indexOf(t)!==new Date(n[0],n[1],n[2]).getDay()&&(g(s).weekdayMismatch=!0,!(s._isValid=!1)))return;e._a=r,e._tzm=function(e,t,n){if(e)return St[e];if(t)return 0;var s=parseInt(n,10),i=s%100;return(s-i)/100*60+i}(i[8],i[9],i[10]),e._d=Ge.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),g(e).rfc2822=!0}else e._isValid=!1}function kt(e){if(e._f!==c.ISO_8601)if(e._f!==c.RFC_2822){e._a=[],g(e).empty=!0;var t,n,s,i,r,a,o,u,l=""+e._i,d=l.length,h=0;for(s=j(e._f,e._locale).match(N)||[],t=0;t<s.length;t++)i=s[t],(n=(l.match(le(i,e))||[])[0])&&(0<(r=l.substr(0,l.indexOf(n))).length&&g(e).unusedInput.push(r),l=l.slice(l.indexOf(n)+n.length),h+=n.length),E[i]?(n?g(e).empty=!1:g(e).unusedTokens.push(i),a=i,u=e,null!=(o=n)&&m(he,a)&&he[a](o,u._a,u,a)):e._strict&&!n&&g(e).unusedTokens.push(i);g(e).charsLeftOver=d-h,0<l.length&&g(e).unusedInput.push(l),e._a[ge]<=12&&!0===g(e).bigHour&&0<e._a[ge]&&(g(e).bigHour=void 0),g(e).parsedDateParts=e._a.slice(0),g(e).meridiem=e._meridiem,e._a[ge]=function(e,t,n){var s;if(null==n)return t;return null!=e.meridiemHour?e.meridiemHour(t,n):(null!=e.isPM&&((s=e.isPM(n))&&t<12&&(t+=12),s||12!==t||(t=0)),t)}(e._locale,e._a[ge],e._meridiem),ct(e),dt(e)}else Dt(e);else vt(e)}function Yt(e){var t,n,s,i,r=e._i,a=e._f;return e._locale=e._locale||lt(e._l),null===r||void 0===a&&""===r?v({nullInput:!0}):("string"==typeof r&&(e._i=r=e._locale.preparse(r)),S(r)?new M(dt(r)):(h(r)?e._d=r:o(a)?function(e){var t,n,s,i,r;if(0===e._f.length)return g(e).invalidFormat=!0,e._d=new Date(NaN);for(i=0;i<e._f.length;i++)r=0,t=w({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],kt(t),p(t)&&(r+=g(t).charsLeftOver,r+=10*g(t).unusedTokens.length,g(t).score=r,(null==s||r<s)&&(s=r,n=t));_(e,n||t)}(e):a?kt(e):l(n=(t=e)._i)?t._d=new Date(c.now()):h(n)?t._d=new Date(n.valueOf()):"string"==typeof n?(s=t,null===(i=pt.exec(s._i))?(vt(s),!1===s._isValid&&(delete s._isValid,Dt(s),!1===s._isValid&&(delete s._isValid,c.createFromInputFallback(s)))):s._d=new Date(+i[1])):o(n)?(t._a=f(n.slice(0),function(e){return parseInt(e,10)}),ct(t)):u(n)?function(e){if(!e._d){var t=C(e._i);e._a=f([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),ct(e)}}(t):d(n)?t._d=new Date(n):c.createFromInputFallback(t),p(e)||(e._d=null),e))}function Ot(e,t,n,s,i){var r,a={};return!0!==n&&!1!==n||(s=n,n=void 0),(u(e)&&function(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}(e)||o(e)&&0===e.length)&&(e=void 0),a._isAMomentObject=!0,a._useUTC=a._isUTC=i,a._l=n,a._i=e,a._f=t,a._strict=s,(r=new M(dt(Yt(a))))._nextDay&&(r.add(1,"d"),r._nextDay=void 0),r}function Tt(e,t,n,s){return Ot(e,t,n,s,!1)}c.createFromInputFallback=n("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),c.ISO_8601=function(){},c.RFC_2822=function(){};var xt=n("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Tt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:v()}),bt=n("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Tt.apply(null,arguments);return this.isValid()&&e.isValid()?this<e?this:e:v()});function Pt(e,t){var n,s;if(1===t.length&&o(t[0])&&(t=t[0]),!t.length)return Tt();for(n=t[0],s=1;s<t.length;++s)t[s].isValid()&&!t[s][e](n)||(n=t[s]);return n}var Wt=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Ht(e){var t=C(e),n=t.year||0,s=t.quarter||0,i=t.month||0,r=t.week||t.isoWeek||0,a=t.day||0,o=t.hour||0,u=t.minute||0,l=t.second||0,d=t.millisecond||0;this._isValid=function(e){for(var t in e)if(-1===Ye.call(Wt,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,s=0;s<Wt.length;++s)if(e[Wt[s]]){if(n)return!1;parseFloat(e[Wt[s]])!==k(e[Wt[s]])&&(n=!0)}return!0}(t),this._milliseconds=+d+1e3*l+6e4*u+1e3*o*60*60,this._days=+a+7*r,this._months=+i+3*s+12*n,this._data={},this._locale=lt(),this._bubble()}function Rt(e){return e instanceof Ht}function Ct(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Ft(e,n){I(e,0,0,function(){var e=this.utcOffset(),t="+";return e<0&&(e=-e,t="-"),t+U(~~(e/60),2)+n+U(~~e%60,2)})}Ft("Z",":"),Ft("ZZ",""),ue("Z",re),ue("ZZ",re),ce(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Ut(re,e)});var Lt=/([\+\-]|\d\d)/gi;function Ut(e,t){var n=(t||"").match(e);if(null===n)return null;var s=((n[n.length-1]||[])+"").match(Lt)||["-",0,0],i=60*s[1]+k(s[2]);return 0===i?0:"+"===s[0]?i:-i}function Nt(e,t){var n,s;return t._isUTC?(n=t.clone(),s=(S(e)||h(e)?e.valueOf():Tt(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+s),c.updateOffset(n,!1),n):Tt(e).local()}function Gt(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Vt(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}c.updateOffset=function(){};var Et=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,It=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function At(e,t){var n,s,i,r=e,a=null;return Rt(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:d(e)?(r={},t?r[t]=e:r.milliseconds=e):(a=Et.exec(e))?(n="-"===a[1]?-1:1,r={y:0,d:k(a[ye])*n,h:k(a[ge])*n,m:k(a[pe])*n,s:k(a[ve])*n,ms:k(Ct(1e3*a[we]))*n}):(a=It.exec(e))?(n="-"===a[1]?-1:1,r={y:jt(a[2],n),M:jt(a[3],n),w:jt(a[4],n),d:jt(a[5],n),h:jt(a[6],n),m:jt(a[7],n),s:jt(a[8],n)}):null==r?r={}:"object"==typeof r&&("from"in r||"to"in r)&&(i=function(e,t){var n;if(!e.isValid()||!t.isValid())return{milliseconds:0,months:0};t=Nt(t,e),e.isBefore(t)?n=Zt(e,t):((n=Zt(t,e)).milliseconds=-n.milliseconds,n.months=-n.months);return n}(Tt(r.from),Tt(r.to)),(r={}).ms=i.milliseconds,r.M=i.months),s=new Ht(r),Rt(e)&&m(e,"_locale")&&(s._locale=e._locale),s}function jt(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Zt(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function zt(s,i){return function(e,t){var n;return null===t||isNaN(+t)||(T(i,"moment()."+i+"(period, number) is deprecated. Please use moment()."+i+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),n=e,e=t,t=n),$t(this,At(e="string"==typeof e?+e:e,t),s),this}}function $t(e,t,n,s){var i=t._milliseconds,r=Ct(t._days),a=Ct(t._months);e.isValid()&&(s=null==s||s,a&&Ce(e,xe(e,"Month")+a*n),r&&be(e,"Date",xe(e,"Date")+r*n),i&&e._d.setTime(e._d.valueOf()+i*n),s&&c.updateOffset(e,r||a))}At.fn=Ht.prototype,At.invalid=function(){return At(NaN)};var qt=zt(1,"add"),Jt=zt(-1,"subtract");function Bt(e,t){var n=12*(t.year()-e.year())+(t.month()-e.month()),s=e.clone().add(n,"months");return-(n+(t-s<0?(t-s)/(s-e.clone().add(n-1,"months")):(t-s)/(e.clone().add(n+1,"months")-s)))||0}function Qt(e){var t;return void 0===e?this._locale._abbr:(null!=(t=lt(e))&&(this._locale=t),this)}c.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",c.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Xt=n("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});function Kt(){return this._locale}function en(e,t){I(0,[e,e.length],0,t)}function tn(e,t,n,s,i){var r;return null==e?Ie(this,s,i).year:((r=Ae(e,s,i))<t&&(t=r),function(e,t,n,s,i){var r=Ee(e,t,n,s,i),a=Ge(r.year,0,r.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}.call(this,e,t,n,s,i))}I(0,["gg",2],0,function(){return this.weekYear()%100}),I(0,["GG",2],0,function(){return this.isoWeekYear()%100}),en("gggg","weekYear"),en("ggggg","weekYear"),en("GGGG","isoWeekYear"),en("GGGGG","isoWeekYear"),H("weekYear","gg"),H("isoWeekYear","GG"),L("weekYear",1),L("isoWeekYear",1),ue("G",se),ue("g",se),ue("GG",B,z),ue("gg",B,z),ue("GGGG",ee,q),ue("gggg",ee,q),ue("GGGGG",te,J),ue("ggggg",te,J),fe(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,s){t[s.substr(0,2)]=k(e)}),fe(["gg","GG"],function(e,t,n,s){t[s]=c.parseTwoDigitYear(e)}),I("Q",0,"Qo","quarter"),H("quarter","Q"),L("quarter",7),ue("Q",Z),ce("Q",function(e,t){t[_e]=3*(k(e)-1)}),I("D",["DD",2],"Do","date"),H("date","D"),L("date",9),ue("D",B),ue("DD",B,z),ue("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),ce(["D","DD"],ye),ce("Do",function(e,t){t[ye]=k(e.match(B)[0])});var nn=Te("Date",!0);I("DDD",["DDDD",3],"DDDo","dayOfYear"),H("dayOfYear","DDD"),L("dayOfYear",4),ue("DDD",K),ue("DDDD",$),ce(["DDD","DDDD"],function(e,t,n){n._dayOfYear=k(e)}),I("m",["mm",2],0,"minute"),H("minute","m"),L("minute",14),ue("m",B),ue("mm",B,z),ce(["m","mm"],pe);var sn=Te("Minutes",!1);I("s",["ss",2],0,"second"),H("second","s"),L("second",15),ue("s",B),ue("ss",B,z),ce(["s","ss"],ve);var rn,an=Te("Seconds",!1);for(I("S",0,0,function(){return~~(this.millisecond()/100)}),I(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),I(0,["SSS",3],0,"millisecond"),I(0,["SSSS",4],0,function(){return 10*this.millisecond()}),I(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),I(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),I(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),I(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),I(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),H("millisecond","ms"),L("millisecond",16),ue("S",K,Z),ue("SS",K,z),ue("SSS",K,$),rn="SSSS";rn.length<=9;rn+="S")ue(rn,ne);function on(e,t){t[we]=k(1e3*("0."+e))}for(rn="S";rn.length<=9;rn+="S")ce(rn,on);var un=Te("Milliseconds",!1);I("z",0,0,"zoneAbbr"),I("zz",0,0,"zoneName");var ln=M.prototype;function dn(e){return e}ln.add=qt,ln.calendar=function(e,t){var n=e||Tt(),s=Nt(n,this).startOf("day"),i=c.calendarFormat(this,s)||"sameElse",r=t&&(x(t[i])?t[i].call(this,n):t[i]);return this.format(r||this.localeData().calendar(i,this,Tt(n)))},ln.clone=function(){return new M(this)},ln.diff=function(e,t,n){var s,i,r;if(!this.isValid())return NaN;if(!(s=Nt(e,this)).isValid())return NaN;switch(i=6e4*(s.utcOffset()-this.utcOffset()),t=R(t)){case"year":r=Bt(this,s)/12;break;case"month":r=Bt(this,s);break;case"quarter":r=Bt(this,s)/3;break;case"second":r=(this-s)/1e3;break;case"minute":r=(this-s)/6e4;break;case"hour":r=(this-s)/36e5;break;case"day":r=(this-s-i)/864e5;break;case"week":r=(this-s-i)/6048e5;break;default:r=this-s}return n?r:D(r)},ln.endOf=function(e){return void 0===(e=R(e))||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))},ln.format=function(e){e||(e=this.isUtc()?c.defaultFormatUtc:c.defaultFormat);var t=A(this,e);return this.localeData().postformat(t)},ln.from=function(e,t){return this.isValid()&&(S(e)&&e.isValid()||Tt(e).isValid())?At({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},ln.fromNow=function(e){return this.from(Tt(),e)},ln.to=function(e,t){return this.isValid()&&(S(e)&&e.isValid()||Tt(e).isValid())?At({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},ln.toNow=function(e){return this.to(Tt(),e)},ln.get=function(e){return x(this[e=R(e)])?this[e]():this},ln.invalidAt=function(){return g(this).overflow},ln.isAfter=function(e,t){var n=S(e)?e:Tt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=R(t)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())},ln.isBefore=function(e,t){var n=S(e)?e:Tt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=R(t)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())},ln.isBetween=function(e,t,n,s){var i=S(e)?e:Tt(e),r=S(t)?t:Tt(t);return!!(this.isValid()&&i.isValid()&&r.isValid())&&("("===(s=s||"()")[0]?this.isAfter(i,n):!this.isBefore(i,n))&&(")"===s[1]?this.isBefore(r,n):!this.isAfter(r,n))},ln.isSame=function(e,t){var n,s=S(e)?e:Tt(e);return!(!this.isValid()||!s.isValid())&&("millisecond"===(t=R(t)||"millisecond")?this.valueOf()===s.valueOf():(n=s.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))},ln.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},ln.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},ln.isValid=function(){return p(this)},ln.lang=Xt,ln.locale=Qt,ln.localeData=Kt,ln.max=bt,ln.min=xt,ln.parsingFlags=function(){return _({},g(this))},ln.set=function(e,t){if("object"==typeof e)for(var n=function(e){var t=[];for(var n in e)t.push({unit:n,priority:F[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}(e=C(e)),s=0;s<n.length;s++)this[n[s].unit](e[n[s].unit]);else if(x(this[e=R(e)]))return this[e](t);return this},ln.startOf=function(e){switch(e=R(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},ln.subtract=Jt,ln.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},ln.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},ln.toDate=function(){return new Date(this.valueOf())},ln.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||9999<n.year()?A(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):x(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",A(n,"Z")):A(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},ln.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',s=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i=t+'[")]';return this.format(n+s+"-MM-DD[T]HH:mm:ss.SSS"+i)},ln.toJSON=function(){return this.isValid()?this.toISOString():null},ln.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},ln.unix=function(){return Math.floor(this.valueOf()/1e3)},ln.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},ln.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},ln.year=Oe,ln.isLeapYear=function(){return ke(this.year())},ln.weekYear=function(e){return tn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},ln.isoWeekYear=function(e){return tn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},ln.quarter=ln.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},ln.month=Fe,ln.daysInMonth=function(){return Pe(this.year(),this.month())},ln.week=ln.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},ln.isoWeek=ln.isoWeeks=function(e){var t=Ie(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},ln.weeksInYear=function(){var e=this.localeData()._week;return Ae(this.year(),e.dow,e.doy)},ln.isoWeeksInYear=function(){return Ae(this.year(),1,4)},ln.date=nn,ln.day=ln.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t,n,s=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(t=e,n=this.localeData(),e="string"!=typeof t?t:isNaN(t)?"number"==typeof(t=n.weekdaysParse(t))?t:null:parseInt(t,10),this.add(e-s,"d")):s},ln.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},ln.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null==e)return this.day()||7;var t,n,s=(t=e,n=this.localeData(),"string"==typeof t?n.weekdaysParse(t)%7||7:isNaN(t)?null:t);return this.day(this.day()%7?s:s-7)},ln.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},ln.hour=ln.hours=tt,ln.minute=ln.minutes=sn,ln.second=ln.seconds=an,ln.millisecond=ln.milliseconds=un,ln.utcOffset=function(e,t,n){var s,i=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null==e)return this._isUTC?i:Gt(this);if("string"==typeof e){if(null===(e=Ut(re,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(s=Gt(this)),this._offset=e,this._isUTC=!0,null!=s&&this.add(s,"m"),i!==e&&(!t||this._changeInProgress?$t(this,At(e-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,c.updateOffset(this,!0),this._changeInProgress=null)),this},ln.utc=function(e){return this.utcOffset(0,e)},ln.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Gt(this),"m")),this},ln.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Ut(ie,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},ln.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?Tt(e).utcOffset():0,(this.utcOffset()-e)%60==0)},ln.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},ln.isLocal=function(){return!!this.isValid()&&!this._isUTC},ln.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},ln.isUtc=Vt,ln.isUTC=Vt,ln.zoneAbbr=function(){return this._isUTC?"UTC":""},ln.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},ln.dates=n("dates accessor is deprecated. Use date instead.",nn),ln.months=n("months accessor is deprecated. Use month instead",Fe),ln.years=n("years accessor is deprecated. Use year instead",Oe),ln.zone=n("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}),ln.isDSTShifted=n("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!l(this._isDSTShifted))return this._isDSTShifted;var e={};if(w(e,this),(e=Yt(e))._a){var t=e._isUTC?y(e._a):Tt(e._a);this._isDSTShifted=this.isValid()&&0<a(e._a,t.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var hn=P.prototype;function cn(e,t,n,s){var i=lt(),r=y().set(s,t);return i[n](r,e)}function fn(e,t,n){if(d(e)&&(t=e,e=void 0),e=e||"",null!=t)return cn(e,t,n,"month");var s,i=[];for(s=0;s<12;s++)i[s]=cn(e,s,n,"month");return i}function mn(e,t,n,s){t=("boolean"==typeof e?d(t)&&(n=t,t=void 0):(t=e,e=!1,d(n=t)&&(n=t,t=void 0)),t||"");var i,r=lt(),a=e?r._week.dow:0;if(null!=n)return cn(t,(n+a)%7,s,"day");var o=[];for(i=0;i<7;i++)o[i]=cn(t,(i+a)%7,s,"day");return o}hn.calendar=function(e,t,n){var s=this._calendar[e]||this._calendar.sameElse;return x(s)?s.call(t,n):s},hn.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])},hn.invalidDate=function(){return this._invalidDate},hn.ordinal=function(e){return this._ordinal.replace("%d",e)},hn.preparse=dn,hn.postformat=dn,hn.relativeTime=function(e,t,n,s){var i=this._relativeTime[n];return x(i)?i(e,t,n,s):i.replace(/%d/i,e)},hn.pastFuture=function(e,t){var n=this._relativeTime[0<e?"future":"past"];return x(n)?n(t):n.replace(/%s/i,t)},hn.set=function(e){var t,n;for(n in e)x(t=e[n])?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},hn.months=function(e,t){return e?o(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||We).test(t)?"format":"standalone"][e.month()]:o(this._months)?this._months:this._months.standalone},hn.monthsShort=function(e,t){return e?o(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[We.test(t)?"format":"standalone"][e.month()]:o(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},hn.monthsParse=function(e,t,n){var s,i,r;if(this._monthsParseExact)return function(e,t,n){var s,i,r,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],s=0;s<12;++s)r=y([2e3,s]),this._shortMonthsParse[s]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[s]=this.months(r,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(i=Ye.call(this._shortMonthsParse,a))?i:null:-1!==(i=Ye.call(this._longMonthsParse,a))?i:null:"MMM"===t?-1!==(i=Ye.call(this._shortMonthsParse,a))?i:-1!==(i=Ye.call(this._longMonthsParse,a))?i:null:-1!==(i=Ye.call(this._longMonthsParse,a))?i:-1!==(i=Ye.call(this._shortMonthsParse,a))?i:null}.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),s=0;s<12;s++){if(i=y([2e3,s]),n&&!this._longMonthsParse[s]&&(this._longMonthsParse[s]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[s]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[s]||(r="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[s]=new RegExp(r.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[s].test(e))return s;if(n&&"MMM"===t&&this._shortMonthsParse[s].test(e))return s;if(!n&&this._monthsParse[s].test(e))return s}},hn.monthsRegex=function(e){return this._monthsParseExact?(m(this,"_monthsRegex")||Ne.call(this),e?this._monthsStrictRegex:this._monthsRegex):(m(this,"_monthsRegex")||(this._monthsRegex=Ue),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},hn.monthsShortRegex=function(e){return this._monthsParseExact?(m(this,"_monthsRegex")||Ne.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(m(this,"_monthsShortRegex")||(this._monthsShortRegex=Le),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},hn.week=function(e){return Ie(e,this._week.dow,this._week.doy).week},hn.firstDayOfYear=function(){return this._week.doy},hn.firstDayOfWeek=function(){return this._week.dow},hn.weekdays=function(e,t){return e?o(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]:o(this._weekdays)?this._weekdays:this._weekdays.standalone},hn.weekdaysMin=function(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin},hn.weekdaysShort=function(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort},hn.weekdaysParse=function(e,t,n){var s,i,r;if(this._weekdaysParseExact)return function(e,t,n){var s,i,r,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],s=0;s<7;++s)r=y([2e3,1]).day(s),this._minWeekdaysParse[s]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[s]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[s]=this.weekdays(r,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(i=Ye.call(this._weekdaysParse,a))?i:null:"ddd"===t?-1!==(i=Ye.call(this._shortWeekdaysParse,a))?i:null:-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:null:"dddd"===t?-1!==(i=Ye.call(this._weekdaysParse,a))?i:-1!==(i=Ye.call(this._shortWeekdaysParse,a))?i:-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:null:"ddd"===t?-1!==(i=Ye.call(this._shortWeekdaysParse,a))?i:-1!==(i=Ye.call(this._weekdaysParse,a))?i:-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:null:-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:-1!==(i=Ye.call(this._weekdaysParse,a))?i:-1!==(i=Ye.call(this._shortWeekdaysParse,a))?i:null}.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),s=0;s<7;s++){if(i=y([2e3,1]).day(s),n&&!this._fullWeekdaysParse[s]&&(this._fullWeekdaysParse[s]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[s]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[s]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[s]||(r="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[s]=new RegExp(r.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[s].test(e))return s;if(n&&"ddd"===t&&this._shortWeekdaysParse[s].test(e))return s;if(n&&"dd"===t&&this._minWeekdaysParse[s].test(e))return s;if(!n&&this._weekdaysParse[s].test(e))return s}},hn.weekdaysRegex=function(e){return this._weekdaysParseExact?(m(this,"_weekdaysRegex")||Be.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(m(this,"_weekdaysRegex")||(this._weekdaysRegex=$e),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},hn.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(m(this,"_weekdaysRegex")||Be.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(m(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=qe),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},hn.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(m(this,"_weekdaysRegex")||Be.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(m(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Je),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},hn.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},hn.meridiem=function(e,t,n){return 11<e?n?"pm":"PM":n?"am":"AM"},ot("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===k(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),c.lang=n("moment.lang is deprecated. Use moment.locale instead.",ot),c.langData=n("moment.langData is deprecated. Use moment.localeData instead.",lt);var _n=Math.abs;function yn(e,t,n,s){var i=At(t,n);return e._milliseconds+=s*i._milliseconds,e._days+=s*i._days,e._months+=s*i._months,e._bubble()}function gn(e){return e<0?Math.floor(e):Math.ceil(e)}function pn(e){return 4800*e/146097}function vn(e){return 146097*e/4800}function wn(e){return function(){return this.as(e)}}var Mn=wn("ms"),Sn=wn("s"),Dn=wn("m"),kn=wn("h"),Yn=wn("d"),On=wn("w"),Tn=wn("M"),xn=wn("y");function bn(e){return function(){return this.isValid()?this._data[e]:NaN}}var Pn=bn("milliseconds"),Wn=bn("seconds"),Hn=bn("minutes"),Rn=bn("hours"),Cn=bn("days"),Fn=bn("months"),Ln=bn("years");var Un=Math.round,Nn={ss:44,s:45,m:45,h:22,d:26,M:11};var Gn=Math.abs;function Vn(e){return(0<e)-(e<0)||+e}function En(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n=Gn(this._milliseconds)/1e3,s=Gn(this._days),i=Gn(this._months);t=D((e=D(n/60))/60),n%=60,e%=60;var r=D(i/12),a=i%=12,o=s,u=t,l=e,d=n?n.toFixed(3).replace(/\.?0+$/,""):"",h=this.asSeconds();if(!h)return"P0D";var c=h<0?"-":"",f=Vn(this._months)!==Vn(h)?"-":"",m=Vn(this._days)!==Vn(h)?"-":"",_=Vn(this._milliseconds)!==Vn(h)?"-":"";return c+"P"+(r?f+r+"Y":"")+(a?f+a+"M":"")+(o?m+o+"D":"")+(u||l||d?"T":"")+(u?_+u+"H":"")+(l?_+l+"M":"")+(d?_+d+"S":"")}var In=Ht.prototype;return In.isValid=function(){return this._isValid},In.abs=function(){var e=this._data;return this._milliseconds=_n(this._milliseconds),this._days=_n(this._days),this._months=_n(this._months),e.milliseconds=_n(e.milliseconds),e.seconds=_n(e.seconds),e.minutes=_n(e.minutes),e.hours=_n(e.hours),e.months=_n(e.months),e.years=_n(e.years),this},In.add=function(e,t){return yn(this,e,t,1)},In.subtract=function(e,t){return yn(this,e,t,-1)},In.as=function(e){if(!this.isValid())return NaN;var t,n,s=this._milliseconds;if("month"===(e=R(e))||"year"===e)return t=this._days+s/864e5,n=this._months+pn(t),"month"===e?n:n/12;switch(t=this._days+Math.round(vn(this._months)),e){case"week":return t/7+s/6048e5;case"day":return t+s/864e5;case"hour":return 24*t+s/36e5;case"minute":return 1440*t+s/6e4;case"second":return 86400*t+s/1e3;case"millisecond":return Math.floor(864e5*t)+s;default:throw new Error("Unknown unit "+e)}},In.asMilliseconds=Mn,In.asSeconds=Sn,In.asMinutes=Dn,In.asHours=kn,In.asDays=Yn,In.asWeeks=On,In.asMonths=Tn,In.asYears=xn,In.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*k(this._months/12):NaN},In._bubble=function(){var e,t,n,s,i,r=this._milliseconds,a=this._days,o=this._months,u=this._data;return 0<=r&&0<=a&&0<=o||r<=0&&a<=0&&o<=0||(r+=864e5*gn(vn(o)+a),o=a=0),u.milliseconds=r%1e3,e=D(r/1e3),u.seconds=e%60,t=D(e/60),u.minutes=t%60,n=D(t/60),u.hours=n%24,o+=i=D(pn(a+=D(n/24))),a-=gn(vn(i)),s=D(o/12),o%=12,u.days=a,u.months=o,u.years=s,this},In.clone=function(){return At(this)},In.get=function(e){return e=R(e),this.isValid()?this[e+"s"]():NaN},In.milliseconds=Pn,In.seconds=Wn,In.minutes=Hn,In.hours=Rn,In.days=Cn,In.weeks=function(){return D(this.days()/7)},In.months=Fn,In.years=Ln,In.humanize=function(e){if(!this.isValid())return this.localeData().invalidDate();var t,n,s,i,r,a,o,u,l,d,h,c=this.localeData(),f=(n=!e,s=c,i=At(t=this).abs(),r=Un(i.as("s")),a=Un(i.as("m")),o=Un(i.as("h")),u=Un(i.as("d")),l=Un(i.as("M")),d=Un(i.as("y")),(h=r<=Nn.ss&&["s",r]||r<Nn.s&&["ss",r]||a<=1&&["m"]||a<Nn.m&&["mm",a]||o<=1&&["h"]||o<Nn.h&&["hh",o]||u<=1&&["d"]||u<Nn.d&&["dd",u]||l<=1&&["M"]||l<Nn.M&&["MM",l]||d<=1&&["y"]||["yy",d])[2]=n,h[3]=0<+t,h[4]=s,function(e,t,n,s,i){return i.relativeTime(t||1,!!n,e,s)}.apply(null,h));return e&&(f=c.pastFuture(+this,f)),c.postformat(f)},In.toISOString=En,In.toString=En,In.toJSON=En,In.locale=Qt,In.localeData=Kt,In.toIsoString=n("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",En),In.lang=Xt,I("X",0,0,"unix"),I("x",0,0,"valueOf"),ue("x",se),ue("X",/[+-]?\d+(\.\d{1,3})?/),ce("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),ce("x",function(e,t,n){n._d=new Date(k(e))}),c.version="2.23.0",e=Tt,c.fn=ln,c.min=function(){return Pt("isBefore",[].slice.call(arguments,0))},c.max=function(){return Pt("isAfter",[].slice.call(arguments,0))},c.now=function(){return Date.now?Date.now():+new Date},c.utc=y,c.unix=function(e){return Tt(1e3*e)},c.months=function(e,t){return fn(e,t,"months")},c.isDate=h,c.locale=ot,c.invalid=v,c.duration=At,c.isMoment=S,c.weekdays=function(e,t,n){return mn(e,t,n,"weekdays")},c.parseZone=function(){return Tt.apply(null,arguments).parseZone()},c.localeData=lt,c.isDuration=Rt,c.monthsShort=function(e,t){return fn(e,t,"monthsShort")},c.weekdaysMin=function(e,t,n){return mn(e,t,n,"weekdaysMin")},c.defineLocale=ut,c.updateLocale=function(e,t){if(null!=t){var n,s,i=nt;null!=(s=at(e))&&(i=s._config),(n=new P(t=b(i,t))).parentLocale=st[e],st[e]=n,ot(e)}else null!=st[e]&&(null!=st[e].parentLocale?st[e]=st[e].parentLocale:null!=st[e]&&delete st[e]);return st[e]},c.locales=function(){return s(st)},c.weekdaysShort=function(e,t,n){return mn(e,t,n,"weekdaysShort")},c.normalizeUnits=R,c.relativeTimeRounding=function(e){return void 0===e?Un:"function"==typeof e&&(Un=e,!0)},c.relativeTimeThreshold=function(e,t){return void 0!==Nn[e]&&(void 0===t?Nn[e]:(Nn[e]=t,"s"===e&&(Nn.ss=t-1),!0))},c.calendarFormat=function(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},c.prototype=ln,c.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},c});;
/*!
 * FullCalendar v3.10.0
 * Docs & License: https://fullcalendar.io/
 * (c) 2018 Adam Shaw
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("moment"),require("jquery")):"function"==typeof define&&define.amd?define(["moment","jquery"],e):"object"==typeof exports?exports.FullCalendar=e(require("moment"),require("jquery")):t.FullCalendar=e(t.moment,t.jQuery)}("undefined"!=typeof self?self:this,function(t,e){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=256)}([function(e,n){e.exports=t},,function(t,e){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};e.__extends=function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}},function(t,n){t.exports=e},function(t,e,n){function r(t,e){e.left&&t.css({"border-left-width":1,"margin-left":e.left-1}),e.right&&t.css({"border-right-width":1,"margin-right":e.right-1})}function i(t){t.css({"margin-left":"","margin-right":"","border-left-width":"","border-right-width":""})}function o(){ht("body").addClass("fc-not-allowed")}function s(){ht("body").removeClass("fc-not-allowed")}function a(t,e,n){var r=Math.floor(e/t.length),i=Math.floor(e-r*(t.length-1)),o=[],s=[],a=[],u=0;l(t),t.each(function(e,n){var l=e===t.length-1?i:r,d=ht(n).outerHeight(!0);d<l?(o.push(n),s.push(d),a.push(ht(n).height())):u+=d}),n&&(e-=u,r=Math.floor(e/o.length),i=Math.floor(e-r*(o.length-1))),ht(o).each(function(t,e){var n=t===o.length-1?i:r,l=s[t],u=a[t],d=n-(l-u);l<n&&ht(e).height(d)})}function l(t){t.height("")}function u(t){var e=0;return t.find("> *").each(function(t,n){var r=ht(n).outerWidth();r>e&&(e=r)}),e++,t.width(e),e}function d(t,e){var n,r=t.add(e);return r.css({position:"relative",left:-1}),n=t.outerHeight()-e.outerHeight(),r.css({position:"",left:""}),n}function c(t){var e=t.css("position"),n=t.parents().filter(function(){var t=ht(this);return/(auto|scroll)/.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==e&&n.length?n:ht(t[0].ownerDocument||document)}function p(t,e){var n=t.offset(),r=n.left-(e?e.left:0),i=n.top-(e?e.top:0);return{left:r,right:r+t.outerWidth(),top:i,bottom:i+t.outerHeight()}}function h(t,e){var n=t.offset(),r=g(t),i=n.left+b(t,"border-left-width")+r.left-(e?e.left:0),o=n.top+b(t,"border-top-width")+r.top-(e?e.top:0);return{left:i,right:i+t[0].clientWidth,top:o,bottom:o+t[0].clientHeight}}function f(t,e){var n=t.offset(),r=n.left+b(t,"border-left-width")+b(t,"padding-left")-(e?e.left:0),i=n.top+b(t,"border-top-width")+b(t,"padding-top")-(e?e.top:0);return{left:r,right:r+t.width(),top:i,bottom:i+t.height()}}function g(t){var e,n=t[0].offsetWidth-t[0].clientWidth,r=t[0].offsetHeight-t[0].clientHeight;return n=v(n),r=v(r),e={left:0,right:0,top:0,bottom:r},y()&&"rtl"===t.css("direction")?e.left=n:e.right=n,e}function v(t){return t=Math.max(0,t),t=Math.round(t)}function y(){return null===ft&&(ft=m()),ft}function m(){var t=ht("<div><div/></div>").css({position:"absolute",top:-1e3,left:0,border:0,padding:0,overflow:"scroll",direction:"rtl"}).appendTo("body"),e=t.children(),n=e.offset().left>t.offset().left;return t.remove(),n}function b(t,e){return parseFloat(t.css(e))||0}function w(t){return 1===t.which&&!t.ctrlKey}function D(t){var e=t.originalEvent.touches;return e&&e.length?e[0].pageX:t.pageX}function E(t){var e=t.originalEvent.touches;return e&&e.length?e[0].pageY:t.pageY}function S(t){return/^touch/.test(t.type)}function C(t){t.addClass("fc-unselectable").on("selectstart",T)}function R(t){t.removeClass("fc-unselectable").off("selectstart",T)}function T(t){t.preventDefault()}function M(t,e){var n={left:Math.max(t.left,e.left),right:Math.min(t.right,e.right),top:Math.max(t.top,e.top),bottom:Math.min(t.bottom,e.bottom)};return n.left<n.right&&n.top<n.bottom&&n}function I(t,e){return{left:Math.min(Math.max(t.left,e.left),e.right),top:Math.min(Math.max(t.top,e.top),e.bottom)}}function H(t){return{left:(t.left+t.right)/2,top:(t.top+t.bottom)/2}}function P(t,e){return{left:t.left-e.left,top:t.top-e.top}}function _(t){var e,n,r=[],i=[];for("string"==typeof t?i=t.split(/\s*,\s*/):"function"==typeof t?i=[t]:ht.isArray(t)&&(i=t),e=0;e<i.length;e++)n=i[e],"string"==typeof n?r.push("-"===n.charAt(0)?{field:n.substring(1),order:-1}:{field:n,order:1}):"function"==typeof n&&r.push({func:n});return r}function x(t,e,n,r,i){var o,s;for(o=0;o<n.length;o++)if(s=O(t,e,n[o],r,i))return s;return 0}function O(t,e,n,r,i){if(n.func)return n.func(t,e);var o=t[n.field],s=e[n.field];return null==o&&r&&(o=r[n.field]),null==s&&i&&(s=i[n.field]),F(o,s)*(n.order||1)}function F(t,e){return t||e?null==e?-1:null==t?1:"string"===ht.type(t)||"string"===ht.type(e)?String(t).localeCompare(String(e)):t-e:0}function z(t,e){return pt.duration({days:t.clone().stripTime().diff(e.clone().stripTime(),"days"),ms:t.time()-e.time()})}function B(t,e){return pt.duration({days:t.clone().stripTime().diff(e.clone().stripTime(),"days")})}function A(t,e,n){return pt.duration(Math.round(t.diff(e,n,!0)),n)}function k(t,n){var r,i,o;for(r=0;r<e.unitsDesc.length&&(i=e.unitsDesc[r],!((o=V(i,t,n))>=1&&ut(o)));r++);return i}function L(t,e){var n=k(t);return"week"===n&&"object"==typeof e&&e.days&&(n="day"),n}function V(t,e,n){return null!=n?n.diff(e,t,!0):pt.isDuration(e)?e.as(t):e.end.diff(e.start,t,!0)}function G(t,e,n){var r;return U(n)?(e-t)/n:(r=n.asMonths(),Math.abs(r)>=1&&ut(r)?e.diff(t,"months",!0)/r:e.diff(t,"days",!0)/n.asDays())}function N(t,e){var n,r;return U(t)||U(e)?t/e:(n=t.asMonths(),r=e.asMonths(),Math.abs(n)>=1&&ut(n)&&Math.abs(r)>=1&&ut(r)?n/r:t.asDays()/e.asDays())}function j(t,e){var n;return U(t)?pt.duration(t*e):(n=t.asMonths(),Math.abs(n)>=1&&ut(n)?pt.duration({months:n*e}):pt.duration({days:t.asDays()*e}))}function U(t){return Boolean(t.hours()||t.minutes()||t.seconds()||t.milliseconds())}function W(t){return"[object Date]"===Object.prototype.toString.call(t)||t instanceof Date}function q(t){return"string"==typeof t&&/^\d+\:\d+(?:\:\d+\.?(?:\d{3})?)?$/.test(t)}function Y(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=window.console;if(n&&n.log)return n.log.apply(n,t)}function Z(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=window.console;return n&&n.warn?n.warn.apply(n,t):Y.apply(null,t)}function X(t,e){var n,r,i,o,s,a,l={};if(e)for(n=0;n<e.length;n++){for(r=e[n],i=[],o=t.length-1;o>=0;o--)if("object"==typeof(s=t[o][r]))i.unshift(s);else if(void 0!==s){l[r]=s;break}i.length&&(l[r]=X(i))}for(n=t.length-1;n>=0;n--){a=t[n];for(r in a)r in l||(l[r]=a[r])}return l}function Q(t,e){for(var n in t)$(t,n)&&(e[n]=t[n])}function $(t,e){return gt.call(t,e)}function K(t,e,n){if(ht.isFunction(t)&&(t=[t]),t){var r=void 0,i=void 0;for(r=0;r<t.length;r++)i=t[r].apply(e,n)||i;return i}}function J(t,e){for(var n=0,r=0;r<t.length;)e(t[r])?(t.splice(r,1),n++):r++;return n}function tt(t,e){for(var n=0,r=0;r<t.length;)t[r]===e?(t.splice(r,1),n++):r++;return n}function et(t,e){var n,r=t.length;if(null==r||r!==e.length)return!1;for(n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function nt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;n++)if(void 0!==t[n])return t[n]}function rt(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function it(t){return t.replace(/&.*?;/g,"")}function ot(t){var e=[];return ht.each(t,function(t,n){null!=n&&e.push(t+":"+n)}),e.join(";")}function st(t){var e=[];return ht.each(t,function(t,n){null!=n&&e.push(t+'="'+rt(n)+'"')}),e.join(" ")}function at(t){return t.charAt(0).toUpperCase()+t.slice(1)}function lt(t,e){return t-e}function ut(t){return t%1==0}function dt(t,e){var n=t[e];return function(){return n.apply(t,arguments)}}function ct(t,e,n){void 0===n&&(n=!1);var r,i,o,s,a,l=function(){var u=+new Date-s;u<e?r=setTimeout(l,e-u):(r=null,n||(a=t.apply(o,i),o=i=null))};return function(){o=this,i=arguments,s=+new Date;var u=n&&!r;return r||(r=setTimeout(l,e)),u&&(a=t.apply(o,i),o=i=null),a}}Object.defineProperty(e,"__esModule",{value:!0});var pt=n(0),ht=n(3);e.compensateScroll=r,e.uncompensateScroll=i,e.disableCursor=o,e.enableCursor=s,e.distributeHeight=a,e.undistributeHeight=l,e.matchCellWidths=u,e.subtractInnerElHeight=d,e.getScrollParent=c,e.getOuterRect=p,e.getClientRect=h,e.getContentRect=f,e.getScrollbarWidths=g;var ft=null;e.isPrimaryMouseButton=w,e.getEvX=D,e.getEvY=E,e.getEvIsTouch=S,e.preventSelection=C,e.allowSelection=R,e.preventDefault=T,e.intersectRects=M,e.constrainPoint=I,e.getRectCenter=H,e.diffPoints=P,e.parseFieldSpecs=_,e.compareByFieldSpecs=x,e.compareByFieldSpec=O,e.flexibleCompare=F,e.dayIDs=["sun","mon","tue","wed","thu","fri","sat"],e.unitsDesc=["year","month","week","day","hour","minute","second","millisecond"],e.diffDayTime=z,e.diffDay=B,e.diffByUnit=A,e.computeGreatestUnit=k,e.computeDurationGreatestUnit=L,e.divideRangeByDuration=G,e.divideDurationByDuration=N,e.multiplyDuration=j,e.durationHasTime=U,e.isNativeDate=W,e.isTimeString=q,e.log=Y,e.warn=Z;var gt={}.hasOwnProperty;e.mergeProps=X,e.copyOwnProps=Q,e.hasOwnProp=$,e.applyAll=K,e.removeMatching=J,e.removeExact=tt,e.isArraysEqual=et,e.firstDefined=nt,e.htmlEscape=rt,e.stripHtmlEntities=it,e.cssToStr=ot,e.attrsToStr=st,e.capitaliseFirstLetter=at,e.compareNumbers=lt,e.isInt=ut,e.proxy=dt,e.debounce=ct},function(t,e,n){function r(t,e){return t.startMs-e.startMs}Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(11),s=function(){function t(t,e){this.isStart=!0,this.isEnd=!0,i.isMoment(t)&&(t=t.clone().stripZone()),i.isMoment(e)&&(e=e.clone().stripZone()),t&&(this.startMs=t.valueOf()),e&&(this.endMs=e.valueOf())}return t.invertRanges=function(e,n){var i,o,s=[],a=n.startMs;for(e.sort(r),i=0;i<e.length;i++)o=e[i],o.startMs>a&&s.push(new t(a,o.startMs)),o.endMs>a&&(a=o.endMs);return a<n.endMs&&s.push(new t(a,n.endMs)),s},t.prototype.intersect=function(e){var n=this.startMs,r=this.endMs,i=null;return null!=e.startMs&&(n=null==n?e.startMs:Math.max(n,e.startMs)),null!=e.endMs&&(r=null==r?e.endMs:Math.min(r,e.endMs)),(null==n||null==r||n<r)&&(i=new t(n,r),i.isStart=this.isStart&&n===this.startMs,i.isEnd=this.isEnd&&r===this.endMs),i},t.prototype.intersectsWith=function(t){return(null==this.endMs||null==t.startMs||this.endMs>t.startMs)&&(null==this.startMs||null==t.endMs||this.startMs<t.endMs)},t.prototype.containsRange=function(t){return(null==this.startMs||null!=t.startMs&&t.startMs>=this.startMs)&&(null==this.endMs||null!=t.endMs&&t.endMs<=this.endMs)},t.prototype.containsDate=function(t){var e=t.valueOf();return(null==this.startMs||e>=this.startMs)&&(null==this.endMs||e<this.endMs)},t.prototype.constrainDate=function(t){var e=t.valueOf();return null!=this.startMs&&e<this.startMs&&(e=this.startMs),null!=this.endMs&&e>=this.endMs&&(e=this.endMs-1),e},t.prototype.equals=function(t){return this.startMs===t.startMs&&this.endMs===t.endMs},t.prototype.clone=function(){var e=new t(this.startMs,this.endMs);return e.isStart=this.isStart,e.isEnd=this.isEnd,e},t.prototype.getStart=function(){return null!=this.startMs?o.default.utc(this.startMs).stripZone():null},t.prototype.getEnd=function(){return null!=this.endMs?o.default.utc(this.endMs).stripZone():null},t.prototype.as=function(t){return i.utc(this.endMs).diff(i.utc(this.startMs),t,!0)},t}();e.default=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(52),s=n(35),a=n(36),l=function(t){function e(n){var r=t.call(this)||this;return r.calendar=n,r.className=[],r.uid=String(e.uuid++),r}return r.__extends(e,t),e.parse=function(t,e){var n=new this(e);return!("object"!=typeof t||!n.applyProps(t))&&n},e.normalizeId=function(t){return t?String(t):null},e.prototype.fetch=function(t,e,n){},e.prototype.removeEventDefsById=function(t){},e.prototype.removeAllEventDefs=function(){},e.prototype.getPrimitive=function(t){},e.prototype.parseEventDefs=function(t){var e,n,r=[];for(e=0;e<t.length;e++)(n=this.parseEventDef(t[e]))&&r.push(n);return r},e.prototype.parseEventDef=function(t){var e=this.calendar.opt("eventDataTransform"),n=this.eventDataTransform;return e&&(t=e(t,this.calendar)),n&&(t=n(t,this.calendar)),a.default.parse(t,this)},e.prototype.applyManualStandardProps=function(t){return null!=t.id&&(this.id=e.normalizeId(t.id)),i.isArray(t.className)?this.className=t.className:"string"==typeof t.className&&(this.className=t.className.split(/\s+/)),!0},e.uuid=0,e.defineStandardProps=o.default.defineStandardProps,e.copyVerbatimStandardProps=o.default.copyVerbatimStandardProps,e}(s.default);e.default=l,o.default.mixInto(l),l.defineStandardProps({id:!1,className:!1,color:!0,backgroundColor:!0,borderColor:!0,textColor:!0,editable:!0,startEditable:!0,durationEditable:!0,rendering:!0,overlap:!0,constraint:!0,allDayDefault:!0,eventDataTransform:!0})},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(15),s=0,a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.listenTo=function(t,e,n){if("object"==typeof e)for(var r in e)e.hasOwnProperty(r)&&this.listenTo(t,r,e[r]);else"string"==typeof e&&t.on(e+"."+this.getListenerNamespace(),i.proxy(n,this))},e.prototype.stopListeningTo=function(t,e){t.off((e||"")+"."+this.getListenerNamespace())},e.prototype.getListenerNamespace=function(){return null==this.listenerId&&(this.listenerId=s++),"_listener"+this.listenerId},e}(o.default);e.default=a},,function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(37),o=n(53),s=n(16),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.buildInstances=function(){return[this.buildInstance()]},e.prototype.buildInstance=function(){return new o.default(this,this.dateProfile)},e.prototype.isAllDay=function(){return this.dateProfile.isAllDay()},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e.dateProfile=this.dateProfile,e},e.prototype.rezone=function(){var t=this.source.calendar,e=this.dateProfile;this.dateProfile=new s.default(t.moment(e.start),e.end?t.moment(e.end):null,t)},e.prototype.applyManualStandardProps=function(e){var n=t.prototype.applyManualStandardProps.call(this,e),r=s.default.parse(e,this.source);return!!r&&(this.dateProfile=r,null!=e.date&&(this.miscProps.date=e.date),n)},e}(i.default);e.default=a,a.defineStandardProps({start:!1,date:!1,end:!1,allDay:!1})},,function(t,e,n){function r(t,e){return c.format.call(t,e)}function i(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var r,i,d,c,p=t[0],h=1===t.length&&"string"==typeof p;return o.isMoment(p)||a.isNativeDate(p)||void 0===p?c=o.apply(null,t):(r=!1,i=!1,h?l.test(p)?(p+="-01",t=[p],r=!0,i=!0):(d=u.exec(p))&&(r=!d[5],i=!0):s.isArray(p)&&(i=!0),c=e||r?o.utc.apply(o,t):o.apply(null,t),r?(c._ambigTime=!0,c._ambigZone=!0):n&&(i?c._ambigZone=!0:h&&c.utcOffset(p))),c._fullCalendar=!0,c}Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),s=n(3),a=n(4),l=/^\s*\d{4}-\d\d$/,u=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?)?$/,d=o.fn;e.newMomentProto=d;var c=s.extend({},d);e.oldMomentProto=c;var p=o.momentProperties;p.push("_fullCalendar"),p.push("_ambigTime"),p.push("_ambigZone"),e.oldMomentFormat=r;var h=function(){return i(arguments)};e.default=h,h.utc=function(){var t=i(arguments,!0);return t.hasTime()&&t.utc(),t},h.parseZone=function(){return i(arguments,!0,!0)},d.week=d.weeks=function(t){var e=this._locale._fullCalendar_weekCalc;return null==t&&"function"==typeof e?e(this):"ISO"===e?c.isoWeek.apply(this,arguments):c.week.apply(this,arguments)},d.time=function(t){if(!this._fullCalendar)return c.time.apply(this,arguments);if(null==t)return o.duration({hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()});this._ambigTime=!1,o.isDuration(t)||o.isMoment(t)||(t=o.duration(t));var e=0;return o.isDuration(t)&&(e=24*Math.floor(t.asDays())),this.hours(e+t.hours()).minutes(t.minutes()).seconds(t.seconds()).milliseconds(t.milliseconds())},d.stripTime=function(){return this._ambigTime||(this.utc(!0),this.set({hours:0,minutes:0,seconds:0,ms:0}),this._ambigTime=!0,this._ambigZone=!0),this},d.hasTime=function(){return!this._ambigTime},d.stripZone=function(){var t;return this._ambigZone||(t=this._ambigTime,this.utc(!0),this._ambigTime=t||!1,this._ambigZone=!0),this},d.hasZone=function(){return!this._ambigZone},d.local=function(t){return c.local.call(this,this._ambigZone||t),this._ambigTime=!1,this._ambigZone=!1,this},d.utc=function(t){return c.utc.call(this,t),this._ambigTime=!1,this._ambigZone=!1,this},d.utcOffset=function(t){return null!=t&&(this._ambigTime=!1,this._ambigZone=!1),c.utcOffset.apply(this,arguments)}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.isAllDay=!1,this.unzonedRange=t,this.isAllDay=e}return t.prototype.toLegacy=function(t){return{start:t.msToMoment(this.unzonedRange.startMs,this.isAllDay),end:t.msToMoment(this.unzonedRange.endMs,this.isAllDay)}},t}();e.default=n},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(15),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.on=function(t,e){return i(this).on(t,this._prepareIntercept(e)),this},e.prototype.one=function(t,e){return i(this).one(t,this._prepareIntercept(e)),this},e.prototype._prepareIntercept=function(t){var e=function(e,n){return t.apply(n.context||this,n.args||[])};return t.guid||(t.guid=i.guid++),e.guid=t.guid,e},e.prototype.off=function(t,e){return i(this).off(t,e),this},e.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return i(this).triggerHandler(t,{args:e}),this},e.prototype.triggerWith=function(t,e,n){return i(this).triggerHandler(t,{context:e,args:n}),this},e.prototype.hasHandlers=function(t){var e=i._data(this,"events");return e&&e[t]&&e[t].length>0},e}(o.default);e.default=s},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.view=t._getView(),this.component=t}return t.prototype.opt=function(t){return this.view.opt(t)},t.prototype.end=function(){},t}();e.default=n},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.mixInto=function(t){var e=this;Object.getOwnPropertyNames(this.prototype).forEach(function(n){t.prototype[n]||(t.prototype[n]=e.prototype[n])})},t.mixOver=function(t){var e=this;Object.getOwnPropertyNames(this.prototype).forEach(function(n){t.prototype[n]=e.prototype[n]})},t}();e.default=n},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),i=function(){function t(t,e,n){this.start=t,this.end=e||null,this.unzonedRange=this.buildUnzonedRange(n)}return t.parse=function(e,n){var r=e.start||e.date,i=e.end;if(!r)return!1;var o=n.calendar,s=o.moment(r),a=i?o.moment(i):null,l=e.allDay,u=o.opt("forceEventDuration");return!!s.isValid()&&(null==l&&null==(l=n.allDayDefault)&&(l=o.opt("allDayDefault")),!0===l?(s.stripTime(),a&&a.stripTime()):!1===l&&(s.hasTime()||s.time(0),a&&!a.hasTime()&&a.time(0)),!a||a.isValid()&&a.isAfter(s)||(a=null),!a&&u&&(a=o.getDefaultEventEnd(!s.hasTime(),s)),new t(s,a,o))},t.isStandardProp=function(t){return"start"===t||"date"===t||"end"===t||"allDay"===t},t.prototype.isAllDay=function(){return!(this.start.hasTime()||this.end&&this.end.hasTime())},t.prototype.buildUnzonedRange=function(t){var e=this.start.clone().stripZone().valueOf(),n=this.getEnd(t).stripZone().valueOf();return new r.default(e,n)},t.prototype.getEnd=function(t){return this.end?this.end.clone():t.getDefaultEventEnd(this.isAllDay(),this.start)},t}();e.default=i},function(t,e,n){function r(t,e){return!t&&!e||!(!t||!e)&&(t.component===e.component&&i(t,e)&&i(e,t))}function i(t,e){for(var n in t)if(!/^(component|left|right|top|bottom)$/.test(n)&&t[n]!==e[n])return!1;return!0}Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),s=n(4),a=n(59),l=function(t){function e(e,n){var r=t.call(this,n)||this;return r.component=e,r}return o.__extends(e,t),e.prototype.handleInteractionStart=function(e){var n,r,i,o=this.subjectEl;this.component.hitsNeeded(),this.computeScrollBounds(),e?(r={left:s.getEvX(e),top:s.getEvY(e)},i=r,o&&(n=s.getOuterRect(o),i=s.constrainPoint(i,n)),this.origHit=this.queryHit(i.left,i.top),o&&this.options.subjectCenter&&(this.origHit&&(n=s.intersectRects(this.origHit,n)||n),i=s.getRectCenter(n)),this.coordAdjust=s.diffPoints(i,r)):(this.origHit=null,this.coordAdjust=null),t.prototype.handleInteractionStart.call(this,e)},e.prototype.handleDragStart=function(e){var n;t.prototype.handleDragStart.call(this,e),(n=this.queryHit(s.getEvX(e),s.getEvY(e)))&&this.handleHitOver(n)},e.prototype.handleDrag=function(e,n,i){var o;t.prototype.handleDrag.call(this,e,n,i),o=this.queryHit(s.getEvX(i),s.getEvY(i)),r(o,this.hit)||(this.hit&&this.handleHitOut(),o&&this.handleHitOver(o))},e.prototype.handleDragEnd=function(e){this.handleHitDone(),t.prototype.handleDragEnd.call(this,e)},e.prototype.handleHitOver=function(t){var e=r(t,this.origHit);this.hit=t,this.trigger("hitOver",this.hit,e,this.origHit)},e.prototype.handleHitOut=function(){this.hit&&(this.trigger("hitOut",this.hit),this.handleHitDone(),this.hit=null)},e.prototype.handleHitDone=function(){this.hit&&this.trigger("hitDone",this.hit)},e.prototype.handleInteractionEnd=function(e,n){t.prototype.handleInteractionEnd.call(this,e,n),this.origHit=null,this.hit=null,this.component.hitsNotNeeded()},e.prototype.handleScrollEnd=function(){t.prototype.handleScrollEnd.call(this),this.isDragging&&(this.component.releaseHits(),this.component.prepareHits())},e.prototype.queryHit=function(t,e){return this.coordAdjust&&(t+=this.coordAdjust.left,e+=this.coordAdjust.top),this.component.queryHit(t,e)},e}(a.default);e.default=l},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.version="3.10.0",e.internalApiVersion=12;var r=n(4);e.applyAll=r.applyAll,e.debounce=r.debounce,e.isInt=r.isInt,e.htmlEscape=r.htmlEscape,e.cssToStr=r.cssToStr,e.proxy=r.proxy,e.capitaliseFirstLetter=r.capitaliseFirstLetter,e.getOuterRect=r.getOuterRect,e.getClientRect=r.getClientRect,e.getContentRect=r.getContentRect,e.getScrollbarWidths=r.getScrollbarWidths,e.preventDefault=r.preventDefault,e.parseFieldSpecs=r.parseFieldSpecs,e.compareByFieldSpecs=r.compareByFieldSpecs,e.compareByFieldSpec=r.compareByFieldSpec,e.flexibleCompare=r.flexibleCompare,e.computeGreatestUnit=r.computeGreatestUnit,e.divideRangeByDuration=r.divideRangeByDuration,e.divideDurationByDuration=r.divideDurationByDuration,e.multiplyDuration=r.multiplyDuration,e.durationHasTime=r.durationHasTime,e.log=r.log,e.warn=r.warn,e.removeExact=r.removeExact,e.intersectRects=r.intersectRects,e.allowSelection=r.allowSelection,e.attrsToStr=r.attrsToStr,e.compareNumbers=r.compareNumbers,e.compensateScroll=r.compensateScroll,e.computeDurationGreatestUnit=r.computeDurationGreatestUnit,e.constrainPoint=r.constrainPoint,e.copyOwnProps=r.copyOwnProps,e.diffByUnit=r.diffByUnit,e.diffDay=r.diffDay,e.diffDayTime=r.diffDayTime,e.diffPoints=r.diffPoints,e.disableCursor=r.disableCursor,e.distributeHeight=r.distributeHeight,e.enableCursor=r.enableCursor,e.firstDefined=r.firstDefined,e.getEvIsTouch=r.getEvIsTouch,e.getEvX=r.getEvX,e.getEvY=r.getEvY,e.getRectCenter=r.getRectCenter,e.getScrollParent=r.getScrollParent,e.hasOwnProp=r.hasOwnProp,e.isArraysEqual=r.isArraysEqual,e.isNativeDate=r.isNativeDate,e.isPrimaryMouseButton=r.isPrimaryMouseButton,e.isTimeString=r.isTimeString,e.matchCellWidths=r.matchCellWidths,e.mergeProps=r.mergeProps,e.preventSelection=r.preventSelection,e.removeMatching=r.removeMatching,e.stripHtmlEntities=r.stripHtmlEntities,e.subtractInnerElHeight=r.subtractInnerElHeight,e.uncompensateScroll=r.uncompensateScroll,e.undistributeHeight=r.undistributeHeight,e.dayIDs=r.dayIDs,e.unitsDesc=r.unitsDesc;var i=n(49);e.formatDate=i.formatDate,e.formatRange=i.formatRange,e.queryMostGranularFormatUnit=i.queryMostGranularFormatUnit;var o=n(32);e.datepickerLocale=o.datepickerLocale,e.locale=o.locale,e.getMomentLocaleData=o.getMomentLocaleData,e.populateInstanceComputableOptions=o.populateInstanceComputableOptions;var s=n(19);e.eventDefsToEventInstances=s.eventDefsToEventInstances,e.eventFootprintToComponentFootprint=s.eventFootprintToComponentFootprint,e.eventInstanceToEventRange=s.eventInstanceToEventRange,e.eventInstanceToUnzonedRange=s.eventInstanceToUnzonedRange,e.eventRangeToEventFootprint=s.eventRangeToEventFootprint;var a=n(11);e.moment=a.default;var l=n(13);e.EmitterMixin=l.default;var u=n(7);e.ListenerMixin=u.default;var d=n(51);e.Model=d.default;var c=n(217);e.Constraints=c.default;var p=n(55);e.DateProfileGenerator=p.default;var h=n(5);e.UnzonedRange=h.default;var f=n(12);e.ComponentFootprint=f.default;var g=n(218);e.BusinessHourGenerator=g.default;var v=n(219);e.EventPeriod=v.default;var y=n(220);e.EventManager=y.default;var m=n(37);e.EventDef=m.default;var b=n(39);e.EventDefMutation=b.default;var w=n(36);e.EventDefParser=w.default;var D=n(53);e.EventInstance=D.default;var E=n(50);e.EventRange=E.default;var S=n(54);e.RecurringEventDef=S.default;var C=n(9);e.SingleEventDef=C.default;var R=n(40);e.EventDefDateMutation=R.default;var T=n(16);e.EventDateProfile=T.default;var M=n(38);e.EventSourceParser=M.default;var I=n(6);e.EventSource=I.default;var H=n(57);e.defineThemeSystem=H.defineThemeSystem,e.getThemeSystemClass=H.getThemeSystemClass;var P=n(20);e.EventInstanceGroup=P.default;var _=n(56);e.ArrayEventSource=_.default;var x=n(223);e.FuncEventSource=x.default;var O=n(224);e.JsonFeedEventSource=O.default;var F=n(34);e.EventFootprint=F.default;var z=n(35);e.Class=z.default;var B=n(15);e.Mixin=B.default;var A=n(58);e.CoordCache=A.default;var k=n(225);e.Iterator=k.default;var L=n(59);e.DragListener=L.default;var V=n(17);e.HitDragListener=V.default;var G=n(226);e.MouseFollower=G.default;var N=n(52);e.ParsableModelMixin=N.default;var j=n(227);e.Popover=j.default;var U=n(21);e.Promise=U.default;var W=n(228);e.TaskQueue=W.default;var q=n(229);e.RenderQueue=q.default;var Y=n(41);e.Scroller=Y.default;var Z=n(22);e.Theme=Z.default;var X=n(230);e.Component=X.default;var Q=n(231);e.DateComponent=Q.default;var $=n(42);e.InteractiveDateComponent=$.default;var K=n(232);e.Calendar=K.default;var J=n(43);e.View=J.default;var tt=n(24);e.defineView=tt.defineView,e.getViewConfig=tt.getViewConfig;var et=n(60);e.DayTableMixin=et.default;var nt=n(61);e.BusinessHourRenderer=nt.default;var rt=n(44);e.EventRenderer=rt.default;var it=n(62);e.FillRenderer=it.default;var ot=n(63);e.HelperRenderer=ot.default;var st=n(233);e.ExternalDropping=st.default;var at=n(234);e.EventResizing=at.default;var lt=n(64);e.EventPointing=lt.default;var ut=n(235);e.EventDragging=ut.default;var dt=n(236);e.DateSelecting=dt.default;var ct=n(237);e.DateClicking=ct.default;var pt=n(14);e.Interaction=pt.default;var ht=n(65);e.StandardInteractionsMixin=ht.default;var ft=n(238);e.AgendaView=ft.default;var gt=n(239);e.TimeGrid=gt.default;var vt=n(240);e.TimeGridEventRenderer=vt.default;var yt=n(242);e.TimeGridFillRenderer=yt.default;var mt=n(241);e.TimeGridHelperRenderer=mt.default;var bt=n(66);e.DayGrid=bt.default;var wt=n(243);e.DayGridEventRenderer=wt.default;var Dt=n(245);e.DayGridFillRenderer=Dt.default;var Et=n(244);e.DayGridHelperRenderer=Et.default;var St=n(67);e.BasicView=St.default;var Ct=n(68);e.BasicViewDateProfileGenerator=Ct.default;var Rt=n(246);e.MonthView=Rt.default;var Tt=n(247);e.MonthViewDateProfileGenerator=Tt.default;var Mt=n(248);e.ListView=Mt.default;var It=n(250);e.ListEventPointing=It.default;var Ht=n(249);e.ListEventRenderer=Ht.default},function(t,e,n){function r(t,e){var n,r=[];for(n=0;n<t.length;n++)r.push.apply(r,t[n].buildInstances(e));return r}function i(t){return new l.default(t.dateProfile.unzonedRange,t.def,t)}function o(t){return new u.default(new d.default(t.unzonedRange,t.eventDef.isAllDay()),t.eventDef,t.eventInstance)}function s(t){return t.dateProfile.unzonedRange}function a(t){return t.componentFootprint}Object.defineProperty(e,"__esModule",{value:!0});var l=n(50),u=n(34),d=n(12);e.eventDefsToEventInstances=r,e.eventInstanceToEventRange=i,e.eventRangeToEventFootprint=o,e.eventInstanceToUnzonedRange=s,e.eventFootprintToComponentFootprint=a},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),i=n(19),o=n(50),s=function(){function t(t){this.eventInstances=t||[]}return t.prototype.getAllEventRanges=function(t){return t?this.sliceNormalRenderRanges(t):this.eventInstances.map(i.eventInstanceToEventRange)},t.prototype.sliceRenderRanges=function(t){return this.isInverse()?this.sliceInverseRenderRanges(t):this.sliceNormalRenderRanges(t)},t.prototype.sliceNormalRenderRanges=function(t){var e,n,r,i=this.eventInstances,s=[];for(e=0;e<i.length;e++)n=i[e],(r=n.dateProfile.unzonedRange.intersect(t))&&s.push(new o.default(r,n.def,n));return s},t.prototype.sliceInverseRenderRanges=function(t){var e=this.eventInstances.map(i.eventInstanceToUnzonedRange),n=this.getEventDef();return e=r.default.invertRanges(e,t),e.map(function(t){return new o.default(t,n)})},t.prototype.isInverse=function(){return this.getEventDef().hasInverseRendering()},t.prototype.getEventDef=function(){return this.explicitEventDef||this.eventInstances[0].def},t}();e.default=s},function(t,e,n){function r(t,e){t.then=function(n){return"function"==typeof n?s.resolve(n(e)):t}}function i(t){t.then=function(e,n){return"function"==typeof n&&n(),t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),s={construct:function(t){var e=o.Deferred(),n=e.promise();return"function"==typeof t&&t(function(t){e.resolve(t),r(n,t)},function(){e.reject(),i(n)}),n},resolve:function(t){var e=o.Deferred().resolve(t),n=e.promise();return r(n,t),n},reject:function(){var t=o.Deferred().reject(),e=t.promise();return i(e),e}};e.default=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=function(){function t(t){this.optionsManager=t,this.processIconOverride()}return t.prototype.processIconOverride=function(){this.iconOverrideOption&&this.setIconOverride(this.optionsManager.get(this.iconOverrideOption))},t.prototype.setIconOverride=function(t){var e,n;if(r.isPlainObject(t)){e=r.extend({},this.iconClasses);for(n in t)e[n]=this.applyIconOverridePrefix(t[n]);this.iconClasses=e}else!1===t&&(this.iconClasses={})},t.prototype.applyIconOverridePrefix=function(t){var e=this.iconOverridePrefix;return e&&0!==t.indexOf(e)&&(t=e+t),t},t.prototype.getClass=function(t){return this.classes[t]||""},t.prototype.getIconClass=function(t){var e=this.iconClasses[t];return e?this.baseIconClass+" "+e:""},t.prototype.getCustomButtonIconClass=function(t){var e;return this.iconOverrideCustomButtonOption&&(e=t[this.iconOverrideCustomButtonOption])?this.baseIconClass+" "+this.applyIconOverridePrefix(e):""},t}();e.default=i,i.prototype.classes={},i.prototype.iconClasses={},i.prototype.baseIconClass="",i.prototype.iconOverridePrefix=""},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(18),o=n(13),s=n(7);i.touchMouseIgnoreWait=500;var a=null,l=0,u=function(){function t(){this.isTouching=!1,this.mouseIgnoreDepth=0}return t.get=function(){return a||(a=new t,a.bind()),a},t.needed=function(){t.get(),l++},t.unneeded=function(){--l||(a.unbind(),a=null)},t.prototype.bind=function(){var t=this;this.listenTo(r(document),{touchstart:this.handleTouchStart,
touchcancel:this.handleTouchCancel,touchend:this.handleTouchEnd,mousedown:this.handleMouseDown,mousemove:this.handleMouseMove,mouseup:this.handleMouseUp,click:this.handleClick,selectstart:this.handleSelectStart,contextmenu:this.handleContextMenu}),window.addEventListener("touchmove",this.handleTouchMoveProxy=function(e){t.handleTouchMove(r.Event(e))},{passive:!1}),window.addEventListener("scroll",this.handleScrollProxy=function(e){t.handleScroll(r.Event(e))},!0)},t.prototype.unbind=function(){this.stopListeningTo(r(document)),window.removeEventListener("touchmove",this.handleTouchMoveProxy,{passive:!1}),window.removeEventListener("scroll",this.handleScrollProxy,!0)},t.prototype.handleTouchStart=function(t){this.stopTouch(t,!0),this.isTouching=!0,this.trigger("touchstart",t)},t.prototype.handleTouchMove=function(t){this.isTouching&&this.trigger("touchmove",t)},t.prototype.handleTouchCancel=function(t){this.isTouching&&(this.trigger("touchcancel",t),this.stopTouch(t))},t.prototype.handleTouchEnd=function(t){this.stopTouch(t)},t.prototype.handleMouseDown=function(t){this.shouldIgnoreMouse()||this.trigger("mousedown",t)},t.prototype.handleMouseMove=function(t){this.shouldIgnoreMouse()||this.trigger("mousemove",t)},t.prototype.handleMouseUp=function(t){this.shouldIgnoreMouse()||this.trigger("mouseup",t)},t.prototype.handleClick=function(t){this.shouldIgnoreMouse()||this.trigger("click",t)},t.prototype.handleSelectStart=function(t){this.trigger("selectstart",t)},t.prototype.handleContextMenu=function(t){this.trigger("contextmenu",t)},t.prototype.handleScroll=function(t){this.trigger("scroll",t)},t.prototype.stopTouch=function(t,e){void 0===e&&(e=!1),this.isTouching&&(this.isTouching=!1,this.trigger("touchend",t),e||this.startTouchMouseIgnore())},t.prototype.startTouchMouseIgnore=function(){var t=this,e=i.touchMouseIgnoreWait;e&&(this.mouseIgnoreDepth++,setTimeout(function(){t.mouseIgnoreDepth--},e))},t.prototype.shouldIgnoreMouse=function(){return this.isTouching||Boolean(this.mouseIgnoreDepth)},t}();e.default=u,s.default.mixInto(u),o.default.mixInto(u)},function(t,e,n){function r(t,n){e.viewHash[t]=n}function i(t){return e.viewHash[t]}Object.defineProperty(e,"__esModule",{value:!0});var o=n(18);e.viewHash={},o.views=e.viewHash,e.defineView=r,e.getViewConfig=i},,,,,,,,function(t,e,n){function r(t){a.each(f,function(e,n){null==t[e]&&(t[e]=n(t))})}function i(t,n,r){var i=e.localeOptionHash[t]||(e.localeOptionHash[t]={});i.isRTL=r.isRTL,i.weekNumberTitle=r.weekHeader,a.each(p,function(t,e){i[t]=e(r)});var o=a.datepicker;o&&(o.regional[n]=o.regional[t]=r,o.regional.en=o.regional[""],o.setDefaults(r))}function o(t,n){var r,i;r=e.localeOptionHash[t]||(e.localeOptionHash[t]={}),n&&(r=e.localeOptionHash[t]=d.mergeOptions([r,n])),i=s(t),a.each(h,function(t,e){null==r[t]&&(r[t]=e(i,r))}),d.globalDefaults.locale=t}function s(t){return l.localeData(t)||l.localeData("en")}Object.defineProperty(e,"__esModule",{value:!0});var a=n(3),l=n(0),u=n(18),d=n(33),c=n(4);e.localeOptionHash={},u.locales=e.localeOptionHash;var p={buttonText:function(t){return{prev:c.stripHtmlEntities(t.prevText),next:c.stripHtmlEntities(t.nextText),today:c.stripHtmlEntities(t.currentText)}},monthYearFormat:function(t){return t.showMonthAfterYear?"YYYY["+t.yearSuffix+"] MMMM":"MMMM YYYY["+t.yearSuffix+"]"}},h={dayOfMonthFormat:function(t,e){var n=t.longDateFormat("l");return n=n.replace(/^Y+[^\w\s]*|[^\w\s]*Y+$/g,""),e.isRTL?n+=" ddd":n="ddd "+n,n},mediumTimeFormat:function(t){return t.longDateFormat("LT").replace(/\s*a$/i,"a")},smallTimeFormat:function(t){return t.longDateFormat("LT").replace(":mm","(:mm)").replace(/(\Wmm)$/,"($1)").replace(/\s*a$/i,"a")},extraSmallTimeFormat:function(t){return t.longDateFormat("LT").replace(":mm","(:mm)").replace(/(\Wmm)$/,"($1)").replace(/\s*a$/i,"t")},hourFormat:function(t){return t.longDateFormat("LT").replace(":mm","").replace(/(\Wmm)$/,"").replace(/\s*a$/i,"a")},noMeridiemTimeFormat:function(t){return t.longDateFormat("LT").replace(/\s*a$/i,"")}},f={smallDayDateFormat:function(t){return t.isRTL?"D dd":"dd D"},weekFormat:function(t){return t.isRTL?"w[ "+t.weekNumberTitle+"]":"["+t.weekNumberTitle+" ]w"},smallWeekFormat:function(t){return t.isRTL?"w["+t.weekNumberTitle+"]":"["+t.weekNumberTitle+"]w"}};e.populateInstanceComputableOptions=r,e.datepickerLocale=i,e.locale=o,e.getMomentLocaleData=s,o("en",d.englishDefaults)},function(t,e,n){function r(t){return i.mergeProps(t,o)}Object.defineProperty(e,"__esModule",{value:!0});var i=n(4);e.globalDefaults={titleRangeSeparator:" â ",monthYearFormat:"MMMM YYYY",defaultTimedEventDuration:"02:00:00",defaultAllDayEventDuration:{days:1},forceEventDuration:!1,nextDayThreshold:"09:00:00",columnHeader:!0,defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberTitle:"W",weekNumberCalculation:"local",scrollTime:"06:00:00",minTime:"00:00:00",maxTime:"24:00:00",showNonCurrentDates:!0,lazyFetching:!0,startParam:"start",endParam:"end",timezoneParam:"timezone",timezone:!1,locale:null,isRTL:!1,buttonText:{prev:"prev",next:"next",prevYear:"prev year",nextYear:"next year",year:"year",today:"today",month:"month",week:"week",day:"day"},allDayText:"all-day",agendaEventMinHeight:0,theme:!1,dragOpacity:.75,dragRevertDuration:500,dragScroll:!0,unselectAuto:!0,dropAccept:"*",eventOrder:"title",eventLimit:!1,eventLimitText:"more",eventLimitClick:"popover",dayPopoverFormat:"LL",handleWindowResize:!0,windowResizeDelay:100,longPressDelay:1e3},e.englishDefaults={dayPopoverFormat:"dddd, MMMM D"},e.rtlDefaults={header:{left:"next,prev today",center:"",right:"title"},buttonIcons:{prev:"right-single-arrow",next:"left-single-arrow",prevYear:"right-double-arrow",nextYear:"left-double-arrow"},themeButtonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w",nextYear:"seek-prev",prevYear:"seek-next"}};var o=["header","footer","buttonText","buttonIcons","themeButtonIcons"];e.mergeOptions=r},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,n){this.componentFootprint=t,this.eventDef=e,n&&(this.eventInstance=n)}return t.prototype.getEventLegacy=function(){return(this.eventInstance||this.eventDef).toLegacy()},t}();e.default=n},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(4),o=function(){function t(){}return t.extend=function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(this);return i.copyOwnProps(t,e.prototype),e},t.mixin=function(t){i.copyOwnProps(t,this.prototype)},t}();e.default=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(4),o=n(9),s=n(54);e.default={parse:function(t,e){return i.isTimeString(t.start)||r.isDuration(t.start)||i.isTimeString(t.end)||r.isDuration(t.end)?s.default.parse(t,e):o.default.parse(t,e)}}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(52),o=function(){function t(t){this.source=t,this.className=[],this.miscProps={}}return t.parse=function(t,e){var n=new this(e);return!!n.applyProps(t)&&n},t.normalizeId=function(t){return String(t)},t.generateId=function(){return"_fc"+t.uuid++},t.prototype.clone=function(){var e=new this.constructor(this.source);return e.id=this.id,e.rawId=this.rawId,e.uid=this.uid,t.copyVerbatimStandardProps(this,e),e.className=this.className.slice(),e.miscProps=r.extend({},this.miscProps),e},t.prototype.hasInverseRendering=function(){return"inverse-background"===this.getRendering()},t.prototype.hasBgRendering=function(){var t=this.getRendering();return"inverse-background"===t||"background"===t},t.prototype.getRendering=function(){return null!=this.rendering?this.rendering:this.source.rendering},t.prototype.getConstraint=function(){return null!=this.constraint?this.constraint:null!=this.source.constraint?this.source.constraint:this.source.calendar.opt("eventConstraint")},t.prototype.getOverlap=function(){return null!=this.overlap?this.overlap:null!=this.source.overlap?this.source.overlap:this.source.calendar.opt("eventOverlap")},t.prototype.isStartExplicitlyEditable=function(){return null!=this.startEditable?this.startEditable:this.source.startEditable},t.prototype.isDurationExplicitlyEditable=function(){return null!=this.durationEditable?this.durationEditable:this.source.durationEditable},t.prototype.isExplicitlyEditable=function(){return null!=this.editable?this.editable:this.source.editable},t.prototype.toLegacy=function(){var e=r.extend({},this.miscProps);return e._id=this.uid,e.source=this.source,e.className=this.className.slice(),e.allDay=this.isAllDay(),null!=this.rawId&&(e.id=this.rawId),t.copyVerbatimStandardProps(this,e),e},t.prototype.applyManualStandardProps=function(e){return null!=e.id?this.id=t.normalizeId(this.rawId=e.id):this.id=t.generateId(),null!=e._id?this.uid=String(e._id):this.uid=t.generateId(),r.isArray(e.className)&&(this.className=e.className),"string"==typeof e.className&&(this.className=e.className.split(/\s+/)),!0},t.prototype.applyMiscProps=function(t){r.extend(this.miscProps,t)},t.uuid=0,t.defineStandardProps=i.default.defineStandardProps,t.copyVerbatimStandardProps=i.default.copyVerbatimStandardProps,t}();e.default=o,i.default.mixInto(o),o.defineStandardProps({_id:!1,id:!1,className:!1,source:!1,title:!0,url:!0,rendering:!0,constraint:!0,overlap:!0,editable:!0,startEditable:!0,durationEditable:!0,color:!0,backgroundColor:!0,borderColor:!0,textColor:!0})},function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default={sourceClasses:[],registerClass:function(t){this.sourceClasses.unshift(t)},parse:function(t,e){var n,r,i=this.sourceClasses;for(n=0;n<i.length;n++)if(r=i[n].parse(t,e))return r}}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(4),i=n(16),o=n(37),s=n(40),a=n(9),l=function(){function t(){}return t.createFromRawProps=function(e,n,a){var l,u,d,c,p=e.def,h={},f={},g={},v={},y=null,m=null;for(l in n)i.default.isStandardProp(l)?h[l]=n[l]:p.isStandardProp(l)?f[l]=n[l]:p.miscProps[l]!==n[l]&&(g[l]=n[l]);return u=i.default.parse(h,p.source),u&&(d=s.default.createFromDiff(e.dateProfile,u,a)),f.id!==p.id&&(y=f.id),r.isArraysEqual(f.className,p.className)||(m=f.className),o.default.copyVerbatimStandardProps(f,v),c=new t,c.eventDefId=y,c.className=m,c.verbatimStandardProps=v,c.miscProps=g,d&&(c.dateMutation=d),c},t.prototype.mutateSingle=function(t){var e;return this.dateMutation&&(e=t.dateProfile,t.dateProfile=this.dateMutation.buildNewDateProfile(e,t.source.calendar)),null!=this.eventDefId&&(t.id=o.default.normalizeId(t.rawId=this.eventDefId)),this.className&&(t.className=this.className),this.verbatimStandardProps&&a.default.copyVerbatimStandardProps(this.verbatimStandardProps,t),this.miscProps&&t.applyMiscProps(this.miscProps),e?function(){t.dateProfile=e}:function(){}},t.prototype.setDateMutation=function(t){t&&!t.isEmpty()?this.dateMutation=t:this.dateMutation=null},t.prototype.isEmpty=function(){return!this.dateMutation},t}();e.default=l},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(4),i=n(16),o=function(){function t(){this.clearEnd=!1,this.forceTimed=!1,this.forceAllDay=!1}return t.createFromDiff=function(e,n,i){function o(t,e){return i?r.diffByUnit(t,e,i):n.isAllDay()?r.diffDay(t,e):r.diffDayTime(t,e)}var s,a,l,u,d=e.end&&!n.end,c=e.isAllDay()&&!n.isAllDay(),p=!e.isAllDay()&&n.isAllDay();return s=o(n.start,e.start),n.end&&(a=o(n.unzonedRange.getEnd(),e.unzonedRange.getEnd()),l=a.subtract(s)),u=new t,u.clearEnd=d,u.forceTimed=c,u.forceAllDay=p,u.setDateDelta(s),u.setEndDelta(l),u},t.prototype.buildNewDateProfile=function(t,e){var n=t.start.clone(),r=null,o=!1;return t.end&&!this.clearEnd?r=t.end.clone():this.endDelta&&!r&&(r=e.getDefaultEventEnd(t.isAllDay(),n)),this.forceTimed?(o=!0,n.hasTime()||n.time(0),r&&!r.hasTime()&&r.time(0)):this.forceAllDay&&(n.hasTime()&&n.stripTime(),r&&r.hasTime()&&r.stripTime()),this.dateDelta&&(o=!0,n.add(this.dateDelta),r&&r.add(this.dateDelta)),this.endDelta&&(o=!0,r.add(this.endDelta)),this.startDelta&&(o=!0,n.add(this.startDelta)),o&&(n=e.applyTimezone(n),r&&(r=e.applyTimezone(r))),!r&&e.opt("forceEventDuration")&&(r=e.getDefaultEventEnd(t.isAllDay(),n)),new i.default(n,r,e)},t.prototype.setDateDelta=function(t){t&&t.valueOf()?this.dateDelta=t:this.dateDelta=null},t.prototype.setStartDelta=function(t){t&&t.valueOf()?this.startDelta=t:this.startDelta=null},t.prototype.setEndDelta=function(t){t&&t.valueOf()?this.endDelta=t:this.endDelta=null},t.prototype.isEmpty=function(){return!(this.clearEnd||this.forceTimed||this.forceAllDay||this.dateDelta||this.startDelta||this.endDelta)},t}();e.default=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(4),s=n(35),a=function(t){function e(e){var n=t.call(this)||this;return e=e||{},n.overflowX=e.overflowX||e.overflow||"auto",n.overflowY=e.overflowY||e.overflow||"auto",n}return r.__extends(e,t),e.prototype.render=function(){this.el=this.renderEl(),this.applyOverflow()},e.prototype.renderEl=function(){return this.scrollEl=i('<div class="fc-scroller"></div>')},e.prototype.clear=function(){this.setHeight("auto"),this.applyOverflow()},e.prototype.destroy=function(){this.el.remove()},e.prototype.applyOverflow=function(){this.scrollEl.css({"overflow-x":this.overflowX,"overflow-y":this.overflowY})},e.prototype.lockOverflow=function(t){var e=this.overflowX,n=this.overflowY;t=t||this.getScrollbarWidths(),"auto"===e&&(e=t.top||t.bottom||this.scrollEl[0].scrollWidth-1>this.scrollEl[0].clientWidth?"scroll":"hidden"),"auto"===n&&(n=t.left||t.right||this.scrollEl[0].scrollHeight-1>this.scrollEl[0].clientHeight?"scroll":"hidden"),this.scrollEl.css({"overflow-x":e,"overflow-y":n})},e.prototype.setHeight=function(t){this.scrollEl.height(t)},e.prototype.getScrollTop=function(){return this.scrollEl.scrollTop()},e.prototype.setScrollTop=function(t){this.scrollEl.scrollTop(t)},e.prototype.getClientWidth=function(){return this.scrollEl[0].clientWidth},e.prototype.getClientHeight=function(){return this.scrollEl[0].clientHeight},e.prototype.getScrollbarWidths=function(){return o.getScrollbarWidths(this.scrollEl)},e}(s.default);e.default=a},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(4),s=n(231),a=n(23),l=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.segSelector=".fc-event-container > *",r.dateSelectingClass&&(r.dateClicking=new r.dateClickingClass(r)),r.dateSelectingClass&&(r.dateSelecting=new r.dateSelectingClass(r)),r.eventPointingClass&&(r.eventPointing=new r.eventPointingClass(r)),r.eventDraggingClass&&r.eventPointing&&(r.eventDragging=new r.eventDraggingClass(r,r.eventPointing)),r.eventResizingClass&&r.eventPointing&&(r.eventResizing=new r.eventResizingClass(r,r.eventPointing)),r.externalDroppingClass&&(r.externalDropping=new r.externalDroppingClass(r)),r}return r.__extends(e,t),e.prototype.setElement=function(e){t.prototype.setElement.call(this,e),this.dateClicking&&this.dateClicking.bindToEl(e),this.dateSelecting&&this.dateSelecting.bindToEl(e),this.bindAllSegHandlersToEl(e)},e.prototype.removeElement=function(){this.endInteractions(),t.prototype.removeElement.call(this)},e.prototype.executeEventUnrender=function(){this.endInteractions(),t.prototype.executeEventUnrender.call(this)},e.prototype.bindGlobalHandlers=function(){t.prototype.bindGlobalHandlers.call(this),this.externalDropping&&this.externalDropping.bindToDocument()},e.prototype.unbindGlobalHandlers=function(){t.prototype.unbindGlobalHandlers.call(this),this.externalDropping&&this.externalDropping.unbindFromDocument()},e.prototype.bindDateHandlerToEl=function(t,e,n){var r=this;this.el.on(e,function(t){if(!i(t.target).is(r.segSelector+":not(.fc-helper),"+r.segSelector+":not(.fc-helper) *,.fc-more,a[data-goto]"))return n.call(r,t)})},e.prototype.bindAllSegHandlersToEl=function(t){[this.eventPointing,this.eventDragging,this.eventResizing].forEach(function(e){e&&e.bindToEl(t)})},e.prototype.bindSegHandlerToEl=function(t,e,n){var r=this;t.on(e,this.segSelector,function(t){var e=i(t.currentTarget);if(!e.is(".fc-helper")){var o=e.data("fc-seg");if(o&&!r.shouldIgnoreEventPointing())return n.call(r,o,t)}})},e.prototype.shouldIgnoreMouse=function(){return a.default.get().shouldIgnoreMouse()},e.prototype.shouldIgnoreTouch=function(){var t=this._getView();return t.isSelected||t.selectedEvent},e.prototype.shouldIgnoreEventPointing=function(){return this.eventDragging&&this.eventDragging.isDragging||this.eventResizing&&this.eventResizing.isResizing},e.prototype.canStartSelection=function(t,e){return o.getEvIsTouch(e)&&!this.canStartResize(t,e)&&(this.isEventDefDraggable(t.footprint.eventDef)||this.isEventDefResizable(t.footprint.eventDef))},e.prototype.canStartDrag=function(t,e){return!this.canStartResize(t,e)&&this.isEventDefDraggable(t.footprint.eventDef)},e.prototype.canStartResize=function(t,e){var n=this._getView(),r=t.footprint.eventDef;return(!o.getEvIsTouch(e)||n.isEventDefSelected(r))&&this.isEventDefResizable(r)&&i(e.target).is(".fc-resizer")},e.prototype.endInteractions=function(){[this.dateClicking,this.dateSelecting,this.eventPointing,this.eventDragging,this.eventResizing].forEach(function(t){t&&t.end()})},e.prototype.isEventDefDraggable=function(t){return this.isEventDefStartEditable(t)},e.prototype.isEventDefStartEditable=function(t){var e=t.isStartExplicitlyEditable();return null==e&&null==(e=this.opt("eventStartEditable"))&&(e=this.isEventDefGenerallyEditable(t)),e},e.prototype.isEventDefGenerallyEditable=function(t){var e=t.isExplicitlyEditable();return null==e&&(e=this.opt("editable")),e},e.prototype.isEventDefResizableFromStart=function(t){return this.opt("eventResizableFromStart")&&this.isEventDefResizable(t)},e.prototype.isEventDefResizableFromEnd=function(t){return this.isEventDefResizable(t)},e.prototype.isEventDefResizable=function(t){var e=t.isDurationExplicitlyEditable();return null==e&&null==(e=this.opt("eventDurationEditable"))&&(e=this.isEventDefGenerallyEditable(t)),e},e.prototype.diffDates=function(t,e){return this.largeUnit?o.diffByUnit(t,e,this.largeUnit):o.diffDayTime(t,e)},e.prototype.isEventInstanceGroupAllowed=function(t){var e,n=this._getView(),r=this.dateProfile,i=this.eventRangesToEventFootprints(t.getAllEventRanges());for(e=0;e<i.length;e++)if(!r.validUnzonedRange.containsRange(i[e].componentFootprint.unzonedRange))return!1;return n.calendar.constraints.isEventInstanceGroupAllowed(t)},e.prototype.isExternalInstanceGroupAllowed=function(t){var e,n=this._getView(),r=this.dateProfile,i=this.eventRangesToEventFootprints(t.getAllEventRanges());for(e=0;e<i.length;e++)if(!r.validUnzonedRange.containsRange(i[e].componentFootprint.unzonedRange))return!1;for(e=0;e<i.length;e++)if(!n.calendar.constraints.isSelectionFootprintAllowed(i[e].componentFootprint))return!1;return!0},e}(s.default);e.default=l},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(0),s=n(4),a=n(229),l=n(55),u=n(42),d=n(23),c=n(5),p=function(t){function e(e,n){var r=t.call(this,null,n.options)||this;return r.batchRenderDepth=0,r.isSelected=!1,r.calendar=e,r.viewSpec=n,r.type=n.type,r.name=r.type,r.initRenderQueue(),r.initHiddenDays(),r.dateProfileGenerator=new r.dateProfileGeneratorClass(r),r.bindBaseRenderHandlers(),r.eventOrderSpecs=s.parseFieldSpecs(r.opt("eventOrder")),r.initialize&&r.initialize(),r}return r.__extends(e,t),e.prototype._getView=function(){return this},e.prototype.opt=function(t){return this.options[t]},e.prototype.initRenderQueue=function(){this.renderQueue=new a.default({event:this.opt("eventRenderWait")}),this.renderQueue.on("start",this.onRenderQueueStart.bind(this)),this.renderQueue.on("stop",this.onRenderQueueStop.bind(this)),this.on("before:change",this.startBatchRender),this.on("change",this.stopBatchRender)},e.prototype.onRenderQueueStart=function(){this.calendar.freezeContentHeight(),this.addScroll(this.queryScroll())},e.prototype.onRenderQueueStop=function(){this.calendar.updateViewSize()&&this.popScroll(),this.calendar.thawContentHeight()},e.prototype.startBatchRender=function(){this.batchRenderDepth++||this.renderQueue.pause()},e.prototype.stopBatchRender=function(){--this.batchRenderDepth||this.renderQueue.resume()},e.prototype.requestRender=function(t,e,n){this.renderQueue.queue(t,e,n)},e.prototype.whenSizeUpdated=function(t){this.renderQueue.isRunning?this.renderQueue.one("stop",t.bind(this)):t.call(this)},e.prototype.computeTitle=function(t){var e;return e=/^(year|month)$/.test(t.currentRangeUnit)?t.currentUnzonedRange:t.activeUnzonedRange,this.formatRange({start:this.calendar.msToMoment(e.startMs,t.isRangeAllDay),end:this.calendar.msToMoment(e.endMs,t.isRangeAllDay)},t.isRangeAllDay,this.opt("titleFormat")||this.computeTitleFormat(t),this.opt("titleRangeSeparator"))},e.prototype.computeTitleFormat=function(t){var e=t.currentRangeUnit;return"year"===e?"YYYY":"month"===e?this.opt("monthYearFormat"):t.currentUnzonedRange.as("days")>1?"ll":"LL"},e.prototype.setDate=function(t){var e=this.get("dateProfile"),n=this.dateProfileGenerator.build(t,void 0,!0);e&&e.activeUnzonedRange.equals(n.activeUnzonedRange)||this.set("dateProfile",n)},e.prototype.unsetDate=function(){this.unset("dateProfile")},e.prototype.fetchInitialEvents=function(t){var e=this.calendar,n=t.isRangeAllDay&&!this.usesMinMaxTime;return e.requestEvents(e.msToMoment(t.activeUnzonedRange.startMs,n),e.msToMoment(t.activeUnzonedRange.endMs,n))},e.prototype.bindEventChanges=function(){this.listenTo(this.calendar,"eventsReset",this.resetEvents)},e.prototype.unbindEventChanges=function(){this.stopListeningTo(this.calendar,"eventsReset")},e.prototype.setEvents=function(t){this.set("currentEvents",t),this.set("hasEvents",!0)},e.prototype.unsetEvents=function(){this.unset("currentEvents"),this.unset("hasEvents")},e.prototype.resetEvents=function(t){this.startBatchRender(),this.unsetEvents(),this.setEvents(t),this.stopBatchRender()},e.prototype.requestDateRender=function(t){var e=this;this.requestRender(function(){e.executeDateRender(t)},"date","init")},e.prototype.requestDateUnrender=function(){var t=this;this.requestRender(function(){t.executeDateUnrender()},"date","destroy")},e.prototype.executeDateRender=function(e){t.prototype.executeDateRender.call(this,e),this.render&&this.render(),this.trigger("datesRendered"),this.addScroll({isDateInit:!0}),this.startNowIndicator()},e.prototype.executeDateUnrender=function(){this.unselect(),this.stopNowIndicator(),this.trigger("before:datesUnrendered"),this.destroy&&this.destroy(),t.prototype.executeDateUnrender.call(this)},e.prototype.bindBaseRenderHandlers=function(){var t=this;this.on("datesRendered",function(){t.whenSizeUpdated(t.triggerViewRender)}),this.on("before:datesUnrendered",function(){t.triggerViewDestroy()})},e.prototype.triggerViewRender=function(){this.publiclyTrigger("viewRender",{context:this,args:[this,this.el]})},e.prototype.triggerViewDestroy=function(){this.publiclyTrigger("viewDestroy",{context:this,args:[this,this.el]})},e.prototype.requestEventsRender=function(t){var e=this;this.requestRender(function(){e.executeEventRender(t),e.whenSizeUpdated(e.triggerAfterEventsRendered)},"event","init")},e.prototype.requestEventsUnrender=function(){var t=this;this.requestRender(function(){t.triggerBeforeEventsDestroyed(),t.executeEventUnrender()},"event","destroy")},e.prototype.requestBusinessHoursRender=function(t){var e=this;this.requestRender(function(){e.renderBusinessHours(t)},"businessHours","init")},e.prototype.requestBusinessHoursUnrender=function(){var t=this;this.requestRender(function(){t.unrenderBusinessHours()},"businessHours","destroy")},e.prototype.bindGlobalHandlers=function(){t.prototype.bindGlobalHandlers.call(this),this.listenTo(d.default.get(),{touchstart:this.processUnselect,mousedown:this.handleDocumentMousedown})},e.prototype.unbindGlobalHandlers=function(){t.prototype.unbindGlobalHandlers.call(this),this.stopListeningTo(d.default.get())},e.prototype.startNowIndicator=function(){var t,e,n,r=this;this.opt("nowIndicator")&&(t=this.getNowIndicatorUnit())&&(e=s.proxy(this,"updateNowIndicator"),this.initialNowDate=this.calendar.getNow(),this.initialNowQueriedMs=(new Date).valueOf(),n=this.initialNowDate.clone().startOf(t).add(1,t).valueOf()-this.initialNowDate.valueOf(),this.nowIndicatorTimeoutID=setTimeout(function(){r.nowIndicatorTimeoutID=null,e(),n=+o.duration(1,t),n=Math.max(100,n),r.nowIndicatorIntervalID=setInterval(e,n)},n))},e.prototype.updateNowIndicator=function(){this.isDatesRendered&&this.initialNowDate&&(this.unrenderNowIndicator(),this.renderNowIndicator(this.initialNowDate.clone().add((new Date).valueOf()-this.initialNowQueriedMs)),this.isNowIndicatorRendered=!0)},e.prototype.stopNowIndicator=function(){this.isNowIndicatorRendered&&(this.nowIndicatorTimeoutID&&(clearTimeout(this.nowIndicatorTimeoutID),this.nowIndicatorTimeoutID=null),this.nowIndicatorIntervalID&&(clearInterval(this.nowIndicatorIntervalID),this.nowIndicatorIntervalID=null),this.unrenderNowIndicator(),this.isNowIndicatorRendered=!1)},e.prototype.updateSize=function(e,n,r){this.setHeight?this.setHeight(e,n):t.prototype.updateSize.call(this,e,n,r),this.updateNowIndicator()},e.prototype.addScroll=function(t){var e=this.queuedScroll||(this.queuedScroll={});i.extend(e,t)},e.prototype.popScroll=function(){this.applyQueuedScroll(),this.queuedScroll=null},e.prototype.applyQueuedScroll=function(){this.queuedScroll&&this.applyScroll(this.queuedScroll)},e.prototype.queryScroll=function(){var t={};return this.isDatesRendered&&i.extend(t,this.queryDateScroll()),t},e.prototype.applyScroll=function(t){t.isDateInit&&this.isDatesRendered&&i.extend(t,this.computeInitialDateScroll()),this.isDatesRendered&&this.applyDateScroll(t)},e.prototype.computeInitialDateScroll=function(){return{}},e.prototype.queryDateScroll=function(){return{}},e.prototype.applyDateScroll=function(t){},e.prototype.reportEventDrop=function(t,e,n,r){var i=this.calendar.eventManager,s=i.mutateEventsWithId(t.def.id,e),a=e.dateMutation;a&&(t.dateProfile=a.buildNewDateProfile(t.dateProfile,this.calendar)),this.triggerEventDrop(t,a&&a.dateDelta||o.duration(),s,n,r)},e.prototype.triggerEventDrop=function(t,e,n,r,i){this.publiclyTrigger("eventDrop",{context:r[0],args:[t.toLegacy(),e,n,i,{},this]})},e.prototype.reportExternalDrop=function(t,e,n,r,i,o){e&&this.calendar.eventManager.addEventDef(t,n),this.triggerExternalDrop(t,e,r,i,o)},e.prototype.triggerExternalDrop=function(t,e,n,r,i){this.publiclyTrigger("drop",{context:n[0],args:[t.dateProfile.start.clone(),r,i,this]}),e&&this.publiclyTrigger("eventReceive",{context:this,args:[t.buildInstance().toLegacy(),this]})},e.prototype.reportEventResize=function(t,e,n,r){var i=this.calendar.eventManager,o=i.mutateEventsWithId(t.def.id,e);t.dateProfile=e.dateMutation.buildNewDateProfile(t.dateProfile,this.calendar);var s=e.dateMutation.endDelta||e.dateMutation.startDelta;this.triggerEventResize(t,s,o,n,r)},e.prototype.triggerEventResize=function(t,e,n,r,i){this.publiclyTrigger("eventResize",{context:r[0],args:[t.toLegacy(),e,n,i,{},this]})},e.prototype.select=function(t,e){this.unselect(e),this.renderSelectionFootprint(t),this.reportSelection(t,e)},e.prototype.renderSelectionFootprint=function(e){this.renderSelection?this.renderSelection(e.toLegacy(this.calendar)):t.prototype.renderSelectionFootprint.call(this,e)},e.prototype.reportSelection=function(t,e){this.isSelected=!0,this.triggerSelect(t,e)},e.prototype.triggerSelect=function(t,e){var n=this.calendar.footprintToDateProfile(t);this.publiclyTrigger("select",{context:this,args:[n.start,n.end,e,this]})},e.prototype.unselect=function(t){this.isSelected&&(this.isSelected=!1,this.destroySelection&&this.destroySelection(),this.unrenderSelection(),this.publiclyTrigger("unselect",{context:this,args:[t,this]}))},e.prototype.selectEventInstance=function(t){this.selectedEventInstance&&this.selectedEventInstance===t||(this.unselectEventInstance(),this.getEventSegs().forEach(function(e){e.footprint.eventInstance===t&&e.el&&e.el.addClass("fc-selected")}),this.selectedEventInstance=t)},e.prototype.unselectEventInstance=function(){this.selectedEventInstance&&(this.getEventSegs().forEach(function(t){t.el&&t.el.removeClass("fc-selected")}),this.selectedEventInstance=null)},e.prototype.isEventDefSelected=function(t){return this.selectedEventInstance&&this.selectedEventInstance.def.id===t.id},e.prototype.handleDocumentMousedown=function(t){s.isPrimaryMouseButton(t)&&this.processUnselect(t)},e.prototype.processUnselect=function(t){this.processRangeUnselect(t),this.processEventUnselect(t)},e.prototype.processRangeUnselect=function(t){var e;this.isSelected&&this.opt("unselectAuto")&&((e=this.opt("unselectCancel"))&&i(t.target).closest(e).length||this.unselect(t))},e.prototype.processEventUnselect=function(t){this.selectedEventInstance&&(i(t.target).closest(".fc-selected").length||this.unselectEventInstance())},e.prototype.triggerBaseRendered=function(){this.publiclyTrigger("viewRender",{context:this,args:[this,this.el]})},e.prototype.triggerBaseUnrendered=function(){this.publiclyTrigger("viewDestroy",{context:this,args:[this,this.el]})},e.prototype.triggerDayClick=function(t,e,n){var r=this.calendar.footprintToDateProfile(t);this.publiclyTrigger("dayClick",{context:e,args:[r.start,n,this]})},e.prototype.isDateInOtherMonth=function(t,e){return!1},e.prototype.getUnzonedRangeOption=function(t){var e=this.opt(t);if("function"==typeof e&&(e=e.apply(null,Array.prototype.slice.call(arguments,1))),e)return this.calendar.parseUnzonedRange(e)},e.prototype.initHiddenDays=function(){var t,e=this.opt("hiddenDays")||[],n=[],r=0;for(!1===this.opt("weekends")&&e.push(0,6),t=0;t<7;t++)(n[t]=-1!==i.inArray(t,e))||r++;if(!r)throw new Error("invalid hiddenDays");this.isHiddenDayHash=n},e.prototype.trimHiddenDays=function(t){var e=t.getStart(),n=t.getEnd();return e&&(e=this.skipHiddenDays(e)),n&&(n=this.skipHiddenDays(n,-1,!0)),null===e||null===n||e<n?new c.default(e,n):null},e.prototype.isHiddenDay=function(t){return o.isMoment(t)&&(t=t.day()),this.isHiddenDayHash[t]},e.prototype.skipHiddenDays=function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!1);for(var r=t.clone();this.isHiddenDayHash[(r.day()+(n?e:0)+7)%7];)r.add(e,"days");return r},e}(u.default);e.default=p,p.prototype.usesMinMaxTime=!1,p.prototype.dateProfileGeneratorClass=l.default,p.watch("displayingDates",["isInDom","dateProfile"],function(t){this.requestDateRender(t.dateProfile)},function(){this.requestDateUnrender()}),p.watch("displayingBusinessHours",["displayingDates","businessHourGenerator"],function(t){this.requestBusinessHoursRender(t.businessHourGenerator)},function(){this.requestBusinessHoursUnrender()}),p.watch("initialEvents",["dateProfile"],function(t){return this.fetchInitialEvents(t.dateProfile)}),p.watch("bindingEvents",["initialEvents"],function(t){this.setEvents(t.initialEvents),this.bindEventChanges()},function(){this.unbindEventChanges(),this.unsetEvents()}),p.watch("displayingEvents",["displayingDates","hasEvents"],function(){this.requestEventsRender(this.get("currentEvents"))},function(){this.requestEventsUnrender()}),p.watch("title",["dateProfile"],function(t){return this.title=this.computeTitle(t.dateProfile)}),p.watch("legacyDateProps",["dateProfile"],function(t){var e=this.calendar,n=t.dateProfile;this.start=e.msToMoment(n.activeUnzonedRange.startMs,n.isRangeAllDay),this.end=e.msToMoment(n.activeUnzonedRange.endMs,n.isRangeAllDay),this.intervalStart=e.msToMoment(n.currentUnzonedRange.startMs,n.isRangeAllDay),this.intervalEnd=e.msToMoment(n.currentUnzonedRange.endMs,n.isRangeAllDay)})},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(4),o=function(){function t(t,e){this.view=t._getView(),this.component=t,this.fillRenderer=e}return t.prototype.opt=function(t){return this.view.opt(t)},t.prototype.rangeUpdated=function(){var t,e
;this.eventTimeFormat=this.opt("eventTimeFormat")||this.opt("timeFormat")||this.computeEventTimeFormat(),t=this.opt("displayEventTime"),null==t&&(t=this.computeDisplayEventTime()),e=this.opt("displayEventEnd"),null==e&&(e=this.computeDisplayEventEnd()),this.displayEventTime=t,this.displayEventEnd=e},t.prototype.render=function(t){var e,n,r,i=this.component._getDateProfile(),o=[],s=[];for(e in t)n=t[e],r=n.sliceRenderRanges(i.activeUnzonedRange),n.getEventDef().hasBgRendering()?o.push.apply(o,r):s.push.apply(s,r);this.renderBgRanges(o),this.renderFgRanges(s)},t.prototype.unrender=function(){this.unrenderBgRanges(),this.unrenderFgRanges()},t.prototype.renderFgRanges=function(t){var e=this.component.eventRangesToEventFootprints(t),n=this.component.eventFootprintsToSegs(e);n=this.renderFgSegEls(n),!1!==this.renderFgSegs(n)&&(this.fgSegs=n)},t.prototype.unrenderFgRanges=function(){this.unrenderFgSegs(this.fgSegs||[]),this.fgSegs=null},t.prototype.renderBgRanges=function(t){var e=this.component.eventRangesToEventFootprints(t),n=this.component.eventFootprintsToSegs(e);!1!==this.renderBgSegs(n)&&(this.bgSegs=n)},t.prototype.unrenderBgRanges=function(){this.unrenderBgSegs(),this.bgSegs=null},t.prototype.getSegs=function(){return(this.bgSegs||[]).concat(this.fgSegs||[])},t.prototype.renderFgSegs=function(t){return!1},t.prototype.unrenderFgSegs=function(t){},t.prototype.renderBgSegs=function(t){var e=this;if(!this.fillRenderer)return!1;this.fillRenderer.renderSegs("bgEvent",t,{getClasses:function(t){return e.getBgClasses(t.footprint.eventDef)},getCss:function(t){return{"background-color":e.getBgColor(t.footprint.eventDef)}},filterEl:function(t,n){return e.filterEventRenderEl(t.footprint,n)}})},t.prototype.unrenderBgSegs=function(){this.fillRenderer&&this.fillRenderer.unrender("bgEvent")},t.prototype.renderFgSegEls=function(t,e){var n=this;void 0===e&&(e=!1);var i,o=this.view.hasPublicHandlers("eventRender"),s="",a=[];if(t.length){for(i=0;i<t.length;i++)this.beforeFgSegHtml(t[i]),s+=this.fgSegHtml(t[i],e);r(s).each(function(e,i){var s=t[e],l=r(i);o&&(l=n.filterEventRenderEl(s.footprint,l)),l&&(l.data("fc-seg",s),s.el=l,a.push(s))})}return a},t.prototype.beforeFgSegHtml=function(t){},t.prototype.fgSegHtml=function(t,e){},t.prototype.getSegClasses=function(t,e,n){var r=["fc-event",t.isStart?"fc-start":"fc-not-start",t.isEnd?"fc-end":"fc-not-end"].concat(this.getClasses(t.footprint.eventDef));return e&&r.push("fc-draggable"),n&&r.push("fc-resizable"),this.view.isEventDefSelected(t.footprint.eventDef)&&r.push("fc-selected"),r},t.prototype.filterEventRenderEl=function(t,e){var n=t.getEventLegacy(),i=this.view.publiclyTrigger("eventRender",{context:n,args:[n,e,this.view]});return!1===i?e=null:i&&!0!==i&&(e=r(i)),e},t.prototype.getTimeText=function(t,e,n){return this._getTimeText(t.eventInstance.dateProfile.start,t.eventInstance.dateProfile.end,t.componentFootprint.isAllDay,e,n)},t.prototype._getTimeText=function(t,e,n,r,i){return null==r&&(r=this.eventTimeFormat),null==i&&(i=this.displayEventEnd),this.displayEventTime&&!n?i&&e?this.view.formatRange({start:t,end:e},!1,r):t.format(r):""},t.prototype.computeEventTimeFormat=function(){return this.opt("smallTimeFormat")},t.prototype.computeDisplayEventTime=function(){return!0},t.prototype.computeDisplayEventEnd=function(){return!0},t.prototype.getBgClasses=function(t){var e=this.getClasses(t);return e.push("fc-bgevent"),e},t.prototype.getClasses=function(t){var e,n=this.getStylingObjs(t),r=[];for(e=0;e<n.length;e++)r.push.apply(r,n[e].eventClassName||n[e].className||[]);return r},t.prototype.getSkinCss=function(t){return{"background-color":this.getBgColor(t),"border-color":this.getBorderColor(t),color:this.getTextColor(t)}},t.prototype.getBgColor=function(t){var e,n,r=this.getStylingObjs(t);for(e=0;e<r.length&&!n;e++)n=r[e].eventBackgroundColor||r[e].eventColor||r[e].backgroundColor||r[e].color;return n||(n=this.opt("eventBackgroundColor")||this.opt("eventColor")),n},t.prototype.getBorderColor=function(t){var e,n,r=this.getStylingObjs(t);for(e=0;e<r.length&&!n;e++)n=r[e].eventBorderColor||r[e].eventColor||r[e].borderColor||r[e].color;return n||(n=this.opt("eventBorderColor")||this.opt("eventColor")),n},t.prototype.getTextColor=function(t){var e,n,r=this.getStylingObjs(t);for(e=0;e<r.length&&!n;e++)n=r[e].eventTextColor||r[e].textColor;return n||(n=this.opt("eventTextColor")),n},t.prototype.getStylingObjs=function(t){var e=this.getFallbackStylingObjs(t);return e.unshift(t),e},t.prototype.getFallbackStylingObjs=function(t){return[t.source]},t.prototype.sortEventSegs=function(t){t.sort(i.proxy(this,"compareEventSegs"))},t.prototype.compareEventSegs=function(t,e){var n=t.footprint,r=e.footprint,o=n.componentFootprint,s=r.componentFootprint,a=o.unzonedRange,l=s.unzonedRange;return a.startMs-l.startMs||l.endMs-l.startMs-(a.endMs-a.startMs)||s.isAllDay-o.isAllDay||i.compareByFieldSpecs(n.eventDef,r.eventDef,this.view.eventOrderSpecs,n.eventDef.miscProps,r.eventDef.miscProps)},t}();e.default=o},,,,,function(t,e,n){function r(t){return"en"!==t.locale()?t.clone().locale("en"):t}function i(t,e){return h(a(e).fakeFormatString,t)}function o(t,e,n,r,i){var o;return t=y.default.parseZone(t),e=y.default.parseZone(e),o=t.localeData(),n=o.longDateFormat(n)||n,s(a(n),t,e,r||" - ",i)}function s(t,e,n,r,i){var o,s,a,l=t.sameUnits,u=e.clone().stripZone(),d=n.clone().stripZone(),c=f(t.fakeFormatString,e),p=f(t.fakeFormatString,n),h="",v="",y="",m="",b="";for(o=0;o<l.length&&(!l[o]||u.isSame(d,l[o]));o++)h+=c[o];for(s=l.length-1;s>o&&(!l[s]||u.isSame(d,l[s]))&&(s-1!==o||"."!==c[s]);s--)v=c[s]+v;for(a=o;a<=s;a++)y+=c[a],m+=p[a];return(y||m)&&(b=i?m+r+y:y+r+m),g(h+b+v)}function a(t){return C[t]||(C[t]=l(t))}function l(t){var e=u(t);return{fakeFormatString:c(e),sameUnits:p(e)}}function u(t){for(var e,n=[],r=/\[([^\]]*)\]|\(([^\)]*)\)|(LTS|LT|(\w)\4*o?)|([^\w\[\(]+)/g;e=r.exec(t);)e[1]?n.push.apply(n,d(e[1])):e[2]?n.push({maybe:u(e[2])}):e[3]?n.push({token:e[3]}):e[5]&&n.push.apply(n,d(e[5]));return n}function d(t){return". "===t?["."," "]:[t]}function c(t){var e,n,r=[];for(e=0;e<t.length;e++)n=t[e],"string"==typeof n?r.push("["+n+"]"):n.token?n.token in E?r.push(b+"["+n.token+"]"):r.push(n.token):n.maybe&&r.push(w+c(n.maybe)+w);return r.join(m)}function p(t){var e,n,r,i=[];for(e=0;e<t.length;e++)n=t[e],n.token?(r=S[n.token.charAt(0)],i.push(r?r.unit:"second")):n.maybe?i.push.apply(i,p(n.maybe)):i.push(null);return i}function h(t,e){return g(f(t,e).join(""))}function f(t,e){var n,r,i=[],o=y.oldMomentFormat(e,t),s=o.split(m);for(n=0;n<s.length;n++)r=s[n],r.charAt(0)===b?i.push(E[r.substring(1)](e)):i.push(r);return i}function g(t){return t.replace(D,function(t,e){return e.match(/[1-9]/)?e:""})}function v(t){var e,n,r,i,o=u(t);for(e=0;e<o.length;e++)n=o[e],n.token&&(r=S[n.token.charAt(0)])&&(!i||r.value>i.value)&&(i=r);return i?i.unit:null}Object.defineProperty(e,"__esModule",{value:!0});var y=n(11);y.newMomentProto.format=function(){return this._fullCalendar&&arguments[0]?i(this,arguments[0]):this._ambigTime?y.oldMomentFormat(r(this),"YYYY-MM-DD"):this._ambigZone?y.oldMomentFormat(r(this),"YYYY-MM-DD[T]HH:mm:ss"):this._fullCalendar?y.oldMomentFormat(r(this)):y.oldMomentProto.format.apply(this,arguments)},y.newMomentProto.toISOString=function(){return this._ambigTime?y.oldMomentFormat(r(this),"YYYY-MM-DD"):this._ambigZone?y.oldMomentFormat(r(this),"YYYY-MM-DD[T]HH:mm:ss"):this._fullCalendar?y.oldMomentProto.toISOString.apply(r(this),arguments):y.oldMomentProto.toISOString.apply(this,arguments)};var m="\v",b="",w="",D=new RegExp(w+"([^"+w+"]*)"+w,"g"),E={t:function(t){return y.oldMomentFormat(t,"a").charAt(0)},T:function(t){return y.oldMomentFormat(t,"A").charAt(0)}},S={Y:{value:1,unit:"year"},M:{value:2,unit:"month"},W:{value:3,unit:"week"},w:{value:3,unit:"week"},D:{value:4,unit:"day"},d:{value:4,unit:"day"}};e.formatDate=i,e.formatRange=o;var C={};e.queryMostGranularFormatUnit=v},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,n){this.unzonedRange=t,this.eventDef=e,n&&(this.eventInstance=n)}return t}();e.default=n},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(35),o=n(13),s=n(7),a=function(t){function e(){var e=t.call(this)||this;return e._watchers={},e._props={},e.applyGlobalWatchers(),e.constructed(),e}return r.__extends(e,t),e.watch=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.prototype.hasOwnProperty("_globalWatchArgs")||(this.prototype._globalWatchArgs=Object.create(this.prototype._globalWatchArgs)),this.prototype._globalWatchArgs[t]=e},e.prototype.constructed=function(){},e.prototype.applyGlobalWatchers=function(){var t,e=this._globalWatchArgs;for(t in e)this.watch.apply(this,[t].concat(e[t]))},e.prototype.has=function(t){return t in this._props},e.prototype.get=function(t){return void 0===t?this._props:this._props[t]},e.prototype.set=function(t,e){var n;"string"==typeof t?(n={},n[t]=void 0===e?null:e):n=t,this.setProps(n)},e.prototype.reset=function(t){var e,n=this._props,r={};for(e in n)r[e]=void 0;for(e in t)r[e]=t[e];this.setProps(r)},e.prototype.unset=function(t){var e,n,r={};for(e="string"==typeof t?[t]:t,n=0;n<e.length;n++)r[e[n]]=void 0;this.setProps(r)},e.prototype.setProps=function(t){var e,n,r={},i=0;for(e in t)"object"!=typeof(n=t[e])&&n===this._props[e]||(r[e]=n,i++);if(i){this.trigger("before:batchChange",r);for(e in r)n=r[e],this.trigger("before:change",e,n),this.trigger("before:change:"+e,n);for(e in r)n=r[e],void 0===n?delete this._props[e]:this._props[e]=n,this.trigger("change:"+e,n),this.trigger("change",e,n);this.trigger("batchChange",r)}},e.prototype.watch=function(t,e,n,r){var i=this;this.unwatch(t),this._watchers[t]=this._watchDeps(e,function(e){var r=n.call(i,e);r&&r.then?(i.unset(t),r.then(function(e){i.set(t,e)})):i.set(t,r)},function(e){i.unset(t),r&&r.call(i,e)})},e.prototype.unwatch=function(t){var e=this._watchers[t];e&&(delete this._watchers[t],e.teardown())},e.prototype._watchDeps=function(t,e,n){var r=this,i=0,o=t.length,s=0,a={},l=[],u=!1,d=function(t,e,r){1===++i&&s===o&&(u=!0,n(a),u=!1)},c=function(t,n,r){void 0===n?(r||void 0===a[t]||s--,delete a[t]):(r||void 0!==a[t]||s++,a[t]=n),--i||s===o&&(u||e(a))},p=function(t,e){r.on(t,e),l.push([t,e])};return t.forEach(function(t){var e=!1;"?"===t.charAt(0)&&(t=t.substring(1),e=!0),p("before:change:"+t,function(t){d()}),p("change:"+t,function(n){c(t,n,e)})}),t.forEach(function(t){var e=!1;"?"===t.charAt(0)&&(t=t.substring(1),e=!0),r.has(t)?(a[t]=r.get(t),s++):e&&s++}),s===o&&e(a),{teardown:function(){for(var t=0;t<l.length;t++)r.off(l[t][0],l[t][1]);l=null,s===o&&n()},flash:function(){s===o&&(n(),e(a))}}},e.prototype.flash=function(t){var e=this._watchers[t];e&&e.flash()},e}(i.default);e.default=a,a.prototype._globalWatchArgs={},o.default.mixInto(a),s.default.mixInto(a)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(4),o=n(15),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.defineStandardProps=function(t){var e=this.prototype;e.hasOwnProperty("standardPropMap")||(e.standardPropMap=Object.create(e.standardPropMap)),i.copyOwnProps(t,e.standardPropMap)},e.copyVerbatimStandardProps=function(t,e){var n,r=this.prototype.standardPropMap;for(n in r)null!=t[n]&&!0===r[n]&&(e[n]=t[n])},e.prototype.applyProps=function(t){var e,n=this.standardPropMap,r={},i={};for(e in t)!0===n[e]?this[e]=t[e]:!1===n[e]?r[e]=t[e]:i[e]=t[e];return this.applyMiscProps(i),this.applyManualStandardProps(r)},e.prototype.applyManualStandardProps=function(t){return!0},e.prototype.applyMiscProps=function(t){},e.prototype.isStandardProp=function(t){return t in this.standardPropMap},e}(o.default);e.default=s,s.prototype.standardPropMap={}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.def=t,this.dateProfile=e}return t.prototype.toLegacy=function(){var t=this.dateProfile,e=this.def.toLegacy();return e.start=t.start.clone(),e.end=t.end?t.end.clone():null,e},t}();e.default=n},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(0),s=n(37),a=n(53),l=n(16),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.isAllDay=function(){return!this.startTime&&!this.endTime},e.prototype.buildInstances=function(t){for(var e,n,r,i=this.source.calendar,o=t.getStart(),s=t.getEnd(),u=[];o.isBefore(s);)this.dowHash&&!this.dowHash[o.day()]||(e=i.applyTimezone(o),n=e.clone(),r=null,this.startTime?n.time(this.startTime):n.stripTime(),this.endTime&&(r=e.clone().time(this.endTime)),u.push(new a.default(this,new l.default(n,r,i)))),o.add(1,"days");return u},e.prototype.setDow=function(t){this.dowHash||(this.dowHash={});for(var e=0;e<t.length;e++)this.dowHash[t[e]]=!0},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e.startTime&&(e.startTime=o.duration(this.startTime)),e.endTime&&(e.endTime=o.duration(this.endTime)),this.dowHash&&(e.dowHash=i.extend({},this.dowHash)),e},e}(s.default);e.default=u,u.prototype.applyProps=function(t){var e=s.default.prototype.applyProps.call(this,t);return t.start&&(this.startTime=o.duration(t.start)),t.end&&(this.endTime=o.duration(t.end)),t.dow&&this.setDow(t.dow),e},u.defineStandardProps({start:!1,end:!1,dow:!1})},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(4),o=n(5),s=function(){function t(t){this._view=t}return t.prototype.opt=function(t){return this._view.opt(t)},t.prototype.trimHiddenDays=function(t){return this._view.trimHiddenDays(t)},t.prototype.msToUtcMoment=function(t,e){return this._view.calendar.msToUtcMoment(t,e)},t.prototype.buildPrev=function(t){var e=t.date.clone().startOf(t.currentRangeUnit).subtract(t.dateIncrement);return this.build(e,-1)},t.prototype.buildNext=function(t){var e=t.date.clone().startOf(t.currentRangeUnit).add(t.dateIncrement);return this.build(e,1)},t.prototype.build=function(t,e,n){void 0===n&&(n=!1);var i,o,s,a,l,u,d=!t.hasTime(),c=null,p=null;return i=this.buildValidRange(),i=this.trimHiddenDays(i),n&&(t=this.msToUtcMoment(i.constrainDate(t),d)),o=this.buildCurrentRangeInfo(t,e),s=/^(year|month|week|day)$/.test(o.unit),a=this.buildRenderRange(this.trimHiddenDays(o.unzonedRange),o.unit,s),a=this.trimHiddenDays(a),l=a.clone(),this.opt("showNonCurrentDates")||(l=l.intersect(o.unzonedRange)),c=r.duration(this.opt("minTime")),p=r.duration(this.opt("maxTime")),l=this.adjustActiveRange(l,c,p),l=l.intersect(i),l&&(t=this.msToUtcMoment(l.constrainDate(t),d)),u=o.unzonedRange.intersectsWith(i),{validUnzonedRange:i,currentUnzonedRange:o.unzonedRange,currentRangeUnit:o.unit,isRangeAllDay:s,activeUnzonedRange:l,renderUnzonedRange:a,minTime:c,maxTime:p,isValid:u,date:t,dateIncrement:this.buildDateIncrement(o.duration)}},t.prototype.buildValidRange=function(){return this._view.getUnzonedRangeOption("validRange",this._view.calendar.getNow())||new o.default},t.prototype.buildCurrentRangeInfo=function(t,e){var n,r=this._view.viewSpec,o=null,s=null,a=null;return r.duration?(o=r.duration,s=r.durationUnit,a=this.buildRangeFromDuration(t,e,o,s)):(n=this.opt("dayCount"))?(s="day",a=this.buildRangeFromDayCount(t,e,n)):(a=this.buildCustomVisibleRange(t))?s=i.computeGreatestUnit(a.getStart(),a.getEnd()):(o=this.getFallbackDuration(),s=i.computeGreatestUnit(o),a=this.buildRangeFromDuration(t,e,o,s)),{duration:o,unit:s,unzonedRange:a}},t.prototype.getFallbackDuration=function(){return r.duration({days:1})},t.prototype.adjustActiveRange=function(t,e,n){var r=t.getStart(),i=t.getEnd();return this._view.usesMinMaxTime&&(e<0&&r.time(0).add(e),n>864e5&&i.time(n-864e5)),new o.default(r,i)},t.prototype.buildRangeFromDuration=function(t,e,n,s){function a(){d=t.clone().startOf(h),c=d.clone().add(n),p=new o.default(d,c)}var l,u,d,c,p,h=this.opt("dateAlignment");return h||(l=this.opt("dateIncrement"),l?(u=r.duration(l),h=u<n?i.computeDurationGreatestUnit(u,l):s):h=s),n.as("days")<=1&&this._view.isHiddenDay(d)&&(d=this._view.skipHiddenDays(d,e),d.startOf("day")),a(),this.trimHiddenDays(p)||(t=this._view.skipHiddenDays(t,e),a()),p},t.prototype.buildRangeFromDayCount=function(t,e,n){var r,i,s=this.opt("dateAlignment"),a=0;if(s||-1!==e){r=t.clone(),s&&r.startOf(s),r.startOf("day"),r=this._view.skipHiddenDays(r),i=r.clone();do{i.add(1,"day"),this._view.isHiddenDay(i)||a++}while(a<n)}else{i=t.clone().startOf("day").add(1,"day"),i=this._view.skipHiddenDays(i,-1,!0),r=i.clone();do{r.add(-1,"day"),this._view.isHiddenDay(r)||a++}while(a<n)}return new o.default(r,i)},t.prototype.buildCustomVisibleRange=function(t){var e=this._view.getUnzonedRangeOption("visibleRange",this._view.calendar.applyTimezone(t));return!e||null!=e.startMs&&null!=e.endMs?e:null},t.prototype.buildRenderRange=function(t,e,n){return t.clone()},t.prototype.buildDateIncrement=function(t){var e,n=this.opt("dateIncrement");return n?r.duration(n):(e=this.opt("dateAlignment"))?r.duration(1,e):t||r.duration({days:1})},t}();e.default=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(4),s=n(21),a=n(6),l=n(9),u=function(t){function e(e){var n=t.call(this,e)||this;return n.eventDefs=[],n}return r.__extends(e,t),e.parse=function(t,e){var n;return i.isArray(t.events)?n=t:i.isArray(t)&&(n={events:t}),!!n&&a.default.parse.call(this,n,e)},e.prototype.setRawEventDefs=function(t){this.rawEventDefs=t,this.eventDefs=this.parseEventDefs(t)},e.prototype.fetch=function(t,e,n){var r,i=this.eventDefs;if(null!=this.currentTimezone&&this.currentTimezone!==n)for(r=0;r<i.length;r++)i[r]instanceof l.default&&i[r].rezone();return this.currentTimezone=n,s.default.resolve(i)},e.prototype.addEventDef=function(t){this.eventDefs.push(t)},e.prototype.removeEventDefsById=function(t){return o.removeMatching(this.eventDefs,function(e){return e.id===t})},e.prototype.removeAllEventDefs=function(){this.eventDefs=[]},e.prototype.getPrimitive=function(){return this.rawEventDefs},e.prototype.applyManualStandardProps=function(e){var n=t.prototype.applyManualStandardProps.call(this,e);return this.setRawEventDefs(e.events),n},e}(a.default);e.default=u,u.defineStandardProps({events:!1})},function(t,e,n){function r(t,e){a[t]=e}function i(t){return t?!0===t?s.default:a[t]:o.default}Object.defineProperty(e,"__esModule",{value:!0});var o=n(221),s=n(222),a={};e.defineThemeSystem=r,e.getThemeSystemClass=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(4),o=function(){function t(t){this.isHorizontal=!1,this.isVertical=!1,this.els=r(t.els),this.isHorizontal=t.isHorizontal,this.isVertical=t.isVertical,this.forcedOffsetParentEl=t.offsetParent?r(t.offsetParent):null}return t.prototype.build=function(){var t=this.forcedOffsetParentEl;!t&&this.els.length>0&&(t=this.els.eq(0).offsetParent()),this.origin=t?t.offset():null,this.boundingRect=this.queryBoundingRect(),this.isHorizontal&&this.buildElHorizontals(),this.isVertical&&this.buildElVerticals()},t.prototype.clear=function(){this.origin=null,this.boundingRect=null,this.lefts=null,this.rights=null,this.tops=null,this.bottoms=null},t.prototype.ensureBuilt=function(){this.origin||this.build()},t.prototype.buildElHorizontals=function(){var t=[],e=[];this.els.each(function(n,i){var o=r(i),s=o.offset().left,a=o.outerWidth();t.push(s),e.push(s+a)}),this.lefts=t,this.rights=e},t.prototype.buildElVerticals=function(){var t=[],e=[];this.els.each(function(n,i){var o=r(i),s=o.offset().top,a=o.outerHeight();t.push(s),e.push(s+a)}),this.tops=t,this.bottoms=e},t.prototype.getHorizontalIndex=function(t){this.ensureBuilt();var e,n=this.lefts,r=this.rights,i=n.length;for(e=0;e<i;e++)if(t>=n[e]&&t<r[e])return e},t.prototype.getVerticalIndex=function(t){this.ensureBuilt();var e,n=this.tops,r=this.bottoms,i=n.length;for(e=0;e<i;e++)if(t>=n[e]&&t<r[e])return e},t.prototype.getLeftOffset=function(t){return this.ensureBuilt(),this.lefts[t]},t.prototype.getLeftPosition=function(t){return this.ensureBuilt(),this.lefts[t]-this.origin.left},t.prototype.getRightOffset=function(t){return this.ensureBuilt(),this.rights[t]},t.prototype.getRightPosition=function(t){return this.ensureBuilt(),this.rights[t]-this.origin.left},t.prototype.getWidth=function(t){return this.ensureBuilt(),this.rights[t]-this.lefts[t]},t.prototype.getTopOffset=function(t){return this.ensureBuilt(),this.tops[t]},t.prototype.getTopPosition=function(t){return this.ensureBuilt(),this.tops[t]-this.origin.top},t.prototype.getBottomOffset=function(t){return this.ensureBuilt(),this.bottoms[t]},t.prototype.getBottomPosition=function(t){return this.ensureBuilt(),this.bottoms[t]-this.origin.top},t.prototype.getHeight=function(t){return this.ensureBuilt(),this.bottoms[t]-this.tops[t]},t.prototype.queryBoundingRect=function(){var t;return this.els.length>0&&(t=i.getScrollParent(this.els.eq(0)),!t.is(document)&&!t.is("html,body"))?i.getClientRect(t):null},t.prototype.isPointInBounds=function(t,e){return this.isLeftInBounds(t)&&this.isTopInBounds(e)},t.prototype.isLeftInBounds=function(t){return!this.boundingRect||t>=this.boundingRect.left&&t<this.boundingRect.right},t.prototype.isTopInBounds=function(t){return!this.boundingRect||t>=this.boundingRect.top&&t<this.boundingRect.bottom},t}();e.default=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(4),o=n(7),s=n(23),a=function(){function t(t){this.isInteracting=!1,this.isDistanceSurpassed=!1,this.isDelayEnded=!1,this.isDragging=!1,this.isTouch=!1,this.isGeneric=!1,this.shouldCancelTouchScroll=!0,this.scrollAlwaysKills=!1,this.isAutoScroll=!1,this.scrollSensitivity=30,this.scrollSpeed=200,this.scrollIntervalMs=50,this.options=t||{}}return t.prototype.startInteraction=function(t,e){if(void 0===e&&(e={}),"mousedown"===t.type){if(s.default.get().shouldIgnoreMouse())return;if(!i.isPrimaryMouseButton(t))return;t.preventDefault()}this.isInteracting||(this.delay=i.firstDefined(e.delay,this.options.delay,0),this.minDistance=i.firstDefined(e.distance,this.options.distance,0),this.subjectEl=this.options.subjectEl,i.preventSelection(r("body")),this.isInteracting=!0,this.isTouch=i.getEvIsTouch(t),this.isGeneric="dragstart"===t.type,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,this.originX=i.getEvX(t),this.originY=i.getEvY(t),this.scrollEl=i.getScrollParent(r(t.target)),this.bindHandlers(),this.initAutoScroll(),this.handleInteractionStart(t),this.startDelay(t),this.minDistance||this.handleDistanceSurpassed(t))},t.prototype.handleInteractionStart=function(t){this.trigger("interactionStart",t)},t.prototype.endInteraction=function(t,e){this.isInteracting&&(this.endDrag(t),this.delayTimeoutId&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=null),this.destroyAutoScroll(),this.unbindHandlers(),this.isInteracting=!1,this.handleInteractionEnd(t,e),i.allowSelection(r("body")))},t.prototype.handleInteractionEnd=function(t,e){this.trigger("interactionEnd",t,e||!1)},t.prototype.bindHandlers=function(){var t=s.default.get();this.isGeneric?this.listenTo(r(document),{drag:this.handleMove,dragstop:this.endInteraction}):this.isTouch?this.listenTo(t,{touchmove:this.handleTouchMove,touchend:this.endInteraction,scroll:this.handleTouchScroll}):this.listenTo(t,{mousemove:this.handleMouseMove,mouseup:this.endInteraction}),this.listenTo(t,{selectstart:i.preventDefault,contextmenu:i.preventDefault})},t.prototype.unbindHandlers=function(){this.stopListeningTo(s.default.get()),this.stopListeningTo(r(document))},t.prototype.startDrag=function(t,e){this.startInteraction(t,e),this.isDragging||(this.isDragging=!0,this.handleDragStart(t))},t.prototype.handleDragStart=function(t){this.trigger("dragStart",t)},t.prototype.handleMove=function(t){var e=i.getEvX(t)-this.originX,n=i.getEvY(t)-this.originY,r=this.minDistance;this.isDistanceSurpassed||e*e+n*n>=r*r&&this.handleDistanceSurpassed(t),this.isDragging&&this.handleDrag(e,n,t)},t.prototype.handleDrag=function(t,e,n){this.trigger("drag",t,e,n),this.updateAutoScroll(n)},t.prototype.endDrag=function(t){this.isDragging&&(this.isDragging=!1,this.handleDragEnd(t))},t.prototype.handleDragEnd=function(t){this.trigger("dragEnd",t)},t.prototype.startDelay=function(t){var e=this;this.delay?this.delayTimeoutId=setTimeout(function(){e.handleDelayEnd(t)},this.delay):this.handleDelayEnd(t)},t.prototype.handleDelayEnd=function(t){this.isDelayEnded=!0,this.isDistanceSurpassed&&this.startDrag(t)},t.prototype.handleDistanceSurpassed=function(t){this.isDistanceSurpassed=!0,this.isDelayEnded&&this.startDrag(t)},t.prototype.handleTouchMove=function(t){this.isDragging&&this.shouldCancelTouchScroll&&t.preventDefault(),this.handleMove(t)},t.prototype.handleMouseMove=function(t){this.handleMove(t)},t.prototype.handleTouchScroll=function(t){this.isDragging&&!this.scrollAlwaysKills||this.endInteraction(t,!0)},t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.options[t]&&this.options[t].apply(this,e),this["_"+t]&&this["_"+t].apply(this,e)},t.prototype.initAutoScroll=function(){var t=this.scrollEl;this.isAutoScroll=this.options.scroll&&t&&!t.is(window)&&!t.is(document),this.isAutoScroll&&this.listenTo(t,"scroll",i.debounce(this.handleDebouncedScroll,100))},t.prototype.destroyAutoScroll=function(){this.endAutoScroll(),this.isAutoScroll&&this.stopListeningTo(this.scrollEl,"scroll")},t.prototype.computeScrollBounds=function(){this.isAutoScroll&&(this.scrollBounds=i.getOuterRect(this.scrollEl))},t.prototype.updateAutoScroll=function(t){var e,n,r,o,s=this.scrollSensitivity,a=this.scrollBounds,l=0,u=0;a&&(e=(s-(i.getEvY(t)-a.top))/s,n=(s-(a.bottom-i.getEvY(t)))/s,r=(s-(i.getEvX(t)-a.left))/s,o=(s-(a.right-i.getEvX(t)))/s,e>=0&&e<=1?l=e*this.scrollSpeed*-1:n>=0&&n<=1&&(l=n*this.scrollSpeed),r>=0&&r<=1?u=r*this.scrollSpeed*-1:o>=0&&o<=1&&(u=o*this.scrollSpeed)),this.setScrollVel(l,u)},t.prototype.setScrollVel=function(t,e){this.scrollTopVel=t,this.scrollLeftVel=e,this.constrainScrollVel(),!this.scrollTopVel&&!this.scrollLeftVel||this.scrollIntervalId||(this.scrollIntervalId=setInterval(i.proxy(this,"scrollIntervalFunc"),this.scrollIntervalMs))},t.prototype.constrainScrollVel=function(){var t=this.scrollEl;this.scrollTopVel<0?t.scrollTop()<=0&&(this.scrollTopVel=0):this.scrollTopVel>0&&t.scrollTop()+t[0].clientHeight>=t[0].scrollHeight&&(this.scrollTopVel=0),this.scrollLeftVel<0?t.scrollLeft()<=0&&(this.scrollLeftVel=0):this.scrollLeftVel>0&&t.scrollLeft()+t[0].clientWidth>=t[0].scrollWidth&&(this.scrollLeftVel=0)},t.prototype.scrollIntervalFunc=function(){var t=this.scrollEl,e=this.scrollIntervalMs/1e3;this.scrollTopVel&&t.scrollTop(t.scrollTop()+this.scrollTopVel*e),this.scrollLeftVel&&t.scrollLeft(t.scrollLeft()+this.scrollLeftVel*e),this.constrainScrollVel(),this.scrollTopVel||this.scrollLeftVel||this.endAutoScroll()},t.prototype.endAutoScroll=function(){this.scrollIntervalId&&(clearInterval(this.scrollIntervalId),this.scrollIntervalId=null,this.handleScrollEnd())},t.prototype.handleDebouncedScroll=function(){this.scrollIntervalId||this.handleScrollEnd()},t.prototype.handleScrollEnd=function(){},t}();e.default=a,o.default.mixInto(a)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(4),o=n(15),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.updateDayTable=function(){for(var t,e,n,r=this,i=r.view,o=i.calendar,s=o.msToUtcMoment(r.dateProfile.renderUnzonedRange.startMs,!0),a=o.msToUtcMoment(r.dateProfile.renderUnzonedRange.endMs,!0),l=-1,u=[],d=[];s.isBefore(a);)i.isHiddenDay(s)?u.push(l+.5):(l++,u.push(l),d.push(s.clone())),s.add(1,"days");if(this.breakOnWeeks){for(e=d[0].day(),t=1;t<d.length&&d[t].day()!==e;t++);n=Math.ceil(d.length/t)}else n=1,t=d.length;this.dayDates=d,this.dayIndices=u,this.daysPerRow=t,this.rowCnt=n,this.updateDayTableCols()},e.prototype.updateDayTableCols=function(){this.colCnt=this.computeColCnt(),this.colHeadFormat=this.opt("columnHeaderFormat")||this.opt("columnFormat")||this.computeColHeadFormat()},e.prototype.computeColCnt=function(){return this.daysPerRow},e.prototype.getCellDate=function(t,e){return this.dayDates[this.getCellDayIndex(t,e)].clone()},e.prototype.getCellRange=function(t,e){var n=this.getCellDate(t,e);return{start:n,end:n.clone().add(1,"days")}},e.prototype.getCellDayIndex=function(t,e){return t*this.daysPerRow+this.getColDayIndex(e)},e.prototype.getColDayIndex=function(t){return this.isRTL?this.colCnt-1-t:t},e.prototype.getDateDayIndex=function(t){var e=this.dayIndices,n=t.diff(this.dayDates[0],"days");return n<0?e[0]-1:n>=e.length?e[e.length-1]+1:e[n]},e.prototype.computeColHeadFormat=function(){return this.rowCnt>1||this.colCnt>10?"ddd":this.colCnt>1?this.opt("dayOfMonthFormat"):"dddd"},e.prototype.sliceRangeByRow=function(t){var e,n,r,i,o,s=this.daysPerRow,a=this.view.computeDayRange(t),l=this.getDateDayIndex(a.start),u=this.getDateDayIndex(a.end.clone().subtract(1,"days")),d=[];for(e=0;e<this.rowCnt;e++)n=e*s,r=n+s-1,i=Math.max(l,n),o=Math.min(u,r),i=Math.ceil(i),o=Math.floor(o),i<=o&&d.push({row:e,firstRowDayIndex:i-n,lastRowDayIndex:o-n,isStart:i===l,isEnd:o===u});return d},e.prototype.sliceRangeByDay=function(t){var e,n,r,i,o,s,a=this.daysPerRow,l=this.view.computeDayRange(t),u=this.getDateDayIndex(l.start),d=this.getDateDayIndex(l.end.clone().subtract(1,"days")),c=[];for(e=0;e<this.rowCnt;e++)for(n=e*a,r=n+a-1,i=n;i<=r;i++)o=Math.max(u,i),s=Math.min(d,i),o=Math.ceil(o),s=Math.floor(s),o<=s&&c.push({row:e,firstRowDayIndex:o-n,lastRowDayIndex:s-n,isStart:o===u,isEnd:s===d});return c},e.prototype.renderHeadHtml=function(){var t=this.view.calendar.theme;return'<div class="fc-row '+t.getClass("headerRow")+'"><table class="'+t.getClass("tableGrid")+'"><thead>'+this.renderHeadTrHtml()+"</thead></table></div>"},e.prototype.renderHeadIntroHtml=function(){return this.renderIntroHtml()},e.prototype.renderHeadTrHtml=function(){return"<tr>"+(this.isRTL?"":this.renderHeadIntroHtml())+this.renderHeadDateCellsHtml()+(this.isRTL?this.renderHeadIntroHtml():"")+"</tr>"},e.prototype.renderHeadDateCellsHtml=function(){var t,e,n=[];for(t=0;t<this.colCnt;t++)e=this.getCellDate(0,t),n.push(this.renderHeadDateCellHtml(e));return n.join("")},e.prototype.renderHeadDateCellHtml=function(t,e,n){var r,o=this,s=o.view,a=o.dateProfile.activeUnzonedRange.containsDate(t),l=["fc-day-header",s.calendar.theme.getClass("widgetHeader")];return r="function"==typeof o.opt("columnHeaderHtml")?o.opt("columnHeaderHtml")(t):"function"==typeof o.opt("columnHeaderText")?i.htmlEscape(o.opt("columnHeaderText")(t)):i.htmlEscape(t.format(o.colHeadFormat)),1===o.rowCnt?l=l.concat(o.getDayClasses(t,!0)):l.push("fc-"+i.dayIDs[t.day()]),'<th class="'+l.join(" ")+'"'+(1===(a&&o.rowCnt)?' data-date="'+t.format("YYYY-MM-DD")+'"':"")+(e>1?' colspan="'+e+'"':"")+(n?" "+n:"")+">"+(a?s.buildGotoAnchorHtml({date:t,forceOff:o.rowCnt>1||1===o.colCnt},r):r)+"</th>"},e.prototype.renderBgTrHtml=function(t){return"<tr>"+(this.isRTL?"":this.renderBgIntroHtml(t))+this.renderBgCellsHtml(t)+(this.isRTL?this.renderBgIntroHtml(t):"")+"</tr>"},e.prototype.renderBgIntroHtml=function(t){return this.renderIntroHtml()},e.prototype.renderBgCellsHtml=function(t){var e,n,r=[];for(e=0;e<this.colCnt;e++)n=this.getCellDate(t,e),r.push(this.renderBgCellHtml(n));return r.join("")},e.prototype.renderBgCellHtml=function(t,e){var n=this,r=n.view,i=n.dateProfile.activeUnzonedRange.containsDate(t),o=n.getDayClasses(t);return o.unshift("fc-day",r.calendar.theme.getClass("widgetContent")),'<td class="'+o.join(" ")+'"'+(i?' data-date="'+t.format("YYYY-MM-DD")+'"':"")+(e?" "+e:"")+"></td>"},e.prototype.renderIntroHtml=function(){},e.prototype.bookendCells=function(t){var e=this.renderIntroHtml();e&&(this.isRTL?t.append(e):t.prepend(e))},e}(o.default);e.default=s},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.component=t,this.fillRenderer=e}
return t.prototype.render=function(t){var e=this.component,n=e._getDateProfile().activeUnzonedRange,r=t.buildEventInstanceGroup(e.hasAllDayBusinessHours,n),i=r?e.eventRangesToEventFootprints(r.sliceRenderRanges(n)):[];this.renderEventFootprints(i)},t.prototype.renderEventFootprints=function(t){var e=this.component.eventFootprintsToSegs(t);this.renderSegs(e),this.segs=e},t.prototype.renderSegs=function(t){this.fillRenderer&&this.fillRenderer.renderSegs("businessHours",t,{getClasses:function(t){return["fc-nonbusiness","fc-bgevent"]}})},t.prototype.unrender=function(){this.fillRenderer&&this.fillRenderer.unrender("businessHours"),this.segs=null},t.prototype.getSegs=function(){return this.segs||[]},t}();e.default=n},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(4),o=function(){function t(t){this.fillSegTag="div",this.component=t,this.elsByFill={}}return t.prototype.renderFootprint=function(t,e,n){this.renderSegs(t,this.component.componentFootprintToSegs(e),n)},t.prototype.renderSegs=function(t,e,n){var r;return e=this.buildSegEls(t,e,n),r=this.attachSegEls(t,e),r&&this.reportEls(t,r),e},t.prototype.unrender=function(t){var e=this.elsByFill[t];e&&(e.remove(),delete this.elsByFill[t])},t.prototype.buildSegEls=function(t,e,n){var i,o=this,s="",a=[];if(e.length){for(i=0;i<e.length;i++)s+=this.buildSegHtml(t,e[i],n);r(s).each(function(t,i){var s=e[t],l=r(i);n.filterEl&&(l=n.filterEl(s,l)),l&&(l=r(l),l.is(o.fillSegTag)&&(s.el=l,a.push(s)))})}return a},t.prototype.buildSegHtml=function(t,e,n){var r=n.getClasses?n.getClasses(e):[],o=i.cssToStr(n.getCss?n.getCss(e):{});return"<"+this.fillSegTag+(r.length?' class="'+r.join(" ")+'"':"")+(o?' style="'+o+'"':"")+" />"},t.prototype.attachSegEls=function(t,e){},t.prototype.reportEls=function(t,e){this.elsByFill[t]?this.elsByFill[t]=this.elsByFill[t].add(e):this.elsByFill[t]=r(e)},t}();e.default=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),i=n(34),o=n(6),s=function(){function t(t,e){this.view=t._getView(),this.component=t,this.eventRenderer=e}return t.prototype.renderComponentFootprint=function(t){this.renderEventFootprints([this.fabricateEventFootprint(t)])},t.prototype.renderEventDraggingFootprints=function(t,e,n){this.renderEventFootprints(t,e,"fc-dragging",n?null:this.view.opt("dragOpacity"))},t.prototype.renderEventResizingFootprints=function(t,e,n){this.renderEventFootprints(t,e,"fc-resizing")},t.prototype.renderEventFootprints=function(t,e,n,r){var i,o=this.component.eventFootprintsToSegs(t),s="fc-helper "+(n||"");for(o=this.eventRenderer.renderFgSegEls(o),i=0;i<o.length;i++)o[i].el.addClass(s);if(null!=r)for(i=0;i<o.length;i++)o[i].el.css("opacity",r);this.helperEls=this.renderSegs(o,e)},t.prototype.renderSegs=function(t,e){},t.prototype.unrender=function(){this.helperEls&&(this.helperEls.remove(),this.helperEls=null)},t.prototype.fabricateEventFootprint=function(t){var e,n=this.view.calendar,s=n.footprintToDateProfile(t),a=new r.default(new o.default(n));return a.dateProfile=s,e=a.buildInstance(),new i.default(t,a,e)},t}();e.default=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(23),o=n(14),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.bindToEl=function(t){var e=this.component;e.bindSegHandlerToEl(t,"click",this.handleClick.bind(this)),e.bindSegHandlerToEl(t,"mouseenter",this.handleMouseover.bind(this)),e.bindSegHandlerToEl(t,"mouseleave",this.handleMouseout.bind(this))},e.prototype.handleClick=function(t,e){!1===this.component.publiclyTrigger("eventClick",{context:t.el[0],args:[t.footprint.getEventLegacy(),e,this.view]})&&e.preventDefault()},e.prototype.handleMouseover=function(t,e){i.default.get().shouldIgnoreMouse()||this.mousedOverSeg||(this.mousedOverSeg=t,this.view.isEventDefResizable(t.footprint.eventDef)&&t.el.addClass("fc-allow-mouse-resize"),this.component.publiclyTrigger("eventMouseover",{context:t.el[0],args:[t.footprint.getEventLegacy(),e,this.view]}))},e.prototype.handleMouseout=function(t,e){this.mousedOverSeg&&(this.mousedOverSeg=null,this.view.isEventDefResizable(t.footprint.eventDef)&&t.el.removeClass("fc-allow-mouse-resize"),this.component.publiclyTrigger("eventMouseout",{context:t.el[0],args:[t.footprint.getEventLegacy(),e||{},this.view]}))},e.prototype.end=function(){this.mousedOverSeg&&this.handleMouseout(this.mousedOverSeg)},e}(o.default);e.default=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(15),o=n(237),s=n(236),a=n(64),l=n(235),u=n(234),d=n(233),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);e.default=c,c.prototype.dateClickingClass=o.default,c.prototype.dateSelectingClass=s.default,c.prototype.eventPointingClass=a.default,c.prototype.eventDraggingClass=l.default,c.prototype.eventResizingClass=u.default,c.prototype.externalDroppingClass=d.default},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(4),s=n(58),a=n(227),l=n(5),u=n(12),d=n(34),c=n(61),p=n(65),h=n(42),f=n(60),g=n(243),v=n(244),y=n(245),m=function(t){function e(e){var n=t.call(this,e)||this;return n.cellWeekNumbersVisible=!1,n.bottomCoordPadding=0,n.isRigid=!1,n.hasAllDayBusinessHours=!0,n}return r.__extends(e,t),e.prototype.componentFootprintToSegs=function(t){var e,n,r=this.sliceRangeByRow(t.unzonedRange);for(e=0;e<r.length;e++)n=r[e],this.isRTL?(n.leftCol=this.daysPerRow-1-n.lastRowDayIndex,n.rightCol=this.daysPerRow-1-n.firstRowDayIndex):(n.leftCol=n.firstRowDayIndex,n.rightCol=n.lastRowDayIndex);return r},e.prototype.renderDates=function(t){this.dateProfile=t,this.updateDayTable(),this.renderGrid()},e.prototype.unrenderDates=function(){this.removeSegPopover()},e.prototype.renderGrid=function(){var t,e,n=this.view,r=this.rowCnt,i=this.colCnt,o="";for(this.headContainerEl&&this.headContainerEl.html(this.renderHeadHtml()),t=0;t<r;t++)o+=this.renderDayRowHtml(t,this.isRigid);for(this.el.html(o),this.rowEls=this.el.find(".fc-row"),this.cellEls=this.el.find(".fc-day, .fc-disabled-day"),this.rowCoordCache=new s.default({els:this.rowEls,isVertical:!0}),this.colCoordCache=new s.default({els:this.cellEls.slice(0,this.colCnt),isHorizontal:!0}),t=0;t<r;t++)for(e=0;e<i;e++)this.publiclyTrigger("dayRender",{context:n,args:[this.getCellDate(t,e),this.getCellEl(t,e),n]})},e.prototype.renderDayRowHtml=function(t,e){var n=this.view.calendar.theme,r=["fc-row","fc-week",n.getClass("dayRow")];return e&&r.push("fc-rigid"),'<div class="'+r.join(" ")+'"><div class="fc-bg"><table class="'+n.getClass("tableGrid")+'">'+this.renderBgTrHtml(t)+'</table></div><div class="fc-content-skeleton"><table>'+(this.getIsNumbersVisible()?"<thead>"+this.renderNumberTrHtml(t)+"</thead>":"")+"</table></div></div>"},e.prototype.getIsNumbersVisible=function(){return this.getIsDayNumbersVisible()||this.cellWeekNumbersVisible},e.prototype.getIsDayNumbersVisible=function(){return this.rowCnt>1},e.prototype.renderNumberTrHtml=function(t){return"<tr>"+(this.isRTL?"":this.renderNumberIntroHtml(t))+this.renderNumberCellsHtml(t)+(this.isRTL?this.renderNumberIntroHtml(t):"")+"</tr>"},e.prototype.renderNumberIntroHtml=function(t){return this.renderIntroHtml()},e.prototype.renderNumberCellsHtml=function(t){var e,n,r=[];for(e=0;e<this.colCnt;e++)n=this.getCellDate(t,e),r.push(this.renderNumberCellHtml(n));return r.join("")},e.prototype.renderNumberCellHtml=function(t){var e,n,r=this.view,i="",o=this.dateProfile.activeUnzonedRange.containsDate(t),s=this.getIsDayNumbersVisible()&&o;return s||this.cellWeekNumbersVisible?(e=this.getDayClasses(t),e.unshift("fc-day-top"),this.cellWeekNumbersVisible&&(n="ISO"===t._locale._fullCalendar_weekCalc?1:t._locale.firstDayOfWeek()),i+='<td class="'+e.join(" ")+'"'+(o?' data-date="'+t.format()+'"':"")+">",this.cellWeekNumbersVisible&&t.day()===n&&(i+=r.buildGotoAnchorHtml({date:t,type:"week"},{class:"fc-week-number"},t.format("w"))),s&&(i+=r.buildGotoAnchorHtml(t,{class:"fc-day-number"},t.format("D"))),i+="</td>"):"<td/>"},e.prototype.prepareHits=function(){this.colCoordCache.build(),this.rowCoordCache.build(),this.rowCoordCache.bottoms[this.rowCnt-1]+=this.bottomCoordPadding},e.prototype.releaseHits=function(){this.colCoordCache.clear(),this.rowCoordCache.clear()},e.prototype.queryHit=function(t,e){if(this.colCoordCache.isLeftInBounds(t)&&this.rowCoordCache.isTopInBounds(e)){var n=this.colCoordCache.getHorizontalIndex(t),r=this.rowCoordCache.getVerticalIndex(e);if(null!=r&&null!=n)return this.getCellHit(r,n)}},e.prototype.getHitFootprint=function(t){var e=this.getCellRange(t.row,t.col);return new u.default(new l.default(e.start,e.end),!0)},e.prototype.getHitEl=function(t){return this.getCellEl(t.row,t.col)},e.prototype.getCellHit=function(t,e){return{row:t,col:e,component:this,left:this.colCoordCache.getLeftOffset(e),right:this.colCoordCache.getRightOffset(e),top:this.rowCoordCache.getTopOffset(t),bottom:this.rowCoordCache.getBottomOffset(t)}},e.prototype.getCellEl=function(t,e){return this.cellEls.eq(t*this.colCnt+e)},e.prototype.executeEventUnrender=function(){this.removeSegPopover(),t.prototype.executeEventUnrender.call(this)},e.prototype.getOwnEventSegs=function(){return t.prototype.getOwnEventSegs.call(this).concat(this.popoverSegs||[])},e.prototype.renderDrag=function(t,e,n){var r;for(r=0;r<t.length;r++)this.renderHighlight(t[r].componentFootprint);if(t.length&&e&&e.component!==this)return this.helperRenderer.renderEventDraggingFootprints(t,e,n),!0},e.prototype.unrenderDrag=function(){this.unrenderHighlight(),this.helperRenderer.unrender()},e.prototype.renderEventResize=function(t,e,n){var r;for(r=0;r<t.length;r++)this.renderHighlight(t[r].componentFootprint);this.helperRenderer.renderEventResizingFootprints(t,e,n)},e.prototype.unrenderEventResize=function(){this.unrenderHighlight(),this.helperRenderer.unrender()},e.prototype.removeSegPopover=function(){this.segPopover&&this.segPopover.hide()},e.prototype.limitRows=function(t){var e,n,r=this.eventRenderer.rowStructs||[];for(e=0;e<r.length;e++)this.unlimitRow(e),!1!==(n=!!t&&("number"==typeof t?t:this.computeRowLevelLimit(e)))&&this.limitRow(e,n)},e.prototype.computeRowLevelLimit=function(t){function e(t,e){o=Math.max(o,i(e).outerHeight())}var n,r,o,s=this.rowEls.eq(t),a=s.height(),l=this.eventRenderer.rowStructs[t].tbodyEl.children();for(n=0;n<l.length;n++)if(r=l.eq(n).removeClass("fc-limited"),o=0,r.find("> td > :first-child").each(e),r.position().top+o>a)return n;return!1},e.prototype.limitRow=function(t,e){var n,r,o,s,a,l,u,d,c,p,h,f,g,v,y,m=this,b=this.eventRenderer.rowStructs[t],w=[],D=0,E=function(n){for(;D<n;)l=m.getCellSegs(t,D,e),l.length&&(c=r[e-1][D],y=m.renderMoreLink(t,D,l),v=i("<div/>").append(y),c.append(v),w.push(v[0])),D++};if(e&&e<b.segLevels.length){for(n=b.segLevels[e-1],r=b.cellMatrix,o=b.tbodyEl.children().slice(e).addClass("fc-limited").get(),s=0;s<n.length;s++){for(a=n[s],E(a.leftCol),d=[],u=0;D<=a.rightCol;)l=this.getCellSegs(t,D,e),d.push(l),u+=l.length,D++;if(u){for(c=r[e-1][a.leftCol],p=c.attr("rowspan")||1,h=[],f=0;f<d.length;f++)g=i('<td class="fc-more-cell"/>').attr("rowspan",p),l=d[f],y=this.renderMoreLink(t,a.leftCol+f,[a].concat(l)),v=i("<div/>").append(y),g.append(v),h.push(g[0]),w.push(g[0]);c.addClass("fc-limited").after(i(h)),o.push(c[0])}}E(this.colCnt),b.moreEls=i(w),b.limitedEls=i(o)}},e.prototype.unlimitRow=function(t){var e=this.eventRenderer.rowStructs[t];e.moreEls&&(e.moreEls.remove(),e.moreEls=null),e.limitedEls&&(e.limitedEls.removeClass("fc-limited"),e.limitedEls=null)},e.prototype.renderMoreLink=function(t,e,n){var r=this,o=this.view;return i('<a class="fc-more"/>').text(this.getMoreLinkText(n.length)).on("click",function(s){var a=r.opt("eventLimitClick"),l=r.getCellDate(t,e),u=i(s.currentTarget),d=r.getCellEl(t,e),c=r.getCellSegs(t,e),p=r.resliceDaySegs(c,l),h=r.resliceDaySegs(n,l);"function"==typeof a&&(a=r.publiclyTrigger("eventLimitClick",{context:o,args:[{date:l.clone(),dayEl:d,moreEl:u,segs:p,hiddenSegs:h},s,o]})),"popover"===a?r.showSegPopover(t,e,u,p):"string"==typeof a&&o.calendar.zoomTo(l,a)})},e.prototype.showSegPopover=function(t,e,n,r){var i,o,s=this,l=this.view,u=n.parent();i=1===this.rowCnt?l.el:this.rowEls.eq(t),o={className:"fc-more-popover "+l.calendar.theme.getClass("popover"),content:this.renderSegPopoverContent(t,e,r),parentEl:l.el,top:i.offset().top,autoHide:!0,viewportConstrain:this.opt("popoverViewportConstrain"),hide:function(){s.popoverSegs&&s.triggerBeforeEventSegsDestroyed(s.popoverSegs),s.segPopover.removeElement(),s.segPopover=null,s.popoverSegs=null}},this.isRTL?o.right=u.offset().left+u.outerWidth()+1:o.left=u.offset().left-1,this.segPopover=new a.default(o),this.segPopover.show(),this.bindAllSegHandlersToEl(this.segPopover.el),this.triggerAfterEventSegsRendered(r)},e.prototype.renderSegPopoverContent=function(t,e,n){var r,s=this.view,a=s.calendar.theme,l=this.getCellDate(t,e).format(this.opt("dayPopoverFormat")),u=i('<div class="fc-header '+a.getClass("popoverHeader")+'"><span class="fc-close '+a.getIconClass("close")+'"></span><span class="fc-title">'+o.htmlEscape(l)+'</span><div class="fc-clear"/></div><div class="fc-body '+a.getClass("popoverContent")+'"><div class="fc-event-container"></div></div>'),d=u.find(".fc-event-container");for(n=this.eventRenderer.renderFgSegEls(n,!0),this.popoverSegs=n,r=0;r<n.length;r++)this.hitsNeeded(),n[r].hit=this.getCellHit(t,e),this.hitsNotNeeded(),d.append(n[r].el);return u},e.prototype.resliceDaySegs=function(t,e){var n,r,o,s=e.clone(),a=s.clone().add(1,"days"),c=new l.default(s,a),p=[];for(n=0;n<t.length;n++)r=t[n],(o=r.footprint.componentFootprint.unzonedRange.intersect(c))&&p.push(i.extend({},r,{footprint:new d.default(new u.default(o,r.footprint.componentFootprint.isAllDay),r.footprint.eventDef,r.footprint.eventInstance),isStart:r.isStart&&o.isStart,isEnd:r.isEnd&&o.isEnd}));return this.eventRenderer.sortEventSegs(p),p},e.prototype.getMoreLinkText=function(t){var e=this.opt("eventLimitText");return"function"==typeof e?e(t):"+"+t+" "+e},e.prototype.getCellSegs=function(t,e,n){for(var r,i=this.eventRenderer.rowStructs[t].segMatrix,o=n||0,s=[];o<i.length;)r=i[o][e],r&&s.push(r),o++;return s},e}(h.default);e.default=m,m.prototype.eventRendererClass=g.default,m.prototype.businessHourRendererClass=c.default,m.prototype.helperRendererClass=v.default,m.prototype.fillRendererClass=y.default,p.default.mixInto(m),f.default.mixInto(m)},function(t,e,n){function r(t){return function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.colWeekNumbersVisible=!1,e}return i.__extends(e,t),e.prototype.renderHeadIntroHtml=function(){var t=this.view;return this.colWeekNumbersVisible?'<th class="fc-week-number '+t.calendar.theme.getClass("widgetHeader")+'" '+t.weekNumberStyleAttr()+"><span>"+s.htmlEscape(this.opt("weekNumberTitle"))+"</span></th>":""},e.prototype.renderNumberIntroHtml=function(t){var e=this.view,n=this.getCellDate(t,0);return this.colWeekNumbersVisible?'<td class="fc-week-number" '+e.weekNumberStyleAttr()+">"+e.buildGotoAnchorHtml({date:n,type:"week",forceOff:1===this.colCnt},n.format("w"))+"</td>":""},e.prototype.renderBgIntroHtml=function(){var t=this.view;return this.colWeekNumbersVisible?'<td class="fc-week-number '+t.calendar.theme.getClass("widgetContent")+'" '+t.weekNumberStyleAttr()+"></td>":""},e.prototype.renderIntroHtml=function(){var t=this.view;return this.colWeekNumbersVisible?'<td class="fc-week-number" '+t.weekNumberStyleAttr()+"></td>":""},e.prototype.getIsNumbersVisible=function(){return d.default.prototype.getIsNumbersVisible.apply(this,arguments)||this.colWeekNumbersVisible},e}(t)}Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=n(3),s=n(4),a=n(41),l=n(43),u=n(68),d=n(66),c=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.dayGrid=r.instantiateDayGrid(),r.dayGrid.isRigid=r.hasRigidRows(),r.opt("weekNumbers")&&(r.opt("weekNumbersWithinDays")?(r.dayGrid.cellWeekNumbersVisible=!0,r.dayGrid.colWeekNumbersVisible=!1):(r.dayGrid.cellWeekNumbersVisible=!1,r.dayGrid.colWeekNumbersVisible=!0)),r.addChild(r.dayGrid),r.scroller=new a.default({overflowX:"hidden",overflowY:"auto"}),r}return i.__extends(e,t),e.prototype.instantiateDayGrid=function(){return new(r(this.dayGridClass))(this)},e.prototype.executeDateRender=function(e){this.dayGrid.breakOnWeeks=/year|month|week/.test(e.currentRangeUnit),t.prototype.executeDateRender.call(this,e)},e.prototype.renderSkeleton=function(){var t,e;this.el.addClass("fc-basic-view").html(this.renderSkeletonHtml()),this.scroller.render(),t=this.scroller.el.addClass("fc-day-grid-container"),e=o('<div class="fc-day-grid" />').appendTo(t),this.el.find(".fc-body > tr > td").append(t),this.dayGrid.headContainerEl=this.el.find(".fc-head-container"),this.dayGrid.setElement(e)},e.prototype.unrenderSkeleton=function(){this.dayGrid.removeElement(),this.scroller.destroy()},e.prototype.renderSkeletonHtml=function(){var t=this.calendar.theme;return'<table class="'+t.getClass("tableGrid")+'">'+(this.opt("columnHeader")?'<thead class="fc-head"><tr><td class="fc-head-container '+t.getClass("widgetHeader")+'">&nbsp;</td></tr></thead>':"")+'<tbody class="fc-body"><tr><td class="'+t.getClass("widgetContent")+'"></td></tr></tbody></table>'},e.prototype.weekNumberStyleAttr=function(){return null!=this.weekNumberWidth?'style="width:'+this.weekNumberWidth+'px"':""},e.prototype.hasRigidRows=function(){var t=this.opt("eventLimit");return t&&"number"!=typeof t},e.prototype.updateSize=function(e,n,r){var i,o,a=this.opt("eventLimit"),l=this.dayGrid.headContainerEl.find(".fc-row");if(!this.dayGrid.rowEls)return void(n||(i=this.computeScrollerHeight(e),this.scroller.setHeight(i)));t.prototype.updateSize.call(this,e,n,r),this.dayGrid.colWeekNumbersVisible&&(this.weekNumberWidth=s.matchCellWidths(this.el.find(".fc-week-number"))),this.scroller.clear(),s.uncompensateScroll(l),this.dayGrid.removeSegPopover(),a&&"number"==typeof a&&this.dayGrid.limitRows(a),i=this.computeScrollerHeight(e),this.setGridHeight(i,n),a&&"number"!=typeof a&&this.dayGrid.limitRows(a),n||(this.scroller.setHeight(i),o=this.scroller.getScrollbarWidths(),(o.left||o.right)&&(s.compensateScroll(l,o),i=this.computeScrollerHeight(e),this.scroller.setHeight(i)),this.scroller.lockOverflow(o))},e.prototype.computeScrollerHeight=function(t){return t-s.subtractInnerElHeight(this.el,this.scroller.el)},e.prototype.setGridHeight=function(t,e){e?s.undistributeHeight(this.dayGrid.rowEls):s.distributeHeight(this.dayGrid.rowEls,t,!0)},e.prototype.computeInitialDateScroll=function(){return{top:0}},e.prototype.queryDateScroll=function(){return{top:this.scroller.getScrollTop()}},e.prototype.applyDateScroll=function(t){void 0!==t.top&&this.scroller.setScrollTop(t.top)},e}(l.default);e.default=c,c.prototype.dateProfileGeneratorClass=u.default,c.prototype.dayGridClass=d.default},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(5),o=n(55),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.buildRenderRange=function(e,n,r){var o=t.prototype.buildRenderRange.call(this,e,n,r),s=this.msToUtcMoment(o.startMs,r),a=this.msToUtcMoment(o.endMs,r);return/^(year|month)$/.test(n)&&(s.startOf("week"),a.weekday()&&a.add(1,"week").startOf("week")),new i.default(s,a)},e}(o.default);e.default=s},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){function r(t,e,n){var r;for(r=0;r<t.length;r++)if(!e(t[r].eventInstance.toLegacy(),n?n.toLegacy():null))return!1;return!0}function i(t,e){var n,r,i,o,s=e.toLegacy();for(n=0;n<t.length;n++){if(r=t[n].eventInstance,i=r.def,!1===(o=i.getOverlap()))return!1;if("function"==typeof o&&!o(r.toLegacy(),s))return!1}return!0}Object.defineProperty(e,"__esModule",{value:!0});var o=n(5),s=n(12),a=n(36),l=n(6),u=n(19),d=function(){function t(t,e){this.eventManager=t,this._calendar=e}return t.prototype.opt=function(t){return this._calendar.opt(t)},t.prototype.isEventInstanceGroupAllowed=function(t){var e,n=t.getEventDef(),r=this.eventRangesToEventFootprints(t.getAllEventRanges()),i=this.getPeerEventInstances(n),o=i.map(u.eventInstanceToEventRange),s=this.eventRangesToEventFootprints(o),a=n.getConstraint(),l=n.getOverlap(),d=this.opt("eventAllow");for(e=0;e<r.length;e++)if(!this.isFootprintAllowed(r[e].componentFootprint,s,a,l,r[e].eventInstance))return!1;if(d)for(e=0;e<r.length;e++)if(!1===d(r[e].componentFootprint.toLegacy(this._calendar),r[e].getEventLegacy()))return!1;return!0},t.prototype.getPeerEventInstances=function(t){return this.eventManager.getEventInstancesWithoutId(t.id)},t.prototype.isSelectionFootprintAllowed=function(t){var e,n=this.eventManager.getEventInstances(),r=n.map(u.eventInstanceToEventRange),i=this.eventRangesToEventFootprints(r);return!!this.isFootprintAllowed(t,i,this.opt("selectConstraint"),this.opt("selectOverlap"))&&(!(e=this.opt("selectAllow"))||!1!==e(t.toLegacy(this._calendar)))},t.prototype.isFootprintAllowed=function(t,e,n,o,s){var a,l;if(null!=n&&(a=this.constraintValToFootprints(n,t.isAllDay),!this.isFootprintWithinConstraints(t,a)))return!1;if(l=this.collectOverlapEventFootprints(e,t),!1===o){if(l.length)return!1}else if("function"==typeof o&&!r(l,o,s))return!1;return!(s&&!i(l,s))},t.prototype.isFootprintWithinConstraints=function(t,e){var n;for(n=0;n<e.length;n++)if(this.footprintContainsFootprint(e[n],t))return!0;return!1},t.prototype.constraintValToFootprints=function(t,e){var n;return"businessHours"===t?this.buildCurrentBusinessFootprints(e):"object"==typeof t?(n=this.parseEventDefToInstances(t),n?this.eventInstancesToFootprints(n):this.parseFootprints(t)):null!=t?(n=this.eventManager.getEventInstancesWithId(t),this.eventInstancesToFootprints(n)):void 0},t.prototype.buildCurrentBusinessFootprints=function(t){var e=this._calendar.view,n=e.get("businessHourGenerator"),r=e.dateProfile.activeUnzonedRange,i=n.buildEventInstanceGroup(t,r);return i?this.eventInstancesToFootprints(i.eventInstances):[]},t.prototype.eventInstancesToFootprints=function(t){var e=t.map(u.eventInstanceToEventRange);return this.eventRangesToEventFootprints(e).map(u.eventFootprintToComponentFootprint)},t.prototype.collectOverlapEventFootprints=function(t,e){var n,r=[];for(n=0;n<t.length;n++)this.footprintsIntersect(e,t[n].componentFootprint)&&r.push(t[n]);return r},t.prototype.parseEventDefToInstances=function(t){var e=this.eventManager,n=a.default.parse(t,new l.default(this._calendar));return!!n&&n.buildInstances(e.currentPeriod.unzonedRange)},t.prototype.eventRangesToEventFootprints=function(t){var e,n=[];for(e=0;e<t.length;e++)n.push.apply(n,this.eventRangeToEventFootprints(t[e]));return n},t.prototype.eventRangeToEventFootprints=function(t){return[u.eventRangeToEventFootprint(t)]},t.prototype.parseFootprints=function(t){var e,n;return t.start&&(e=this._calendar.moment(t.start),e.isValid()||(e=null)),t.end&&(n=this._calendar.moment(t.end),n.isValid()||(n=null)),[new s.default(new o.default(e,n),e&&!e.hasTime()||n&&!n.hasTime())]},t.prototype.footprintContainsFootprint=function(t,e){return t.unzonedRange.containsRange(e.unzonedRange)},t.prototype.footprintsIntersect=function(t,e){return t.unzonedRange.intersectsWith(e.unzonedRange)},t}();e.default=d},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(19),o=n(20),s=n(54),a=n(6),l={start:"09:00",end:"17:00",dow:[1,2,3,4,5],rendering:"inverse-background"},u=function(){function t(t,e){this.rawComplexDef=t,this.calendar=e}return t.prototype.buildEventInstanceGroup=function(t,e){var n,r=this.buildEventDefs(t);if(r.length)return n=new o.default(i.eventDefsToEventInstances(r,e)),n.explicitEventDef=r[0],n},t.prototype.buildEventDefs=function(t){var e,n=this.rawComplexDef,i=[],o=!1,s=[];for(!0===n?i=[{}]:r.isPlainObject(n)?i=[n]:r.isArray(n)&&(i=n,o=!0),e=0;e<i.length;e++)o&&!i[e].dow||s.push(this.buildEventDef(t,i[e]));return s},t.prototype.buildEventDef=function(t,e){var n=r.extend({},l,e);return t&&(n.start=null,n.end=null),s.default.parse(n,new a.default(this.calendar))},t}();e.default=u},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(4),o=n(21),s=n(13),a=n(5),l=n(20),u=function(){function t(t,e,n){this.pendingCnt=0,this.freezeDepth=0,this.stuntedReleaseCnt=0,this.releaseCnt=0,this.start=t,this.end=e,this.timezone=n,this.unzonedRange=new a.default(t.clone().stripZone(),e.clone().stripZone()),this.requestsByUid={},this.eventDefsByUid={},this.eventDefsById={},this.eventInstanceGroupsById={}}return t.prototype.isWithinRange=function(t,e){return!t.isBefore(this.start)&&!e.isAfter(this.end)},t.prototype.requestSources=function(t){this.freeze();for(var e=0;e<t.length;e++)this.requestSource(t[e]);this.thaw()},t.prototype.requestSource=function(t){var e=this,n={source:t,status:"pending",eventDefs:null};this.requestsByUid[t.uid]=n,this.pendingCnt+=1,t.fetch(this.start,this.end,this.timezone).then(function(t){"cancelled"!==n.status&&(n.status="completed",n.eventDefs=t,e.addEventDefs(t),e.pendingCnt--,e.tryRelease())},function(){"cancelled"!==n.status&&(n.status="failed",e.pendingCnt--,e.tryRelease())})},t.prototype.purgeSource=function(t){var e=this.requestsByUid[t.uid];e&&(delete this.requestsByUid[t.uid],"pending"===e.status?(e.status="cancelled",this.pendingCnt--,this.tryRelease()):"completed"===e.status&&e.eventDefs.forEach(this.removeEventDef.bind(this)))},t.prototype.purgeAllSources=function(){var t,e,n=this.requestsByUid,r=0;for(t in n)e=n[t],"pending"===e.status?e.status="cancelled":"completed"===e.status&&r++;this.requestsByUid={},this.pendingCnt=0,r&&this.removeAllEventDefs()},t.prototype.getEventDefByUid=function(t){return this.eventDefsByUid[t]},t.prototype.getEventDefsById=function(t){var e=this.eventDefsById[t];return e?e.slice():[]},t.prototype.addEventDefs=function(t){for(var e=0;e<t.length;e++)this.addEventDef(t[e])},t.prototype.addEventDef=function(t){var e,n=this.eventDefsById,r=t.id,i=n[r]||(n[r]=[]),o=t.buildInstances(this.unzonedRange);for(i.push(t),this.eventDefsByUid[t.uid]=t,e=0;e<o.length;e++)this.addEventInstance(o[e],r)},t.prototype.removeEventDefsById=function(t){var e=this;this.getEventDefsById(t).forEach(function(t){e.removeEventDef(t)})},t.prototype.removeAllEventDefs=function(){var t=r.isEmptyObject(this.eventDefsByUid);this.eventDefsByUid={},this.eventDefsById={},this.eventInstanceGroupsById={},t||this.tryRelease()},t.prototype.removeEventDef=function(t){var e=this.eventDefsById,n=e[t.id];delete this.eventDefsByUid[t.uid],n&&(i.removeExact(n,t),n.length||delete e[t.id],this.removeEventInstancesForDef(t))},t.prototype.getEventInstances=function(){var t,e=this.eventInstanceGroupsById,n=[];for(t in e)n.push.apply(n,e[t].eventInstances);return n},t.prototype.getEventInstancesWithId=function(t){var e=this.eventInstanceGroupsById[t];return e?e.eventInstances.slice():[]},t.prototype.getEventInstancesWithoutId=function(t){var e,n=this.eventInstanceGroupsById,r=[];for(e in n)e!==t&&r.push.apply(r,n[e].eventInstances);return r},t.prototype.addEventInstance=function(t,e){var n=this.eventInstanceGroupsById;(n[e]||(n[e]=new l.default)).eventInstances.push(t),this.tryRelease()},t.prototype.removeEventInstancesForDef=function(t){var e,n=this.eventInstanceGroupsById,r=n[t.id];r&&(e=i.removeMatching(r.eventInstances,function(e){return e.def===t}),r.eventInstances.length||delete n[t.id],e&&this.tryRelease())},t.prototype.tryRelease=function(){this.pendingCnt||(this.freezeDepth?this.stuntedReleaseCnt++:this.release())},t.prototype.release=function(){this.releaseCnt++,this.trigger("release",this.eventInstanceGroupsById)},t.prototype.whenReleased=function(){var t=this;return this.releaseCnt?o.default.resolve(this.eventInstanceGroupsById):o.default.construct(function(e){t.one("release",e)})},t.prototype.freeze=function(){this.freezeDepth++||(this.stuntedReleaseCnt=0)},t.prototype.thaw=function(){--this.freezeDepth||!this.stuntedReleaseCnt||this.pendingCnt||this.release()},t}();e.default=u,s.default.mixInto(u)},function(t,e,n){function r(t,e){return t.getPrimitive()===e.getPrimitive()}Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),o=n(4),s=n(219),a=n(56),l=n(6),u=n(38),d=n(9),c=n(20),p=n(13),h=n(7),f=function(){function t(t){this.calendar=t,this.stickySource=new a.default(t),this.otherSources=[]}return t.prototype.requestEvents=function(t,e,n,r){return!r&&this.currentPeriod&&this.currentPeriod.isWithinRange(t,e)&&n===this.currentPeriod.timezone||this.setPeriod(new s.default(t,e,n)),this.currentPeriod.whenReleased()},t.prototype.addSource=function(t){this.otherSources.push(t),this.currentPeriod&&this.currentPeriod.requestSource(t)},t.prototype.removeSource=function(t){o.removeExact(this.otherSources,t),this.currentPeriod&&this.currentPeriod.purgeSource(t)},t.prototype.removeAllSources=function(){this.otherSources=[],this.currentPeriod&&this.currentPeriod.purgeAllSources()},t.prototype.refetchSource=function(t){var e=this.currentPeriod;e&&(e.freeze(),e.purgeSource(t),e.requestSource(t),e.thaw())},t.prototype.refetchAllSources=function(){var t=this.currentPeriod;t&&(t.freeze(),t.purgeAllSources(),t.requestSources(this.getSources()),t.thaw())},t.prototype.getSources=function(){return[this.stickySource].concat(this.otherSources)},t.prototype.multiQuerySources=function(t){t?i.isArray(t)||(t=[t]):t=[];var e,n=[];for(e=0;e<t.length;e++)n.push.apply(n,this.querySources(t[e]));return n},t.prototype.querySources=function(t){var e,n,o=this.otherSources;for(e=0;e<o.length;e++)if((n=o[e])===t)return[n];return(n=this.getSourceById(l.default.normalizeId(t)))?[n]:(t=u.default.parse(t,this.calendar),t?i.grep(o,function(e){return r(t,e)}):void 0)},t.prototype.getSourceById=function(t){return i.grep(this.otherSources,function(e){return e.id&&e.id===t})[0]},t.prototype.setPeriod=function(t){this.currentPeriod&&(this.unbindPeriod(this.currentPeriod),this.currentPeriod=null),this.currentPeriod=t,this.bindPeriod(t),t.requestSources(this.getSources())},t.prototype.bindPeriod=function(t){this.listenTo(t,"release",function(t){this.trigger("release",t)})},t.prototype.unbindPeriod=function(t){this.stopListeningTo(t)},t.prototype.getEventDefByUid=function(t){if(this.currentPeriod)return this.currentPeriod.getEventDefByUid(t)},t.prototype.addEventDef=function(t,e){e&&this.stickySource.addEventDef(t),this.currentPeriod&&this.currentPeriod.addEventDef(t)},t.prototype.removeEventDefsById=function(t){this.getSources().forEach(function(e){e.removeEventDefsById(t)}),this.currentPeriod&&this.currentPeriod.removeEventDefsById(t)},t.prototype.removeAllEventDefs=function(){this.getSources().forEach(function(t){t.removeAllEventDefs()}),this.currentPeriod&&this.currentPeriod.removeAllEventDefs()},t.prototype.mutateEventsWithId=function(t,e){var n,r=this.currentPeriod,i=[];return r?(r.freeze(),n=r.getEventDefsById(t),n.forEach(function(t){r.removeEventDef(t),i.push(e.mutateSingle(t)),r.addEventDef(t)}),r.thaw(),function(){r.freeze();for(var t=0;t<n.length;t++)r.removeEventDef(n[t]),i[t](),r.addEventDef(n[t]);r.thaw()}):function(){}},t.prototype.buildMutatedEventInstanceGroup=function(t,e){var n,r,i=this.getEventDefsById(t),o=[];for(n=0;n<i.length;n++)(r=i[n].clone())instanceof d.default&&(e.mutateSingle(r),o.push.apply(o,r.buildInstances()));return new c.default(o)},t.prototype.freeze=function(){this.currentPeriod&&this.currentPeriod.freeze()},t.prototype.thaw=function(){this.currentPeriod&&this.currentPeriod.thaw()},t.prototype.getEventDefsById=function(t){return this.currentPeriod.getEventDefsById(t)},t.prototype.getEventInstances=function(){return this.currentPeriod.getEventInstances()},t.prototype.getEventInstancesWithId=function(t){return this.currentPeriod.getEventInstancesWithId(t)},t.prototype.getEventInstancesWithoutId=function(t){return this.currentPeriod.getEventInstancesWithoutId(t)},t
}();e.default=f,p.default.mixInto(f),h.default.mixInto(f)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(22),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);e.default=o,o.prototype.classes={widget:"fc-unthemed",widgetHeader:"fc-widget-header",widgetContent:"fc-widget-content",buttonGroup:"fc-button-group",button:"fc-button",cornerLeft:"fc-corner-left",cornerRight:"fc-corner-right",stateDefault:"fc-state-default",stateActive:"fc-state-active",stateDisabled:"fc-state-disabled",stateHover:"fc-state-hover",stateDown:"fc-state-down",popoverHeader:"fc-widget-header",popoverContent:"fc-widget-content",headerRow:"fc-widget-header",dayRow:"fc-widget-content",listView:"fc-widget-content"},o.prototype.baseIconClass="fc-icon",o.prototype.iconClasses={close:"fc-icon-x",prev:"fc-icon-left-single-arrow",next:"fc-icon-right-single-arrow",prevYear:"fc-icon-left-double-arrow",nextYear:"fc-icon-right-double-arrow"},o.prototype.iconOverrideOption="buttonIcons",o.prototype.iconOverrideCustomButtonOption="icon",o.prototype.iconOverridePrefix="fc-icon-"},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(22),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);e.default=o,o.prototype.classes={widget:"ui-widget",widgetHeader:"ui-widget-header",widgetContent:"ui-widget-content",buttonGroup:"fc-button-group",button:"ui-button",cornerLeft:"ui-corner-left",cornerRight:"ui-corner-right",stateDefault:"ui-state-default",stateActive:"ui-state-active",stateDisabled:"ui-state-disabled",stateHover:"ui-state-hover",stateDown:"ui-state-down",today:"ui-state-highlight",popoverHeader:"ui-widget-header",popoverContent:"ui-widget-content",headerRow:"ui-widget-header",dayRow:"ui-widget-content",listView:"ui-widget-content"},o.prototype.baseIconClass="ui-icon",o.prototype.iconClasses={close:"ui-icon-closethick",prev:"ui-icon-circle-triangle-w",next:"ui-icon-circle-triangle-e",prevYear:"ui-icon-seek-prev",nextYear:"ui-icon-seek-next"},o.prototype.iconOverrideOption="themeButtonIcons",o.prototype.iconOverrideCustomButtonOption="themeIcon",o.prototype.iconOverridePrefix="ui-icon-"},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(21),s=n(6),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.parse=function(t,e){var n;return i.isFunction(t.events)?n=t:i.isFunction(t)&&(n={events:t}),!!n&&s.default.parse.call(this,n,e)},e.prototype.fetch=function(t,e,n){var r=this;return this.calendar.pushLoading(),o.default.construct(function(i){r.func.call(r.calendar,t.clone(),e.clone(),n,function(t){r.calendar.popLoading(),i(r.parseEventDefs(t))})})},e.prototype.getPrimitive=function(){return this.func},e.prototype.applyManualStandardProps=function(e){var n=t.prototype.applyManualStandardProps.call(this,e);return this.func=e.events,n},e}(s.default);e.default=a,a.defineStandardProps({events:!1})},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(4),s=n(21),a=n(6),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.parse=function(t,e){var n;return"string"==typeof t.url?n=t:"string"==typeof t&&(n={url:t}),!!n&&a.default.parse.call(this,n,e)},e.prototype.fetch=function(t,n,r){var a=this,l=this.ajaxSettings,u=l.success,d=l.error,c=this.buildRequestParams(t,n,r);return this.calendar.pushLoading(),s.default.construct(function(t,n){i.ajax(i.extend({},e.AJAX_DEFAULTS,l,{url:a.url,data:c,success:function(e,r,s){var l;a.calendar.popLoading(),e?(l=o.applyAll(u,a,[e,r,s]),i.isArray(l)&&(e=l),t(a.parseEventDefs(e))):n()},error:function(t,e,r){a.calendar.popLoading(),o.applyAll(d,a,[t,e,r]),n()}}))})},e.prototype.buildRequestParams=function(t,e,n){var r,o,s,a,l=this.calendar,u=this.ajaxSettings,d={};return r=this.startParam,null==r&&(r=l.opt("startParam")),o=this.endParam,null==o&&(o=l.opt("endParam")),s=this.timezoneParam,null==s&&(s=l.opt("timezoneParam")),a=i.isFunction(u.data)?u.data():u.data||{},i.extend(d,a),d[r]=t.format(),d[o]=e.format(),n&&"local"!==n&&(d[s]=n),d},e.prototype.getPrimitive=function(){return this.url},e.prototype.applyMiscProps=function(t){this.ajaxSettings=t},e.AJAX_DEFAULTS={dataType:"json",cache:!1},e}(a.default);e.default=l,l.defineStandardProps({url:!0,startParam:!0,endParam:!0,timezoneParam:!0})},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.items=t||[]}return t.prototype.proxyCall=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=[];return this.items.forEach(function(n){r.push(n[t].apply(n,e))}),r},t}();e.default=n},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(4),o=n(7),s=function(){function t(t,e){this.isFollowing=!1,this.isHidden=!1,this.isAnimating=!1,this.options=e=e||{},this.sourceEl=t,this.parentEl=e.parentEl?r(e.parentEl):t.parent()}return t.prototype.start=function(t){this.isFollowing||(this.isFollowing=!0,this.y0=i.getEvY(t),this.x0=i.getEvX(t),this.topDelta=0,this.leftDelta=0,this.isHidden||this.updatePosition(),i.getEvIsTouch(t)?this.listenTo(r(document),"touchmove",this.handleMove):this.listenTo(r(document),"mousemove",this.handleMove))},t.prototype.stop=function(t,e){var n=this,i=this.options.revertDuration,o=function(){n.isAnimating=!1,n.removeElement(),n.top0=n.left0=null,e&&e()};this.isFollowing&&!this.isAnimating&&(this.isFollowing=!1,this.stopListeningTo(r(document)),t&&i&&!this.isHidden?(this.isAnimating=!0,this.el.animate({top:this.top0,left:this.left0},{duration:i,complete:o})):o())},t.prototype.getEl=function(){var t=this.el;return t||(t=this.el=this.sourceEl.clone().addClass(this.options.additionalClass||"").css({position:"absolute",visibility:"",display:this.isHidden?"none":"",margin:0,right:"auto",bottom:"auto",width:this.sourceEl.width(),height:this.sourceEl.height(),opacity:this.options.opacity||"",zIndex:this.options.zIndex}),t.addClass("fc-unselectable"),t.appendTo(this.parentEl)),t},t.prototype.removeElement=function(){this.el&&(this.el.remove(),this.el=null)},t.prototype.updatePosition=function(){var t,e;this.getEl(),null==this.top0&&(t=this.sourceEl.offset(),e=this.el.offsetParent().offset(),this.top0=t.top-e.top,this.left0=t.left-e.left),this.el.css({top:this.top0+this.topDelta,left:this.left0+this.leftDelta})},t.prototype.handleMove=function(t){this.topDelta=i.getEvY(t)-this.y0,this.leftDelta=i.getEvX(t)-this.x0,this.isHidden||this.updatePosition()},t.prototype.hide=function(){this.isHidden||(this.isHidden=!0,this.el&&this.el.hide())},t.prototype.show=function(){this.isHidden&&(this.isHidden=!1,this.updatePosition(),this.getEl().show())},t}();e.default=s,o.default.mixInto(s)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(4),o=n(7),s=function(){function t(t){this.isHidden=!0,this.margin=10,this.options=t||{}}return t.prototype.show=function(){this.isHidden&&(this.el||this.render(),this.el.show(),this.position(),this.isHidden=!1,this.trigger("show"))},t.prototype.hide=function(){this.isHidden||(this.el.hide(),this.isHidden=!0,this.trigger("hide"))},t.prototype.render=function(){var t=this,e=this.options;this.el=r('<div class="fc-popover"/>').addClass(e.className||"").css({top:0,left:0}).append(e.content).appendTo(e.parentEl),this.el.on("click",".fc-close",function(){t.hide()}),e.autoHide&&this.listenTo(r(document),"mousedown",this.documentMousedown)},t.prototype.documentMousedown=function(t){this.el&&!r(t.target).closest(this.el).length&&this.hide()},t.prototype.removeElement=function(){this.hide(),this.el&&(this.el.remove(),this.el=null),this.stopListeningTo(r(document),"mousedown")},t.prototype.position=function(){var t,e,n,o,s,a=this.options,l=this.el.offsetParent().offset(),u=this.el.outerWidth(),d=this.el.outerHeight(),c=r(window),p=i.getScrollParent(this.el);o=a.top||0,s=void 0!==a.left?a.left:void 0!==a.right?a.right-u:0,p.is(window)||p.is(document)?(p=c,t=0,e=0):(n=p.offset(),t=n.top,e=n.left),t+=c.scrollTop(),e+=c.scrollLeft(),!1!==a.viewportConstrain&&(o=Math.min(o,t+p.outerHeight()-d-this.margin),o=Math.max(o,t+this.margin),s=Math.min(s,e+p.outerWidth()-u-this.margin),s=Math.max(s,e+this.margin)),this.el.css({top:o-l.top,left:s-l.left})},t.prototype.trigger=function(t){this.options[t]&&this.options[t].apply(this,Array.prototype.slice.call(arguments,1))},t}();e.default=s,o.default.mixInto(s)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(13),i=function(){function t(){this.q=[],this.isPaused=!1,this.isRunning=!1}return t.prototype.queue=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.q.push.apply(this.q,t),this.tryStart()},t.prototype.pause=function(){this.isPaused=!0},t.prototype.resume=function(){this.isPaused=!1,this.tryStart()},t.prototype.getIsIdle=function(){return!this.isRunning&&!this.isPaused},t.prototype.tryStart=function(){!this.isRunning&&this.canRunNext()&&(this.isRunning=!0,this.trigger("start"),this.runRemaining())},t.prototype.canRunNext=function(){return!this.isPaused&&this.q.length},t.prototype.runRemaining=function(){var t,e,n=this;do{if(t=this.q.shift(),(e=this.runTask(t))&&e.then)return void e.then(function(){n.canRunNext()&&n.runRemaining()})}while(this.canRunNext());this.trigger("stop"),this.isRunning=!1,this.tryStart()},t.prototype.runTask=function(t){return t()},t}();e.default=i,r.default.mixInto(i)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(228),o=function(t){function e(e){var n=t.call(this)||this;return n.waitsByNamespace=e||{},n}return r.__extends(e,t),e.prototype.queue=function(t,e,n){var r,i={func:t,namespace:e,type:n};e&&(r=this.waitsByNamespace[e]),this.waitNamespace&&(e===this.waitNamespace&&null!=r?this.delayWait(r):(this.clearWait(),this.tryStart())),this.compoundTask(i)&&(this.waitNamespace||null==r?this.tryStart():this.startWait(e,r))},e.prototype.startWait=function(t,e){this.waitNamespace=t,this.spawnWait(e)},e.prototype.delayWait=function(t){clearTimeout(this.waitId),this.spawnWait(t)},e.prototype.spawnWait=function(t){var e=this;this.waitId=setTimeout(function(){e.waitNamespace=null,e.tryStart()},t)},e.prototype.clearWait=function(){this.waitNamespace&&(clearTimeout(this.waitId),this.waitId=null,this.waitNamespace=null)},e.prototype.canRunNext=function(){if(!t.prototype.canRunNext.call(this))return!1;if(this.waitNamespace){for(var e=this.q,n=0;n<e.length;n++)if(e[n].namespace!==this.waitNamespace)return!0;return!1}return!0},e.prototype.runTask=function(t){t.func()},e.prototype.compoundTask=function(t){var e,n,r=this.q,i=!0;if(t.namespace&&"destroy"===t.type)for(e=r.length-1;e>=0;e--)if(n=r[e],n.namespace===t.namespace)switch(n.type){case"init":i=!1;case"add":case"remove":r.splice(e,1)}return i&&r.push(t),i},e}(i.default);e.default=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(51),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.setElement=function(t){this.el=t,this.bindGlobalHandlers(),this.renderSkeleton(),this.set("isInDom",!0)},e.prototype.removeElement=function(){this.unset("isInDom"),this.unrenderSkeleton(),this.unbindGlobalHandlers(),this.el.remove()},e.prototype.bindGlobalHandlers=function(){},e.prototype.unbindGlobalHandlers=function(){},e.prototype.renderSkeleton=function(){},e.prototype.unrenderSkeleton=function(){},e}(i.default);e.default=o},function(t,e,n){function r(t){var e,n,r,i=[];for(e in t)for(n=t[e].eventInstances,r=0;r<n.length;r++)i.push(n[r].toLegacy());return i}Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=n(3),s=n(0),a=n(4),l=n(11),u=n(49),d=n(230),c=n(19),p=function(t){function e(n,r){var i=t.call(this)||this;return i.isRTL=!1,i.hitsNeededDepth=0,i.hasAllDayBusinessHours=!1,i.isDatesRendered=!1,n&&(i.view=n),r&&(i.options=r),i.uid=String(e.guid++),i.childrenByUid={},i.nextDayThreshold=s.duration(i.opt("nextDayThreshold")),i.isRTL=i.opt("isRTL"),i.fillRendererClass&&(i.fillRenderer=new i.fillRendererClass(i)),i.eventRendererClass&&(i.eventRenderer=new i.eventRendererClass(i,i.fillRenderer)),i.helperRendererClass&&i.eventRenderer&&(i.helperRenderer=new i.helperRendererClass(i,i.eventRenderer)),i.businessHourRendererClass&&i.fillRenderer&&(i.businessHourRenderer=new i.businessHourRendererClass(i,i.fillRenderer)),i}return i.__extends(e,t),e.prototype.addChild=function(t){return!this.childrenByUid[t.uid]&&(this.childrenByUid[t.uid]=t,!0)},e.prototype.removeChild=function(t){return!!this.childrenByUid[t.uid]&&(delete this.childrenByUid[t.uid],!0)},e.prototype.updateSize=function(t,e,n){this.callChildren("updateSize",arguments)},e.prototype.opt=function(t){return this._getView().opt(t)},e.prototype.publiclyTrigger=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getCalendar();return n.publiclyTrigger.apply(n,t)},e.prototype.hasPublicHandlers=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getCalendar();return n.hasPublicHandlers.apply(n,t)},e.prototype.executeDateRender=function(t){this.dateProfile=t,this.renderDates(t),this.isDatesRendered=!0,this.callChildren("executeDateRender",arguments)},e.prototype.executeDateUnrender=function(){this.callChildren("executeDateUnrender",arguments),this.dateProfile=null,this.unrenderDates(),this.isDatesRendered=!1},e.prototype.renderDates=function(t){},e.prototype.unrenderDates=function(){},e.prototype.getNowIndicatorUnit=function(){},e.prototype.renderNowIndicator=function(t){this.callChildren("renderNowIndicator",arguments)},e.prototype.unrenderNowIndicator=function(){this.callChildren("unrenderNowIndicator",arguments)},e.prototype.renderBusinessHours=function(t){this.businessHourRenderer&&this.businessHourRenderer.render(t),this.callChildren("renderBusinessHours",arguments)},e.prototype.unrenderBusinessHours=function(){this.callChildren("unrenderBusinessHours",arguments),this.businessHourRenderer&&this.businessHourRenderer.unrender()},e.prototype.executeEventRender=function(t){this.eventRenderer?(this.eventRenderer.rangeUpdated(),this.eventRenderer.render(t)):this.renderEvents&&this.renderEvents(r(t)),this.callChildren("executeEventRender",arguments)},e.prototype.executeEventUnrender=function(){this.callChildren("executeEventUnrender",arguments),this.eventRenderer?this.eventRenderer.unrender():this.destroyEvents&&this.destroyEvents()},e.prototype.getBusinessHourSegs=function(){var t=this.getOwnBusinessHourSegs();return this.iterChildren(function(e){t.push.apply(t,e.getBusinessHourSegs())}),t},e.prototype.getOwnBusinessHourSegs=function(){return this.businessHourRenderer?this.businessHourRenderer.getSegs():[]},e.prototype.getEventSegs=function(){var t=this.getOwnEventSegs();return this.iterChildren(function(e){t.push.apply(t,e.getEventSegs())}),t},e.prototype.getOwnEventSegs=function(){return this.eventRenderer?this.eventRenderer.getSegs():[]},e.prototype.triggerAfterEventsRendered=function(){this.triggerAfterEventSegsRendered(this.getEventSegs()),this.publiclyTrigger("eventAfterAllRender",{context:this,args:[this]})},e.prototype.triggerAfterEventSegsRendered=function(t){var e=this;this.hasPublicHandlers("eventAfterRender")&&t.forEach(function(t){var n;t.el&&(n=t.footprint.getEventLegacy(),e.publiclyTrigger("eventAfterRender",{context:n,args:[n,t.el,e]}))})},e.prototype.triggerBeforeEventsDestroyed=function(){this.triggerBeforeEventSegsDestroyed(this.getEventSegs())},e.prototype.triggerBeforeEventSegsDestroyed=function(t){var e=this;this.hasPublicHandlers("eventDestroy")&&t.forEach(function(t){var n;t.el&&(n=t.footprint.getEventLegacy(),e.publiclyTrigger("eventDestroy",{context:n,args:[n,t.el,e]}))})},e.prototype.showEventsWithId=function(t){this.getEventSegs().forEach(function(e){e.footprint.eventDef.id===t&&e.el&&e.el.css("visibility","")}),this.callChildren("showEventsWithId",arguments)},e.prototype.hideEventsWithId=function(t){this.getEventSegs().forEach(function(e){e.footprint.eventDef.id===t&&e.el&&e.el.css("visibility","hidden")}),this.callChildren("hideEventsWithId",arguments)},e.prototype.renderDrag=function(t,e,n){var r=!1;return this.iterChildren(function(i){i.renderDrag(t,e,n)&&(r=!0)}),r},e.prototype.unrenderDrag=function(){this.callChildren("unrenderDrag",arguments)},e.prototype.renderEventResize=function(t,e,n){this.callChildren("renderEventResize",arguments)},e.prototype.unrenderEventResize=function(){this.callChildren("unrenderEventResize",arguments)},e.prototype.renderSelectionFootprint=function(t){this.renderHighlight(t),this.callChildren("renderSelectionFootprint",arguments)},e.prototype.unrenderSelection=function(){this.unrenderHighlight(),this.callChildren("unrenderSelection",arguments)},e.prototype.renderHighlight=function(t){this.fillRenderer&&this.fillRenderer.renderFootprint("highlight",t,{getClasses:function(){return["fc-highlight"]}}),this.callChildren("renderHighlight",arguments)},e.prototype.unrenderHighlight=function(){this.fillRenderer&&this.fillRenderer.unrender("highlight"),this.callChildren("unrenderHighlight",arguments)},e.prototype.hitsNeeded=function(){this.hitsNeededDepth++||this.prepareHits(),this.callChildren("hitsNeeded",arguments)},e.prototype.hitsNotNeeded=function(){this.hitsNeededDepth&&!--this.hitsNeededDepth&&this.releaseHits(),this.callChildren("hitsNotNeeded",arguments)},e.prototype.prepareHits=function(){},e.prototype.releaseHits=function(){},e.prototype.queryHit=function(t,e){var n,r,i=this.childrenByUid;for(n in i)if(r=i[n].queryHit(t,e))break;return r},e.prototype.getSafeHitFootprint=function(t){var e=this.getHitFootprint(t);return this.dateProfile.activeUnzonedRange.containsRange(e.unzonedRange)?e:null},e.prototype.getHitFootprint=function(t){},e.prototype.getHitEl=function(t){},e.prototype.eventRangesToEventFootprints=function(t){var e,n=[];for(e=0;e<t.length;e++)n.push.apply(n,this.eventRangeToEventFootprints(t[e]));return n},e.prototype.eventRangeToEventFootprints=function(t){return[c.eventRangeToEventFootprint(t)]},e.prototype.eventFootprintsToSegs=function(t){var e,n=[];for(e=0;e<t.length;e++)n.push.apply(n,this.eventFootprintToSegs(t[e]));return n},e.prototype.eventFootprintToSegs=function(t){var e,n,r,i=t.componentFootprint.unzonedRange;for(e=this.componentFootprintToSegs(t.componentFootprint),n=0;n<e.length;n++)r=e[n],i.isStart||(r.isStart=!1),i.isEnd||(r.isEnd=!1),r.footprint=t;return e},e.prototype.componentFootprintToSegs=function(t){return[]},e.prototype.callChildren=function(t,e){this.iterChildren(function(n){n[t].apply(n,e)})},e.prototype.iterChildren=function(t){var e,n=this.childrenByUid;for(e in n)t(n[e])},e.prototype._getCalendar=function(){var t=this;return t.calendar||t.view.calendar},e.prototype._getView=function(){return this.view},e.prototype._getDateProfile=function(){return this._getView().get("dateProfile")},e.prototype.buildGotoAnchorHtml=function(t,e,n){var r,i,s,u;return o.isPlainObject(t)?(r=t.date,i=t.type,s=t.forceOff):r=t,r=l.default(r),u={date:r.format("YYYY-MM-DD"),type:i||"day"},"string"==typeof e&&(n=e,e=null),e=e?" "+a.attrsToStr(e):"",n=n||"",!s&&this.opt("navLinks")?"<a"+e+' data-goto="'+a.htmlEscape(JSON.stringify(u))+'">'+n+"</a>":"<span"+e+">"+n+"</span>"},e.prototype.getAllDayHtml=function(){return this.opt("allDayHtml")||a.htmlEscape(this.opt("allDayText"))},e.prototype.getDayClasses=function(t,e){var n,r=this._getView(),i=[];return this.dateProfile.activeUnzonedRange.containsDate(t)?(i.push("fc-"+a.dayIDs[t.day()]),r.isDateInOtherMonth(t,this.dateProfile)&&i.push("fc-other-month"),n=r.calendar.getNow(),t.isSame(n,"day")?(i.push("fc-today"),!0!==e&&i.push(r.calendar.theme.getClass("today"))):t<n?i.push("fc-past"):i.push("fc-future")):i.push("fc-disabled-day"),i},e.prototype.formatRange=function(t,e,n,r){var i=t.end;return e&&(i=i.clone().subtract(1)),u.formatRange(t.start,i,n,r,this.isRTL)},e.prototype.currentRangeAs=function(t){return this._getDateProfile().currentUnzonedRange.as(t)},e.prototype.computeDayRange=function(t){var e=this._getCalendar(),n=e.msToUtcMoment(t.startMs,!0),r=e.msToUtcMoment(t.endMs),i=+r.time(),o=r.clone().stripTime();return i&&i>=this.nextDayThreshold&&o.add(1,"days"),o<=n&&(o=n.clone().add(1,"days")),{start:n,end:o}},e.prototype.isMultiDayRange=function(t){var e=this.computeDayRange(t);return e.end.diff(e.start,"days")>1},e.guid=0,e}(d.default);e.default=p},function(t,e,n){function r(t,e){return null==e?t:i.isFunction(e)?t.filter(e):(e+="",t.filter(function(t){return t.id==e||t._id===e}))}Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),o=n(0),s=n(4),a=n(33),l=n(225),u=n(23),d=n(13),c=n(7),p=n(257),h=n(258),f=n(259),g=n(217),v=n(32),y=n(11),m=n(5),b=n(12),w=n(16),D=n(220),E=n(218),S=n(38),C=n(36),R=n(9),T=n(39),M=n(6),I=n(57),H=function(){function t(t,e){this.loadingLevel=0,this.ignoreUpdateViewSize=0,this.freezeContentHeightDepth=0,u.default.needed(),this.el=t,this.viewsByType={},this.optionsManager=new h.default(this,e),this.viewSpecManager=new f.default(this.optionsManager,this),this.initMomentInternals(),this.initCurrentDate(),this.initEventManager(),this.constraints=new g.default(this.eventManager,this),this.constructed()}return t.prototype.constructed=function(){},t.prototype.getView=function(){return this.view},t.prototype.publiclyTrigger=function(t,e){var n,r,o=this.opt(t);if(i.isPlainObject(e)?(n=e.context,r=e.args):i.isArray(e)&&(r=e),null==n&&(n=this.el[0]),r||(r=[]),this.triggerWith(t,n,r),o)return o.apply(n,r)},t.prototype.hasPublicHandlers=function(t){return this.hasHandlers(t)||this.opt(t)},t.prototype.option=function(t,e){var n;if("string"==typeof t){if(void 0===e)return this.optionsManager.get(t);n={},n[t]=e,this.optionsManager.add(n)}else"object"==typeof t&&this.optionsManager.add(t)},t.prototype.opt=function(t){return this.optionsManager.get(t)},t.prototype.instantiateView=function(t){var e=this.viewSpecManager.getViewSpec(t);if(!e)throw new Error('View type "'+t+'" is not valid');return new e.class(this,e)},t.prototype.isValidViewType=function(t){return Boolean(this.viewSpecManager.getViewSpec(t))},t.prototype.changeView=function(t,e){e&&(e.start&&e.end?this.optionsManager.recordOverrides({visibleRange:e}):this.currentDate=this.moment(e).stripZone()),this.renderView(t)},t.prototype.zoomTo=function(t,e){var n;e=e||"day",n=this.viewSpecManager.getViewSpec(e)||this.viewSpecManager.getUnitViewSpec(e),this.currentDate=t.clone(),this.renderView(n?n.type:null)},t.prototype.initCurrentDate=function(){var t=this.opt("defaultDate");this.currentDate=null!=t?this.moment(t).stripZone():this.getNow()},t.prototype.prev=function(){var t=this.view,e=t.dateProfileGenerator.buildPrev(t.get("dateProfile"));e.isValid&&(this.currentDate=e.date,this.renderView())},t.prototype.next=function(){var t=this.view,e=t.dateProfileGenerator.buildNext(t.get("dateProfile"));e.isValid&&(this.currentDate=e.date,this.renderView())},t.prototype.prevYear=function(){this.currentDate.add(-1,"years"),this.renderView()},t.prototype.nextYear=function(){this.currentDate.add(1,"years"),this.renderView()},t.prototype.today=function(){this.currentDate=this.getNow(),this.renderView()},t.prototype.gotoDate=function(t){this.currentDate=this.moment(t).stripZone(),this.renderView()},t.prototype.incrementDate=function(t){this.currentDate.add(o.duration(t)),this.renderView()},t.prototype.getDate=function(){return this.applyTimezone(this.currentDate)},t.prototype.pushLoading=function(){this.loadingLevel++||this.publiclyTrigger("loading",[!0,this.view])},t.prototype.popLoading=function(){--this.loadingLevel||this.publiclyTrigger("loading",[!1,this.view])},t.prototype.render=function(){this.contentEl?this.elementVisible()&&(this.calcSize(),this.updateViewSize()):this.initialRender()},t.prototype.initialRender=function(){var t=this,e=this.el;e.addClass("fc"),e.on("click.fc","a[data-goto]",function(e){var n=i(e.currentTarget),r=n.data("goto"),o=t.moment(r.date),a=r.type,l=t.view.opt("navLink"+s.capitaliseFirstLetter(a)+"Click");"function"==typeof l?l(o,e):("string"==typeof l&&(a=l),t.zoomTo(o,a))}),this.optionsManager.watch("settingTheme",["?theme","?themeSystem"],function(n){var r=I.getThemeSystemClass(n.themeSystem||n.theme),i=new r(t.optionsManager),o=i.getClass("widget");t.theme=i,o&&e.addClass(o)},function(){var n=t.theme.getClass("widget");t.theme=null,n&&e.removeClass(n)}),this.optionsManager.watch("settingBusinessHourGenerator",["?businessHours"],function(e){t.businessHourGenerator=new E.default(e.businessHours,t),t.view&&t.view.set("businessHourGenerator",t.businessHourGenerator)},function(){t.businessHourGenerator=null}),this.optionsManager.watch("applyingDirClasses",["?isRTL","?locale"],function(t){e.toggleClass("fc-ltr",!t.isRTL),e.toggleClass("fc-rtl",t.isRTL)}),this.contentEl=i("<div class='fc-view-container'/>").prependTo(e),this.initToolbars(),this.renderHeader(),this.renderFooter(),this.renderView(this.opt("defaultView")),this.opt("handleWindowResize")&&i(window).resize(this.windowResizeProxy=s.debounce(this.windowResize.bind(this),this.opt("windowResizeDelay")))},t.prototype.destroy=function(){this.view&&this.clearView(),this.toolbarsManager.proxyCall("removeElement"),this.contentEl.remove(),this.el.removeClass("fc fc-ltr fc-rtl"),this.optionsManager.unwatch("settingTheme"),this.optionsManager.unwatch("settingBusinessHourGenerator"),this.el.off(".fc"),this.windowResizeProxy&&(i(window).unbind("resize",this.windowResizeProxy),this.windowResizeProxy=null),u.default.unneeded()},t.prototype.elementVisible=function(){return this.el.is(":visible")},t.prototype.bindViewHandlers=function(t){var e=this;t.watch("titleForCalendar",["title"],function(n){t===e.view&&e.setToolbarsTitle(n.title)}),t.watch("dateProfileForCalendar",["dateProfile"],function(n){t===e.view&&(e.currentDate=n.dateProfile.date,e.updateToolbarButtons(n.dateProfile))})},t.prototype.unbindViewHandlers=function(t){t.unwatch("titleForCalendar"),t.unwatch("dateProfileForCalendar")},t.prototype.renderView=function(t){var e,n=this.view;this.freezeContentHeight(),n&&t&&n.type!==t&&this.clearView(),!this.view&&t&&(e=this.view=this.viewsByType[t]||(this.viewsByType[t]=this.instantiateView(t)),this.bindViewHandlers(e),e.startBatchRender(),e.setElement(i("<div class='fc-view fc-"+t+"-view' />").appendTo(this.contentEl)),this.toolbarsManager.proxyCall("activateButton",t)),this.view&&(this.view.get("businessHourGenerator")!==this.businessHourGenerator&&this.view.set("businessHourGenerator",this.businessHourGenerator),this.view.setDate(this.currentDate),e&&e.stopBatchRender()),this.thawContentHeight()},t.prototype.clearView=function(){var t=this.view;this.toolbarsManager.proxyCall("deactivateButton",t.type),this.unbindViewHandlers(t),t.removeElement(),t.unsetDate(),this.view=null},t.prototype.reinitView=function(){var t=this.view,e=t.queryScroll();this.freezeContentHeight(),this.clearView(),this.calcSize(),this.renderView(t.type),this.view.applyScroll(e),this.thawContentHeight()},t.prototype.getSuggestedViewHeight=function(){return null==this.suggestedViewHeight&&this.calcSize(),this.suggestedViewHeight},t.prototype.isHeightAuto=function(){return"auto"===this.opt("contentHeight")||"auto"===this.opt("height")},t.prototype.updateViewSize=function(t){void 0===t&&(t=!1);var e,n=this.view;if(!this.ignoreUpdateViewSize&&n)return t&&(this.calcSize(),e=n.queryScroll()),this.ignoreUpdateViewSize++,n.updateSize(this.getSuggestedViewHeight(),this.isHeightAuto(),t),this.ignoreUpdateViewSize--,t&&n.applyScroll(e),!0},t.prototype.calcSize=function(){this.elementVisible()&&this._calcSize()},t.prototype._calcSize=function(){var t=this.opt("contentHeight"),e=this.opt("height");this.suggestedViewHeight="number"==typeof t?t:"function"==typeof t?t():"number"==typeof e?e-this.queryToolbarsHeight():"function"==typeof e?e()-this.queryToolbarsHeight():"parent"===e?this.el.parent().height()-this.queryToolbarsHeight():Math.round(this.contentEl.width()/Math.max(this.opt("aspectRatio"),.5))},t.prototype.windowResize=function(t){t.target===window&&this.view&&this.view.isDatesRendered&&this.updateViewSize(!0)&&this.publiclyTrigger("windowResize",[this.view])},t.prototype.freezeContentHeight=function(){this.freezeContentHeightDepth++||this.forceFreezeContentHeight()},t.prototype.forceFreezeContentHeight=function(){this.contentEl.css({width:"100%",height:this.contentEl.height(),overflow:"hidden"})},t.prototype.thawContentHeight=function(){this.freezeContentHeightDepth--,this.contentEl.css({width:"",height:"",overflow:""}),this.freezeContentHeightDepth&&this.forceFreezeContentHeight()},t.prototype.initToolbars=function(){this.header=new p.default(this,this.computeHeaderOptions()),this.footer=new p.default(this,this.computeFooterOptions()),this.toolbarsManager=new l.default([this.header,this.footer])},t.prototype.computeHeaderOptions=function(){return{extraClasses:"fc-header-toolbar",layout:this.opt("header")}},t.prototype.computeFooterOptions=function(){return{extraClasses:"fc-footer-toolbar",layout:this.opt("footer")}},t.prototype.renderHeader=function(){var t=this.header;t.setToolbarOptions(this.computeHeaderOptions()),t.render(),t.el&&this.el.prepend(t.el)},t.prototype.renderFooter=function(){var t=this.footer;t.setToolbarOptions(this.computeFooterOptions()),t.render(),t.el&&this.el.append(t.el)},t.prototype.setToolbarsTitle=function(t){this.toolbarsManager.proxyCall("updateTitle",t)},t.prototype.updateToolbarButtons=function(t){var e=this.getNow(),n=this.view,r=n.dateProfileGenerator.build(e),i=n.dateProfileGenerator.buildPrev(n.get("dateProfile")),o=n.dateProfileGenerator.buildNext(n.get("dateProfile"));this.toolbarsManager.proxyCall(r.isValid&&!t.currentUnzonedRange.containsDate(e)?"enableButton":"disableButton","today"),this.toolbarsManager.proxyCall(i.isValid?"enableButton":"disableButton","prev"),this.toolbarsManager.proxyCall(o.isValid?"enableButton":"disableButton","next")},t.prototype.queryToolbarsHeight=function(){return this.toolbarsManager.items.reduce(function(t,e){return t+(e.el?e.el.outerHeight(!0):0)},0)},t.prototype.select=function(t,e){this.view.select(this.buildSelectFootprint.apply(this,arguments))},t.prototype.unselect=function(){this.view&&this.view.unselect()},t.prototype.buildSelectFootprint=function(t,e){var n,r=this.moment(t).stripZone();return n=e?this.moment(e).stripZone():r.hasTime()?r.clone().add(this.defaultTimedEventDuration):r.clone().add(this.defaultAllDayEventDuration),new b.default(new m.default(r,n),!r.hasTime())},t.prototype.initMomentInternals=function(){var t=this;this.defaultAllDayEventDuration=o.duration(this.opt("defaultAllDayEventDuration")),this.defaultTimedEventDuration=o.duration(this.opt("defaultTimedEventDuration")),this.optionsManager.watch("buildingMomentLocale",["?locale","?monthNames","?monthNamesShort","?dayNames","?dayNamesShort","?firstDay","?weekNumberCalculation"],function(e){var n,r=e.weekNumberCalculation,i=e.firstDay;"iso"===r&&(r="ISO");var o=Object.create(v.getMomentLocaleData(e.locale));e.monthNames&&(o._months=e.monthNames),e.monthNamesShort&&(o._monthsShort=e.monthNamesShort),e.dayNames&&(o._weekdays=e.dayNames),e.dayNamesShort&&(o._weekdaysShort=e.dayNamesShort),null==i&&"ISO"===r&&(i=1),null!=i&&(n=Object.create(o._week),n.dow=i,o._week=n),"ISO"!==r&&"local"!==r&&"function"!=typeof r||(o._fullCalendar_weekCalc=r),t.localeData=o,t.currentDate&&t.localizeMoment(t.currentDate)})},t.prototype.moment=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n;return"local"===this.opt("timezone")?(n=y.default.apply(null,t),n.hasTime()&&n.local()):n="UTC"===this.opt("timezone")?y.default.utc.apply(null,t):y.default.parseZone.apply(null,t),this.localizeMoment(n),n},t.prototype.msToMoment=function(t,e){var n=y.default.utc(t);return e?n.stripTime():n=this.applyTimezone(n),this.localizeMoment(n),n},
t.prototype.msToUtcMoment=function(t,e){var n=y.default.utc(t);return e&&n.stripTime(),this.localizeMoment(n),n},t.prototype.localizeMoment=function(t){t._locale=this.localeData},t.prototype.getIsAmbigTimezone=function(){return"local"!==this.opt("timezone")&&"UTC"!==this.opt("timezone")},t.prototype.applyTimezone=function(t){if(!t.hasTime())return t.clone();var e,n=this.moment(t.toArray()),r=t.time().asMilliseconds()-n.time().asMilliseconds();return r&&(e=n.clone().add(r),t.time().asMilliseconds()-e.time().asMilliseconds()==0&&(n=e)),n},t.prototype.footprintToDateProfile=function(t,e){void 0===e&&(e=!1);var n,r=y.default.utc(t.unzonedRange.startMs);return e||(n=y.default.utc(t.unzonedRange.endMs)),t.isAllDay?(r.stripTime(),n&&n.stripTime()):(r=this.applyTimezone(r),n&&(n=this.applyTimezone(n))),this.localizeMoment(r),n&&this.localizeMoment(n),new w.default(r,n,this)},t.prototype.getNow=function(){var t=this.opt("now");return"function"==typeof t&&(t=t()),this.moment(t).stripZone()},t.prototype.humanizeDuration=function(t){return t.locale(this.opt("locale")).humanize()},t.prototype.parseUnzonedRange=function(t){var e=null,n=null;return t.start&&(e=this.moment(t.start).stripZone()),t.end&&(n=this.moment(t.end).stripZone()),e||n?e&&n&&n.isBefore(e)?null:new m.default(e,n):null},t.prototype.initEventManager=function(){var t=this,e=new D.default(this),n=this.opt("eventSources")||[],r=this.opt("events");this.eventManager=e,r&&n.unshift(r),e.on("release",function(e){t.trigger("eventsReset",e)}),e.freeze(),n.forEach(function(n){var r=S.default.parse(n,t);r&&e.addSource(r)}),e.thaw()},t.prototype.requestEvents=function(t,e){return this.eventManager.requestEvents(t,e,this.opt("timezone"),!this.opt("lazyFetching"))},t.prototype.getEventEnd=function(t){return t.end?t.end.clone():this.getDefaultEventEnd(t.allDay,t.start)},t.prototype.getDefaultEventEnd=function(t,e){var n=e.clone();return t?n.stripTime().add(this.defaultAllDayEventDuration):n.add(this.defaultTimedEventDuration),this.getIsAmbigTimezone()&&n.stripZone(),n},t.prototype.rerenderEvents=function(){this.view.flash("displayingEvents")},t.prototype.refetchEvents=function(){this.eventManager.refetchAllSources()},t.prototype.renderEvents=function(t,e){this.eventManager.freeze();for(var n=0;n<t.length;n++)this.renderEvent(t[n],e);this.eventManager.thaw()},t.prototype.renderEvent=function(t,e){void 0===e&&(e=!1);var n=this.eventManager,r=C.default.parse(t,t.source||n.stickySource);r&&n.addEventDef(r,e)},t.prototype.removeEvents=function(t){var e,n,i=this.eventManager,o=[],s={};if(null==t)i.removeAllEventDefs();else{for(i.getEventInstances().forEach(function(t){o.push(t.toLegacy())}),o=r(o,t),n=0;n<o.length;n++)e=this.eventManager.getEventDefByUid(o[n]._id),s[e.id]=!0;i.freeze();for(n in s)i.removeEventDefsById(n);i.thaw()}},t.prototype.clientEvents=function(t){var e=[];return this.eventManager.getEventInstances().forEach(function(t){e.push(t.toLegacy())}),r(e,t)},t.prototype.updateEvents=function(t){this.eventManager.freeze();for(var e=0;e<t.length;e++)this.updateEvent(t[e]);this.eventManager.thaw()},t.prototype.updateEvent=function(t){var e,n,r=this.eventManager.getEventDefByUid(t._id);r instanceof R.default&&(e=r.buildInstance(),n=T.default.createFromRawProps(e,t,null),this.eventManager.mutateEventsWithId(r.id,n))},t.prototype.getEventSources=function(){return this.eventManager.otherSources.slice()},t.prototype.getEventSourceById=function(t){return this.eventManager.getSourceById(M.default.normalizeId(t))},t.prototype.addEventSource=function(t){var e=S.default.parse(t,this);e&&this.eventManager.addSource(e)},t.prototype.removeEventSources=function(t){var e,n,r=this.eventManager;if(null==t)this.eventManager.removeAllSources();else{for(e=r.multiQuerySources(t),r.freeze(),n=0;n<e.length;n++)r.removeSource(e[n]);r.thaw()}},t.prototype.removeEventSource=function(t){var e,n=this.eventManager,r=n.querySources(t);for(n.freeze(),e=0;e<r.length;e++)n.removeSource(r[e]);n.thaw()},t.prototype.refetchEventSources=function(t){var e,n=this.eventManager,r=n.multiQuerySources(t);for(n.freeze(),e=0;e<r.length;e++)n.refetchSource(r[e]);n.thaw()},t.defaults=a.globalDefaults,t.englishDefaults=a.englishDefaults,t.rtlDefaults=a.rtlDefaults,t}();e.default=H,d.default.mixInto(H),c.default.mixInto(H)},function(t,e,n){function r(t){var e,n,r,i,l=a.dataAttrPrefix;return l&&(l+="-"),e=t.data(l+"event")||null,e&&(e="object"==typeof e?o.extend({},e):{},n=e.start,null==n&&(n=e.time),r=e.duration,i=e.stick,delete e.start,delete e.time,delete e.duration,delete e.stick),null==n&&(n=t.data(l+"start")),null==n&&(n=t.data(l+"time")),null==r&&(r=t.data(l+"duration")),null==i&&(i=t.data(l+"stick")),n=null!=n?s.duration(n):null,r=null!=r?s.duration(r):null,i=Boolean(i),{eventProps:e,startTime:n,duration:r,stick:i}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=n(3),s=n(0),a=n(18),l=n(4),u=n(11),d=n(7),c=n(17),p=n(9),h=n(20),f=n(6),g=n(14),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isDragging=!1,e}return i.__extends(e,t),e.prototype.end=function(){this.dragListener&&this.dragListener.endInteraction()},e.prototype.bindToDocument=function(){this.listenTo(o(document),{dragstart:this.handleDragStart,sortstart:this.handleDragStart})},e.prototype.unbindFromDocument=function(){this.stopListeningTo(o(document))},e.prototype.handleDragStart=function(t,e){var n,r;this.opt("droppable")&&(n=o((e?e.item:null)||t.target),r=this.opt("dropAccept"),(o.isFunction(r)?r.call(n[0],n):n.is(r))&&(this.isDragging||this.listenToExternalDrag(n,t,e)))},e.prototype.listenToExternalDrag=function(t,e,n){var i,o=this,s=this.component,a=this.view,u=r(t);(this.dragListener=new c.default(s,{interactionStart:function(){o.isDragging=!0},hitOver:function(t){var e,n=!0,r=t.component.getSafeHitFootprint(t);r?(i=o.computeExternalDrop(r,u),i?(e=new h.default(i.buildInstances()),n=u.eventProps?s.isEventInstanceGroupAllowed(e):s.isExternalInstanceGroupAllowed(e)):n=!1):n=!1,n||(i=null,l.disableCursor()),i&&s.renderDrag(s.eventRangesToEventFootprints(e.sliceRenderRanges(s.dateProfile.renderUnzonedRange,a.calendar)))},hitOut:function(){i=null},hitDone:function(){l.enableCursor(),s.unrenderDrag()},interactionEnd:function(e){i&&a.reportExternalDrop(i,Boolean(u.eventProps),Boolean(u.stick),t,e,n),o.isDragging=!1,o.dragListener=null}})).startDrag(e)},e.prototype.computeExternalDrop=function(t,e){var n,r=this.view.calendar,i=u.default.utc(t.unzonedRange.startMs).stripZone();return t.isAllDay&&(e.startTime?i.time(e.startTime):i.stripTime()),e.duration&&(n=i.clone().add(e.duration)),i=r.applyTimezone(i),n&&(n=r.applyTimezone(n)),p.default.parse(o.extend({},e.eventProps,{start:i,end:n}),new f.default(r))},e}(g.default);e.default=v,d.default.mixInto(v),a.dataAttrPrefix=""},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(4),s=n(39),a=n(40),l=n(17),u=n(14),d=function(t){function e(e,n){var r=t.call(this,e)||this;return r.isResizing=!1,r.eventPointing=n,r}return r.__extends(e,t),e.prototype.end=function(){this.dragListener&&this.dragListener.endInteraction()},e.prototype.bindToEl=function(t){var e=this.component;e.bindSegHandlerToEl(t,"mousedown",this.handleMouseDown.bind(this)),e.bindSegHandlerToEl(t,"touchstart",this.handleTouchStart.bind(this))},e.prototype.handleMouseDown=function(t,e){this.component.canStartResize(t,e)&&this.buildDragListener(t,i(e.target).is(".fc-start-resizer")).startInteraction(e,{distance:5})},e.prototype.handleTouchStart=function(t,e){this.component.canStartResize(t,e)&&this.buildDragListener(t,i(e.target).is(".fc-start-resizer")).startInteraction(e)},e.prototype.buildDragListener=function(t,e){var n,r,i=this,s=this.component,a=this.view,u=a.calendar,d=u.eventManager,c=t.el,p=t.footprint.eventDef,h=t.footprint.eventInstance;return this.dragListener=new l.default(s,{scroll:this.opt("dragScroll"),subjectEl:c,interactionStart:function(){n=!1},dragStart:function(e){n=!0,i.eventPointing.handleMouseout(t,e),i.segResizeStart(t,e)},hitOver:function(n,l,c){var h,f=!0,g=s.getSafeHitFootprint(c),v=s.getSafeHitFootprint(n);g&&v?(r=e?i.computeEventStartResizeMutation(g,v,t.footprint):i.computeEventEndResizeMutation(g,v,t.footprint),r?(h=d.buildMutatedEventInstanceGroup(p.id,r),f=s.isEventInstanceGroupAllowed(h)):f=!1):f=!1,f?r.isEmpty()&&(r=null):(r=null,o.disableCursor()),r&&(a.hideEventsWithId(t.footprint.eventDef.id),a.renderEventResize(s.eventRangesToEventFootprints(h.sliceRenderRanges(s.dateProfile.renderUnzonedRange,u)),t))},hitOut:function(){r=null},hitDone:function(){a.unrenderEventResize(t),a.showEventsWithId(t.footprint.eventDef.id),o.enableCursor()},interactionEnd:function(e){n&&i.segResizeStop(t,e),r&&a.reportEventResize(h,r,c,e),i.dragListener=null}})},e.prototype.segResizeStart=function(t,e){this.isResizing=!0,this.component.publiclyTrigger("eventResizeStart",{context:t.el[0],args:[t.footprint.getEventLegacy(),e,{},this.view]})},e.prototype.segResizeStop=function(t,e){this.isResizing=!1,this.component.publiclyTrigger("eventResizeStop",{context:t.el[0],args:[t.footprint.getEventLegacy(),e,{},this.view]})},e.prototype.computeEventStartResizeMutation=function(t,e,n){var r,i,o=n.componentFootprint.unzonedRange,l=this.component.diffDates(e.unzonedRange.getStart(),t.unzonedRange.getStart());return o.getStart().add(l)<o.getEnd()&&(r=new a.default,r.setStartDelta(l),i=new s.default,i.setDateMutation(r),i)},e.prototype.computeEventEndResizeMutation=function(t,e,n){var r,i,o=n.componentFootprint.unzonedRange,l=this.component.diffDates(e.unzonedRange.getEnd(),t.unzonedRange.getEnd());return o.getEnd().add(l)>o.getStart()&&(r=new a.default,r.setEndDelta(l),i=new s.default,i.setDateMutation(r),i)},e}(u.default);e.default=d},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(4),o=n(39),s=n(40),a=n(59),l=n(17),u=n(226),d=n(14),c=function(t){function e(e,n){var r=t.call(this,e)||this;return r.isDragging=!1,r.eventPointing=n,r}return r.__extends(e,t),e.prototype.end=function(){this.dragListener&&this.dragListener.endInteraction()},e.prototype.getSelectionDelay=function(){var t=this.opt("eventLongPressDelay");return null==t&&(t=this.opt("longPressDelay")),t},e.prototype.bindToEl=function(t){var e=this.component;e.bindSegHandlerToEl(t,"mousedown",this.handleMousedown.bind(this)),e.bindSegHandlerToEl(t,"touchstart",this.handleTouchStart.bind(this))},e.prototype.handleMousedown=function(t,e){!this.component.shouldIgnoreMouse()&&this.component.canStartDrag(t,e)&&this.buildDragListener(t).startInteraction(e,{distance:5})},e.prototype.handleTouchStart=function(t,e){var n=this.component,r={delay:this.view.isEventDefSelected(t.footprint.eventDef)?0:this.getSelectionDelay()};n.canStartDrag(t,e)?this.buildDragListener(t).startInteraction(e,r):n.canStartSelection(t,e)&&this.buildSelectListener(t).startInteraction(e,r)},e.prototype.buildSelectListener=function(t){var e=this,n=this.view,r=t.footprint.eventDef,i=t.footprint.eventInstance;if(this.dragListener)return this.dragListener;var o=this.dragListener=new a.default({dragStart:function(t){o.isTouch&&!n.isEventDefSelected(r)&&i&&n.selectEventInstance(i)},interactionEnd:function(t){e.dragListener=null}});return o},e.prototype.buildDragListener=function(t){var e,n,r,o=this,s=this.component,a=this.view,d=a.calendar,c=d.eventManager,p=t.el,h=t.footprint.eventDef,f=t.footprint.eventInstance;if(this.dragListener)return this.dragListener;var g=this.dragListener=new l.default(a,{scroll:this.opt("dragScroll"),subjectEl:p,subjectCenter:!0,interactionStart:function(r){t.component=s,e=!1,n=new u.default(t.el,{additionalClass:"fc-dragging",parentEl:a.el,opacity:g.isTouch?null:o.opt("dragOpacity"),revertDuration:o.opt("dragRevertDuration"),zIndex:2}),n.hide(),n.start(r)},dragStart:function(n){g.isTouch&&!a.isEventDefSelected(h)&&f&&a.selectEventInstance(f),e=!0,o.eventPointing.handleMouseout(t,n),o.segDragStart(t,n),a.hideEventsWithId(t.footprint.eventDef.id)},hitOver:function(e,l,u){var p,f,v,y=!0;t.hit&&(u=t.hit),p=u.component.getSafeHitFootprint(u),f=e.component.getSafeHitFootprint(e),p&&f?(r=o.computeEventDropMutation(p,f,h),r?(v=c.buildMutatedEventInstanceGroup(h.id,r),y=s.isEventInstanceGroupAllowed(v)):y=!1):y=!1,y||(r=null,i.disableCursor()),r&&a.renderDrag(s.eventRangesToEventFootprints(v.sliceRenderRanges(s.dateProfile.renderUnzonedRange,d)),t,g.isTouch)?n.hide():n.show(),l&&(r=null)},hitOut:function(){a.unrenderDrag(t),n.show(),r=null},hitDone:function(){i.enableCursor()},interactionEnd:function(i){delete t.component,n.stop(!r,function(){e&&(a.unrenderDrag(t),o.segDragStop(t,i)),a.showEventsWithId(t.footprint.eventDef.id),r&&a.reportEventDrop(f,r,p,i)}),o.dragListener=null}});return g},e.prototype.segDragStart=function(t,e){this.isDragging=!0,this.component.publiclyTrigger("eventDragStart",{context:t.el[0],args:[t.footprint.getEventLegacy(),e,{},this.view]})},e.prototype.segDragStop=function(t,e){this.isDragging=!1,this.component.publiclyTrigger("eventDragStop",{context:t.el[0],args:[t.footprint.getEventLegacy(),e,{},this.view]})},e.prototype.computeEventDropMutation=function(t,e,n){var r=new o.default;return r.setDateMutation(this.computeEventDateMutation(t,e)),r},e.prototype.computeEventDateMutation=function(t,e){var n,r,i=t.unzonedRange.getStart(),o=e.unzonedRange.getStart(),a=!1,l=!1,u=!1;return t.isAllDay!==e.isAllDay&&(a=!0,e.isAllDay?(u=!0,i.stripTime()):l=!0),n=this.component.diffDates(o,i),r=new s.default,r.clearEnd=a,r.forceTimed=l,r.forceAllDay=u,r.setDateDelta(n),r},e}(d.default);e.default=c},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(4),o=n(17),s=n(12),a=n(5),l=n(14),u=function(t){function e(e){var n=t.call(this,e)||this;return n.dragListener=n.buildDragListener(),n}return r.__extends(e,t),e.prototype.end=function(){this.dragListener.endInteraction()},e.prototype.getDelay=function(){var t=this.opt("selectLongPressDelay");return null==t&&(t=this.opt("longPressDelay")),t},e.prototype.bindToEl=function(t){var e=this,n=this.component,r=this.dragListener;n.bindDateHandlerToEl(t,"mousedown",function(t){e.opt("selectable")&&!n.shouldIgnoreMouse()&&r.startInteraction(t,{distance:e.opt("selectMinDistance")})}),n.bindDateHandlerToEl(t,"touchstart",function(t){e.opt("selectable")&&!n.shouldIgnoreTouch()&&r.startInteraction(t,{delay:e.getDelay()})}),i.preventSelection(t)},e.prototype.buildDragListener=function(){var t,e=this,n=this.component;return new o.default(n,{scroll:this.opt("dragScroll"),interactionStart:function(){t=null},dragStart:function(t){e.view.unselect(t)},hitOver:function(r,o,s){var a,l;s&&(a=n.getSafeHitFootprint(s),l=n.getSafeHitFootprint(r),t=a&&l?e.computeSelection(a,l):null,t?n.renderSelectionFootprint(t):!1===t&&i.disableCursor())},hitOut:function(){t=null,n.unrenderSelection()},hitDone:function(){i.enableCursor()},interactionEnd:function(n,r){!r&&t&&e.view.reportSelection(t,n)}})},e.prototype.computeSelection=function(t,e){var n=this.computeSelectionFootprint(t,e);return!(n&&!this.isSelectionFootprintAllowed(n))&&n},e.prototype.computeSelectionFootprint=function(t,e){var n=[t.unzonedRange.startMs,t.unzonedRange.endMs,e.unzonedRange.startMs,e.unzonedRange.endMs];return n.sort(i.compareNumbers),new s.default(new a.default(n[0],n[3]),t.isAllDay)},e.prototype.isSelectionFootprintAllowed=function(t){return this.component.dateProfile.validUnzonedRange.containsRange(t.unzonedRange)&&this.view.calendar.constraints.isSelectionFootprintAllowed(t)},e}(l.default);e.default=u},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(17),o=n(14),s=function(t){function e(e){var n=t.call(this,e)||this;return n.dragListener=n.buildDragListener(),n}return r.__extends(e,t),e.prototype.end=function(){this.dragListener.endInteraction()},e.prototype.bindToEl=function(t){var e=this.component,n=this.dragListener;e.bindDateHandlerToEl(t,"mousedown",function(t){e.shouldIgnoreMouse()||n.startInteraction(t)}),e.bindDateHandlerToEl(t,"touchstart",function(t){e.shouldIgnoreTouch()||n.startInteraction(t)})},e.prototype.buildDragListener=function(){var t,e=this,n=this.component,r=new i.default(n,{scroll:this.opt("dragScroll"),interactionStart:function(){t=r.origHit},hitOver:function(e,n,r){n||(t=null)},hitOut:function(){t=null},interactionEnd:function(r,i){var o;!i&&t&&(o=n.getSafeHitFootprint(t))&&e.view.triggerDayClick(o,n.getHitEl(t),r)}});return r.shouldCancelTouchScroll=!1,r.scrollAlwaysKills=!0,r},e}(o.default);e.default=s},function(t,e,n){function r(t){var e,n=[],r=[];for(e=0;e<t.length;e++)t[e].componentFootprint.isAllDay?n.push(t[e]):r.push(t[e]);return{allDay:n,timed:r}}Object.defineProperty(e,"__esModule",{value:!0});var i,o,s=n(2),a=n(0),l=n(3),u=n(4),d=n(41),c=n(43),p=n(239),h=n(66),f=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.usesMinMaxTime=!0,r.timeGrid=r.instantiateTimeGrid(),r.addChild(r.timeGrid),r.opt("allDaySlot")&&(r.dayGrid=r.instantiateDayGrid(),r.addChild(r.dayGrid)),r.scroller=new d.default({overflowX:"hidden",overflowY:"auto"}),r}return s.__extends(e,t),e.prototype.instantiateTimeGrid=function(){var t=new this.timeGridClass(this);return u.copyOwnProps(i,t),t},e.prototype.instantiateDayGrid=function(){var t=new this.dayGridClass(this);return u.copyOwnProps(o,t),t},e.prototype.renderSkeleton=function(){var t,e;this.el.addClass("fc-agenda-view").html(this.renderSkeletonHtml()),this.scroller.render(),t=this.scroller.el.addClass("fc-time-grid-container"),e=l('<div class="fc-time-grid" />').appendTo(t),this.el.find(".fc-body > tr > td").append(t),this.timeGrid.headContainerEl=this.el.find(".fc-head-container"),this.timeGrid.setElement(e),this.dayGrid&&(this.dayGrid.setElement(this.el.find(".fc-day-grid")),this.dayGrid.bottomCoordPadding=this.dayGrid.el.next("hr").outerHeight())},e.prototype.unrenderSkeleton=function(){this.timeGrid.removeElement(),this.dayGrid&&this.dayGrid.removeElement(),this.scroller.destroy()},e.prototype.renderSkeletonHtml=function(){var t=this.calendar.theme;return'<table class="'+t.getClass("tableGrid")+'">'+(this.opt("columnHeader")?'<thead class="fc-head"><tr><td class="fc-head-container '+t.getClass("widgetHeader")+'">&nbsp;</td></tr></thead>':"")+'<tbody class="fc-body"><tr><td class="'+t.getClass("widgetContent")+'">'+(this.dayGrid?'<div class="fc-day-grid"/><hr class="fc-divider '+t.getClass("widgetHeader")+'"/>':"")+"</td></tr></tbody></table>"},e.prototype.axisStyleAttr=function(){return null!=this.axisWidth?'style="width:'+this.axisWidth+'px"':""},e.prototype.getNowIndicatorUnit=function(){return this.timeGrid.getNowIndicatorUnit()},e.prototype.updateSize=function(e,n,r){var i,o,s;if(t.prototype.updateSize.call(this,e,n,r),this.axisWidth=u.matchCellWidths(this.el.find(".fc-axis")),!this.timeGrid.colEls)return void(n||(o=this.computeScrollerHeight(e),this.scroller.setHeight(o)));var a=this.el.find(".fc-row:not(.fc-scroller *)");this.timeGrid.bottomRuleEl.hide(),this.scroller.clear(),u.uncompensateScroll(a),this.dayGrid&&(this.dayGrid.removeSegPopover(),i=this.opt("eventLimit"),i&&"number"!=typeof i&&(i=5),i&&this.dayGrid.limitRows(i)),n||(o=this.computeScrollerHeight(e),this.scroller.setHeight(o),s=this.scroller.getScrollbarWidths(),(s.left||s.right)&&(u.compensateScroll(a,s),o=this.computeScrollerHeight(e),this.scroller.setHeight(o)),this.scroller.lockOverflow(s),this.timeGrid.getTotalSlatHeight()<o&&this.timeGrid.bottomRuleEl.show())},e.prototype.computeScrollerHeight=function(t){return t-u.subtractInnerElHeight(this.el,this.scroller.el)},e.prototype.computeInitialDateScroll=function(){var t=a.duration(this.opt("scrollTime")),e=this.timeGrid.computeTimeTop(t);return e=Math.ceil(e),e&&e++,{top:e}},e.prototype.queryDateScroll=function(){return{top:this.scroller.getScrollTop()}},e.prototype.applyDateScroll=function(t){void 0!==t.top&&this.scroller.setScrollTop(t.top)},e.prototype.getHitFootprint=function(t){return t.component.getHitFootprint(t)},e.prototype.getHitEl=function(t){return t.component.getHitEl(t)},e.prototype.executeEventRender=function(t){var e,n,r={},i={};for(e in t)n=t[e],n.getEventDef().isAllDay()?r[e]=n:i[e]=n;this.timeGrid.executeEventRender(i),this.dayGrid&&this.dayGrid.executeEventRender(r)},e.prototype.renderDrag=function(t,e,n){var i=r(t),o=!1;return o=this.timeGrid.renderDrag(i.timed,e,n),this.dayGrid&&(o=this.dayGrid.renderDrag(i.allDay,e,n)||o),o},e.prototype.renderEventResize=function(t,e,n){var i=r(t);this.timeGrid.renderEventResize(i.timed,e,n),this.dayGrid&&this.dayGrid.renderEventResize(i.allDay,e,n)},e.prototype.renderSelectionFootprint=function(t){t.isAllDay?this.dayGrid&&this.dayGrid.renderSelectionFootprint(t):this.timeGrid.renderSelectionFootprint(t)},e}(c.default);e.default=f,f.prototype.timeGridClass=p.default,f.prototype.dayGridClass=h.default,i={renderHeadIntroHtml:function(){var t,e=this.view,n=e.calendar,r=n.msToUtcMoment(this.dateProfile.renderUnzonedRange.startMs,!0);return this.opt("weekNumbers")?(t=r.format(this.opt("smallWeekFormat")),'<th class="fc-axis fc-week-number '+n.theme.getClass("widgetHeader")+'" '+e.axisStyleAttr()+">"+e.buildGotoAnchorHtml({date:r,type:"week",forceOff:this.colCnt>1},u.htmlEscape(t))+"</th>"):'<th class="fc-axis '+n.theme.getClass("widgetHeader")+'" '+e.axisStyleAttr()+"></th>"},renderBgIntroHtml:function(){var t=this.view;return'<td class="fc-axis '+t.calendar.theme.getClass("widgetContent")+'" '+t.axisStyleAttr()+"></td>"},renderIntroHtml:function(){return'<td class="fc-axis" '+this.view.axisStyleAttr()+"></td>"}},o={renderBgIntroHtml:function(){var t=this.view;return'<td class="fc-axis '+t.calendar.theme.getClass("widgetContent")+'" '+t.axisStyleAttr()+"><span>"+t.getAllDayHtml()+"</span></td>"},renderIntroHtml:function(){return'<td class="fc-axis" '+this.view.axisStyleAttr()+"></td>"}}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(0),s=n(4),a=n(42),l=n(61),u=n(65),d=n(60),c=n(58),p=n(5),h=n(12),f=n(240),g=n(241),v=n(242),y=[{hours:1},{minutes:30},{minutes:15},{seconds:30},{seconds:15}],m=function(t){function e(e){var n=t.call(this,e)||this;return n.processOptions(),n}return r.__extends(e,t),e.prototype.componentFootprintToSegs=function(t){var e,n=this.sliceRangeByTimes(t.unzonedRange);for(e=0;e<n.length;e++)this.isRTL?n[e].col=this.daysPerRow-1-n[e].dayIndex:n[e].col=n[e].dayIndex;return n},e.prototype.sliceRangeByTimes=function(t){var e,n,r=[];for(n=0;n<this.daysPerRow;n++)(e=t.intersect(this.dayRanges[n]))&&r.push({startMs:e.startMs,endMs:e.endMs,isStart:e.isStart,isEnd:e.isEnd,dayIndex:n});return r},e.prototype.processOptions=function(){var t,e=this.opt("slotDuration"),n=this.opt("snapDuration");e=o.duration(e),n=n?o.duration(n):e,this.slotDuration=e,this.snapDuration=n,this.snapsPerSlot=e/n,t=this.opt("slotLabelFormat"),i.isArray(t)&&(t=t[t.length-1]),this.labelFormat=t||this.opt("smallTimeFormat"),t=this.opt("slotLabelInterval"),this.labelInterval=t?o.duration(t):this.computeLabelInterval(e)},e.prototype.computeLabelInterval=function(t){var e,n,r;for(e=y.length-1;e>=0;e--)if(n=o.duration(y[e]),r=s.divideDurationByDuration(n,t),s.isInt(r)&&r>1)return n;return o.duration(t)},e.prototype.renderDates=function(t){this.dateProfile=t,this.updateDayTable(),this.renderSlats(),this.renderColumns()},e.prototype.unrenderDates=function(){this.unrenderColumns()},e.prototype.renderSkeleton=function(){var t=this.view.calendar.theme;this.el.html('<div class="fc-bg"></div><div class="fc-slats"></div><hr class="fc-divider '+t.getClass("widgetHeader")+'" style="display:none" />'),this.bottomRuleEl=this.el.find("hr")},e.prototype.renderSlats=function(){var t=this.view.calendar.theme;this.slatContainerEl=this.el.find("> .fc-slats").html('<table class="'+t.getClass("tableGrid")+'">'+this.renderSlatRowHtml()+"</table>"),this.slatEls=this.slatContainerEl.find("tr"),this.slatCoordCache=new c.default({els:this.slatEls,isVertical:!0})},e.prototype.renderSlatRowHtml=function(){for(var t,e,n,r=this.view,i=r.calendar,a=i.theme,l=this.isRTL,u=this.dateProfile,d="",c=o.duration(+u.minTime),p=o.duration(0);c<u.maxTime;)t=i.msToUtcMoment(u.renderUnzonedRange.startMs).time(c),e=s.isInt(s.divideDurationByDuration(p,this.labelInterval)),n='<td class="fc-axis fc-time '+a.getClass("widgetContent")+'" '+r.axisStyleAttr()+">"+(e?"<span>"+s.htmlEscape(t.format(this.labelFormat))+"</span>":"")+"</td>",d+='<tr data-time="'+t.format("HH:mm:ss")+'"'+(e?"":' class="fc-minor"')+">"+(l?"":n)+'<td class="'+a.getClass("widgetContent")+'"/>'+(l?n:"")+"</tr>",c.add(this.slotDuration),p.add(this.slotDuration);return d},e.prototype.renderColumns=function(){var t=this.dateProfile,e=this.view.calendar.theme;this.dayRanges=this.dayDates.map(function(e){return new p.default(e.clone().add(t.minTime),e.clone().add(t.maxTime))}),this.headContainerEl&&this.headContainerEl.html(this.renderHeadHtml()),this.el.find("> .fc-bg").html('<table class="'+e.getClass("tableGrid")+'">'+this.renderBgTrHtml(0)+"</table>"),this.colEls=this.el.find(".fc-day, .fc-disabled-day"),this.colCoordCache=new c.default({els:this.colEls,isHorizontal:!0}),this.renderContentSkeleton()},e.prototype.unrenderColumns=function(){this.unrenderContentSkeleton()},e.prototype.renderContentSkeleton=function(){var t,e,n="";for(t=0;t<this.colCnt;t++)n+='<td><div class="fc-content-col"><div class="fc-event-container fc-helper-container"></div><div class="fc-event-container"></div><div class="fc-highlight-container"></div><div class="fc-bgevent-container"></div><div class="fc-business-container"></div></div></td>';e=this.contentSkeletonEl=i('<div class="fc-content-skeleton"><table><tr>'+n+"</tr></table></div>"),this.colContainerEls=e.find(".fc-content-col"),this.helperContainerEls=e.find(".fc-helper-container"),this.fgContainerEls=e.find(".fc-event-container:not(.fc-helper-container)"),this.bgContainerEls=e.find(".fc-bgevent-container"),this.highlightContainerEls=e.find(".fc-highlight-container"),this.businessContainerEls=e.find(".fc-business-container"),this.bookendCells(e.find("tr")),this.el.append(e)},e.prototype.unrenderContentSkeleton=function(){this.contentSkeletonEl&&(this.contentSkeletonEl.remove(),this.contentSkeletonEl=null,this.colContainerEls=null,this.helperContainerEls=null,this.fgContainerEls=null,this.bgContainerEls=null,this.highlightContainerEls=null,this.businessContainerEls=null)},e.prototype.groupSegsByCol=function(t){var e,n=[];for(e=0;e<this.colCnt;e++)n.push([]);for(e=0;e<t.length;e++)n[t[e].col].push(t[e]);return n},e.prototype.attachSegsByCol=function(t,e){var n,r,i;for(n=0;n<this.colCnt;n++)for(r=t[n],i=0;i<r.length;i++)e.eq(n).append(r[i].el)},e.prototype.getNowIndicatorUnit=function(){return"minute"},e.prototype.renderNowIndicator=function(t){if(this.colContainerEls){var e,n=this.componentFootprintToSegs(new h.default(new p.default(t,t.valueOf()+1),!1)),r=this.computeDateTop(t,t),o=[];for(e=0;e<n.length;e++)o.push(i('<div class="fc-now-indicator fc-now-indicator-line"></div>').css("top",r).appendTo(this.colContainerEls.eq(n[e].col))[0]);n.length>0&&o.push(i('<div class="fc-now-indicator fc-now-indicator-arrow"></div>').css("top",r).appendTo(this.el.find(".fc-content-skeleton"))[0]),this.nowIndicatorEls=i(o)}},e.prototype.unrenderNowIndicator=function(){this.nowIndicatorEls&&(this.nowIndicatorEls.remove(),this.nowIndicatorEls=null)},e.prototype.updateSize=function(e,n,r){t.prototype.updateSize.call(this,e,n,r),this.slatCoordCache.build(),r&&this.updateSegVerticals([].concat(this.eventRenderer.getSegs(),this.businessSegs||[]))},e.prototype.getTotalSlatHeight=function(){return this.slatContainerEl.outerHeight()},e.prototype.computeDateTop=function(t,e){return this.computeTimeTop(o.duration(t-e.clone().stripTime()))},e.prototype.computeTimeTop=function(t){var e,n,r=this.slatEls.length,i=this.dateProfile,o=(t-i.minTime)/this.slotDuration;return o=Math.max(0,o),o=Math.min(r,o),e=Math.floor(o),e=Math.min(e,r-1),n=o-e,this.slatCoordCache.getTopPosition(e)+this.slatCoordCache.getHeight(e)*n},e.prototype.updateSegVerticals=function(t){this.computeSegVerticals(t),this.assignSegVerticals(t)},e.prototype.computeSegVerticals=function(t){var e,n,r,i=this.opt("agendaEventMinHeight");for(e=0;e<t.length;e++)n=t[e],r=this.dayDates[n.dayIndex],n.top=this.computeDateTop(n.startMs,r),n.bottom=Math.max(n.top+i,this.computeDateTop(n.endMs,r))},e.prototype.assignSegVerticals=function(t){var e,n;for(e=0;e<t.length;e++)n=t[e],n.el.css(this.generateSegVerticalCss(n))},e.prototype.generateSegVerticalCss=function(t){return{top:t.top,bottom:-t.bottom}},e.prototype.prepareHits=function(){this.colCoordCache.build(),this.slatCoordCache.build()},e.prototype.releaseHits=function(){this.colCoordCache.clear()},e.prototype.queryHit=function(t,e){var n=this.snapsPerSlot,r=this.colCoordCache,i=this.slatCoordCache;if(r.isLeftInBounds(t)&&i.isTopInBounds(e)){var o=r.getHorizontalIndex(t),s=i.getVerticalIndex(e);if(null!=o&&null!=s){var a=i.getTopOffset(s),l=i.getHeight(s),u=(e-a)/l,d=Math.floor(u*n),c=s*n+d,p=a+d/n*l,h=a+(d+1)/n*l;return{col:o,snap:c,component:this,left:r.getLeftOffset(o),right:r.getRightOffset(o),top:p,bottom:h}}}},e.prototype.getHitFootprint=function(t){var e,n=this.getCellDate(0,t.col),r=this.computeSnapTime(t.snap);return n.time(r),e=n.clone().add(this.snapDuration),new h.default(new p.default(n,e),!1)},e.prototype.computeSnapTime=function(t){return o.duration(this.dateProfile.minTime+this.snapDuration*t)},e.prototype.getHitEl=function(t){return this.colEls.eq(t.col)},e.prototype.renderDrag=function(t,e,n){var r;if(e){if(t.length)return this.helperRenderer.renderEventDraggingFootprints(t,e,n),!0}else for(r=0;r<t.length;r++)this.renderHighlight(t[r].componentFootprint)},e.prototype.unrenderDrag=function(){this.unrenderHighlight(),this.helperRenderer.unrender()},e.prototype.renderEventResize=function(t,e,n){this.helperRenderer.renderEventResizingFootprints(t,e,n)},e.prototype.unrenderEventResize=function(){this.helperRenderer.unrender()},e.prototype.renderSelectionFootprint=function(t){this.opt("selectHelper")?this.helperRenderer.renderComponentFootprint(t):this.renderHighlight(t)},e.prototype.unrenderSelection=function(){this.helperRenderer.unrender(),this.unrenderHighlight()},e}(a.default);e.default=m,m.prototype.eventRendererClass=f.default,m.prototype.businessHourRendererClass=l.default,m.prototype.helperRendererClass=g.default,m.prototype.fillRendererClass=v.default,u.default.mixInto(m),d.default.mixInto(m)},function(t,e,n){function r(t){var e,n,r,i=[];for(e=0;e<t.length;e++){for(n=t[e],r=0;r<i.length&&s(n,i[r]).length;r++);n.level=r,(i[r]||(i[r]=[])).push(n)}return i}function i(t){var e,n,r,i,o;for(e=0;e<t.length;e++)for(n=t[e],r=0;r<n.length;r++)for(i=n[r],i.forwardSegs=[],o=e+1;o<t.length;o++)s(i,t[o],i.forwardSegs)}function o(t){var e,n,r=t.forwardSegs,i=0;if(void 0===t.forwardPressure){for(e=0;e<r.length;e++)n=r[e],o(n),i=Math.max(i,1+n.forwardPressure);t.forwardPressure=i}}function s(t,e,n){void 0===n&&(n=[]);for(var r=0;r<e.length;r++)a(t,e[r])&&n.push(e[r]);return n}function a(t,e){return t.bottom>e.top&&t.top<e.bottom}Object.defineProperty(e,"__esModule",{value:!0});var l=n(2),u=n(4),d=n(44),c=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.timeGrid=e,r}return l.__extends(e,t),e.prototype.renderFgSegs=function(t){this.renderFgSegsIntoContainers(t,this.timeGrid.fgContainerEls)},e.prototype.renderFgSegsIntoContainers=function(t,e){var n,r;for(n=this.timeGrid.groupSegsByCol(t),r=0;r<this.timeGrid.colCnt;r++)this.updateFgSegCoords(n[r]);this.timeGrid.attachSegsByCol(n,e)},e.prototype.unrenderFgSegs=function(){this.fgSegs&&this.fgSegs.forEach(function(t){t.el.remove()})},e.prototype.computeEventTimeFormat=function(){return this.opt("noMeridiemTimeFormat")},e.prototype.computeDisplayEventEnd=function(){return!0},e.prototype.fgSegHtml=function(t,e){
var n,r,i,o=this.view,s=o.calendar,a=t.footprint.componentFootprint,l=a.isAllDay,d=t.footprint.eventDef,c=o.isEventDefDraggable(d),p=!e&&t.isStart&&o.isEventDefResizableFromStart(d),h=!e&&t.isEnd&&o.isEventDefResizableFromEnd(d),f=this.getSegClasses(t,c,p||h),g=u.cssToStr(this.getSkinCss(d));if(f.unshift("fc-time-grid-event","fc-v-event"),o.isMultiDayRange(a.unzonedRange)){if(t.isStart||t.isEnd){var v=s.msToMoment(t.startMs),y=s.msToMoment(t.endMs);n=this._getTimeText(v,y,l),r=this._getTimeText(v,y,l,"LT"),i=this._getTimeText(v,y,l,null,!1)}}else n=this.getTimeText(t.footprint),r=this.getTimeText(t.footprint,"LT"),i=this.getTimeText(t.footprint,null,!1);return'<a class="'+f.join(" ")+'"'+(d.url?' href="'+u.htmlEscape(d.url)+'"':"")+(g?' style="'+g+'"':"")+'><div class="fc-content">'+(n?'<div class="fc-time" data-start="'+u.htmlEscape(i)+'" data-full="'+u.htmlEscape(r)+'"><span>'+u.htmlEscape(n)+"</span></div>":"")+(d.title?'<div class="fc-title">'+u.htmlEscape(d.title)+"</div>":"")+'</div><div class="fc-bg"/>'+(h?'<div class="fc-resizer fc-end-resizer" />':"")+"</a>"},e.prototype.updateFgSegCoords=function(t){this.timeGrid.computeSegVerticals(t),this.computeFgSegHorizontals(t),this.timeGrid.assignSegVerticals(t),this.assignFgSegHorizontals(t)},e.prototype.computeFgSegHorizontals=function(t){var e,n,s;if(this.sortEventSegs(t),e=r(t),i(e),n=e[0]){for(s=0;s<n.length;s++)o(n[s]);for(s=0;s<n.length;s++)this.computeFgSegForwardBack(n[s],0,0)}},e.prototype.computeFgSegForwardBack=function(t,e,n){var r,i=t.forwardSegs;if(void 0===t.forwardCoord)for(i.length?(this.sortForwardSegs(i),this.computeFgSegForwardBack(i[0],e+1,n),t.forwardCoord=i[0].backwardCoord):t.forwardCoord=1,t.backwardCoord=t.forwardCoord-(t.forwardCoord-n)/(e+1),r=0;r<i.length;r++)this.computeFgSegForwardBack(i[r],0,t.forwardCoord)},e.prototype.sortForwardSegs=function(t){t.sort(u.proxy(this,"compareForwardSegs"))},e.prototype.compareForwardSegs=function(t,e){return e.forwardPressure-t.forwardPressure||(t.backwardCoord||0)-(e.backwardCoord||0)||this.compareEventSegs(t,e)},e.prototype.assignFgSegHorizontals=function(t){var e,n;for(e=0;e<t.length;e++)n=t[e],n.el.css(this.generateFgSegHorizontalCss(n)),n.footprint.eventDef.title&&n.bottom-n.top<30&&n.el.addClass("fc-short")},e.prototype.generateFgSegHorizontalCss=function(t){var e,n,r=this.opt("slotEventOverlap"),i=t.backwardCoord,o=t.forwardCoord,s=this.timeGrid.generateSegVerticalCss(t),a=this.timeGrid.isRTL;return r&&(o=Math.min(1,i+2*(o-i))),a?(e=1-o,n=i):(e=i,n=1-o),s.zIndex=t.level+1,s.left=100*e+"%",s.right=100*n+"%",r&&t.forwardPressure&&(s[a?"marginLeft":"marginRight"]=20),s},e}(d.default);e.default=c},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(63),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.renderSegs=function(t,e){var n,r,o,s=[];for(this.eventRenderer.renderFgSegsIntoContainers(t,this.component.helperContainerEls),n=0;n<t.length;n++)r=t[n],e&&e.col===r.col&&(o=e.el,r.el.css({left:o.css("left"),right:o.css("right"),"margin-left":o.css("margin-left"),"margin-right":o.css("margin-right")})),s.push(r.el[0]);return i(s)},e}(o.default);e.default=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(62),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.attachSegEls=function(t,e){var n,r=this.component;return"bgEvent"===t?n=r.bgContainerEls:"businessHours"===t?n=r.businessContainerEls:"highlight"===t&&(n=r.highlightContainerEls),r.updateSegVerticals(e),r.attachSegsByCol(r.groupSegsByCol(e),n),e.map(function(t){return t.el[0]})},e}(i.default);e.default=o},function(t,e,n){function r(t,e){var n,r;for(n=0;n<e.length;n++)if(r=e[n],r.leftCol<=t.rightCol&&r.rightCol>=t.leftCol)return!0;return!1}function i(t,e){return t.leftCol-e.leftCol}Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),s=n(3),a=n(4),l=n(44),u=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.dayGrid=e,r}return o.__extends(e,t),e.prototype.renderBgRanges=function(e){e=s.grep(e,function(t){return t.eventDef.isAllDay()}),t.prototype.renderBgRanges.call(this,e)},e.prototype.renderFgSegs=function(t){var e=this.rowStructs=this.renderSegRows(t);this.dayGrid.rowEls.each(function(t,n){s(n).find(".fc-content-skeleton > table").append(e[t].tbodyEl)})},e.prototype.unrenderFgSegs=function(){for(var t,e=this.rowStructs||[];t=e.pop();)t.tbodyEl.remove();this.rowStructs=null},e.prototype.renderSegRows=function(t){var e,n,r=[];for(e=this.groupSegRows(t),n=0;n<e.length;n++)r.push(this.renderSegRow(n,e[n]));return r},e.prototype.renderSegRow=function(t,e){function n(t){for(;o<t;)d=(y[r-1]||[])[o],d?d.attr("rowspan",parseInt(d.attr("rowspan")||1,10)+1):(d=s("<td/>"),a.append(d)),v[r][o]=d,y[r][o]=d,o++}var r,i,o,a,l,u,d,c=this.dayGrid.colCnt,p=this.buildSegLevels(e),h=Math.max(1,p.length),f=s("<tbody/>"),g=[],v=[],y=[];for(r=0;r<h;r++){if(i=p[r],o=0,a=s("<tr/>"),g.push([]),v.push([]),y.push([]),i)for(l=0;l<i.length;l++){for(u=i[l],n(u.leftCol),d=s('<td class="fc-event-container"/>').append(u.el),u.leftCol!==u.rightCol?d.attr("colspan",u.rightCol-u.leftCol+1):y[r][o]=d;o<=u.rightCol;)v[r][o]=d,g[r][o]=u,o++;a.append(d)}n(c),this.dayGrid.bookendCells(a),f.append(a)}return{row:t,tbodyEl:f,cellMatrix:v,segMatrix:g,segLevels:p,segs:e}},e.prototype.buildSegLevels=function(t){var e,n,o,s=[];for(this.sortEventSegs(t),e=0;e<t.length;e++){for(n=t[e],o=0;o<s.length&&r(n,s[o]);o++);n.level=o,(s[o]||(s[o]=[])).push(n)}for(o=0;o<s.length;o++)s[o].sort(i);return s},e.prototype.groupSegRows=function(t){var e,n=[];for(e=0;e<this.dayGrid.rowCnt;e++)n.push([]);for(e=0;e<t.length;e++)n[t[e].row].push(t[e]);return n},e.prototype.computeEventTimeFormat=function(){return this.opt("extraSmallTimeFormat")},e.prototype.computeDisplayEventEnd=function(){return 1===this.dayGrid.colCnt},e.prototype.fgSegHtml=function(t,e){var n,r,i=this.view,o=t.footprint.eventDef,s=t.footprint.componentFootprint.isAllDay,l=i.isEventDefDraggable(o),u=!e&&s&&t.isStart&&i.isEventDefResizableFromStart(o),d=!e&&s&&t.isEnd&&i.isEventDefResizableFromEnd(o),c=this.getSegClasses(t,l,u||d),p=a.cssToStr(this.getSkinCss(o)),h="";return c.unshift("fc-day-grid-event","fc-h-event"),t.isStart&&(n=this.getTimeText(t.footprint))&&(h='<span class="fc-time">'+a.htmlEscape(n)+"</span>"),r='<span class="fc-title">'+(a.htmlEscape(o.title||"")||"&nbsp;")+"</span>",'<a class="'+c.join(" ")+'"'+(o.url?' href="'+a.htmlEscape(o.url)+'"':"")+(p?' style="'+p+'"':"")+'><div class="fc-content">'+(this.dayGrid.isRTL?r+" "+h:h+" "+r)+"</div>"+(u?'<div class="fc-resizer fc-start-resizer" />':"")+(d?'<div class="fc-resizer fc-end-resizer" />':"")+"</a>"},e}(l.default);e.default=u},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(63),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.renderSegs=function(t,e){var n,r=[];return n=this.eventRenderer.renderSegRows(t),this.component.rowEls.each(function(t,o){var s,a,l=i(o),u=i('<div class="fc-helper-skeleton"><table/></div>');e&&e.row===t?a=e.el.position().top:(s=l.find(".fc-content-skeleton tbody"),s.length||(s=l.find(".fc-content-skeleton table")),a=s.position().top),u.css("top",a).find("table").append(n[t].tbodyEl),l.append(u),r.push(u[0])}),i(r)},e}(o.default);e.default=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(62),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fillSegTag="td",e}return r.__extends(e,t),e.prototype.attachSegEls=function(t,e){var n,r,i,o=[];for(n=0;n<e.length;n++)r=e[n],i=this.renderFillRow(t,r),this.component.rowEls.eq(r.row).append(i),o.push(i[0]);return o},e.prototype.renderFillRow=function(t,e){var n,r,o,s=this.component.colCnt,a=e.leftCol,l=e.rightCol+1;return n="businessHours"===t?"bgevent":t.toLowerCase(),r=i('<div class="fc-'+n+'-skeleton"><table><tr/></table></div>'),o=r.find("tr"),a>0&&o.append(new Array(a+1).join("<td/>")),o.append(e.el.attr("colspan",l-a)),l<s&&o.append(new Array(s-l+1).join("<td/>")),this.component.bookendCells(o),r},e}(o.default);e.default=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(0),o=n(4),s=n(67),a=n(247),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.setGridHeight=function(t,e){e&&(t*=this.dayGrid.rowCnt/6),o.distributeHeight(this.dayGrid.rowEls,t,!e)},e.prototype.isDateInOtherMonth=function(t,e){return t.month()!==i.utc(e.currentUnzonedRange.startMs).month()},e}(s.default);e.default=l,l.prototype.dateProfileGeneratorClass=a.default},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(68),o=n(5),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.buildRenderRange=function(e,n,r){var i,s=t.prototype.buildRenderRange.call(this,e,n,r),a=this.msToUtcMoment(s.startMs,r),l=this.msToUtcMoment(s.endMs,r);return this.opt("fixedWeekCount")&&(i=Math.ceil(l.diff(a,"weeks",!0)),l.add(6-i,"weeks")),new o.default(a,l)},e}(i.default);e.default=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(4),s=n(5),a=n(43),l=n(41),u=n(249),d=n(250),c=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.segSelector=".fc-list-item",r.scroller=new l.default({overflowX:"hidden",overflowY:"auto"}),r}return r.__extends(e,t),e.prototype.renderSkeleton=function(){this.el.addClass("fc-list-view "+this.calendar.theme.getClass("listView")),this.scroller.render(),this.scroller.el.appendTo(this.el),this.contentEl=this.scroller.scrollEl},e.prototype.unrenderSkeleton=function(){this.scroller.destroy()},e.prototype.updateSize=function(e,n,r){t.prototype.updateSize.call(this,e,n,r),this.scroller.clear(),n||this.scroller.setHeight(this.computeScrollerHeight(e))},e.prototype.computeScrollerHeight=function(t){return t-o.subtractInnerElHeight(this.el,this.scroller.el)},e.prototype.renderDates=function(t){for(var e=this.calendar,n=e.msToUtcMoment(t.renderUnzonedRange.startMs,!0),r=e.msToUtcMoment(t.renderUnzonedRange.endMs,!0),i=[],o=[];n<r;)i.push(n.clone()),o.push(new s.default(n,n.clone().add(1,"day"))),n.add(1,"day");this.dayDates=i,this.dayRanges=o},e.prototype.componentFootprintToSegs=function(t){var e,n,r,i=this.dayRanges,o=[];for(e=0;e<i.length;e++)if((n=t.unzonedRange.intersect(i[e]))&&(r={startMs:n.startMs,endMs:n.endMs,isStart:n.isStart,isEnd:n.isEnd,dayIndex:e},o.push(r),!r.isEnd&&!t.isAllDay&&e+1<i.length&&t.unzonedRange.endMs<i[e+1].startMs+this.nextDayThreshold)){r.endMs=t.unzonedRange.endMs,r.isEnd=!0;break}return o},e.prototype.renderEmptyMessage=function(){this.contentEl.html('<div class="fc-list-empty-wrap2"><div class="fc-list-empty-wrap1"><div class="fc-list-empty">'+o.htmlEscape(this.opt("noEventsMessage"))+"</div></div></div>")},e.prototype.renderSegList=function(t){var e,n,r,o=this.groupSegsByDay(t),s=i('<table class="fc-list-table '+this.calendar.theme.getClass("tableList")+'"><tbody/></table>'),a=s.find("tbody");for(e=0;e<o.length;e++)if(n=o[e])for(a.append(this.dayHeaderHtml(this.dayDates[e])),this.eventRenderer.sortEventSegs(n),r=0;r<n.length;r++)a.append(n[r].el);this.contentEl.empty().append(s)},e.prototype.groupSegsByDay=function(t){var e,n,r=[];for(e=0;e<t.length;e++)n=t[e],(r[n.dayIndex]||(r[n.dayIndex]=[])).push(n);return r},e.prototype.dayHeaderHtml=function(t){var e=this.opt("listDayFormat"),n=this.opt("listDayAltFormat");return'<tr class="fc-list-heading" data-date="'+t.format("YYYY-MM-DD")+'"><td class="'+(this.calendar.theme.getClass("tableListHeading")||this.calendar.theme.getClass("widgetHeader"))+'" colspan="3">'+(e?this.buildGotoAnchorHtml(t,{class:"fc-list-heading-main"},o.htmlEscape(t.format(e))):"")+(n?this.buildGotoAnchorHtml(t,{class:"fc-list-heading-alt"},o.htmlEscape(t.format(n))):"")+"</td></tr>"},e}(a.default);e.default=c,c.prototype.eventRendererClass=u.default,c.prototype.eventPointingClass=d.default},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(4),o=n(44),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.renderFgSegs=function(t){t.length?this.component.renderSegList(t):this.component.renderEmptyMessage()},e.prototype.fgSegHtml=function(t){var e,n=this.view,r=n.calendar,o=r.theme,s=t.footprint,a=s.eventDef,l=s.componentFootprint,u=a.url,d=["fc-list-item"].concat(this.getClasses(a)),c=this.getBgColor(a);return e=l.isAllDay?n.getAllDayHtml():n.isMultiDayRange(l.unzonedRange)?t.isStart||t.isEnd?i.htmlEscape(this._getTimeText(r.msToMoment(t.startMs),r.msToMoment(t.endMs),l.isAllDay)):n.getAllDayHtml():i.htmlEscape(this.getTimeText(s)),u&&d.push("fc-has-url"),'<tr class="'+d.join(" ")+'">'+(this.displayEventTime?'<td class="fc-list-item-time '+o.getClass("widgetContent")+'">'+(e||"")+"</td>":"")+'<td class="fc-list-item-marker '+o.getClass("widgetContent")+'"><span class="fc-event-dot"'+(c?' style="background-color:'+c+'"':"")+'></span></td><td class="fc-list-item-title '+o.getClass("widgetContent")+'"><a'+(u?' href="'+i.htmlEscape(u)+'"':"")+">"+i.htmlEscape(a.title||"")+"</a></td></tr>"},e.prototype.computeEventTimeFormat=function(){return this.opt("mediumTimeFormat")},e}(o.default);e.default=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(64),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.handleClick=function(e,n){var r;t.prototype.handleClick.call(this,e,n),i(n.target).closest("a[href]").length||(r=e.footprint.eventDef.url)&&!n.isDefaultPrevented()&&(window.location.href=r)},e}(o.default);e.default=s},,,,,,function(t,e,n){var r=n(3),i=n(18),o=n(4),s=n(232);n(11),n(49),n(260),n(261),n(264),n(265),n(266),n(267),r.fullCalendar=i,r.fn.fullCalendar=function(t){var e=Array.prototype.slice.call(arguments,1),n=this;return this.each(function(i,a){var l,u=r(a),d=u.data("fullCalendar");"string"==typeof t?"getCalendar"===t?i||(n=d):"destroy"===t?d&&(d.destroy(),u.removeData("fullCalendar")):d?r.isFunction(d[t])?(l=d[t].apply(d,e),i||(n=l),"destroy"===t&&u.removeData("fullCalendar")):o.warn("'"+t+"' is an unknown FullCalendar method."):o.warn("Attempting to call a FullCalendar method on an element with no calendar."):d||(d=new s.default(u,t),u.data("fullCalendar",d),d.render())}),n},t.exports=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(4),o=function(){function t(t,e){this.el=null,this.viewsWithButtons=[],this.calendar=t,this.toolbarOptions=e}return t.prototype.setToolbarOptions=function(t){this.toolbarOptions=t},t.prototype.render=function(){var t=this.toolbarOptions.layout,e=this.el;t?(e?e.empty():e=this.el=r("<div class='fc-toolbar "+this.toolbarOptions.extraClasses+"'/>"),e.append(this.renderSection("left")).append(this.renderSection("right")).append(this.renderSection("center")).append('<div class="fc-clear"/>')):this.removeElement()},t.prototype.removeElement=function(){this.el&&(this.el.remove(),this.el=null)},t.prototype.renderSection=function(t){var e=this,n=this.calendar,o=n.theme,s=n.optionsManager,a=n.viewSpecManager,l=r('<div class="fc-'+t+'"/>'),u=this.toolbarOptions.layout[t],d=s.get("customButtons")||{},c=s.overrides.buttonText||{},p=s.get("buttonText")||{};return u&&r.each(u.split(" "),function(t,s){var u,h=r(),f=!0;r.each(s.split(","),function(t,s){var l,u,g,v,y,m,b,w,D;"title"===s?(h=h.add(r("<h2>&nbsp;</h2>")),f=!1):((l=d[s])?(g=function(t){l.click&&l.click.call(w[0],t)},(v=o.getCustomButtonIconClass(l))||(v=o.getIconClass(s))||(y=l.text)):(u=a.getViewSpec(s))?(e.viewsWithButtons.push(s),g=function(){n.changeView(s)},(y=u.buttonTextOverride)||(v=o.getIconClass(s))||(y=u.buttonTextDefault)):n[s]&&(g=function(){n[s]()},(y=c[s])||(v=o.getIconClass(s))||(y=p[s])),g&&(b=["fc-"+s+"-button",o.getClass("button"),o.getClass("stateDefault")],y?(m=i.htmlEscape(y),D=""):v&&(m="<span class='"+v+"'></span>",D=' aria-label="'+s+'"'),w=r('<button type="button" class="'+b.join(" ")+'"'+D+">"+m+"</button>").click(function(t){w.hasClass(o.getClass("stateDisabled"))||(g(t),(w.hasClass(o.getClass("stateActive"))||w.hasClass(o.getClass("stateDisabled")))&&w.removeClass(o.getClass("stateHover")))}).mousedown(function(){w.not("."+o.getClass("stateActive")).not("."+o.getClass("stateDisabled")).addClass(o.getClass("stateDown"))}).mouseup(function(){w.removeClass(o.getClass("stateDown"))}).hover(function(){w.not("."+o.getClass("stateActive")).not("."+o.getClass("stateDisabled")).addClass(o.getClass("stateHover"))},function(){w.removeClass(o.getClass("stateHover")).removeClass(o.getClass("stateDown"))}),h=h.add(w)))}),f&&h.first().addClass(o.getClass("cornerLeft")).end().last().addClass(o.getClass("cornerRight")).end(),h.length>1?(u=r("<div/>"),f&&u.addClass(o.getClass("buttonGroup")),u.append(h),l.append(u)):l.append(h)}),l},t.prototype.updateTitle=function(t){this.el&&this.el.find("h2").text(t)},t.prototype.activateButton=function(t){this.el&&this.el.find(".fc-"+t+"-button").addClass(this.calendar.theme.getClass("stateActive"))},t.prototype.deactivateButton=function(t){this.el&&this.el.find(".fc-"+t+"-button").removeClass(this.calendar.theme.getClass("stateActive"))},t.prototype.disableButton=function(t){this.el&&this.el.find(".fc-"+t+"-button").prop("disabled",!0).addClass(this.calendar.theme.getClass("stateDisabled"))},t.prototype.enableButton=function(t){this.el&&this.el.find(".fc-"+t+"-button").prop("disabled",!1).removeClass(this.calendar.theme.getClass("stateDisabled"))},t.prototype.getViewsWithButtons=function(){return this.viewsWithButtons},t}();e.default=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(3),o=n(4),s=n(33),a=n(32),l=n(51),u=function(t){function e(e,n){var r=t.call(this)||this;return r._calendar=e,r.overrides=i.extend({},n),r.dynamicOverrides={},r.compute(),r}return r.__extends(e,t),e.prototype.add=function(t){var e,n=0;this.recordOverrides(t);for(e in t)n++;if(1===n){if("height"===e||"contentHeight"===e||"aspectRatio"===e)return void this._calendar.updateViewSize(!0);if("defaultDate"===e)return;if("businessHours"===e)return;if(/^(event|select)(Overlap|Constraint|Allow)$/.test(e))return;if("timezone"===e)return void this._calendar.view.flash("initialEvents")}this._calendar.renderHeader(),this._calendar.renderFooter(),this._calendar.viewsByType={},this._calendar.reinitView()},e.prototype.compute=function(){var t,e,n,r,i;t=o.firstDefined(this.dynamicOverrides.locale,this.overrides.locale),e=a.localeOptionHash[t],e||(t=s.globalDefaults.locale,e=a.localeOptionHash[t]||{}),n=o.firstDefined(this.dynamicOverrides.isRTL,this.overrides.isRTL,e.isRTL,s.globalDefaults.isRTL),r=n?s.rtlDefaults:{},this.dirDefaults=r,this.localeDefaults=e,i=s.mergeOptions([s.globalDefaults,r,e,this.overrides,this.dynamicOverrides]),a.populateInstanceComputableOptions(i),this.reset(i)},e.prototype.recordOverrides=function(t){var e;for(e in t)this.dynamicOverrides[e]=t[e];this._calendar.viewSpecManager.clearCache(),this.compute()},e}(l.default);e.default=u},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(3),o=n(24),s=n(4),a=n(33),l=n(32),u=function(){function t(t,e){this.optionsManager=t,this._calendar=e,this.clearCache()}return t.prototype.clearCache=function(){this.viewSpecCache={}},t.prototype.getViewSpec=function(t){var e=this.viewSpecCache;return e[t]||(e[t]=this.buildViewSpec(t))},t.prototype.getUnitViewSpec=function(t){var e,n,r;if(-1!==i.inArray(t,s.unitsDesc))for(e=this._calendar.header.getViewsWithButtons(),i.each(o.viewHash,function(t){e.push(t)}),n=0;n<e.length;n++)if((r=this.getViewSpec(e[n]))&&r.singleUnit===t)return r},t.prototype.buildViewSpec=function(t){for(var e,n,i,l,u,d=this.optionsManager.overrides.views||{},c=[],p=[],h=[],f=t;f;)e=o.viewHash[f],n=d[f],f=null,"function"==typeof e&&(e={class:e}),e&&(c.unshift(e),p.unshift(e.defaults||{}),i=i||e.duration,f=f||e.type),n&&(h.unshift(n),i=i||n.duration,f=f||n.type);return e=s.mergeProps(c),e.type=t,!!e.class&&(i=i||this.optionsManager.dynamicOverrides.duration||this.optionsManager.overrides.duration,i&&(l=r.duration(i),l.valueOf()&&(u=s.computeDurationGreatestUnit(l,i),e.duration=l,e.durationUnit=u,1===l.as(u)&&(e.singleUnit=u,h.unshift(d[u]||{})))),e.defaults=a.mergeOptions(p),e.overrides=a.mergeOptions(h),this.buildViewSpecOptions(e),this.buildViewSpecButtonText(e,t),e)},t.prototype.buildViewSpecOptions=function(t){var e=this.optionsManager;t.options=a.mergeOptions([a.globalDefaults,t.defaults,e.dirDefaults,e.localeDefaults,e.overrides,t.overrides,e.dynamicOverrides]),l.populateInstanceComputableOptions(t.options)},t.prototype.buildViewSpecButtonText=function(t,e){function n(n){var r=n.buttonText||{};return r[e]||(t.buttonTextKey?r[t.buttonTextKey]:null)||(t.singleUnit?r[t.singleUnit]:null)}var r=this.optionsManager;t.buttonTextOverride=n(r.dynamicOverrides)||n(r.overrides)||t.overrides.buttonText,t.buttonTextDefault=n(r.localeDefaults)||n(r.dirDefaults)||t.defaults.buttonText||n(a.globalDefaults)||(t.duration?this._calendar.humanizeDuration(t.duration):null)||e},t}();e.default=u},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(38),i=n(56),o=n(223),s=n(224);r.default.registerClass(i.default),r.default.registerClass(o.default),r.default.registerClass(s.default)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(57),i=n(221),o=n(222),s=n(262),a=n(263);r.defineThemeSystem("standard",i.default),r.defineThemeSystem("jquery-ui",o.default),r.defineThemeSystem("bootstrap3",s.default),r.defineThemeSystem("bootstrap4",a.default)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(22),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);e.default=o,o.prototype.classes={widget:"fc-bootstrap3",tableGrid:"table-bordered",tableList:"table",tableListHeading:"active",buttonGroup:"btn-group",button:"btn btn-default",stateActive:"active",stateDisabled:"disabled",today:"alert alert-info",popover:"panel panel-default",popoverHeader:"panel-heading",popoverContent:"panel-body",headerRow:"panel-default",dayRow:"panel-default",listView:"panel panel-default"},o.prototype.baseIconClass="glyphicon",o.prototype.iconClasses={close:"glyphicon-remove",prev:"glyphicon-chevron-left",next:"glyphicon-chevron-right",prevYear:"glyphicon-backward",nextYear:"glyphicon-forward"},o.prototype.iconOverrideOption="bootstrapGlyphicons",o.prototype.iconOverrideCustomButtonOption="bootstrapGlyphicon",o.prototype.iconOverridePrefix="glyphicon-"},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(22),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);e.default=o,o.prototype.classes={widget:"fc-bootstrap4",tableGrid:"table-bordered",tableList:"table",tableListHeading:"table-active",buttonGroup:"btn-group",button:"btn btn-primary",stateActive:"active",stateDisabled:"disabled",today:"alert alert-info",popover:"card card-primary",popoverHeader:"card-header",popoverContent:"card-body",headerRow:"table-bordered",dayRow:"table-bordered",listView:"card card-primary"},o.prototype.baseIconClass="fa",o.prototype.iconClasses={close:"fa-times",prev:"fa-chevron-left",next:"fa-chevron-right",prevYear:"fa-angle-double-left",nextYear:"fa-angle-double-right"},o.prototype.iconOverrideOption="bootstrapFontAwesome",o.prototype.iconOverrideCustomButtonOption="bootstrapFontAwesome",o.prototype.iconOverridePrefix="fa-"},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(24),i=n(67),o=n(246);r.defineView("basic",{class:i.default}),r.defineView("basicDay",{type:"basic",duration:{days:1}}),r.defineView("basicWeek",{type:"basic",duration:{weeks:1}}),r.defineView("month",{class:o.default,duration:{months:1},defaults:{fixedWeekCount:!0}})},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(24),i=n(238);r.defineView("agenda",{class:i.default,defaults:{allDaySlot:!0,slotDuration:"00:30:00",slotEventOverlap:!0}}),r.defineView("agendaDay",{type:"agenda",duration:{days:1}}),r.defineView("agendaWeek",{type:"agenda",duration:{weeks:1}})},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(24),i=n(248);r.defineView("list",{class:i.default,buttonTextKey:"list",defaults:{buttonText:"list",listDayFormat:"LL",noEventsMessage:"No events to display"}}),r.defineView("listDay",{type:"list",duration:{days:1},defaults:{listDayFormat:"dddd"}}),r.defineView("listWeek",{type:"list",duration:{weeks:1},defaults:{listDayFormat:"dddd",listDayAltFormat:"LL"}}),r.defineView("listMonth",{type:"list",duration:{month:1},defaults:{listDayAltFormat:"dddd"}}),r.defineView("listYear",{type:"list",duration:{year:1},defaults:{listDayAltFormat:"dddd"}})},function(t,e){Object.defineProperty(e,"__esModule",{value:!0})}])});;
var FogSoft=(function(module,$){var tenderParticipationModule=module.TenderParticipation=module.TenderParticipation||{};var currentCertificateThumbprint;var operatorCertificateRawData;tenderParticipationModule.setModuleOptions=function(options){currentCertificateThumbprint=options.currentCertificateThumbprint;operatorCertificateRawData=options.operatorCertificateRawData};tenderParticipationModule.preventSubmitForm=function(e){e.preventDefault()};tenderParticipationModule.serializeFieldsInvariantCulture=function($element){var obj=$element.find(":input:not([do-not-post])").filter(function(i,e){return e.name&&e.value!==""}).map(function(i,e){var item={name:e.name};if($(e).hasClass("numeric")){var parsedNumber=$(e).data("valInteger")?Globalize.parseInt(e.value):Globalize.parseFloat(e.value);item.value=!isNaN(parsedNumber)&&isFinite(parsedNumber)?parsedNumber:e.value}else{if($(e).data("is-classifier-input")){var text=$(e).data("text");return[{name:e.name,value:e.value,text:text},{name:e.name+".Title",value:text,text:text}]}else{item.value=e.value}}return item}).get();return JSON.stringify(obj)};tenderParticipationModule.fillViewFormBySerializedFields=function($element,values){if(!values||!values.length){return}$element.find('[data-type="classifier"]').each(function(){var $classifier=$(this);var dataUrl=$classifier.data("items-url");var dataType=$classifier.data("type");var $control=$classifier.closest(".control-readonly");$control.data("items-url",dataUrl);$control.data("type",dataType)});values.forEach(function(item){var $input=$element.find('.control-readonly[data-field-name="'+item.name+'"]');if(typeof item.value==="number"){$input.hasClass("money")?$input.html(module.Common.formatNumber(item.value,null,"Money")):$input.html(module.Common.formatNumber(item.value,null,"Number"))}else{$input.html(item.value)}});$element.find('.control-readonly[data-type="classifier"]').each(function(){var $control=$(this);var name=$control.data("field-name");var classifierItems=$.grep(values,function(e){return e.name===name}).map(function(e){return e.text});if(classifierItems.length){var text="";classifierItems.forEach(function(classifierItem){text=text+classifierItem+"<br/>"});$control.html(text)}})};tenderParticipationModule.encryptDataWithManyCertificates=function(certificatesArray,data){return FogSoftSigner.getAsync().then(function(signer){var certificatesDeferreds=[];certificatesArray.forEach(function(cert){certificatesDeferreds.push(signer.ImportCertificateAsync(cert))});certificatesDeferreds.push(signer.FindCertificateByThumbprintAsync(currentCertificateThumbprint));return $.when.apply($,certificatesDeferreds).then(function(){return signer.EncryptAsync(Array.prototype.slice.call(arguments),data)})})};tenderParticipationModule.encryptData=function(withOperatorOver,data){return FogSoftSigner.getAsync().then(function(signer){return signer.FindCertificateByThumbprintAsync(currentCertificateThumbprint).then(function(userCert){return signer.EncryptAsync(userCert,data)}).then(function(encryptedData){if(withOperatorOver){return tenderParticipationModule.encryptDataByOperator(encryptedData)}return encryptedData})})};tenderParticipationModule.encryptDataByOperator=function(data){return FogSoftSigner.getAsync().then(function(signer){return signer.ImportCertificateAsync(operatorCertificateRawData).then(function(operatorCert){return signer.EncryptAsync(operatorCert,data)})})};tenderParticipationModule.getXmlString=function(url,action){return $.ajax({type:"POST",url:url,success:function(data){action(data&&data.Data?data.Data.Xml:$.type(data)=="string"?data:null)},dataType:"json"})};tenderParticipationModule.loadXmlDataForSigningInCollapsableBlock=function($publicDataToSignBlock,$actionBtn,getXmlUrl,xmlObject){$publicDataToSignBlock.on("loading.dataBlock.data-api",function(e,opt){if(opt){opt.dataType="json";opt.dataHandler=function(data,jqXhr,block,contentHolder){var dataToSign=data&&data.Data?data.Data.Xml:$.type(data)==="string"?data:null;$actionBtn.removeAttr("disabled");$actionBtn.removeClass("disabled");contentHolder.text(dataToSign);xmlObject.xmlData=dataToSign}}}).on("loaded.dataBlock.data-api",function(){}).dataBlock({url:getXmlUrl,target:".ui-block-content pre",autoLoad:true})};tenderParticipationModule.checkAndNotifyCurrentUserCertificateAvailability=function(){return FogSoftSigner.getAsync().then(function(signer){return signer.FindCertificateByThumbprintAsync(currentCertificateThumbprint).then(function(){return true})})};tenderParticipationModule.getSignedData=function(data){return FogSoftSigner.getAsync().then(function(signer){return signer.FindCertificateByThumbprintAsync(currentCertificateThumbprint).then(function(userCert){return signer.SignAsync(userCert,data)})})};var validatePriceOffer=function(offer,initialPrice,priceChangeDirectionCode,positionTitle,previousOffer){var maxPrice=1000000000000;if(isNaN(offer)||offer>maxPrice){return positionTitle?tenderParticipationModule.messages.incorrectInputForPosition.format(positionTitle):tenderParticipationModule.messages.incorrectInput}if(offer<=0){return positionTitle?tenderParticipationModule.messages.priceOfferHasToBeGreaterThanZeroForPosition.format(positionTitle):tenderParticipationModule.messages.priceOfferHasToBeGreaterThanZero}if(initialPrice&&priceChangeDirectionCode==-1&&offer>initialPrice){return positionTitle?tenderParticipationModule.messages.priceOfferHasToBeLessThanInitialPriceForPosition.format(positionTitle):tenderParticipationModule.messages.priceOfferHasToBeLessThanInitialPrice}if(initialPrice&&priceChangeDirectionCode==1&&offer<initialPrice){return positionTitle?tenderParticipationModule.messages.priceOfferHasToBeGreaterThanInitialPriceForPosition.format(positionTitle):tenderParticipationModule.messages.priceOfferHasToBeGreaterThanInitialPrice}if(previousOffer&&priceChangeDirectionCode==-1&&offer>=previousOffer){return positionTitle?tenderParticipationModule.messages.priceOfferHasToBeLessThanPreviousPriceForPosition.format(positionTitle):tenderParticipationModule.messages.priceOfferHasToBeLessThanPreviousPrice}if(previousOffer&&priceChangeDirectionCode==1&&offer<=previousOffer){return positionTitle?tenderParticipationModule.messages.priceOfferHasToBeGreaterThanPreviousPriceForPosition.format(positionTitle):tenderParticipationModule.messages.priceOfferHasToBeGreaterThanPreviousPrice}};var tryGetNumber=function(value){var v=value===null?"":value;return typeof v=="number"?v:Globalize.parseFloat(v)};tenderParticipationModule.validateRequest=function(request,offerRequired,priceChangeDirectionCode){var errorMessages=[];if(!request.priceOffer&&offerRequired){errorMessages.push(tenderParticipationModule.messages.errorNoPriceOffer)}if(!!request.priceOffer){var priceOffer=tryGetNumber(request.priceOffer);var previousOffer=tryGetNumber(request.previousOffer);var initialPrice=tryGetNumber(request.initialPrice);var message=validatePriceOffer(priceOffer,initialPrice,priceChangeDirectionCode,"",previousOffer);if(message){errorMessages.push(message)}}return{success:errorMessages.length==0,messages:errorMessages}};tenderParticipationModule.validatePositionalRequest=function(requestPositions,offerRequired,priceChangeDirectionCode){if(!requestPositions||requestPositions.length==0){return{success:false,messages:[tenderParticipationModule.messages.errorSelectedPositionListEmpty]}}var errorMessages=[];requestPositions.forEach(function(requestPosition){if(!requestPosition.priceOffer&&offerRequired){errorMessages.push(tenderParticipationModule.messages.errorNoPriceOfferForPosition.format(requestPosition.title))}if(!!requestPosition.priceOffer){var priceOffer=tryGetNumber(requestPosition.priceOffer);var previousPriceOffer=tryGetNumber(requestPosition.previousPriceOffer);var initialPrice=tryGetNumber(requestPosition.initialPrice);var message=validatePriceOffer(priceOffer,initialPrice,priceChangeDirectionCode,requestPosition.title,previousPriceOffer);if(message){errorMessages.push(message)}}});return{success:errorMessages.length==0,messages:errorMessages}};tenderParticipationModule.excludeAjaxPostData=function($form,propertyName){$form.on("sending.dataForm.data-api",function(e,ajaxOpts){var data=ajaxOpts.data;if(!$.isArray(data)){return}ajaxOpts.data=$.grep(data,function(el){return el&&el.name&&el.name.indexOf(propertyName)===-1})})};tenderParticipationModule.replaceOldJsonValues=function(object){if(object.length||object.length===0){return object}var items=[{name:"PriceOffer",value:object}];return items};if(!String.prototype.format){String.prototype.format=function(){var args=arguments;return this.replace(/{(\d+)}/g,function(match,number){return typeof args[number]!="undefined"?args[number]:match})}}return module}(FogSoft||{},jQuery));if(!String.prototype.format){String.prototype.format=function(){var args=arguments;return this.replace(/{(\d+)}/g,function(match,number){return typeof args[number]!="undefined"?args[number]:match})}}var FogSoft=(function(module,$){var teamsModule=module.Teams=module.Teams||{};teamsModule.initTeams=function(form,options){$(form).TeamsForm(options)};return module})(FogSoft||{},$);(function(jQuery){function updateBuffer(form,options){var total=[];form.find(".role").each(function(){var role=$(this);var roleCode=role.data()["roleCode"];role.find(".member").each(function(){var data=$(this).data();var uid=data.memberUid;var typecode=data.memberCode;total.push({EntityUid:uid,EntityTypeCode:typecode,RoleCode:roleCode})});return this});form.find(options.bufferId).val(JSON.stringify(total));return this}jQuery.fn.Role=function(options){var self=this,container=$(self);var input=container.find("input");var isEdit=typeof options.autocompleteUrl!=="undefined";var obj={members:{},container:container,addMember:function(name,uid,typeCode,isLocked){var role=this.container,memberTemplate=options.templateResolver(typeCode);var template=(isEdit&&isLocked===false)?"#team-member-edit":"#team-member-view";var member=$(template).tmpl({memberUid:uid,memberCode:typeCode,memberName:name,memberTemplate:memberTemplate});var form=role.parents("form");if(!(uid in this.members)){if(isEdit){role.find("#members .member-search").before(member)}else{role.find("#members").append(member)}member.find(".remove-button").on("click",function(){var parent=$(this).parent();obj.removeMember(parent.data("member-uid"));return this});this.members[uid]=null;updateBuffer(form,options)}return self},removeMember:function(memberUid){if(memberUid in this.members){$(self).find('[data-member-uid="'+memberUid+'"]').parent().remove();delete this.members[memberUid];updateBuffer(this.container.parents("form"),options)}return self}};if(options.autocompleteUrl){obj.container.on("click",function(){input.focus()});input.typeaheadExt({selectKey:function(key){if(typeof key=="undefined"){return false}obj.addMember(key.value,key.id,key.typeCode,false);input.focus();return true}});input.change(function(ev){$(this).val("");ev.preventDefault();return false});input.focus(function(ev){input.closest("#members").parent().addClass("input-highlight")});input.blur(function(ev){input.closest("#members").parent().removeClass("input-highlight")});input.keydown(function(event){if(event.keyCode==8){if(event.target.value.length>0){return true}if(obj.container.find(".member").length>0){obj.removeMember(obj.container.find(".member").last().data("member-uid"));return false}}return true})}return obj};jQuery.fn.TeamsForm=function(options){var opts=jQuery.extend({bufferId:"#hiddenBuffer",rolesContainer:"#rolesContainer",templateResolver:function(memberType){memberType=memberType.toLowerCase();switch(memberType){case"person":return"#team-member-person";case"companypersongroup":return"#team-member-group";default:return"#team-member-person"}}},options);return this.each(function(){var buffer=JSON.parse($(this).find(opts.bufferId).val()),form=$(this);jQuery.each(buffer,function(index,elem){var roleTmp=opts.autocompleteUrl?"#team-roles-edit":"#team-roles-view";var role=$($(roleTmp).tmpl({roleCode:elem.roleCode,roleName:elem.roleName,roleDescription:elem.roleDescription,autocompleteUrl:opts.autocompleteUrl})).Role(opts);jQuery.each(elem.members,function(idx,member){role.addMember(member.entityName,member.entityUid,member.entityTypeCode,member.isLocked)});form.find(opts.rolesContainer).append(role.container)});updateBuffer(form,options)})}})(jQuery);$(function(){$('[rel="reset-password"]').on("click",function(e){var $el=$(this),qsParam=$el.data("queryStringParam");if(!qsParam||!$.isPlainObject(qsParam)){return}var $form=$el.closest("form"),queryString="";$.each(qsParam,function(p,v){var val=$form.find('[name="'+v+'"]').val();if(val){queryString+=(queryString?"&":"")+p+"="+val}});if(queryString){var href=$el.attr("href");$el.attr("href",href+(href.indexOf("?")>0?"&":"?")+queryString)}})});$(function(){var $clockBlock=$(".clock");var loadUrl=$clockBlock.data("loadUrl");if(!loadUrl){return}var $spanDate=$($clockBlock).find(".date-part");var $spanTime=$($clockBlock).find(".time-part");var timeZone=$clockBlock.data("timeZone");var dateTime=new Date($clockBlock.data("initialDate"));update(dateTime);function updateServerTime(timeout){window.setTimeout(function getServerTime(){$.ajax({type:"GET",dataType:"json",url:loadUrl,success:function(result){if(result.Success){dateTime=new Date(result.Data);if(dateTime){update(dateTime)}var newTimeout=((60-dateTime.getSeconds())||1)*1000;updateServerTime(newTimeout)}else{for(var numMessage in result.Messages){FogSoft.Common.showErrorMessage(result.Messages[numMessage].Text)}}},error:function(response){response.status!==200&&console&&console.log("ÐÑÐ¾Ð¸Ð·Ð¾ÑÐ»Ð° ÑÐµÑÐ²ÐµÑÐ½Ð°Ñ Ð¾ÑÐ¸Ð±ÐºÐ° Ð¿ÑÐ¸ ÑÐ¸Ð½ÑÑÐ¾Ð½Ð¸Ð·Ð°ÑÐ¸Ð¸ Ð²ÑÐµÐ¼ÐµÐ½Ð¸")}})},timeout)}updateServerTime(1000);function getTwoDigitNumber(number){return(number<10?"0":"")+number}function getFormattedTime(serverDateTime){return getTwoDigitNumber(serverDateTime.getHours())+":"+getTwoDigitNumber(serverDateTime.getMinutes())}function setFormattedTime(formattedDateTime){$spanTime.text(formattedDateTime).append('<span class="time-zone"> UTC'+timeZone+"</span>")}function setFormattedDate(formattedDate){$spanDate.text(formattedDate)}function setTooltipDateTime(formattedDateTime,serverDate){$clockBlock.attr("data-original-title",serverDate+" "+formattedDateTime+" (UTC"+timeZone+")")}function update(serverDateTime){var formattedDateTime=getFormattedTime(serverDateTime);var serverDate=window.Globalize.format(serverDateTime,"dd.MM.yy");setTooltipDateTime(formattedDateTime,serverDate);setFormattedTime(formattedDateTime);var formattedDate=window.Globalize.format(serverDateTime,"dd MMMM yyyy");setFormattedDate(formattedDate)}});(function(module,$){var submodule=module.TenderCompletion=module.TenderCompletion||{};submodule.collapsePositions=function(selector){var $list=$(selector);var list=$(selector)[0];var i;if($list.hasClass("closed")){for(i=1;i<list.children.length;++i){$(list.children[i]).removeClass("hidden")}$list.removeClass("closed");$list.parent().find(".icon-triangle-down").addClass("hidden");$list.parent().find(".icon-triangle-up").removeClass("hidden")}else{for(i=1;i<list.children.length;++i){$(list.children[i]).addClass("hidden")}$list.addClass("closed");$list.parent().find(".icon-triangle-down").removeClass("hidden");$list.parent().find(".icon-triangle-up").addClass("hidden")}return false};return module})(window.FogSoft||{},window.jQuery);$(function(){$(".generate-report").click(function(e){var url=$(e.target).data("reportUrl");var $form=$(e.target).closest("form");var formData=$form.dataForm("getValuesArray");var queryString=formData.reduce(function(accumulator,currentValue,index,array){return accumulator+"&"+currentValue.name+"="+currentValue.value},"");window.location.href=url+queryString})});
/* PhotoSwipe - v4.1.2 - 2017-04-05
* http://photoswipe.com
* Copyright (c) 2017 Dmitry Semenov; */
(function(root,factory){if(typeof define==="function"&&define.amd){define(factory)}else{if(typeof exports==="object"){module.exports=factory()}else{root.PhotoSwipe=factory()}}})(this,function(){var PhotoSwipe=function(template,UiClass,items,options){var framework={features:null,bind:function(target,type,listener,unbind){var methodName=(unbind?"remove":"add")+"EventListener";type=type.split(" ");for(var i=0;i<type.length;i++){if(type[i]){target[methodName](type[i],listener,false)}}},isArray:function(obj){return(obj instanceof Array)},createEl:function(classes,tag){var el=document.createElement(tag||"div");if(classes){el.className=classes}return el},getScrollY:function(){var yOffset=window.pageYOffset;return yOffset!==undefined?yOffset:document.documentElement.scrollTop},unbind:function(target,type,listener){framework.bind(target,type,listener,true)},removeClass:function(el,className){var reg=new RegExp("(\\s|^)"+className+"(\\s|$)");el.className=el.className.replace(reg," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")},addClass:function(el,className){if(!framework.hasClass(el,className)){el.className+=(el.className?" ":"")+className}},hasClass:function(el,className){return el.className&&new RegExp("(^|\\s)"+className+"(\\s|$)").test(el.className)},getChildByClass:function(parentEl,childClassName){var node=parentEl.firstChild;while(node){if(framework.hasClass(node,childClassName)){return node}node=node.nextSibling}},arraySearch:function(array,value,key){var i=array.length;while(i--){if(array[i][key]===value){return i}}return -1},extend:function(o1,o2,preventOverwrite){for(var prop in o2){if(o2.hasOwnProperty(prop)){if(preventOverwrite&&o1.hasOwnProperty(prop)){continue}o1[prop]=o2[prop]}}},easing:{sine:{out:function(k){return Math.sin(k*(Math.PI/2))},inOut:function(k){return -(Math.cos(Math.PI*k)-1)/2}},cubic:{out:function(k){return --k*k*k+1}}},detectFeatures:function(){if(framework.features){return framework.features}var helperEl=framework.createEl(),helperStyle=helperEl.style,vendor="",features={};features.oldIE=document.all&&!document.addEventListener;features.touch="ontouchstart" in window;if(window.requestAnimationFrame){features.raf=window.requestAnimationFrame;features.caf=window.cancelAnimationFrame}features.pointerEvent=navigator.pointerEnabled||navigator.msPointerEnabled;if(!features.pointerEvent){var ua=navigator.userAgent;if(/iP(hone|od)/.test(navigator.platform)){var v=(navigator.appVersion).match(/OS (\d+)_(\d+)_?(\d+)?/);if(v&&v.length>0){v=parseInt(v[1],10);if(v>=1&&v<8){features.isOldIOSPhone=true}}}var match=ua.match(/Android\s([0-9\.]*)/);var androidversion=match?match[1]:0;androidversion=parseFloat(androidversion);if(androidversion>=1){if(androidversion<4.4){features.isOldAndroid=true}features.androidVersion=androidversion}features.isMobileOpera=/opera mini|opera mobi/i.test(ua)}var styleChecks=["transform","perspective","animationName"],vendors=["","webkit","Moz","ms","O"],styleCheckItem,styleName;for(var i=0;i<4;i++){vendor=vendors[i];for(var a=0;a<3;a++){styleCheckItem=styleChecks[a];styleName=vendor+(vendor?styleCheckItem.charAt(0).toUpperCase()+styleCheckItem.slice(1):styleCheckItem);if(!features[styleCheckItem]&&styleName in helperStyle){features[styleCheckItem]=styleName}}if(vendor&&!features.raf){vendor=vendor.toLowerCase();features.raf=window[vendor+"RequestAnimationFrame"];if(features.raf){features.caf=window[vendor+"CancelAnimationFrame"]||window[vendor+"CancelRequestAnimationFrame"]}}}if(!features.raf){var lastTime=0;features.raf=function(fn){var currTime=new Date().getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){fn(currTime+timeToCall)},timeToCall);lastTime=currTime+timeToCall;return id};features.caf=function(id){clearTimeout(id)}}features.svg=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect;framework.features=features;return features}};framework.detectFeatures();if(framework.features.oldIE){framework.bind=function(target,type,listener,unbind){type=type.split(" ");var methodName=(unbind?"detach":"attach")+"Event",evName,_handleEv=function(){listener.handleEvent.call(listener)};for(var i=0;i<type.length;i++){evName=type[i];if(evName){if(typeof listener==="object"&&listener.handleEvent){if(!unbind){listener["oldIE"+evName]=_handleEv}else{if(!listener["oldIE"+evName]){return false}}target[methodName]("on"+evName,listener["oldIE"+evName])}else{target[methodName]("on"+evName,listener)}}}}}var self=this;var DOUBLE_TAP_RADIUS=25,NUM_HOLDERS=3;var _options={allowPanToNext:true,spacing:0.12,bgOpacity:1,mouseUsed:false,loop:true,pinchToClose:true,closeOnScroll:true,closeOnVerticalDrag:true,verticalDragRange:0.75,hideAnimationDuration:333,showAnimationDuration:333,showHideOpacity:false,focus:true,escKey:true,arrowKeys:true,mainScrollEndFriction:0.35,panEndFriction:0.35,isClickableElement:function(el){return el.tagName==="A"},getDoubleTapZoom:function(isMouseClick,item){if(isMouseClick){return 1}else{return item.initialZoomLevel<0.7?1:1.33}},maxSpreadZoom:1.33,modal:true,scaleMode:"fit"};framework.extend(_options,options);var _getEmptyPoint=function(){return{x:0,y:0}};var _isOpen,_isDestroying,_closedByScroll,_currentItemIndex,_containerStyle,_containerShiftIndex,_currPanDist=_getEmptyPoint(),_startPanOffset=_getEmptyPoint(),_panOffset=_getEmptyPoint(),_upMoveEvents,_downEvents,_globalEventHandlers,_viewportSize={},_currZoomLevel,_startZoomLevel,_translatePrefix,_translateSufix,_updateSizeInterval,_itemsNeedUpdate,_currPositionIndex=0,_offset={},_slideSize=_getEmptyPoint(),_itemHolders,_prevItemIndex,_indexDiff=0,_dragStartEvent,_dragMoveEvent,_dragEndEvent,_dragCancelEvent,_transformKey,_pointerEventEnabled,_isFixedPosition=true,_likelyTouchDevice,_modules=[],_requestAF,_cancelAF,_initalClassName,_initalWindowScrollY,_oldIE,_currentWindowScrollY,_features,_windowVisibleSize={},_renderMaxResolution=false,_orientationChangeTimeout,_registerModule=function(name,module){framework.extend(self,module.publicMethods);_modules.push(name)},_getLoopedId=function(index){var numSlides=_getNumItems();if(index>numSlides-1){return index-numSlides}else{if(index<0){return numSlides+index}}return index},_listeners={},_listen=function(name,fn){if(!_listeners[name]){_listeners[name]=[]}return _listeners[name].push(fn)},_shout=function(name){var listeners=_listeners[name];if(listeners){var args=Array.prototype.slice.call(arguments);args.shift();for(var i=0;i<listeners.length;i++){listeners[i].apply(self,args)}}},_getCurrentTime=function(){return new Date().getTime()},_applyBgOpacity=function(opacity){_bgOpacity=opacity;self.bg.style.opacity=opacity*_options.bgOpacity},_applyZoomTransform=function(styleObj,x,y,zoom,item){if(!_renderMaxResolution||(item&&item!==self.currItem)){zoom=zoom/(item?item.fitRatio:self.currItem.fitRatio)}styleObj[_transformKey]=_translatePrefix+x+"px, "+y+"px"+_translateSufix+" scale("+zoom+")"},_applyCurrentZoomPan=function(allowRenderResolution){if(_currZoomElementStyle){if(allowRenderResolution){if(_currZoomLevel>self.currItem.fitRatio){if(!_renderMaxResolution){_setImageSize(self.currItem,false,true);_renderMaxResolution=true}}else{if(_renderMaxResolution){_setImageSize(self.currItem);_renderMaxResolution=false}}}_applyZoomTransform(_currZoomElementStyle,_panOffset.x,_panOffset.y,_currZoomLevel)}},_applyZoomPanToItem=function(item){if(item.container){_applyZoomTransform(item.container.style,item.initialPosition.x,item.initialPosition.y,item.initialZoomLevel,item)}},_setTranslateX=function(x,elStyle){elStyle[_transformKey]=_translatePrefix+x+"px, 0px"+_translateSufix},_moveMainScroll=function(x,dragging){if(!_options.loop&&dragging){var newSlideIndexOffset=_currentItemIndex+(_slideSize.x*_currPositionIndex-x)/_slideSize.x,delta=Math.round(x-_mainScrollPos.x);if((newSlideIndexOffset<0&&delta>0)||(newSlideIndexOffset>=_getNumItems()-1&&delta<0)){x=_mainScrollPos.x+delta*_options.mainScrollEndFriction}}_mainScrollPos.x=x;_setTranslateX(x,_containerStyle)},_calculatePanOffset=function(axis,zoomLevel){var m=_midZoomPoint[axis]-_offset[axis];return _startPanOffset[axis]+_currPanDist[axis]+m-m*(zoomLevel/_startZoomLevel)},_equalizePoints=function(p1,p2){p1.x=p2.x;p1.y=p2.y;if(p2.id){p1.id=p2.id}},_roundPoint=function(p){p.x=Math.round(p.x);p.y=Math.round(p.y)},_mouseMoveTimeout=null,_onFirstMouseMove=function(){if(_mouseMoveTimeout){framework.unbind(document,"mousemove",_onFirstMouseMove);framework.addClass(template,"pswp--has_mouse");_options.mouseUsed=true;_shout("mouseUsed")}_mouseMoveTimeout=setTimeout(function(){_mouseMoveTimeout=null},100)},_bindEvents=function(){framework.bind(document,"keydown",self);if(_features.transform){framework.bind(self.scrollWrap,"click",self)}if(!_options.mouseUsed){framework.bind(document,"mousemove",_onFirstMouseMove)}framework.bind(window,"resize scroll orientationchange",self);_shout("bindEvents")},_unbindEvents=function(){framework.unbind(window,"resize scroll orientationchange",self);framework.unbind(window,"scroll",_globalEventHandlers.scroll);framework.unbind(document,"keydown",self);framework.unbind(document,"mousemove",_onFirstMouseMove);if(_features.transform){framework.unbind(self.scrollWrap,"click",self)}if(_isDragging){framework.unbind(window,_upMoveEvents,self)}clearTimeout(_orientationChangeTimeout);_shout("unbindEvents")},_calculatePanBounds=function(zoomLevel,update){var bounds=_calculateItemSize(self.currItem,_viewportSize,zoomLevel);if(update){_currPanBounds=bounds}return bounds},_getMinZoomLevel=function(item){if(!item){item=self.currItem}return item.initialZoomLevel},_getMaxZoomLevel=function(item){if(!item){item=self.currItem}return item.w>0?_options.maxSpreadZoom:1},_modifyDestPanOffset=function(axis,destPanBounds,destPanOffset,destZoomLevel){if(destZoomLevel===self.currItem.initialZoomLevel){destPanOffset[axis]=self.currItem.initialPosition[axis];return true}else{destPanOffset[axis]=_calculatePanOffset(axis,destZoomLevel);if(destPanOffset[axis]>destPanBounds.min[axis]){destPanOffset[axis]=destPanBounds.min[axis];return true}else{if(destPanOffset[axis]<destPanBounds.max[axis]){destPanOffset[axis]=destPanBounds.max[axis];return true}}}return false},_setupTransforms=function(){if(_transformKey){var allow3dTransform=_features.perspective&&!_likelyTouchDevice;_translatePrefix="translate"+(allow3dTransform?"3d(":"(");_translateSufix=_features.perspective?", 0px)":")";return}_transformKey="left";framework.addClass(template,"pswp--ie");_setTranslateX=function(x,elStyle){elStyle.left=x+"px"};_applyZoomPanToItem=function(item){var zoomRatio=item.fitRatio>1?1:item.fitRatio,s=item.container.style,w=zoomRatio*item.w,h=zoomRatio*item.h;s.width=w+"px";s.height=h+"px";s.left=item.initialPosition.x+"px";s.top=item.initialPosition.y+"px"};_applyCurrentZoomPan=function(){if(_currZoomElementStyle){var s=_currZoomElementStyle,item=self.currItem,zoomRatio=item.fitRatio>1?1:item.fitRatio,w=zoomRatio*item.w,h=zoomRatio*item.h;s.width=w+"px";s.height=h+"px";s.left=_panOffset.x+"px";s.top=_panOffset.y+"px"}}},_onKeyDown=function(e){var keydownAction="";if(_options.escKey&&e.keyCode===27){keydownAction="close"}else{if(_options.arrowKeys){if(e.keyCode===37){keydownAction="prev"}else{if(e.keyCode===39){keydownAction="next"}}}}if(keydownAction){if(!e.ctrlKey&&!e.altKey&&!e.shiftKey&&!e.metaKey){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}self[keydownAction]()}}},_onGlobalClick=function(e){if(!e){return}if(_moved||_zoomStarted||_mainScrollAnimating||_verticalDragInitiated){e.preventDefault();e.stopPropagation()}},_updatePageScrollOffset=function(){self.setScrollOffset(0,framework.getScrollY())};var _animations={},_numAnimations=0,_stopAnimation=function(name){if(_animations[name]){if(_animations[name].raf){_cancelAF(_animations[name].raf)}_numAnimations--;delete _animations[name]}},_registerStartAnimation=function(name){if(_animations[name]){_stopAnimation(name)}if(!_animations[name]){_numAnimations++;_animations[name]={}}},_stopAllAnimations=function(){for(var prop in _animations){if(_animations.hasOwnProperty(prop)){_stopAnimation(prop)}}},_animateProp=function(name,b,endProp,d,easingFn,onUpdate,onComplete){var startAnimTime=_getCurrentTime(),t;_registerStartAnimation(name);var animloop=function(){if(_animations[name]){t=_getCurrentTime()-startAnimTime;if(t>=d){_stopAnimation(name);onUpdate(endProp);if(onComplete){onComplete()}return}onUpdate((endProp-b)*easingFn(t/d)+b);_animations[name].raf=_requestAF(animloop)}};animloop()};var publicMethods={shout:_shout,listen:_listen,viewportSize:_viewportSize,options:_options,isMainScrollAnimating:function(){return _mainScrollAnimating},getZoomLevel:function(){return _currZoomLevel},getCurrentIndex:function(){return _currentItemIndex},isDragging:function(){return _isDragging},isZooming:function(){return _isZooming},setScrollOffset:function(x,y){_offset.x=x;_currentWindowScrollY=_offset.y=y;_shout("updateScrollOffset",_offset)},applyZoomPan:function(zoomLevel,panX,panY,allowRenderResolution){_panOffset.x=panX;_panOffset.y=panY;_currZoomLevel=zoomLevel;_applyCurrentZoomPan(allowRenderResolution)},init:function(){if(_isOpen||_isDestroying){return}var i;self.framework=framework;self.template=template;self.bg=framework.getChildByClass(template,"pswp__bg");_initalClassName=template.className;_isOpen=true;_features=framework.detectFeatures();_requestAF=_features.raf;_cancelAF=_features.caf;_transformKey=_features.transform;_oldIE=_features.oldIE;self.scrollWrap=framework.getChildByClass(template,"pswp__scroll-wrap");self.container=framework.getChildByClass(self.scrollWrap,"pswp__container");_containerStyle=self.container.style;self.itemHolders=_itemHolders=[{el:self.container.children[0],wrap:0,index:-1},{el:self.container.children[1],wrap:0,index:-1},{el:self.container.children[2],wrap:0,index:-1}];_itemHolders[0].el.style.display=_itemHolders[2].el.style.display="none";_setupTransforms();_globalEventHandlers={resize:self.updateSize,orientationchange:function(){clearTimeout(_orientationChangeTimeout);_orientationChangeTimeout=setTimeout(function(){if(_viewportSize.x!==self.scrollWrap.clientWidth){self.updateSize()}},500)},scroll:_updatePageScrollOffset,keydown:_onKeyDown,click:_onGlobalClick};var oldPhone=_features.isOldIOSPhone||_features.isOldAndroid||_features.isMobileOpera;if(!_features.animationName||!_features.transform||oldPhone){_options.showAnimationDuration=_options.hideAnimationDuration=0}for(i=0;i<_modules.length;i++){self["init"+_modules[i]]()}if(UiClass){var ui=self.ui=new UiClass(self,framework);ui.init()}_shout("firstUpdate");_currentItemIndex=_currentItemIndex||_options.index||0;if(isNaN(_currentItemIndex)||_currentItemIndex<0||_currentItemIndex>=_getNumItems()){_currentItemIndex=0}self.currItem=_getItemAt(_currentItemIndex);if(_features.isOldIOSPhone||_features.isOldAndroid){_isFixedPosition=false}template.setAttribute("aria-hidden","false");if(_options.modal){if(!_isFixedPosition){template.style.position="absolute";template.style.top=framework.getScrollY()+"px"}else{template.style.position="fixed"}}if(_currentWindowScrollY===undefined){_shout("initialLayout");_currentWindowScrollY=_initalWindowScrollY=framework.getScrollY()}var rootClasses="pswp--open ";if(_options.mainClass){rootClasses+=_options.mainClass+" "}if(_options.showHideOpacity){rootClasses+="pswp--animate_opacity "}rootClasses+=_likelyTouchDevice?"pswp--touch":"pswp--notouch";rootClasses+=_features.animationName?" pswp--css_animation":"";rootClasses+=_features.svg?" pswp--svg":"";framework.addClass(template,rootClasses);self.updateSize();_containerShiftIndex=-1;_indexDiff=null;for(i=0;i<NUM_HOLDERS;i++){_setTranslateX((i+_containerShiftIndex)*_slideSize.x,_itemHolders[i].el.style)}if(!_oldIE){framework.bind(self.scrollWrap,_downEvents,self)}_listen("initialZoomInEnd",function(){self.setContent(_itemHolders[0],_currentItemIndex-1);self.setContent(_itemHolders[2],_currentItemIndex+1);_itemHolders[0].el.style.display=_itemHolders[2].el.style.display="block";if(_options.focus){template.focus()}_bindEvents()});self.setContent(_itemHolders[1],_currentItemIndex);self.updateCurrItem();_shout("afterInit");if(!_isFixedPosition){_updateSizeInterval=setInterval(function(){if(!_numAnimations&&!_isDragging&&!_isZooming&&(_currZoomLevel===self.currItem.initialZoomLevel)){self.updateSize()}},1000)}framework.addClass(template,"pswp--visible")},close:function(){if(!_isOpen){return}_isOpen=false;_isDestroying=true;_shout("close");_unbindEvents();_showOrHide(self.currItem,null,true,self.destroy)},destroy:function(){_shout("destroy");if(_showOrHideTimeout){clearTimeout(_showOrHideTimeout)}template.setAttribute("aria-hidden","true");template.className=_initalClassName;if(_updateSizeInterval){clearInterval(_updateSizeInterval)}framework.unbind(self.scrollWrap,_downEvents,self);framework.unbind(window,"scroll",self);_stopDragUpdateLoop();_stopAllAnimations();_listeners=null},panTo:function(x,y,force){if(!force){if(x>_currPanBounds.min.x){x=_currPanBounds.min.x}else{if(x<_currPanBounds.max.x){x=_currPanBounds.max.x}}if(y>_currPanBounds.min.y){y=_currPanBounds.min.y}else{if(y<_currPanBounds.max.y){y=_currPanBounds.max.y}}}_panOffset.x=x;_panOffset.y=y;_applyCurrentZoomPan()},handleEvent:function(e){e=e||window.event;if(_globalEventHandlers[e.type]){_globalEventHandlers[e.type](e)}},goTo:function(index){index=_getLoopedId(index);var diff=index-_currentItemIndex;_indexDiff=diff;_currentItemIndex=index;self.currItem=_getItemAt(_currentItemIndex);_currPositionIndex-=diff;_moveMainScroll(_slideSize.x*_currPositionIndex);_stopAllAnimations();_mainScrollAnimating=false;self.updateCurrItem()},next:function(){self.goTo(_currentItemIndex+1)},prev:function(){self.goTo(_currentItemIndex-1)},updateCurrZoomItem:function(emulateSetContent){if(emulateSetContent){_shout("beforeChange",0)}if(_itemHolders[1].el.children.length){var zoomElement=_itemHolders[1].el.children[0];if(framework.hasClass(zoomElement,"pswp__zoom-wrap")){_currZoomElementStyle=zoomElement.style}else{_currZoomElementStyle=null}}else{_currZoomElementStyle=null}_currPanBounds=self.currItem.bounds;_startZoomLevel=_currZoomLevel=self.currItem.initialZoomLevel;_panOffset.x=_currPanBounds.center.x;_panOffset.y=_currPanBounds.center.y;if(emulateSetContent){_shout("afterChange")}},invalidateCurrItems:function(){_itemsNeedUpdate=true;for(var i=0;i<NUM_HOLDERS;i++){if(_itemHolders[i].item){_itemHolders[i].item.needsUpdate=true}}},updateCurrItem:function(beforeAnimation){if(_indexDiff===0){return}var diffAbs=Math.abs(_indexDiff),tempHolder;if(beforeAnimation&&diffAbs<2){return}self.currItem=_getItemAt(_currentItemIndex);_renderMaxResolution=false;_shout("beforeChange",_indexDiff);if(diffAbs>=NUM_HOLDERS){_containerShiftIndex+=_indexDiff+(_indexDiff>0?-NUM_HOLDERS:NUM_HOLDERS);diffAbs=NUM_HOLDERS}for(var i=0;i<diffAbs;i++){if(_indexDiff>0){tempHolder=_itemHolders.shift();_itemHolders[NUM_HOLDERS-1]=tempHolder;_containerShiftIndex++;_setTranslateX((_containerShiftIndex+2)*_slideSize.x,tempHolder.el.style);self.setContent(tempHolder,_currentItemIndex-diffAbs+i+1+1)}else{tempHolder=_itemHolders.pop();_itemHolders.unshift(tempHolder);_containerShiftIndex--;_setTranslateX(_containerShiftIndex*_slideSize.x,tempHolder.el.style);self.setContent(tempHolder,_currentItemIndex+diffAbs-i-1-1)}}if(_currZoomElementStyle&&Math.abs(_indexDiff)===1){var prevItem=_getItemAt(_prevItemIndex);if(prevItem.initialZoomLevel!==_currZoomLevel){_calculateItemSize(prevItem,_viewportSize);_setImageSize(prevItem);_applyZoomPanToItem(prevItem)}}_indexDiff=0;self.updateCurrZoomItem();_prevItemIndex=_currentItemIndex;_shout("afterChange")},updateSize:function(force){if(!_isFixedPosition&&_options.modal){var windowScrollY=framework.getScrollY();if(_currentWindowScrollY!==windowScrollY){template.style.top=windowScrollY+"px";_currentWindowScrollY=windowScrollY}if(!force&&_windowVisibleSize.x===window.innerWidth&&_windowVisibleSize.y===window.innerHeight){return}_windowVisibleSize.x=window.innerWidth;_windowVisibleSize.y=window.innerHeight;template.style.height=_windowVisibleSize.y+"px"}_viewportSize.x=self.scrollWrap.clientWidth;_viewportSize.y=self.scrollWrap.clientHeight;_updatePageScrollOffset();_slideSize.x=_viewportSize.x+Math.round(_viewportSize.x*_options.spacing);_slideSize.y=_viewportSize.y;_moveMainScroll(_slideSize.x*_currPositionIndex);_shout("beforeResize");if(_containerShiftIndex!==undefined){var holder,item,hIndex;for(var i=0;i<NUM_HOLDERS;i++){holder=_itemHolders[i];_setTranslateX((i+_containerShiftIndex)*_slideSize.x,holder.el.style);hIndex=_currentItemIndex+i-1;if(_options.loop&&_getNumItems()>2){hIndex=_getLoopedId(hIndex)}item=_getItemAt(hIndex);if(item&&(_itemsNeedUpdate||item.needsUpdate||!item.bounds)){self.cleanSlide(item);self.setContent(holder,hIndex);if(i===1){self.currItem=item;self.updateCurrZoomItem(true)}item.needsUpdate=false}else{if(holder.index===-1&&hIndex>=0){self.setContent(holder,hIndex)}}if(item&&item.container){_calculateItemSize(item,_viewportSize);_setImageSize(item);_applyZoomPanToItem(item)}}_itemsNeedUpdate=false}_startZoomLevel=_currZoomLevel=self.currItem.initialZoomLevel;_currPanBounds=self.currItem.bounds;if(_currPanBounds){_panOffset.x=_currPanBounds.center.x;_panOffset.y=_currPanBounds.center.y;_applyCurrentZoomPan(true)}_shout("resize")},zoomTo:function(destZoomLevel,centerPoint,speed,easingFn,updateFn){if(centerPoint){_startZoomLevel=_currZoomLevel;_midZoomPoint.x=Math.abs(centerPoint.x)-_panOffset.x;_midZoomPoint.y=Math.abs(centerPoint.y)-_panOffset.y;_equalizePoints(_startPanOffset,_panOffset)}var destPanBounds=_calculatePanBounds(destZoomLevel,false),destPanOffset={};_modifyDestPanOffset("x",destPanBounds,destPanOffset,destZoomLevel);_modifyDestPanOffset("y",destPanBounds,destPanOffset,destZoomLevel);var initialZoomLevel=_currZoomLevel;var initialPanOffset={x:_panOffset.x,y:_panOffset.y};_roundPoint(destPanOffset);var onUpdate=function(now){if(now===1){_currZoomLevel=destZoomLevel;_panOffset.x=destPanOffset.x;_panOffset.y=destPanOffset.y}else{_currZoomLevel=(destZoomLevel-initialZoomLevel)*now+initialZoomLevel;_panOffset.x=(destPanOffset.x-initialPanOffset.x)*now+initialPanOffset.x;_panOffset.y=(destPanOffset.y-initialPanOffset.y)*now+initialPanOffset.y}if(updateFn){updateFn(now)}_applyCurrentZoomPan(now===1)};if(speed){_animateProp("customZoomTo",0,1,speed,easingFn||framework.easing.sine.inOut,onUpdate)}else{onUpdate(1)}}};var MIN_SWIPE_DISTANCE=30,DIRECTION_CHECK_OFFSET=10;var _gestureStartTime,_gestureCheckSpeedTime,p={},p2={},delta={},_currPoint={},_startPoint={},_currPointers=[],_startMainScrollPos={},_releaseAnimData,_posPoints=[],_tempPoint={},_isZoomingIn,_verticalDragInitiated,_oldAndroidTouchEndTimeout,_currZoomedItemIndex=0,_centerPoint=_getEmptyPoint(),_lastReleaseTime=0,_isDragging,_isMultitouch,_zoomStarted,_moved,_dragAnimFrame,_mainScrollShifted,_currentPoints,_isZooming,_currPointsDistance,_startPointsDistance,_currPanBounds,_mainScrollPos=_getEmptyPoint(),_currZoomElementStyle,_mainScrollAnimating,_midZoomPoint=_getEmptyPoint(),_currCenterPoint=_getEmptyPoint(),_direction,_isFirstMove,_opacityChanged,_bgOpacity,_wasOverInitialZoom,_isEqualPoints=function(p1,p2){return p1.x===p2.x&&p1.y===p2.y},_isNearbyPoints=function(touch0,touch1){return Math.abs(touch0.x-touch1.x)<DOUBLE_TAP_RADIUS&&Math.abs(touch0.y-touch1.y)<DOUBLE_TAP_RADIUS},_calculatePointsDistance=function(p1,p2){_tempPoint.x=Math.abs(p1.x-p2.x);_tempPoint.y=Math.abs(p1.y-p2.y);return Math.sqrt(_tempPoint.x*_tempPoint.x+_tempPoint.y*_tempPoint.y)},_stopDragUpdateLoop=function(){if(_dragAnimFrame){_cancelAF(_dragAnimFrame);_dragAnimFrame=null}},_dragUpdateLoop=function(){if(_isDragging){_dragAnimFrame=_requestAF(_dragUpdateLoop);_renderMovement()}},_canPan=function(){return !(_options.scaleMode==="fit"&&_currZoomLevel===self.currItem.initialZoomLevel)},_closestElement=function(el,fn){if(!el||el===document){return false}if(el.getAttribute("class")&&el.getAttribute("class").indexOf("pswp__scroll-wrap")>-1){return false}if(fn(el)){return el}return _closestElement(el.parentNode,fn)},_preventObj={},_preventDefaultEventBehaviour=function(e,isDown){_preventObj.prevent=!_closestElement(e.target,_options.isClickableElement);_shout("preventDragEvent",e,isDown,_preventObj);return _preventObj.prevent},_convertTouchToPoint=function(touch,p){p.x=touch.pageX;p.y=touch.pageY;p.id=touch.identifier;return p},_findCenterOfPoints=function(p1,p2,pCenter){pCenter.x=(p1.x+p2.x)*0.5;pCenter.y=(p1.y+p2.y)*0.5},_pushPosPoint=function(time,x,y){if(time-_gestureCheckSpeedTime>50){var o=_posPoints.length>2?_posPoints.shift():{};o.x=x;o.y=y;_posPoints.push(o);_gestureCheckSpeedTime=time}},_calculateVerticalDragOpacityRatio=function(){var yOffset=_panOffset.y-self.currItem.initialPosition.y;return 1-Math.abs(yOffset/(_viewportSize.y/2))},_ePoint1={},_ePoint2={},_tempPointsArr=[],_tempCounter,_getTouchPoints=function(e){while(_tempPointsArr.length>0){_tempPointsArr.pop()}if(!_pointerEventEnabled){if(e.type.indexOf("touch")>-1){if(e.touches&&e.touches.length>0){_tempPointsArr[0]=_convertTouchToPoint(e.touches[0],_ePoint1);if(e.touches.length>1){_tempPointsArr[1]=_convertTouchToPoint(e.touches[1],_ePoint2)}}}else{_ePoint1.x=e.pageX;_ePoint1.y=e.pageY;_ePoint1.id="";_tempPointsArr[0]=_ePoint1}}else{_tempCounter=0;_currPointers.forEach(function(p){if(_tempCounter===0){_tempPointsArr[0]=p}else{if(_tempCounter===1){_tempPointsArr[1]=p}}_tempCounter++})}return _tempPointsArr},_panOrMoveMainScroll=function(axis,delta){var panFriction,overDiff=0,newOffset=_panOffset[axis]+delta[axis],startOverDiff,dir=delta[axis]>0,newMainScrollPosition=_mainScrollPos.x+delta.x,mainScrollDiff=_mainScrollPos.x-_startMainScrollPos.x,newPanPos,newMainScrollPos;if(newOffset>_currPanBounds.min[axis]||newOffset<_currPanBounds.max[axis]){panFriction=_options.panEndFriction}else{panFriction=1}newOffset=_panOffset[axis]+delta[axis]*panFriction;if(_options.allowPanToNext||_currZoomLevel===self.currItem.initialZoomLevel){if(!_currZoomElementStyle){newMainScrollPos=newMainScrollPosition}else{if(_direction==="h"&&axis==="x"&&!_zoomStarted){if(dir){if(newOffset>_currPanBounds.min[axis]){panFriction=_options.panEndFriction;overDiff=_currPanBounds.min[axis]-newOffset;startOverDiff=_currPanBounds.min[axis]-_startPanOffset[axis]}if((startOverDiff<=0||mainScrollDiff<0)&&_getNumItems()>1){newMainScrollPos=newMainScrollPosition;if(mainScrollDiff<0&&newMainScrollPosition>_startMainScrollPos.x){newMainScrollPos=_startMainScrollPos.x}}else{if(_currPanBounds.min.x!==_currPanBounds.max.x){newPanPos=newOffset}}}else{if(newOffset<_currPanBounds.max[axis]){panFriction=_options.panEndFriction;overDiff=newOffset-_currPanBounds.max[axis];startOverDiff=_startPanOffset[axis]-_currPanBounds.max[axis]}if((startOverDiff<=0||mainScrollDiff>0)&&_getNumItems()>1){newMainScrollPos=newMainScrollPosition;if(mainScrollDiff>0&&newMainScrollPosition<_startMainScrollPos.x){newMainScrollPos=_startMainScrollPos.x}}else{if(_currPanBounds.min.x!==_currPanBounds.max.x){newPanPos=newOffset}}}}}if(axis==="x"){if(newMainScrollPos!==undefined){_moveMainScroll(newMainScrollPos,true);if(newMainScrollPos===_startMainScrollPos.x){_mainScrollShifted=false}else{_mainScrollShifted=true}}if(_currPanBounds.min.x!==_currPanBounds.max.x){if(newPanPos!==undefined){_panOffset.x=newPanPos}else{if(!_mainScrollShifted){_panOffset.x+=delta.x*panFriction}}}return newMainScrollPos!==undefined}}if(!_mainScrollAnimating){if(!_mainScrollShifted){if(_currZoomLevel>self.currItem.fitRatio){_panOffset[axis]+=delta[axis]*panFriction}}}},_onDragStart=function(e){if(e.type==="mousedown"&&e.button>0){return}if(_initialZoomRunning){e.preventDefault();return}if(_oldAndroidTouchEndTimeout&&e.type==="mousedown"){return}if(_preventDefaultEventBehaviour(e,true)){e.preventDefault()}_shout("pointerDown");if(_pointerEventEnabled){var pointerIndex=framework.arraySearch(_currPointers,e.pointerId,"id");if(pointerIndex<0){pointerIndex=_currPointers.length}_currPointers[pointerIndex]={x:e.pageX,y:e.pageY,id:e.pointerId}}var startPointsList=_getTouchPoints(e),numPoints=startPointsList.length;_currentPoints=null;_stopAllAnimations();if(!_isDragging||numPoints===1){_isDragging=_isFirstMove=true;framework.bind(window,_upMoveEvents,self);_isZoomingIn=_wasOverInitialZoom=_opacityChanged=_verticalDragInitiated=_mainScrollShifted=_moved=_isMultitouch=_zoomStarted=false;_direction=null;_shout("firstTouchStart",startPointsList);_equalizePoints(_startPanOffset,_panOffset);_currPanDist.x=_currPanDist.y=0;_equalizePoints(_currPoint,startPointsList[0]);_equalizePoints(_startPoint,_currPoint);_startMainScrollPos.x=_slideSize.x*_currPositionIndex;_posPoints=[{x:_currPoint.x,y:_currPoint.y}];_gestureCheckSpeedTime=_gestureStartTime=_getCurrentTime();_calculatePanBounds(_currZoomLevel,true);_stopDragUpdateLoop();_dragUpdateLoop()}if(!_isZooming&&numPoints>1&&!_mainScrollAnimating&&!_mainScrollShifted){_startZoomLevel=_currZoomLevel;_zoomStarted=false;_isZooming=_isMultitouch=true;_currPanDist.y=_currPanDist.x=0;_equalizePoints(_startPanOffset,_panOffset);_equalizePoints(p,startPointsList[0]);_equalizePoints(p2,startPointsList[1]);_findCenterOfPoints(p,p2,_currCenterPoint);_midZoomPoint.x=Math.abs(_currCenterPoint.x)-_panOffset.x;_midZoomPoint.y=Math.abs(_currCenterPoint.y)-_panOffset.y;_currPointsDistance=_startPointsDistance=_calculatePointsDistance(p,p2)}},_onDragMove=function(e){e.preventDefault();if(_pointerEventEnabled){var pointerIndex=framework.arraySearch(_currPointers,e.pointerId,"id");if(pointerIndex>-1){var p=_currPointers[pointerIndex];p.x=e.pageX;p.y=e.pageY}}if(_isDragging){var touchesList=_getTouchPoints(e);if(!_direction&&!_moved&&!_isZooming){if(_mainScrollPos.x!==_slideSize.x*_currPositionIndex){_direction="h"}else{var diff=Math.abs(touchesList[0].x-_currPoint.x)-Math.abs(touchesList[0].y-_currPoint.y);if(Math.abs(diff)>=DIRECTION_CHECK_OFFSET){_direction=diff>0?"h":"v";_currentPoints=touchesList}}}else{_currentPoints=touchesList}}},_renderMovement=function(){if(!_currentPoints){return}var numPoints=_currentPoints.length;if(numPoints===0){return}_equalizePoints(p,_currentPoints[0]);delta.x=p.x-_currPoint.x;delta.y=p.y-_currPoint.y;if(_isZooming&&numPoints>1){_currPoint.x=p.x;_currPoint.y=p.y;if(!delta.x&&!delta.y&&_isEqualPoints(_currentPoints[1],p2)){return}_equalizePoints(p2,_currentPoints[1]);if(!_zoomStarted){_zoomStarted=true;_shout("zoomGestureStarted")}var pointsDistance=_calculatePointsDistance(p,p2);var zoomLevel=_calculateZoomLevel(pointsDistance);if(zoomLevel>self.currItem.initialZoomLevel+self.currItem.initialZoomLevel/15){_wasOverInitialZoom=true}var zoomFriction=1,minZoomLevel=_getMinZoomLevel(),maxZoomLevel=_getMaxZoomLevel();if(zoomLevel<minZoomLevel){if(_options.pinchToClose&&!_wasOverInitialZoom&&_startZoomLevel<=self.currItem.initialZoomLevel){var minusDiff=minZoomLevel-zoomLevel;var percent=1-minusDiff/(minZoomLevel/1.2);_applyBgOpacity(percent);_shout("onPinchClose",percent);_opacityChanged=true}else{zoomFriction=(minZoomLevel-zoomLevel)/minZoomLevel;if(zoomFriction>1){zoomFriction=1}zoomLevel=minZoomLevel-zoomFriction*(minZoomLevel/3)}}else{if(zoomLevel>maxZoomLevel){zoomFriction=(zoomLevel-maxZoomLevel)/(minZoomLevel*6);if(zoomFriction>1){zoomFriction=1}zoomLevel=maxZoomLevel+zoomFriction*minZoomLevel}}if(zoomFriction<0){zoomFriction=0}_currPointsDistance=pointsDistance;_findCenterOfPoints(p,p2,_centerPoint);_currPanDist.x+=_centerPoint.x-_currCenterPoint.x;_currPanDist.y+=_centerPoint.y-_currCenterPoint.y;_equalizePoints(_currCenterPoint,_centerPoint);_panOffset.x=_calculatePanOffset("x",zoomLevel);_panOffset.y=_calculatePanOffset("y",zoomLevel);_isZoomingIn=zoomLevel>_currZoomLevel;_currZoomLevel=zoomLevel;_applyCurrentZoomPan()}else{if(!_direction){return}if(_isFirstMove){_isFirstMove=false;if(Math.abs(delta.x)>=DIRECTION_CHECK_OFFSET){delta.x-=_currentPoints[0].x-_startPoint.x}if(Math.abs(delta.y)>=DIRECTION_CHECK_OFFSET){delta.y-=_currentPoints[0].y-_startPoint.y}}_currPoint.x=p.x;_currPoint.y=p.y;if(delta.x===0&&delta.y===0){return}if(_direction==="v"&&_options.closeOnVerticalDrag){if(!_canPan()){_currPanDist.y+=delta.y;_panOffset.y+=delta.y;var opacityRatio=_calculateVerticalDragOpacityRatio();_verticalDragInitiated=true;_shout("onVerticalDrag",opacityRatio);_applyBgOpacity(opacityRatio);_applyCurrentZoomPan();return}}_pushPosPoint(_getCurrentTime(),p.x,p.y);_moved=true;_currPanBounds=self.currItem.bounds;var mainScrollChanged=_panOrMoveMainScroll("x",delta);if(!mainScrollChanged){_panOrMoveMainScroll("y",delta);_roundPoint(_panOffset);_applyCurrentZoomPan()}}},_onDragRelease=function(e){if(_features.isOldAndroid){if(_oldAndroidTouchEndTimeout&&e.type==="mouseup"){return}if(e.type.indexOf("touch")>-1){clearTimeout(_oldAndroidTouchEndTimeout);_oldAndroidTouchEndTimeout=setTimeout(function(){_oldAndroidTouchEndTimeout=0},600)}}_shout("pointerUp");if(_preventDefaultEventBehaviour(e,false)){e.preventDefault()}var releasePoint;if(_pointerEventEnabled){var pointerIndex=framework.arraySearch(_currPointers,e.pointerId,"id");if(pointerIndex>-1){releasePoint=_currPointers.splice(pointerIndex,1)[0];if(navigator.pointerEnabled){releasePoint.type=e.pointerType||"mouse"}else{var MSPOINTER_TYPES={4:"mouse",2:"touch",3:"pen"};releasePoint.type=MSPOINTER_TYPES[e.pointerType];if(!releasePoint.type){releasePoint.type=e.pointerType||"mouse"}}}}var touchList=_getTouchPoints(e),gestureType,numPoints=touchList.length;if(e.type==="mouseup"){numPoints=0}if(numPoints===2){_currentPoints=null;return true}if(numPoints===1){_equalizePoints(_startPoint,touchList[0])}if(numPoints===0&&!_direction&&!_mainScrollAnimating){if(!releasePoint){if(e.type==="mouseup"){releasePoint={x:e.pageX,y:e.pageY,type:"mouse"}}else{if(e.changedTouches&&e.changedTouches[0]){releasePoint={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY,type:"touch"}}}}_shout("touchRelease",e,releasePoint)}var releaseTimeDiff=-1;if(numPoints===0){_isDragging=false;framework.unbind(window,_upMoveEvents,self);_stopDragUpdateLoop();if(_isZooming){releaseTimeDiff=0}else{if(_lastReleaseTime!==-1){releaseTimeDiff=_getCurrentTime()-_lastReleaseTime}}}_lastReleaseTime=numPoints===1?_getCurrentTime():-1;if(releaseTimeDiff!==-1&&releaseTimeDiff<150){gestureType="zoom"}else{gestureType="swipe"}if(_isZooming&&numPoints<2){_isZooming=false;if(numPoints===1){gestureType="zoomPointerUp"}_shout("zoomGestureEnded")}_currentPoints=null;if(!_moved&&!_zoomStarted&&!_mainScrollAnimating&&!_verticalDragInitiated){return}_stopAllAnimations();if(!_releaseAnimData){_releaseAnimData=_initDragReleaseAnimationData()}_releaseAnimData.calculateSwipeSpeed("x");if(_verticalDragInitiated){var opacityRatio=_calculateVerticalDragOpacityRatio();if(opacityRatio<_options.verticalDragRange){self.close()}else{var initalPanY=_panOffset.y,initialBgOpacity=_bgOpacity;_animateProp("verticalDrag",0,1,300,framework.easing.cubic.out,function(now){_panOffset.y=(self.currItem.initialPosition.y-initalPanY)*now+initalPanY;_applyBgOpacity((1-initialBgOpacity)*now+initialBgOpacity);_applyCurrentZoomPan()});_shout("onVerticalDrag",1)}return}if((_mainScrollShifted||_mainScrollAnimating)&&numPoints===0){var itemChanged=_finishSwipeMainScrollGesture(gestureType,_releaseAnimData);if(itemChanged){return}gestureType="zoomPointerUp"}if(_mainScrollAnimating){return}if(gestureType!=="swipe"){_completeZoomGesture();return}if(!_mainScrollShifted&&_currZoomLevel>self.currItem.fitRatio){_completePanGesture(_releaseAnimData)}},_initDragReleaseAnimationData=function(){var lastFlickDuration,tempReleasePos;var s={lastFlickOffset:{},lastFlickDist:{},lastFlickSpeed:{},slowDownRatio:{},slowDownRatioReverse:{},speedDecelerationRatio:{},speedDecelerationRatioAbs:{},distanceOffset:{},backAnimDestination:{},backAnimStarted:{},calculateSwipeSpeed:function(axis){if(_posPoints.length>1){lastFlickDuration=_getCurrentTime()-_gestureCheckSpeedTime+50;tempReleasePos=_posPoints[_posPoints.length-2][axis]}else{lastFlickDuration=_getCurrentTime()-_gestureStartTime;tempReleasePos=_startPoint[axis]}s.lastFlickOffset[axis]=_currPoint[axis]-tempReleasePos;s.lastFlickDist[axis]=Math.abs(s.lastFlickOffset[axis]);if(s.lastFlickDist[axis]>20){s.lastFlickSpeed[axis]=s.lastFlickOffset[axis]/lastFlickDuration}else{s.lastFlickSpeed[axis]=0}if(Math.abs(s.lastFlickSpeed[axis])<0.1){s.lastFlickSpeed[axis]=0}s.slowDownRatio[axis]=0.95;s.slowDownRatioReverse[axis]=1-s.slowDownRatio[axis];s.speedDecelerationRatio[axis]=1},calculateOverBoundsAnimOffset:function(axis,speed){if(!s.backAnimStarted[axis]){if(_panOffset[axis]>_currPanBounds.min[axis]){s.backAnimDestination[axis]=_currPanBounds.min[axis]}else{if(_panOffset[axis]<_currPanBounds.max[axis]){s.backAnimDestination[axis]=_currPanBounds.max[axis]}}if(s.backAnimDestination[axis]!==undefined){s.slowDownRatio[axis]=0.7;s.slowDownRatioReverse[axis]=1-s.slowDownRatio[axis];if(s.speedDecelerationRatioAbs[axis]<0.05){s.lastFlickSpeed[axis]=0;s.backAnimStarted[axis]=true;_animateProp("bounceZoomPan"+axis,_panOffset[axis],s.backAnimDestination[axis],speed||300,framework.easing.sine.out,function(pos){_panOffset[axis]=pos;_applyCurrentZoomPan()})}}}},calculateAnimOffset:function(axis){if(!s.backAnimStarted[axis]){s.speedDecelerationRatio[axis]=s.speedDecelerationRatio[axis]*(s.slowDownRatio[axis]+s.slowDownRatioReverse[axis]-s.slowDownRatioReverse[axis]*s.timeDiff/10);s.speedDecelerationRatioAbs[axis]=Math.abs(s.lastFlickSpeed[axis]*s.speedDecelerationRatio[axis]);s.distanceOffset[axis]=s.lastFlickSpeed[axis]*s.speedDecelerationRatio[axis]*s.timeDiff;_panOffset[axis]+=s.distanceOffset[axis]}},panAnimLoop:function(){if(_animations.zoomPan){_animations.zoomPan.raf=_requestAF(s.panAnimLoop);s.now=_getCurrentTime();s.timeDiff=s.now-s.lastNow;s.lastNow=s.now;s.calculateAnimOffset("x");s.calculateAnimOffset("y");_applyCurrentZoomPan();s.calculateOverBoundsAnimOffset("x");s.calculateOverBoundsAnimOffset("y");if(s.speedDecelerationRatioAbs.x<0.05&&s.speedDecelerationRatioAbs.y<0.05){_panOffset.x=Math.round(_panOffset.x);_panOffset.y=Math.round(_panOffset.y);_applyCurrentZoomPan();_stopAnimation("zoomPan");return}}}};return s},_completePanGesture=function(animData){animData.calculateSwipeSpeed("y");_currPanBounds=self.currItem.bounds;animData.backAnimDestination={};animData.backAnimStarted={};if(Math.abs(animData.lastFlickSpeed.x)<=0.05&&Math.abs(animData.lastFlickSpeed.y)<=0.05){animData.speedDecelerationRatioAbs.x=animData.speedDecelerationRatioAbs.y=0;animData.calculateOverBoundsAnimOffset("x");animData.calculateOverBoundsAnimOffset("y");return true}_registerStartAnimation("zoomPan");animData.lastNow=_getCurrentTime();animData.panAnimLoop()},_finishSwipeMainScrollGesture=function(gestureType,_releaseAnimData){var itemChanged;if(!_mainScrollAnimating){_currZoomedItemIndex=_currentItemIndex}var itemsDiff;if(gestureType==="swipe"){var totalShiftDist=_currPoint.x-_startPoint.x,isFastLastFlick=_releaseAnimData.lastFlickDist.x<10;if(totalShiftDist>MIN_SWIPE_DISTANCE&&(isFastLastFlick||_releaseAnimData.lastFlickOffset.x>20)){itemsDiff=-1}else{if(totalShiftDist<-MIN_SWIPE_DISTANCE&&(isFastLastFlick||_releaseAnimData.lastFlickOffset.x<-20)){itemsDiff=1}}}var nextCircle;if(itemsDiff){_currentItemIndex+=itemsDiff;if(_currentItemIndex<0){_currentItemIndex=_options.loop?_getNumItems()-1:0;nextCircle=true}else{if(_currentItemIndex>=_getNumItems()){_currentItemIndex=_options.loop?0:_getNumItems()-1;nextCircle=true}}if(!nextCircle||_options.loop){_indexDiff+=itemsDiff;_currPositionIndex-=itemsDiff;itemChanged=true}}var animateToX=_slideSize.x*_currPositionIndex;var animateToDist=Math.abs(animateToX-_mainScrollPos.x);var finishAnimDuration;if(!itemChanged&&animateToX>_mainScrollPos.x!==_releaseAnimData.lastFlickSpeed.x>0){finishAnimDuration=333}else{finishAnimDuration=Math.abs(_releaseAnimData.lastFlickSpeed.x)>0?animateToDist/Math.abs(_releaseAnimData.lastFlickSpeed.x):333;finishAnimDuration=Math.min(finishAnimDuration,400);finishAnimDuration=Math.max(finishAnimDuration,250)}if(_currZoomedItemIndex===_currentItemIndex){itemChanged=false}_mainScrollAnimating=true;_shout("mainScrollAnimStart");_animateProp("mainScroll",_mainScrollPos.x,animateToX,finishAnimDuration,framework.easing.cubic.out,_moveMainScroll,function(){_stopAllAnimations();_mainScrollAnimating=false;_currZoomedItemIndex=-1;if(itemChanged||_currZoomedItemIndex!==_currentItemIndex){self.updateCurrItem()}_shout("mainScrollAnimComplete")});if(itemChanged){self.updateCurrItem(true)}return itemChanged},_calculateZoomLevel=function(touchesDistance){return 1/_startPointsDistance*touchesDistance*_startZoomLevel},_completeZoomGesture=function(){var destZoomLevel=_currZoomLevel,minZoomLevel=_getMinZoomLevel(),maxZoomLevel=_getMaxZoomLevel();if(_currZoomLevel<minZoomLevel){destZoomLevel=minZoomLevel}else{if(_currZoomLevel>maxZoomLevel){destZoomLevel=maxZoomLevel}}var destOpacity=1,onUpdate,initialOpacity=_bgOpacity;if(_opacityChanged&&!_isZoomingIn&&!_wasOverInitialZoom&&_currZoomLevel<minZoomLevel){self.close();return true}if(_opacityChanged){onUpdate=function(now){_applyBgOpacity((destOpacity-initialOpacity)*now+initialOpacity)}}self.zoomTo(destZoomLevel,0,200,framework.easing.cubic.out,onUpdate);return true};_registerModule("Gestures",{publicMethods:{initGestures:function(){var addEventNames=function(pref,down,move,up,cancel){_dragStartEvent=pref+down;_dragMoveEvent=pref+move;_dragEndEvent=pref+up;if(cancel){_dragCancelEvent=pref+cancel}else{_dragCancelEvent=""}};_pointerEventEnabled=_features.pointerEvent;if(_pointerEventEnabled&&_features.touch){_features.touch=false}if(_pointerEventEnabled){if(navigator.pointerEnabled){addEventNames("pointer","down","move","up","cancel")}else{addEventNames("MSPointer","Down","Move","Up","Cancel")}}else{if(_features.touch){addEventNames("touch","start","move","end","cancel");_likelyTouchDevice=true}else{addEventNames("mouse","down","move","up")}}_upMoveEvents=_dragMoveEvent+" "+_dragEndEvent+" "+_dragCancelEvent;_downEvents=_dragStartEvent;if(_pointerEventEnabled&&!_likelyTouchDevice){_likelyTouchDevice=(navigator.maxTouchPoints>1)||(navigator.msMaxTouchPoints>1)}self.likelyTouchDevice=_likelyTouchDevice;_globalEventHandlers[_dragStartEvent]=_onDragStart;_globalEventHandlers[_dragMoveEvent]=_onDragMove;_globalEventHandlers[_dragEndEvent]=_onDragRelease;if(_dragCancelEvent){_globalEventHandlers[_dragCancelEvent]=_globalEventHandlers[_dragEndEvent]}if(_features.touch){_downEvents+=" mousedown";_upMoveEvents+=" mousemove mouseup";_globalEventHandlers.mousedown=_globalEventHandlers[_dragStartEvent];_globalEventHandlers.mousemove=_globalEventHandlers[_dragMoveEvent];_globalEventHandlers.mouseup=_globalEventHandlers[_dragEndEvent]}if(!_likelyTouchDevice){_options.allowPanToNext=false}}}});var _showOrHideTimeout,_showOrHide=function(item,img,out,completeFn){if(_showOrHideTimeout){clearTimeout(_showOrHideTimeout)}_initialZoomRunning=true;_initialContentSet=true;var thumbBounds;if(item.initialLayout){thumbBounds=item.initialLayout;item.initialLayout=null}else{thumbBounds=_options.getThumbBoundsFn&&_options.getThumbBoundsFn(_currentItemIndex)}var duration=out?_options.hideAnimationDuration:_options.showAnimationDuration;var onComplete=function(){_stopAnimation("initialZoom");if(!out){_applyBgOpacity(1);if(img){img.style.display="block"}framework.addClass(template,"pswp--animated-in");_shout("initialZoom"+(out?"OutEnd":"InEnd"))}else{self.template.removeAttribute("style");self.bg.removeAttribute("style")}if(completeFn){completeFn()}_initialZoomRunning=false};if(!duration||!thumbBounds||thumbBounds.x===undefined){_shout("initialZoom"+(out?"Out":"In"));_currZoomLevel=item.initialZoomLevel;_equalizePoints(_panOffset,item.initialPosition);_applyCurrentZoomPan();template.style.opacity=out?0:1;_applyBgOpacity(1);if(duration){setTimeout(function(){onComplete()},duration)}else{onComplete()}return}var startAnimation=function(){var closeWithRaf=_closedByScroll,fadeEverything=!self.currItem.src||self.currItem.loadError||_options.showHideOpacity;if(item.miniImg){item.miniImg.style.webkitBackfaceVisibility="hidden"}if(!out){_currZoomLevel=thumbBounds.w/item.w;_panOffset.x=thumbBounds.x;_panOffset.y=thumbBounds.y-_initalWindowScrollY;self[fadeEverything?"template":"bg"].style.opacity=0.001;_applyCurrentZoomPan()}_registerStartAnimation("initialZoom");if(out&&!closeWithRaf){framework.removeClass(template,"pswp--animated-in")}if(fadeEverything){if(out){framework[(closeWithRaf?"remove":"add")+"Class"](template,"pswp--animate_opacity")}else{setTimeout(function(){framework.addClass(template,"pswp--animate_opacity")},30)}}_showOrHideTimeout=setTimeout(function(){_shout("initialZoom"+(out?"Out":"In"));if(!out){_currZoomLevel=item.initialZoomLevel;_equalizePoints(_panOffset,item.initialPosition);_applyCurrentZoomPan();_applyBgOpacity(1);if(fadeEverything){template.style.opacity=1}else{_applyBgOpacity(1)}_showOrHideTimeout=setTimeout(onComplete,duration+20)}else{var destZoomLevel=thumbBounds.w/item.w,initialPanOffset={x:_panOffset.x,y:_panOffset.y},initialZoomLevel=_currZoomLevel,initalBgOpacity=_bgOpacity,onUpdate=function(now){if(now===1){_currZoomLevel=destZoomLevel;_panOffset.x=thumbBounds.x;_panOffset.y=thumbBounds.y-_currentWindowScrollY}else{_currZoomLevel=(destZoomLevel-initialZoomLevel)*now+initialZoomLevel;_panOffset.x=(thumbBounds.x-initialPanOffset.x)*now+initialPanOffset.x;_panOffset.y=(thumbBounds.y-_currentWindowScrollY-initialPanOffset.y)*now+initialPanOffset.y}_applyCurrentZoomPan();if(fadeEverything){template.style.opacity=1-now}else{_applyBgOpacity(initalBgOpacity-now*initalBgOpacity)}};if(closeWithRaf){_animateProp("initialZoom",0,1,duration,framework.easing.cubic.out,onUpdate,onComplete)}else{onUpdate(1);_showOrHideTimeout=setTimeout(onComplete,duration+20)}}},out?25:90)};startAnimation()};var _items,_tempPanAreaSize={},_imagesToAppendPool=[],_initialContentSet,_initialZoomRunning,_controllerDefaultOptions={index:0,errorMsg:'<div class="pswp__error-msg"><a href="%url%" target="_blank">The image</a> could not be loaded.</div>',forceProgressiveLoading:false,preload:[1,1],getNumItemsFn:function(){return _items.length}};var _getItemAt,_getNumItems,_initialIsLoop,_getZeroBounds=function(){return{center:{x:0,y:0},max:{x:0,y:0},min:{x:0,y:0}}},_calculateSingleItemPanBounds=function(item,realPanElementW,realPanElementH){var bounds=item.bounds;bounds.center.x=Math.round((_tempPanAreaSize.x-realPanElementW)/2);bounds.center.y=Math.round((_tempPanAreaSize.y-realPanElementH)/2)+item.vGap.top;bounds.max.x=(realPanElementW>_tempPanAreaSize.x)?Math.round(_tempPanAreaSize.x-realPanElementW):bounds.center.x;bounds.max.y=(realPanElementH>_tempPanAreaSize.y)?Math.round(_tempPanAreaSize.y-realPanElementH)+item.vGap.top:bounds.center.y;bounds.min.x=(realPanElementW>_tempPanAreaSize.x)?0:bounds.center.x;bounds.min.y=(realPanElementH>_tempPanAreaSize.y)?item.vGap.top:bounds.center.y},_calculateItemSize=function(item,viewportSize,zoomLevel){if(item.src&&!item.loadError){var isInitial=!zoomLevel;if(isInitial){if(!item.vGap){item.vGap={top:0,bottom:0}}_shout("parseVerticalMargin",item)}_tempPanAreaSize.x=viewportSize.x;_tempPanAreaSize.y=viewportSize.y-item.vGap.top-item.vGap.bottom;if(isInitial){var hRatio=_tempPanAreaSize.x/item.w;var vRatio=_tempPanAreaSize.y/item.h;item.fitRatio=hRatio<vRatio?hRatio:vRatio;var scaleMode=_options.scaleMode;if(scaleMode==="orig"){zoomLevel=1}else{if(scaleMode==="fit"){zoomLevel=item.fitRatio}}if(zoomLevel>1){zoomLevel=1}item.initialZoomLevel=zoomLevel;if(!item.bounds){item.bounds=_getZeroBounds()}}if(!zoomLevel){return}_calculateSingleItemPanBounds(item,item.w*zoomLevel,item.h*zoomLevel);if(isInitial&&zoomLevel===item.initialZoomLevel){item.initialPosition=item.bounds.center}return item.bounds}else{item.w=item.h=0;item.initialZoomLevel=item.fitRatio=1;item.bounds=_getZeroBounds();item.initialPosition=item.bounds.center;return item.bounds}},_appendImage=function(index,item,baseDiv,img,preventAnimation,keepPlaceholder){if(item.loadError){return}if(img){item.imageAppended=true;_setImageSize(item,img,(item===self.currItem&&_renderMaxResolution));baseDiv.appendChild(img);if(keepPlaceholder){setTimeout(function(){if(item&&item.loaded&&item.placeholder){item.placeholder.style.display="none";item.placeholder=null}},500)}}},_preloadImage=function(item){item.loading=true;item.loaded=false;var img=item.img=framework.createEl("pswp__img","img");var onComplete=function(){item.loading=false;item.loaded=true;if(item.loadComplete){item.loadComplete(item)}else{item.img=null}img.onload=img.onerror=null;img=null};img.onload=onComplete;img.onerror=function(){item.loadError=true;onComplete()};img.src=item.src;return img},_checkForError=function(item,cleanUp){if(item.src&&item.loadError&&item.container){if(cleanUp){item.container.innerHTML=""}item.container.innerHTML=_options.errorMsg.replace("%url%",item.src);return true}},_setImageSize=function(item,img,maxRes){if(!item.src){return}if(!img){img=item.container.lastChild}var w=maxRes?item.w:Math.round(item.w*item.fitRatio),h=maxRes?item.h:Math.round(item.h*item.fitRatio);if(item.placeholder&&!item.loaded){item.placeholder.style.width=w+"px";item.placeholder.style.height=h+"px"}img.style.width=w+"px";img.style.height=h+"px"},_appendImagesPool=function(){if(_imagesToAppendPool.length){var poolItem;for(var i=0;i<_imagesToAppendPool.length;i++){poolItem=_imagesToAppendPool[i];if(poolItem.holder.index===poolItem.index){_appendImage(poolItem.index,poolItem.item,poolItem.baseDiv,poolItem.img,false,poolItem.clearPlaceholder)}}_imagesToAppendPool=[]}};_registerModule("Controller",{publicMethods:{lazyLoadItem:function(index){index=_getLoopedId(index);var item=_getItemAt(index);if(!item||((item.loaded||item.loading)&&!_itemsNeedUpdate)){return}_shout("gettingData",index,item);if(!item.src){return}_preloadImage(item)},initController:function(){framework.extend(_options,_controllerDefaultOptions,true);self.items=_items=items;_getItemAt=self.getItemAt;_getNumItems=_options.getNumItemsFn;_initialIsLoop=_options.loop;if(_getNumItems()<3){_options.loop=false}_listen("beforeChange",function(diff){var p=_options.preload,isNext=diff===null?true:(diff>=0),preloadBefore=Math.min(p[0],_getNumItems()),preloadAfter=Math.min(p[1],_getNumItems()),i;for(i=1;i<=(isNext?preloadAfter:preloadBefore);i++){self.lazyLoadItem(_currentItemIndex+i)}for(i=1;i<=(isNext?preloadBefore:preloadAfter);i++){self.lazyLoadItem(_currentItemIndex-i)}});_listen("initialLayout",function(){self.currItem.initialLayout=_options.getThumbBoundsFn&&_options.getThumbBoundsFn(_currentItemIndex)});_listen("mainScrollAnimComplete",_appendImagesPool);_listen("initialZoomInEnd",_appendImagesPool);_listen("destroy",function(){var item;for(var i=0;i<_items.length;i++){item=_items[i];if(item.container){item.container=null}if(item.placeholder){item.placeholder=null}if(item.img){item.img=null}if(item.preloader){item.preloader=null}if(item.loadError){item.loaded=item.loadError=false}}_imagesToAppendPool=null})},getItemAt:function(index){if(index>=0){return _items[index]!==undefined?_items[index]:false}return false},allowProgressiveImg:function(){return _options.forceProgressiveLoading||!_likelyTouchDevice||_options.mouseUsed||screen.width>1200},setContent:function(holder,index){if(_options.loop){index=_getLoopedId(index)}var prevItem=self.getItemAt(holder.index);if(prevItem){prevItem.container=null}var item=self.getItemAt(index),img;if(!item){holder.el.innerHTML="";return}_shout("gettingData",index,item);holder.index=index;holder.item=item;var baseDiv=item.container=framework.createEl("pswp__zoom-wrap");if(!item.src&&item.html){if(item.html.tagName){baseDiv.appendChild(item.html)}else{baseDiv.innerHTML=item.html}}_checkForError(item);_calculateItemSize(item,_viewportSize);if(item.src&&!item.loadError&&!item.loaded){item.loadComplete=function(item){if(!_isOpen){return}if(holder&&holder.index===index){if(_checkForError(item,true)){item.loadComplete=item.img=null;_calculateItemSize(item,_viewportSize);_applyZoomPanToItem(item);if(holder.index===_currentItemIndex){self.updateCurrZoomItem()}return}if(!item.imageAppended){if(_features.transform&&(_mainScrollAnimating||_initialZoomRunning)){_imagesToAppendPool.push({item:item,baseDiv:baseDiv,img:item.img,index:index,holder:holder,clearPlaceholder:true})}else{_appendImage(index,item,baseDiv,item.img,_mainScrollAnimating||_initialZoomRunning,true)}}else{if(!_initialZoomRunning&&item.placeholder){item.placeholder.style.display="none";item.placeholder=null}}}item.loadComplete=null;item.img=null;_shout("imageLoadComplete",index,item)};if(framework.features.transform){var placeholderClassName="pswp__img pswp__img--placeholder";placeholderClassName+=(item.msrc?"":" pswp__img--placeholder--blank");var placeholder=framework.createEl(placeholderClassName,item.msrc?"img":"");if(item.msrc){placeholder.src=item.msrc}_setImageSize(item,placeholder);baseDiv.appendChild(placeholder);item.placeholder=placeholder}if(!item.loading){_preloadImage(item)}if(self.allowProgressiveImg()){if(!_initialContentSet&&_features.transform){_imagesToAppendPool.push({item:item,baseDiv:baseDiv,img:item.img,index:index,holder:holder})}else{_appendImage(index,item,baseDiv,item.img,true,true)}}}else{if(item.src&&!item.loadError){img=framework.createEl("pswp__img","img");img.style.opacity=1;img.src=item.src;_setImageSize(item,img);_appendImage(index,item,baseDiv,img,true)}}if(!_initialContentSet&&index===_currentItemIndex){_currZoomElementStyle=baseDiv.style;_showOrHide(item,(img||item.img))}else{_applyZoomPanToItem(item)}holder.el.innerHTML="";holder.el.appendChild(baseDiv)},cleanSlide:function(item){if(item.img){item.img.onload=item.img.onerror=null}item.loaded=item.loading=item.img=item.imageAppended=false}}});var tapTimer,tapReleasePoint={},_dispatchTapEvent=function(origEvent,releasePoint,pointerType){var e=document.createEvent("CustomEvent"),eDetail={origEvent:origEvent,target:origEvent.target,releasePoint:releasePoint,pointerType:pointerType||"touch"};e.initCustomEvent("pswpTap",true,true,eDetail);origEvent.target.dispatchEvent(e)};_registerModule("Tap",{publicMethods:{initTap:function(){_listen("firstTouchStart",self.onTapStart);_listen("touchRelease",self.onTapRelease);_listen("destroy",function(){tapReleasePoint={};tapTimer=null})},onTapStart:function(touchList){if(touchList.length>1){clearTimeout(tapTimer);tapTimer=null}},onTapRelease:function(e,releasePoint){if(!releasePoint){return}if(!_moved&&!_isMultitouch&&!_numAnimations){var p0=releasePoint;if(tapTimer){clearTimeout(tapTimer);tapTimer=null;if(_isNearbyPoints(p0,tapReleasePoint)){_shout("doubleTap",p0);return}}if(releasePoint.type==="mouse"){_dispatchTapEvent(e,releasePoint,"mouse");return}var clickedTagName=e.target.tagName.toUpperCase();if(clickedTagName==="BUTTON"||framework.hasClass(e.target,"pswp__single-tap")){_dispatchTapEvent(e,releasePoint);return}_equalizePoints(tapReleasePoint,p0);tapTimer=setTimeout(function(){_dispatchTapEvent(e,releasePoint);tapTimer=null},300)}}}});var _wheelDelta;_registerModule("DesktopZoom",{publicMethods:{initDesktopZoom:function(){if(_oldIE){return}if(_likelyTouchDevice){_listen("mouseUsed",function(){self.setupDesktopZoom()})}else{self.setupDesktopZoom(true)}},setupDesktopZoom:function(onInit){_wheelDelta={};var events="wheel mousewheel DOMMouseScroll";_listen("bindEvents",function(){framework.bind(template,events,self.handleMouseWheel)});_listen("unbindEvents",function(){if(_wheelDelta){framework.unbind(template,events,self.handleMouseWheel)}});self.mouseZoomedIn=false;var hasDraggingClass,updateZoomable=function(){if(self.mouseZoomedIn){framework.removeClass(template,"pswp--zoomed-in");self.mouseZoomedIn=false}if(_currZoomLevel<1){framework.addClass(template,"pswp--zoom-allowed")}else{framework.removeClass(template,"pswp--zoom-allowed")}removeDraggingClass()},removeDraggingClass=function(){if(hasDraggingClass){framework.removeClass(template,"pswp--dragging");hasDraggingClass=false}};_listen("resize",updateZoomable);_listen("afterChange",updateZoomable);_listen("pointerDown",function(){if(self.mouseZoomedIn){hasDraggingClass=true;framework.addClass(template,"pswp--dragging")}});_listen("pointerUp",removeDraggingClass);if(!onInit){updateZoomable()}},handleMouseWheel:function(e){if(_currZoomLevel<=self.currItem.fitRatio){if(_options.modal){if(!_options.closeOnScroll||_numAnimations||_isDragging){e.preventDefault()}else{if(_transformKey&&Math.abs(e.deltaY)>2){_closedByScroll=true;self.close()}}}return true}e.stopPropagation();_wheelDelta.x=0;if("deltaX" in e){if(e.deltaMode===1){_wheelDelta.x=e.deltaX*18;_wheelDelta.y=e.deltaY*18}else{_wheelDelta.x=e.deltaX;_wheelDelta.y=e.deltaY}}else{if("wheelDelta" in e){if(e.wheelDeltaX){_wheelDelta.x=-0.16*e.wheelDeltaX}if(e.wheelDeltaY){_wheelDelta.y=-0.16*e.wheelDeltaY}else{_wheelDelta.y=-0.16*e.wheelDelta}}else{if("detail" in e){_wheelDelta.y=e.detail}else{return}}}_calculatePanBounds(_currZoomLevel,true);var newPanX=_panOffset.x-_wheelDelta.x,newPanY=_panOffset.y-_wheelDelta.y;if(_options.modal||(newPanX<=_currPanBounds.min.x&&newPanX>=_currPanBounds.max.x&&newPanY<=_currPanBounds.min.y&&newPanY>=_currPanBounds.max.y)){e.preventDefault()}self.panTo(newPanX,newPanY)},toggleDesktopZoom:function(centerPoint){centerPoint=centerPoint||{x:_viewportSize.x/2+_offset.x,y:_viewportSize.y/2+_offset.y};var doubleTapZoomLevel=_options.getDoubleTapZoom(true,self.currItem);var zoomOut=_currZoomLevel===doubleTapZoomLevel;self.mouseZoomedIn=!zoomOut;self.zoomTo(zoomOut?self.currItem.initialZoomLevel:doubleTapZoomLevel,centerPoint,333);framework[(!zoomOut?"add":"remove")+"Class"](template,"pswp--zoomed-in")}}});var _historyDefaultOptions={history:true,galleryUID:1};var _historyUpdateTimeout,_hashChangeTimeout,_hashAnimCheckTimeout,_hashChangedByScript,_hashChangedByHistory,_hashReseted,_initialHash,_historyChanged,_closedFromURL,_urlChangedOnce,_windowLoc,_supportsPushState,_getHash=function(){return _windowLoc.hash.substring(1)},_cleanHistoryTimeouts=function(){if(_historyUpdateTimeout){clearTimeout(_historyUpdateTimeout)}if(_hashAnimCheckTimeout){clearTimeout(_hashAnimCheckTimeout)}},_parseItemIndexFromURL=function(){var hash=_getHash(),params={};if(hash.length<5){return params}var i,vars=hash.split("&");for(i=0;i<vars.length;i++){if(!vars[i]){continue}var pair=vars[i].split("=");if(pair.length<2){continue}params[pair[0]]=pair[1]}if(_options.galleryPIDs){var searchfor=params.pid;params.pid=0;for(i=0;i<_items.length;i++){if(_items[i].pid===searchfor){params.pid=i;break}}}else{params.pid=parseInt(params.pid,10)-1}if(params.pid<0){params.pid=0}return params},_updateHash=function(){if(_hashAnimCheckTimeout){clearTimeout(_hashAnimCheckTimeout)}if(_numAnimations||_isDragging){_hashAnimCheckTimeout=setTimeout(_updateHash,500);return}if(_hashChangedByScript){clearTimeout(_hashChangeTimeout)}else{_hashChangedByScript=true}var pid=(_currentItemIndex+1);var item=_getItemAt(_currentItemIndex);if(item.hasOwnProperty("pid")){pid=item.pid}var newHash=_initialHash+"&gid="+_options.galleryUID+"&pid="+pid;if(!_historyChanged){if(_windowLoc.hash.indexOf(newHash)===-1){_urlChangedOnce=true}}var newURL=_windowLoc.href.split("#")[0]+"#"+newHash;if(_supportsPushState){if("#"+newHash!==window.location.hash){history[_historyChanged?"replaceState":"pushState"]("",document.title,newURL)}}else{if(_historyChanged){_windowLoc.replace(newURL)}else{_windowLoc.hash=newHash}}_historyChanged=true;_hashChangeTimeout=setTimeout(function(){_hashChangedByScript=false},60)};_registerModule("History",{publicMethods:{initHistory:function(){framework.extend(_options,_historyDefaultOptions,true);if(!_options.history){return}_windowLoc=window.location;_urlChangedOnce=false;_closedFromURL=false;_historyChanged=false;_initialHash=_getHash();_supportsPushState=("pushState" in history);if(_initialHash.indexOf("gid=")>-1){_initialHash=_initialHash.split("&gid=")[0];_initialHash=_initialHash.split("?gid=")[0]}_listen("afterChange",self.updateURL);_listen("unbindEvents",function(){framework.unbind(window,"hashchange",self.onHashChange)});var returnToOriginal=function(){_hashReseted=true;if(!_closedFromURL){if(_urlChangedOnce){history.back()}else{if(_initialHash){_windowLoc.hash=_initialHash}else{if(_supportsPushState){history.pushState("",document.title,_windowLoc.pathname+_windowLoc.search)}else{_windowLoc.hash=""}}}}_cleanHistoryTimeouts()};_listen("unbindEvents",function(){if(_closedByScroll){returnToOriginal()}});_listen("destroy",function(){if(!_hashReseted){returnToOriginal()}});_listen("firstUpdate",function(){_currentItemIndex=_parseItemIndexFromURL().pid});var index=_initialHash.indexOf("pid=");if(index>-1){_initialHash=_initialHash.substring(0,index);if(_initialHash.slice(-1)==="&"){_initialHash=_initialHash.slice(0,-1)}}setTimeout(function(){if(_isOpen){framework.bind(window,"hashchange",self.onHashChange)}},40)},onHashChange:function(){if(_getHash()===_initialHash){_closedFromURL=true;self.close();return}if(!_hashChangedByScript){_hashChangedByHistory=true;self.goTo(_parseItemIndexFromURL().pid);_hashChangedByHistory=false}},updateURL:function(){_cleanHistoryTimeouts();if(_hashChangedByHistory){return}if(!_historyChanged){_updateHash()}else{_historyUpdateTimeout=setTimeout(_updateHash,800)}}}});framework.extend(self,publicMethods)};return PhotoSwipe});
/* PhotoSwipe Default UI - 4.1.2 - 2017-04-05
* http://photoswipe.com
* Copyright (c) 2017 Dmitry Semenov; */
(function(root,factory){if(typeof define==="function"&&define.amd){define(factory)}else{if(typeof exports==="object"){module.exports=factory()}else{root.PhotoSwipeUI_Default=factory()}}})(this,function(){var PhotoSwipeUI_Default=function(pswp,framework){var ui=this;var _overlayUIUpdated=false,_controlsVisible=true,_fullscrenAPI,_controls,_captionContainer,_fakeCaptionContainer,_indexIndicator,_shareButton,_shareModal,_shareModalHidden=true,_initalCloseOnScrollValue,_isIdle,_listen,_loadingIndicator,_loadingIndicatorHidden,_loadingIndicatorTimeout,_galleryHasOneSlide,_options,_defaultUIOptions={barsSize:{top:44,bottom:"auto"},closeElClasses:["item","caption","zoom-wrap","ui","top-bar"],timeToIdle:4000,timeToIdleOutside:1000,loadingIndicatorDelay:1000,addCaptionHTMLFn:function(item,captionEl){if(!item.title){captionEl.children[0].innerHTML="";return false}captionEl.children[0].innerHTML=item.title;return true},closeEl:true,captionEl:true,fullscreenEl:true,zoomEl:true,shareEl:true,counterEl:true,arrowEl:true,preloaderEl:true,tapToClose:false,tapToToggleControls:true,clickToCloseNonZoomable:true,shareButtons:[{id:"facebook",label:"Share on Facebook",url:"https://www.facebook.com/sharer/sharer.php?u={{url}}"},{id:"twitter",label:"Tweet",url:"https://twitter.com/intent/tweet?text={{text}}&url={{url}}"},{id:"pinterest",label:"Pin it",url:"http://www.pinterest.com/pin/create/button/?url={{url}}&media={{image_url}}&description={{text}}"},{id:"download",label:"Download image",url:"{{raw_image_url}}",download:true}],getImageURLForShare:function(){return pswp.currItem.src||""},getPageURLForShare:function(){return window.location.href},getTextForShare:function(){return pswp.currItem.title||""},indexIndicatorSep:" / ",fitControlsWidth:1200},_blockControlsTap,_blockControlsTapTimeout;var _onControlsTap=function(e){if(_blockControlsTap){return true}e=e||window.event;if(_options.timeToIdle&&_options.mouseUsed&&!_isIdle){_onIdleMouseMove()}var target=e.target||e.srcElement,uiElement,clickedClass=target.getAttribute("class")||"",found;for(var i=0;i<_uiElements.length;i++){uiElement=_uiElements[i];if(uiElement.onTap&&clickedClass.indexOf("pswp__"+uiElement.name)>-1){uiElement.onTap();found=true}}if(found){if(e.stopPropagation){e.stopPropagation()}_blockControlsTap=true;var tapDelay=framework.features.isOldAndroid?600:30;_blockControlsTapTimeout=setTimeout(function(){_blockControlsTap=false},tapDelay)}},_fitControlsInViewport=function(){return !pswp.likelyTouchDevice||_options.mouseUsed||screen.width>_options.fitControlsWidth},_togglePswpClass=function(el,cName,add){framework[(add?"add":"remove")+"Class"](el,"pswp__"+cName)},_countNumItems=function(){var hasOneSlide=(_options.getNumItemsFn()===1);if(hasOneSlide!==_galleryHasOneSlide){_togglePswpClass(_controls,"ui--one-slide",hasOneSlide);_galleryHasOneSlide=hasOneSlide}},_toggleShareModalClass=function(){_togglePswpClass(_shareModal,"share-modal--hidden",_shareModalHidden)},_toggleShareModal=function(){_shareModalHidden=!_shareModalHidden;if(!_shareModalHidden){_toggleShareModalClass();setTimeout(function(){if(!_shareModalHidden){framework.addClass(_shareModal,"pswp__share-modal--fade-in")}},30)}else{framework.removeClass(_shareModal,"pswp__share-modal--fade-in");setTimeout(function(){if(_shareModalHidden){_toggleShareModalClass()}},300)}if(!_shareModalHidden){_updateShareURLs()}return false},_openWindowPopup=function(e){e=e||window.event;var target=e.target||e.srcElement;pswp.shout("shareLinkClick",e,target);if(!target.href){return false}if(target.hasAttribute("download")){return true}window.open(target.href,"pswp_share","scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,top=100,left="+(window.screen?Math.round(screen.width/2-275):100));if(!_shareModalHidden){_toggleShareModal()}return false},_updateShareURLs=function(){var shareButtonOut="",shareButtonData,shareURL,image_url,page_url,share_text;for(var i=0;i<_options.shareButtons.length;i++){shareButtonData=_options.shareButtons[i];image_url=_options.getImageURLForShare(shareButtonData);page_url=_options.getPageURLForShare(shareButtonData);share_text=_options.getTextForShare(shareButtonData);shareURL=shareButtonData.url.replace("{{url}}",encodeURIComponent(page_url)).replace("{{image_url}}",encodeURIComponent(image_url)).replace("{{raw_image_url}}",image_url).replace("{{text}}",encodeURIComponent(share_text));shareButtonOut+='<a href="'+shareURL+'" target="_blank" class="pswp__share--'+shareButtonData.id+'"'+(shareButtonData.download?"download":"")+">"+shareButtonData.label+"</a>";if(_options.parseShareButtonOut){shareButtonOut=_options.parseShareButtonOut(shareButtonData,shareButtonOut)}}_shareModal.children[0].innerHTML=shareButtonOut;_shareModal.children[0].onclick=_openWindowPopup},_hasCloseClass=function(target){for(var i=0;i<_options.closeElClasses.length;i++){if(framework.hasClass(target,"pswp__"+_options.closeElClasses[i])){return true}}},_idleInterval,_idleTimer,_idleIncrement=0,_onIdleMouseMove=function(){clearTimeout(_idleTimer);_idleIncrement=0;if(_isIdle){ui.setIdle(false)}},_onMouseLeaveWindow=function(e){e=e?e:window.event;var from=e.relatedTarget||e.toElement;if(!from||from.nodeName==="HTML"){clearTimeout(_idleTimer);_idleTimer=setTimeout(function(){ui.setIdle(true)},_options.timeToIdleOutside)}},_setupFullscreenAPI=function(){if(_options.fullscreenEl&&!framework.features.isOldAndroid){if(!_fullscrenAPI){_fullscrenAPI=ui.getFullscreenAPI()}if(_fullscrenAPI){framework.bind(document,_fullscrenAPI.eventK,ui.updateFullscreen);ui.updateFullscreen();framework.addClass(pswp.template,"pswp--supports-fs")}else{framework.removeClass(pswp.template,"pswp--supports-fs")}}},_setupLoadingIndicator=function(){if(_options.preloaderEl){_toggleLoadingIndicator(true);_listen("beforeChange",function(){clearTimeout(_loadingIndicatorTimeout);_loadingIndicatorTimeout=setTimeout(function(){if(pswp.currItem&&pswp.currItem.loading){if(!pswp.allowProgressiveImg()||(pswp.currItem.img&&!pswp.currItem.img.naturalWidth)){_toggleLoadingIndicator(false)}}else{_toggleLoadingIndicator(true)}},_options.loadingIndicatorDelay)});_listen("imageLoadComplete",function(index,item){if(pswp.currItem===item){_toggleLoadingIndicator(true)}})}},_toggleLoadingIndicator=function(hide){if(_loadingIndicatorHidden!==hide){_togglePswpClass(_loadingIndicator,"preloader--active",!hide);_loadingIndicatorHidden=hide}},_applyNavBarGaps=function(item){var gap=item.vGap;if(_fitControlsInViewport()){var bars=_options.barsSize;if(_options.captionEl&&bars.bottom==="auto"){if(!_fakeCaptionContainer){_fakeCaptionContainer=framework.createEl("pswp__caption pswp__caption--fake");_fakeCaptionContainer.appendChild(framework.createEl("pswp__caption__center"));_controls.insertBefore(_fakeCaptionContainer,_captionContainer);framework.addClass(_controls,"pswp__ui--fit")}if(_options.addCaptionHTMLFn(item,_fakeCaptionContainer,true)){var captionSize=_fakeCaptionContainer.clientHeight;gap.bottom=parseInt(captionSize,10)||44}else{gap.bottom=bars.top}}else{gap.bottom=bars.bottom==="auto"?0:bars.bottom}gap.top=bars.top}else{gap.top=gap.bottom=0}},_setupIdle=function(){if(_options.timeToIdle){_listen("mouseUsed",function(){framework.bind(document,"mousemove",_onIdleMouseMove);framework.bind(document,"mouseout",_onMouseLeaveWindow);_idleInterval=setInterval(function(){_idleIncrement++;if(_idleIncrement===2){ui.setIdle(true)}},_options.timeToIdle/2)})}},_setupHidingControlsDuringGestures=function(){_listen("onVerticalDrag",function(now){if(_controlsVisible&&now<0.95){ui.hideControls()}else{if(!_controlsVisible&&now>=0.95){ui.showControls()}}});var pinchControlsHidden;_listen("onPinchClose",function(now){if(_controlsVisible&&now<0.9){ui.hideControls();pinchControlsHidden=true}else{if(pinchControlsHidden&&!_controlsVisible&&now>0.9){ui.showControls()}}});_listen("zoomGestureEnded",function(){pinchControlsHidden=false;if(pinchControlsHidden&&!_controlsVisible){ui.showControls()}})};var _uiElements=[{name:"caption",option:"captionEl",onInit:function(el){_captionContainer=el}},{name:"share-modal",option:"shareEl",onInit:function(el){_shareModal=el},onTap:function(){_toggleShareModal()}},{name:"button--share",option:"shareEl",onInit:function(el){_shareButton=el},onTap:function(){_toggleShareModal()}},{name:"button--zoom",option:"zoomEl",onTap:pswp.toggleDesktopZoom},{name:"counter",option:"counterEl",onInit:function(el){_indexIndicator=el}},{name:"button--close",option:"closeEl",onTap:pswp.close},{name:"button--arrow--left",option:"arrowEl",onTap:pswp.prev},{name:"button--arrow--right",option:"arrowEl",onTap:pswp.next},{name:"button--fs",option:"fullscreenEl",onTap:function(){if(_fullscrenAPI.isFullscreen()){_fullscrenAPI.exit()}else{_fullscrenAPI.enter()}}},{name:"preloader",option:"preloaderEl",onInit:function(el){_loadingIndicator=el}}];var _setupUIElements=function(){var item,classAttr,uiElement;var loopThroughChildElements=function(sChildren){if(!sChildren){return}var l=sChildren.length;for(var i=0;i<l;i++){item=sChildren[i];classAttr=item.className;for(var a=0;a<_uiElements.length;a++){uiElement=_uiElements[a];if(classAttr.indexOf("pswp__"+uiElement.name)>-1){if(_options[uiElement.option]){framework.removeClass(item,"pswp__element--disabled");if(uiElement.onInit){uiElement.onInit(item)}}else{framework.addClass(item,"pswp__element--disabled")}}}}};loopThroughChildElements(_controls.children);var topBar=framework.getChildByClass(_controls,"pswp__top-bar");if(topBar){loopThroughChildElements(topBar.children)}};ui.init=function(){framework.extend(pswp.options,_defaultUIOptions,true);_options=pswp.options;_controls=framework.getChildByClass(pswp.scrollWrap,"pswp__ui");_listen=pswp.listen;_setupHidingControlsDuringGestures();_listen("beforeChange",ui.update);_listen("doubleTap",function(point){var initialZoomLevel=pswp.currItem.initialZoomLevel;if(pswp.getZoomLevel()!==initialZoomLevel){pswp.zoomTo(initialZoomLevel,point,333)}else{pswp.zoomTo(_options.getDoubleTapZoom(false,pswp.currItem),point,333)}});_listen("preventDragEvent",function(e,isDown,preventObj){var t=e.target||e.srcElement;if(t&&t.getAttribute("class")&&e.type.indexOf("mouse")>-1&&(t.getAttribute("class").indexOf("__caption")>0||(/(SMALL|STRONG|EM)/i).test(t.tagName))){preventObj.prevent=false}});_listen("bindEvents",function(){framework.bind(_controls,"pswpTap click",_onControlsTap);framework.bind(pswp.scrollWrap,"pswpTap",ui.onGlobalTap);if(!pswp.likelyTouchDevice){framework.bind(pswp.scrollWrap,"mouseover",ui.onMouseOver)}});_listen("unbindEvents",function(){if(!_shareModalHidden){_toggleShareModal()}if(_idleInterval){clearInterval(_idleInterval)}framework.unbind(document,"mouseout",_onMouseLeaveWindow);framework.unbind(document,"mousemove",_onIdleMouseMove);framework.unbind(_controls,"pswpTap click",_onControlsTap);framework.unbind(pswp.scrollWrap,"pswpTap",ui.onGlobalTap);framework.unbind(pswp.scrollWrap,"mouseover",ui.onMouseOver);if(_fullscrenAPI){framework.unbind(document,_fullscrenAPI.eventK,ui.updateFullscreen);if(_fullscrenAPI.isFullscreen()){_options.hideAnimationDuration=0;_fullscrenAPI.exit()}_fullscrenAPI=null}});_listen("destroy",function(){if(_options.captionEl){if(_fakeCaptionContainer){_controls.removeChild(_fakeCaptionContainer)}framework.removeClass(_captionContainer,"pswp__caption--empty")}if(_shareModal){_shareModal.children[0].onclick=null}framework.removeClass(_controls,"pswp__ui--over-close");framework.addClass(_controls,"pswp__ui--hidden");ui.setIdle(false)});if(!_options.showAnimationDuration){framework.removeClass(_controls,"pswp__ui--hidden")}_listen("initialZoomIn",function(){if(_options.showAnimationDuration){framework.removeClass(_controls,"pswp__ui--hidden")}});_listen("initialZoomOut",function(){framework.addClass(_controls,"pswp__ui--hidden")});_listen("parseVerticalMargin",_applyNavBarGaps);_setupUIElements();if(_options.shareEl&&_shareButton&&_shareModal){_shareModalHidden=true}_countNumItems();_setupIdle();_setupFullscreenAPI();_setupLoadingIndicator()};ui.setIdle=function(isIdle){_isIdle=isIdle;_togglePswpClass(_controls,"ui--idle",isIdle)};ui.update=function(){if(_controlsVisible&&pswp.currItem){ui.updateIndexIndicator();if(_options.captionEl){_options.addCaptionHTMLFn(pswp.currItem,_captionContainer);_togglePswpClass(_captionContainer,"caption--empty",!pswp.currItem.title)}_overlayUIUpdated=true}else{_overlayUIUpdated=false}if(!_shareModalHidden){_toggleShareModal()}_countNumItems()};ui.updateFullscreen=function(e){if(e){setTimeout(function(){pswp.setScrollOffset(0,framework.getScrollY())},50)}framework[(_fullscrenAPI.isFullscreen()?"add":"remove")+"Class"](pswp.template,"pswp--fs")};ui.updateIndexIndicator=function(){if(_options.counterEl){_indexIndicator.innerHTML=(pswp.getCurrentIndex()+1)+_options.indexIndicatorSep+_options.getNumItemsFn()}};ui.onGlobalTap=function(e){e=e||window.event;var target=e.target||e.srcElement;if(_blockControlsTap){return}if(e.detail&&e.detail.pointerType==="mouse"){if(_hasCloseClass(target)){pswp.close();return}if(framework.hasClass(target,"pswp__img")){if(pswp.getZoomLevel()===1&&pswp.getZoomLevel()<=pswp.currItem.fitRatio){if(_options.clickToCloseNonZoomable){pswp.close()}}else{pswp.toggleDesktopZoom(e.detail.releasePoint)}}}else{if(_options.tapToToggleControls){if(_controlsVisible){ui.hideControls()}else{ui.showControls()}}if(_options.tapToClose&&(framework.hasClass(target,"pswp__img")||_hasCloseClass(target))){pswp.close();return}}};ui.onMouseOver=function(e){e=e||window.event;var target=e.target||e.srcElement;_togglePswpClass(_controls,"ui--over-close",_hasCloseClass(target))};ui.hideControls=function(){framework.addClass(_controls,"pswp__ui--hidden");_controlsVisible=false};ui.showControls=function(){_controlsVisible=true;if(!_overlayUIUpdated){ui.update()}framework.removeClass(_controls,"pswp__ui--hidden")};ui.supportsFullscreen=function(){var d=document;return !!(d.exitFullscreen||d.mozCancelFullScreen||d.webkitExitFullscreen||d.msExitFullscreen)};ui.getFullscreenAPI=function(){var dE=document.documentElement,api,tF="fullscreenchange";if(dE.requestFullscreen){api={enterK:"requestFullscreen",exitK:"exitFullscreen",elementK:"fullscreenElement",eventK:tF}}else{if(dE.mozRequestFullScreen){api={enterK:"mozRequestFullScreen",exitK:"mozCancelFullScreen",elementK:"mozFullScreenElement",eventK:"moz"+tF}}else{if(dE.webkitRequestFullscreen){api={enterK:"webkitRequestFullscreen",exitK:"webkitExitFullscreen",elementK:"webkitFullscreenElement",eventK:"webkit"+tF}}else{if(dE.msRequestFullscreen){api={enterK:"msRequestFullscreen",exitK:"msExitFullscreen",elementK:"msFullscreenElement",eventK:"MSFullscreenChange"}}}}}if(api){api.enter=function(){_initalCloseOnScrollValue=_options.closeOnScroll;_options.closeOnScroll=false;if(this.enterK==="webkitRequestFullscreen"){pswp.template[this.enterK](Element.ALLOW_KEYBOARD_INPUT)}else{return pswp.template[this.enterK]()}};api.exit=function(){_options.closeOnScroll=_initalCloseOnScrollValue;return document[this.exitK]()};api.isFullscreen=function(){return document[this.elementK]}}return api}};return PhotoSwipeUI_Default});var FogSoft=(function(module,$,PhotoSwipe,PhotoSwipeUI_Default){var docModule=module.DocumentsPreview=module.DocumentsPreview||{};docModule.initPhotoSwipeFromDOM=function(gallerySelector){var parseThumbnailElements=function(el){var thumbElements=el.childNodes,numNodes=thumbElements.length,items=[],el,childElements,item;for(var i=0;i<numNodes;i++){el=thumbElements[i];if(el.nodeType!==1){continue}childElements=el.children;item={src:el.getAttribute("href"),w:-1,h:-1,title:$(childElements[0]).data("title")};item.el=el;if(childElements.length>0){item.msrc=childElements[0].getAttribute("src")}item.o={src:item.src,w:item.w,h:item.h};items.push(item)}return items};var closest=function closest(el,fn){return el&&(fn(el)?el:closest(el.parentNode,fn))};var onThumbnailsClick=function(e){e=e||window.event;e.preventDefault?e.preventDefault():e.returnValue=false;var eTarget=e.target||e.srcElement;var clickedListItem=closest(eTarget,function(el){return el.tagName==="A"});if(!clickedListItem){return}var clickedGallery=clickedListItem.parentNode;var childNodes=clickedListItem.parentNode.childNodes,numChildNodes=childNodes.length,nodeIndex=0,index;for(var i=0;i<numChildNodes;i++){if(childNodes[i].nodeType!==1){continue}if(childNodes[i]===clickedListItem){index=nodeIndex;break}nodeIndex++}if(index>=0){openPhotoSwipe(index,clickedGallery)}return false};var photoswipeParseHash=function(){var hash=window.location.hash.substring(1),params={};if(hash.length<5){return params}var vars=hash.split("&");for(var i=0;i<vars.length;i++){if(!vars[i]){continue}var pair=vars[i].split("=");if(pair.length<2){continue}params[pair[0]]=pair[1]}if(params.gid){params.gid=parseInt(params.gid,10)}return params};var openPhotoSwipe=function(index,galleryElement,disableAnimation,fromURL){var pswpElement=document.querySelectorAll(".pswp")[0],gallery,options,items;items=parseThumbnailElements(galleryElement);options={bgOpacity:0.7,showHideOpacity:true,hideAnimationDuration:0,showAnimationDuration:0,addCaptionHTMLFn:function(item,captionEl){captionEl.children[0].innerHTML="<b>ÐÐ¼Ñ ÑÐ°Ð¹Ð»Ð°: "+item.title+"</b>";return true}};if(fromURL){if(options.galleryPIDs){for(var j=0;j<items.length;j++){if(items[j].pid==index){options.index=j;break}}}else{options.index=parseInt(index,10)-1}}else{options.index=parseInt(index,10)}if(isNaN(options.index)){return}gallery=new PhotoSwipe(pswpElement,PhotoSwipeUI_Default,items,options);var realViewportWidth,useLargeImages=false,firstResize=true,imageSrcWillChange;gallery.listen("beforeResize",function(){var dpiRatio=window.devicePixelRatio?window.devicePixelRatio:1;dpiRatio=Math.min(dpiRatio,2.5);realViewportWidth=gallery.viewportSize.x*dpiRatio;if(realViewportWidth>=1200||(!gallery.likelyTouchDevice&&realViewportWidth>800)||screen.width>1200){if(!useLargeImages){useLargeImages=true;imageSrcWillChange=true}}else{if(useLargeImages){useLargeImages=false;imageSrcWillChange=true}}if(imageSrcWillChange&&!firstResize){gallery.invalidateCurrItems()}if(firstResize){firstResize=false}imageSrcWillChange=false});gallery.listen("gettingData",function(index,item){if(item.w<1||item.h<1){var img=new Image();img.onload=function(){item.w=this.width;item.h=this.height;gallery.updateSize(true)};img.src=item.src}});gallery.init()};var galleryElements=document.querySelectorAll(gallerySelector);for(var i=0,l=galleryElements.length;i<l;i++){galleryElements[i].setAttribute("data-pswp-uid",i+1);galleryElements[i].onclick=onThumbnailsClick}var hashData=photoswipeParseHash();if(hashData.pid&&hashData.gid){openPhotoSwipe(hashData.pid,galleryElements[hashData.gid-1],true,true)}};return module}(FogSoft||{},jQuery,window.PhotoSwipe,window.PhotoSwipeUI_Default));